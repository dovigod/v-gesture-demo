(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();function jS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var KS={exports:{}},Jp={},qS={exports:{}},Me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ic=Symbol.for("react.element"),XT=Symbol.for("react.portal"),YT=Symbol.for("react.fragment"),QT=Symbol.for("react.strict_mode"),ZT=Symbol.for("react.profiler"),JT=Symbol.for("react.provider"),eR=Symbol.for("react.context"),tR=Symbol.for("react.forward_ref"),nR=Symbol.for("react.suspense"),rR=Symbol.for("react.memo"),sR=Symbol.for("react.lazy"),qw=Symbol.iterator;function aR(t){return t===null||typeof t!="object"?null:(t=qw&&t[qw]||t["@@iterator"],typeof t=="function"?t:null)}var XS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},YS=Object.assign,QS={};function Nu(t,e,n){this.props=t,this.context=e,this.refs=QS,this.updater=n||XS}Nu.prototype.isReactComponent={};Nu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Nu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function ZS(){}ZS.prototype=Nu.prototype;function Vy(t,e,n){this.props=t,this.context=e,this.refs=QS,this.updater=n||XS}var zy=Vy.prototype=new ZS;zy.constructor=Vy;YS(zy,Nu.prototype);zy.isPureReactComponent=!0;var Xw=Array.isArray,JS=Object.prototype.hasOwnProperty,Wy={current:null},eC={key:!0,ref:!0,__self:!0,__source:!0};function tC(t,e,n){var r,s={},a=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(a=""+e.key),e)JS.call(e,r)&&!eC.hasOwnProperty(r)&&(s[r]=e[r]);var i=arguments.length-2;if(i===1)s.children=n;else if(1<i){for(var u=Array(i),c=0;c<i;c++)u[c]=arguments[c+2];s.children=u}if(t&&t.defaultProps)for(r in i=t.defaultProps,i)s[r]===void 0&&(s[r]=i[r]);return{$$typeof:Ic,type:t,key:a,ref:o,props:s,_owner:Wy.current}}function oR(t,e){return{$$typeof:Ic,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Uy(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ic}function iR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Yw=/\/+/g;function Jh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?iR(""+t.key):e.toString(36)}function Vd(t,e,n,r,s){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ic:case XT:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Jh(o,0):r,Xw(s)?(n="",t!=null&&(n=t.replace(Yw,"$&/")+"/"),Vd(s,e,n,"",function(c){return c})):s!=null&&(Uy(s)&&(s=oR(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Yw,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Xw(t))for(var i=0;i<t.length;i++){a=t[i];var u=r+Jh(a,i);o+=Vd(a,e,n,u,s)}else if(u=aR(t),typeof u=="function")for(t=u.call(t),i=0;!(a=t.next()).done;)a=a.value,u=r+Jh(a,i++),o+=Vd(a,e,n,u,s);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function id(t,e,n){if(t==null)return t;var r=[],s=0;return Vd(t,r,"","",function(a){return e.call(n,a,s++)}),r}function uR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var En={current:null},zd={transition:null},lR={ReactCurrentDispatcher:En,ReactCurrentBatchConfig:zd,ReactCurrentOwner:Wy};function nC(){throw Error("act(...) is not supported in production builds of React.")}Me.Children={map:id,forEach:function(t,e,n){id(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return id(t,function(){e++}),e},toArray:function(t){return id(t,function(e){return e})||[]},only:function(t){if(!Uy(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Me.Component=Nu;Me.Fragment=YT;Me.Profiler=ZT;Me.PureComponent=Vy;Me.StrictMode=QT;Me.Suspense=nR;Me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lR;Me.act=nC;Me.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=YS({},t.props),s=t.key,a=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,o=Wy.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var i=t.type.defaultProps;for(u in e)JS.call(e,u)&&!eC.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&i!==void 0?i[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){i=Array(u);for(var c=0;c<u;c++)i[c]=arguments[c+2];r.children=i}return{$$typeof:Ic,type:t.type,key:s,ref:a,props:r,_owner:o}};Me.createContext=function(t){return t={$$typeof:eR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:JT,_context:t},t.Consumer=t};Me.createElement=tC;Me.createFactory=function(t){var e=tC.bind(null,t);return e.type=t,e};Me.createRef=function(){return{current:null}};Me.forwardRef=function(t){return{$$typeof:tR,render:t}};Me.isValidElement=Uy;Me.lazy=function(t){return{$$typeof:sR,_payload:{_status:-1,_result:t},_init:uR}};Me.memo=function(t,e){return{$$typeof:rR,type:t,compare:e===void 0?null:e}};Me.startTransition=function(t){var e=zd.transition;zd.transition={};try{t()}finally{zd.transition=e}};Me.unstable_act=nC;Me.useCallback=function(t,e){return En.current.useCallback(t,e)};Me.useContext=function(t){return En.current.useContext(t)};Me.useDebugValue=function(){};Me.useDeferredValue=function(t){return En.current.useDeferredValue(t)};Me.useEffect=function(t,e){return En.current.useEffect(t,e)};Me.useId=function(){return En.current.useId()};Me.useImperativeHandle=function(t,e,n){return En.current.useImperativeHandle(t,e,n)};Me.useInsertionEffect=function(t,e){return En.current.useInsertionEffect(t,e)};Me.useLayoutEffect=function(t,e){return En.current.useLayoutEffect(t,e)};Me.useMemo=function(t,e){return En.current.useMemo(t,e)};Me.useReducer=function(t,e,n){return En.current.useReducer(t,e,n)};Me.useRef=function(t){return En.current.useRef(t)};Me.useState=function(t){return En.current.useState(t)};Me.useSyncExternalStore=function(t,e,n){return En.current.useSyncExternalStore(t,e,n)};Me.useTransition=function(){return En.current.useTransition()};Me.version="18.3.1";qS.exports=Me;var G=qS.exports;const cR=jS(G);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dR=G,pR=Symbol.for("react.element"),fR=Symbol.for("react.fragment"),hR=Object.prototype.hasOwnProperty,mR=dR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,gR={key:!0,ref:!0,__self:!0,__source:!0};function rC(t,e,n){var r,s={},a=null,o=null;n!==void 0&&(a=""+n),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)hR.call(e,r)&&!gR.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:pR,type:t,key:a,ref:o,props:s,_owner:mR.current}}Jp.Fragment=fR;Jp.jsx=rC;Jp.jsxs=rC;KS.exports=Jp;var Ee=KS.exports,qm={},sC={exports:{}},pr={},aC={exports:{}},oC={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(j,ee){var me=j.length;j.push(ee);e:for(;0<me;){var Ie=me-1>>>1,Pe=j[Ie];if(0<s(Pe,ee))j[Ie]=ee,j[me]=Pe,me=Ie;else break e}}function n(j){return j.length===0?null:j[0]}function r(j){if(j.length===0)return null;var ee=j[0],me=j.pop();if(me!==ee){j[0]=me;e:for(var Ie=0,Pe=j.length,Ge=Pe>>>1;Ie<Ge;){var _t=2*(Ie+1)-1,Pt=j[_t],Nt=_t+1,wn=j[Nt];if(0>s(Pt,me))Nt<Pe&&0>s(wn,Pt)?(j[Ie]=wn,j[Nt]=me,Ie=Nt):(j[Ie]=Pt,j[_t]=me,Ie=_t);else if(Nt<Pe&&0>s(wn,me))j[Ie]=wn,j[Nt]=me,Ie=Nt;else break e}}return ee}function s(j,ee){var me=j.sortIndex-ee.sortIndex;return me!==0?me:j.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,i=o.now();t.unstable_now=function(){return o.now()-i}}var u=[],c=[],l=1,d=null,p=3,f=!1,h=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(j){for(var ee=n(c);ee!==null;){if(ee.callback===null)r(c);else if(ee.startTime<=j)r(c),ee.sortIndex=ee.expirationTime,e(u,ee);else break;ee=n(c)}}function S(j){if(y=!1,w(j),!h)if(n(u)!==null)h=!0,de($);else{var ee=n(c);ee!==null&&ce(S,ee.startTime-j)}}function $(j,ee){h=!1,y&&(y=!1,g(A),A=-1),f=!0;var me=p;try{for(w(ee),d=n(u);d!==null&&(!(d.expirationTime>ee)||j&&!z());){var Ie=d.callback;if(typeof Ie=="function"){d.callback=null,p=d.priorityLevel;var Pe=Ie(d.expirationTime<=ee);ee=t.unstable_now(),typeof Pe=="function"?d.callback=Pe:d===n(u)&&r(u),w(ee)}else r(u);d=n(u)}if(d!==null)var Ge=!0;else{var _t=n(c);_t!==null&&ce(S,_t.startTime-ee),Ge=!1}return Ge}finally{d=null,p=me,f=!1}}var k=!1,T=null,A=-1,B=5,L=-1;function z(){return!(t.unstable_now()-L<B)}function Y(){if(T!==null){var j=t.unstable_now();L=j;var ee=!0;try{ee=T(!0,j)}finally{ee?Q():(k=!1,T=null)}}else k=!1}var Q;if(typeof v=="function")Q=function(){v(Y)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,Z=re.port2;re.port1.onmessage=Y,Q=function(){Z.postMessage(null)}}else Q=function(){x(Y,0)};function de(j){T=j,k||(k=!0,Q())}function ce(j,ee){A=x(function(){j(t.unstable_now())},ee)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(j){j.callback=null},t.unstable_continueExecution=function(){h||f||(h=!0,de($))},t.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<j?Math.floor(1e3/j):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(j){switch(p){case 1:case 2:case 3:var ee=3;break;default:ee=p}var me=p;p=ee;try{return j()}finally{p=me}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(j,ee){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var me=p;p=j;try{return ee()}finally{p=me}},t.unstable_scheduleCallback=function(j,ee,me){var Ie=t.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?Ie+me:Ie):me=Ie,j){case 1:var Pe=-1;break;case 2:Pe=250;break;case 5:Pe=1073741823;break;case 4:Pe=1e4;break;default:Pe=5e3}return Pe=me+Pe,j={id:l++,callback:ee,priorityLevel:j,startTime:me,expirationTime:Pe,sortIndex:-1},me>Ie?(j.sortIndex=me,e(c,j),n(u)===null&&j===n(c)&&(y?(g(A),A=-1):y=!0,ce(S,me-Ie))):(j.sortIndex=Pe,e(u,j),h||f||(h=!0,de($))),j},t.unstable_shouldYield=z,t.unstable_wrapCallback=function(j){var ee=p;return function(){var me=p;p=ee;try{return j.apply(this,arguments)}finally{p=me}}}})(oC);aC.exports=oC;var yR=aC.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xR=G,dr=yR;function ne(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var iC=new Set,Vl={};function ei(t,e){lu(t,e),lu(t+"Capture",e)}function lu(t,e){for(Vl[t]=e,t=0;t<e.length;t++)iC.add(e[t])}var Ks=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xm=Object.prototype.hasOwnProperty,vR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Qw={},Zw={};function wR(t){return Xm.call(Zw,t)?!0:Xm.call(Qw,t)?!1:vR.test(t)?Zw[t]=!0:(Qw[t]=!0,!1)}function bR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function SR(t,e,n,r){if(e===null||typeof e>"u"||bR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Tn(t,e,n,r,s,a,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=o}var sn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){sn[t]=new Tn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];sn[e]=new Tn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){sn[t]=new Tn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){sn[t]=new Tn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){sn[t]=new Tn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){sn[t]=new Tn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){sn[t]=new Tn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){sn[t]=new Tn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){sn[t]=new Tn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Gy=/[\-:]([a-z])/g;function Hy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Gy,Hy);sn[e]=new Tn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Gy,Hy);sn[e]=new Tn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Gy,Hy);sn[e]=new Tn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){sn[t]=new Tn(t,1,!1,t.toLowerCase(),null,!1,!1)});sn.xlinkHref=new Tn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){sn[t]=new Tn(t,1,!1,t.toLowerCase(),null,!0,!0)});function jy(t,e,n,r){var s=sn.hasOwnProperty(e)?sn[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(SR(e,n,s,r)&&(n=null),r||s===null?wR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ra=xR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ud=Symbol.for("react.element"),Mi=Symbol.for("react.portal"),Bi=Symbol.for("react.fragment"),Ky=Symbol.for("react.strict_mode"),Ym=Symbol.for("react.profiler"),uC=Symbol.for("react.provider"),lC=Symbol.for("react.context"),qy=Symbol.for("react.forward_ref"),Qm=Symbol.for("react.suspense"),Zm=Symbol.for("react.suspense_list"),Xy=Symbol.for("react.memo"),ga=Symbol.for("react.lazy"),cC=Symbol.for("react.offscreen"),Jw=Symbol.iterator;function rl(t){return t===null||typeof t!="object"?null:(t=Jw&&t[Jw]||t["@@iterator"],typeof t=="function"?t:null)}var St=Object.assign,em;function xl(t){if(em===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);em=e&&e[1]||""}return`
`+em+t}var tm=!1;function nm(t,e){if(!t||tm)return"";tm=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),a=r.stack.split(`
`),o=s.length-1,i=a.length-1;1<=o&&0<=i&&s[o]!==a[i];)i--;for(;1<=o&&0<=i;o--,i--)if(s[o]!==a[i]){if(o!==1||i!==1)do if(o--,i--,0>i||s[o]!==a[i]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=i);break}}}finally{tm=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?xl(t):""}function CR(t){switch(t.tag){case 5:return xl(t.type);case 16:return xl("Lazy");case 13:return xl("Suspense");case 19:return xl("SuspenseList");case 0:case 2:case 15:return t=nm(t.type,!1),t;case 11:return t=nm(t.type.render,!1),t;case 1:return t=nm(t.type,!0),t;default:return""}}function Jm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Bi:return"Fragment";case Mi:return"Portal";case Ym:return"Profiler";case Ky:return"StrictMode";case Qm:return"Suspense";case Zm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case lC:return(t.displayName||"Context")+".Consumer";case uC:return(t._context.displayName||"Context")+".Provider";case qy:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Xy:return e=t.displayName||null,e!==null?e:Jm(t.type)||"Memo";case ga:e=t._payload,t=t._init;try{return Jm(t(e))}catch{}}return null}function IR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Jm(e);case 8:return e===Ky?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ma(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function dC(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function $R(t){var e=dC(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,a.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ld(t){t._valueTracker||(t._valueTracker=$R(t))}function pC(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=dC(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function sp(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function eg(t,e){var n=e.checked;return St({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function e1(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ma(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function fC(t,e){e=e.checked,e!=null&&jy(t,"checked",e,!1)}function tg(t,e){fC(t,e);var n=Ma(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ng(t,e.type,n):e.hasOwnProperty("defaultValue")&&ng(t,e.type,Ma(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function t1(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function ng(t,e,n){(e!=="number"||sp(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var vl=Array.isArray;function Qi(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ma(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function rg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ne(91));return St({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function n1(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ne(92));if(vl(n)){if(1<n.length)throw Error(ne(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ma(n)}}function hC(t,e){var n=Ma(e.value),r=Ma(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function r1(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function mC(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function sg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?mC(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var cd,gC=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(cd=cd||document.createElement("div"),cd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=cd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function zl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Nl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},_R=["Webkit","ms","Moz","O"];Object.keys(Nl).forEach(function(t){_R.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Nl[e]=Nl[t]})});function yC(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Nl.hasOwnProperty(t)&&Nl[t]?(""+e).trim():e+"px"}function xC(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=yC(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var NR=St({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ag(t,e){if(e){if(NR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ne(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ne(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ne(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ne(62))}}function og(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ig=null;function Yy(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ug=null,Zi=null,Ji=null;function s1(t){if(t=Nc(t)){if(typeof ug!="function")throw Error(ne(280));var e=t.stateNode;e&&(e=sf(e),ug(t.stateNode,t.type,e))}}function vC(t){Zi?Ji?Ji.push(t):Ji=[t]:Zi=t}function wC(){if(Zi){var t=Zi,e=Ji;if(Ji=Zi=null,s1(t),e)for(t=0;t<e.length;t++)s1(e[t])}}function bC(t,e){return t(e)}function SC(){}var rm=!1;function CC(t,e,n){if(rm)return t(e,n);rm=!0;try{return bC(t,e,n)}finally{rm=!1,(Zi!==null||Ji!==null)&&(SC(),wC())}}function Wl(t,e){var n=t.stateNode;if(n===null)return null;var r=sf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ne(231,e,typeof n));return n}var lg=!1;if(Ks)try{var sl={};Object.defineProperty(sl,"passive",{get:function(){lg=!0}}),window.addEventListener("test",sl,sl),window.removeEventListener("test",sl,sl)}catch{lg=!1}function kR(t,e,n,r,s,a,o,i,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(l){this.onError(l)}}var kl=!1,ap=null,op=!1,cg=null,ER={onError:function(t){kl=!0,ap=t}};function TR(t,e,n,r,s,a,o,i,u){kl=!1,ap=null,kR.apply(ER,arguments)}function RR(t,e,n,r,s,a,o,i,u){if(TR.apply(this,arguments),kl){if(kl){var c=ap;kl=!1,ap=null}else throw Error(ne(198));op||(op=!0,cg=c)}}function ti(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function IC(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function a1(t){if(ti(t)!==t)throw Error(ne(188))}function AR(t){var e=t.alternate;if(!e){if(e=ti(t),e===null)throw Error(ne(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var a=s.alternate;if(a===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===n)return a1(s),t;if(a===r)return a1(s),e;a=a.sibling}throw Error(ne(188))}if(n.return!==r.return)n=s,r=a;else{for(var o=!1,i=s.child;i;){if(i===n){o=!0,n=s,r=a;break}if(i===r){o=!0,r=s,n=a;break}i=i.sibling}if(!o){for(i=a.child;i;){if(i===n){o=!0,n=a,r=s;break}if(i===r){o=!0,r=a,n=s;break}i=i.sibling}if(!o)throw Error(ne(189))}}if(n.alternate!==r)throw Error(ne(190))}if(n.tag!==3)throw Error(ne(188));return n.stateNode.current===n?t:e}function $C(t){return t=AR(t),t!==null?_C(t):null}function _C(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=_C(t);if(e!==null)return e;t=t.sibling}return null}var NC=dr.unstable_scheduleCallback,o1=dr.unstable_cancelCallback,OR=dr.unstable_shouldYield,DR=dr.unstable_requestPaint,Et=dr.unstable_now,PR=dr.unstable_getCurrentPriorityLevel,Qy=dr.unstable_ImmediatePriority,kC=dr.unstable_UserBlockingPriority,ip=dr.unstable_NormalPriority,FR=dr.unstable_LowPriority,EC=dr.unstable_IdlePriority,ef=null,$s=null;function LR(t){if($s&&typeof $s.onCommitFiberRoot=="function")try{$s.onCommitFiberRoot(ef,t,void 0,(t.current.flags&128)===128)}catch{}}var es=Math.clz32?Math.clz32:VR,MR=Math.log,BR=Math.LN2;function VR(t){return t>>>=0,t===0?32:31-(MR(t)/BR|0)|0}var dd=64,pd=4194304;function wl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function up(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,a=t.pingedLanes,o=n&268435455;if(o!==0){var i=o&~s;i!==0?r=wl(i):(a&=o,a!==0&&(r=wl(a)))}else o=n&~s,o!==0?r=wl(o):a!==0&&(r=wl(a));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,a=e&-e,s>=a||s===16&&(a&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-es(e),s=1<<n,r|=t[n],e&=~s;return r}function zR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function WR(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,a=t.pendingLanes;0<a;){var o=31-es(a),i=1<<o,u=s[o];u===-1?(!(i&n)||i&r)&&(s[o]=zR(i,e)):u<=e&&(t.expiredLanes|=i),a&=~i}}function dg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function TC(){var t=dd;return dd<<=1,!(dd&4194240)&&(dd=64),t}function sm(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function $c(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-es(e),t[e]=n}function UR(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-es(n),a=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~a}}function Zy(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-es(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var tt=0;function RC(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var AC,Jy,OC,DC,PC,pg=!1,fd=[],Na=null,ka=null,Ea=null,Ul=new Map,Gl=new Map,wa=[],GR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function i1(t,e){switch(t){case"focusin":case"focusout":Na=null;break;case"dragenter":case"dragleave":ka=null;break;case"mouseover":case"mouseout":Ea=null;break;case"pointerover":case"pointerout":Ul.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gl.delete(e.pointerId)}}function al(t,e,n,r,s,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[s]},e!==null&&(e=Nc(e),e!==null&&Jy(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function HR(t,e,n,r,s){switch(e){case"focusin":return Na=al(Na,t,e,n,r,s),!0;case"dragenter":return ka=al(ka,t,e,n,r,s),!0;case"mouseover":return Ea=al(Ea,t,e,n,r,s),!0;case"pointerover":var a=s.pointerId;return Ul.set(a,al(Ul.get(a)||null,t,e,n,r,s)),!0;case"gotpointercapture":return a=s.pointerId,Gl.set(a,al(Gl.get(a)||null,t,e,n,r,s)),!0}return!1}function FC(t){var e=$o(t.target);if(e!==null){var n=ti(e);if(n!==null){if(e=n.tag,e===13){if(e=IC(n),e!==null){t.blockedOn=e,PC(t.priority,function(){OC(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Wd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=fg(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);ig=r,n.target.dispatchEvent(r),ig=null}else return e=Nc(n),e!==null&&Jy(e),t.blockedOn=n,!1;e.shift()}return!0}function u1(t,e,n){Wd(t)&&n.delete(e)}function jR(){pg=!1,Na!==null&&Wd(Na)&&(Na=null),ka!==null&&Wd(ka)&&(ka=null),Ea!==null&&Wd(Ea)&&(Ea=null),Ul.forEach(u1),Gl.forEach(u1)}function ol(t,e){t.blockedOn===e&&(t.blockedOn=null,pg||(pg=!0,dr.unstable_scheduleCallback(dr.unstable_NormalPriority,jR)))}function Hl(t){function e(s){return ol(s,t)}if(0<fd.length){ol(fd[0],t);for(var n=1;n<fd.length;n++){var r=fd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Na!==null&&ol(Na,t),ka!==null&&ol(ka,t),Ea!==null&&ol(Ea,t),Ul.forEach(e),Gl.forEach(e),n=0;n<wa.length;n++)r=wa[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<wa.length&&(n=wa[0],n.blockedOn===null);)FC(n),n.blockedOn===null&&wa.shift()}var eu=ra.ReactCurrentBatchConfig,lp=!0;function KR(t,e,n,r){var s=tt,a=eu.transition;eu.transition=null;try{tt=1,e0(t,e,n,r)}finally{tt=s,eu.transition=a}}function qR(t,e,n,r){var s=tt,a=eu.transition;eu.transition=null;try{tt=4,e0(t,e,n,r)}finally{tt=s,eu.transition=a}}function e0(t,e,n,r){if(lp){var s=fg(t,e,n,r);if(s===null)hm(t,e,r,cp,n),i1(t,r);else if(HR(s,t,e,n,r))r.stopPropagation();else if(i1(t,r),e&4&&-1<GR.indexOf(t)){for(;s!==null;){var a=Nc(s);if(a!==null&&AC(a),a=fg(t,e,n,r),a===null&&hm(t,e,r,cp,n),a===s)break;s=a}s!==null&&r.stopPropagation()}else hm(t,e,r,null,n)}}var cp=null;function fg(t,e,n,r){if(cp=null,t=Yy(r),t=$o(t),t!==null)if(e=ti(t),e===null)t=null;else if(n=e.tag,n===13){if(t=IC(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return cp=t,null}function LC(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(PR()){case Qy:return 1;case kC:return 4;case ip:case FR:return 16;case EC:return 536870912;default:return 16}default:return 16}}var Ca=null,t0=null,Ud=null;function MC(){if(Ud)return Ud;var t,e=t0,n=e.length,r,s="value"in Ca?Ca.value:Ca.textContent,a=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[a-r];r++);return Ud=s.slice(t,1<r?1-r:void 0)}function Gd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function hd(){return!0}function l1(){return!1}function fr(t){function e(n,r,s,a,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var i in t)t.hasOwnProperty(i)&&(n=t[i],this[i]=n?n(a):a[i]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?hd:l1,this.isPropagationStopped=l1,this}return St(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=hd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=hd)},persist:function(){},isPersistent:hd}),e}var ku={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},n0=fr(ku),_c=St({},ku,{view:0,detail:0}),XR=fr(_c),am,om,il,tf=St({},_c,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:r0,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==il&&(il&&t.type==="mousemove"?(am=t.screenX-il.screenX,om=t.screenY-il.screenY):om=am=0,il=t),am)},movementY:function(t){return"movementY"in t?t.movementY:om}}),c1=fr(tf),YR=St({},tf,{dataTransfer:0}),QR=fr(YR),ZR=St({},_c,{relatedTarget:0}),im=fr(ZR),JR=St({},ku,{animationName:0,elapsedTime:0,pseudoElement:0}),eA=fr(JR),tA=St({},ku,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),nA=fr(tA),rA=St({},ku,{data:0}),d1=fr(rA),sA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},aA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},oA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function iA(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=oA[t])?!!e[t]:!1}function r0(){return iA}var uA=St({},_c,{key:function(t){if(t.key){var e=sA[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Gd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?aA[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:r0,charCode:function(t){return t.type==="keypress"?Gd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Gd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),lA=fr(uA),cA=St({},tf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),p1=fr(cA),dA=St({},_c,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:r0}),pA=fr(dA),fA=St({},ku,{propertyName:0,elapsedTime:0,pseudoElement:0}),hA=fr(fA),mA=St({},tf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),gA=fr(mA),yA=[9,13,27,32],s0=Ks&&"CompositionEvent"in window,El=null;Ks&&"documentMode"in document&&(El=document.documentMode);var xA=Ks&&"TextEvent"in window&&!El,BC=Ks&&(!s0||El&&8<El&&11>=El),f1=" ",h1=!1;function VC(t,e){switch(t){case"keyup":return yA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zC(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Vi=!1;function vA(t,e){switch(t){case"compositionend":return zC(e);case"keypress":return e.which!==32?null:(h1=!0,f1);case"textInput":return t=e.data,t===f1&&h1?null:t;default:return null}}function wA(t,e){if(Vi)return t==="compositionend"||!s0&&VC(t,e)?(t=MC(),Ud=t0=Ca=null,Vi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return BC&&e.locale!=="ko"?null:e.data;default:return null}}var bA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function m1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!bA[t.type]:e==="textarea"}function WC(t,e,n,r){vC(r),e=dp(e,"onChange"),0<e.length&&(n=new n0("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Tl=null,jl=null;function SA(t){JC(t,0)}function nf(t){var e=Ui(t);if(pC(e))return t}function CA(t,e){if(t==="change")return e}var UC=!1;if(Ks){var um;if(Ks){var lm="oninput"in document;if(!lm){var g1=document.createElement("div");g1.setAttribute("oninput","return;"),lm=typeof g1.oninput=="function"}um=lm}else um=!1;UC=um&&(!document.documentMode||9<document.documentMode)}function y1(){Tl&&(Tl.detachEvent("onpropertychange",GC),jl=Tl=null)}function GC(t){if(t.propertyName==="value"&&nf(jl)){var e=[];WC(e,jl,t,Yy(t)),CC(SA,e)}}function IA(t,e,n){t==="focusin"?(y1(),Tl=e,jl=n,Tl.attachEvent("onpropertychange",GC)):t==="focusout"&&y1()}function $A(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return nf(jl)}function _A(t,e){if(t==="click")return nf(e)}function NA(t,e){if(t==="input"||t==="change")return nf(e)}function kA(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var os=typeof Object.is=="function"?Object.is:kA;function Kl(t,e){if(os(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Xm.call(e,s)||!os(t[s],e[s]))return!1}return!0}function x1(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function v1(t,e){var n=x1(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=x1(n)}}function HC(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?HC(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function jC(){for(var t=window,e=sp();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=sp(t.document)}return e}function a0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function EA(t){var e=jC(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&HC(n.ownerDocument.documentElement,n)){if(r!==null&&a0(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,a=Math.min(r.start,s);r=r.end===void 0?a:Math.min(r.end,s),!t.extend&&a>r&&(s=r,r=a,a=s),s=v1(n,a);var o=v1(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),a>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var TA=Ks&&"documentMode"in document&&11>=document.documentMode,zi=null,hg=null,Rl=null,mg=!1;function w1(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;mg||zi==null||zi!==sp(r)||(r=zi,"selectionStart"in r&&a0(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Rl&&Kl(Rl,r)||(Rl=r,r=dp(hg,"onSelect"),0<r.length&&(e=new n0("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=zi)))}function md(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Wi={animationend:md("Animation","AnimationEnd"),animationiteration:md("Animation","AnimationIteration"),animationstart:md("Animation","AnimationStart"),transitionend:md("Transition","TransitionEnd")},cm={},KC={};Ks&&(KC=document.createElement("div").style,"AnimationEvent"in window||(delete Wi.animationend.animation,delete Wi.animationiteration.animation,delete Wi.animationstart.animation),"TransitionEvent"in window||delete Wi.transitionend.transition);function rf(t){if(cm[t])return cm[t];if(!Wi[t])return t;var e=Wi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in KC)return cm[t]=e[n];return t}var qC=rf("animationend"),XC=rf("animationiteration"),YC=rf("animationstart"),QC=rf("transitionend"),ZC=new Map,b1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qa(t,e){ZC.set(t,e),ei(e,[t])}for(var dm=0;dm<b1.length;dm++){var pm=b1[dm],RA=pm.toLowerCase(),AA=pm[0].toUpperCase()+pm.slice(1);qa(RA,"on"+AA)}qa(qC,"onAnimationEnd");qa(XC,"onAnimationIteration");qa(YC,"onAnimationStart");qa("dblclick","onDoubleClick");qa("focusin","onFocus");qa("focusout","onBlur");qa(QC,"onTransitionEnd");lu("onMouseEnter",["mouseout","mouseover"]);lu("onMouseLeave",["mouseout","mouseover"]);lu("onPointerEnter",["pointerout","pointerover"]);lu("onPointerLeave",["pointerout","pointerover"]);ei("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ei("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ei("onBeforeInput",["compositionend","keypress","textInput","paste"]);ei("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ei("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ei("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),OA=new Set("cancel close invalid load scroll toggle".split(" ").concat(bl));function S1(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,RR(r,e,void 0,t),t.currentTarget=null}function JC(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var a=void 0;if(e)for(var o=r.length-1;0<=o;o--){var i=r[o],u=i.instance,c=i.currentTarget;if(i=i.listener,u!==a&&s.isPropagationStopped())break e;S1(s,i,c),a=u}else for(o=0;o<r.length;o++){if(i=r[o],u=i.instance,c=i.currentTarget,i=i.listener,u!==a&&s.isPropagationStopped())break e;S1(s,i,c),a=u}}}if(op)throw t=cg,op=!1,cg=null,t}function dt(t,e){var n=e[wg];n===void 0&&(n=e[wg]=new Set);var r=t+"__bubble";n.has(r)||(eI(e,t,2,!1),n.add(r))}function fm(t,e,n){var r=0;e&&(r|=4),eI(n,t,r,e)}var gd="_reactListening"+Math.random().toString(36).slice(2);function ql(t){if(!t[gd]){t[gd]=!0,iC.forEach(function(n){n!=="selectionchange"&&(OA.has(n)||fm(n,!1,t),fm(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[gd]||(e[gd]=!0,fm("selectionchange",!1,e))}}function eI(t,e,n,r){switch(LC(e)){case 1:var s=KR;break;case 4:s=qR;break;default:s=e0}n=s.bind(null,e,n,t),s=void 0,!lg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function hm(t,e,n,r,s){var a=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var i=r.stateNode.containerInfo;if(i===s||i.nodeType===8&&i.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;i!==null;){if(o=$o(i),o===null)return;if(u=o.tag,u===5||u===6){r=a=o;continue e}i=i.parentNode}}r=r.return}CC(function(){var c=a,l=Yy(n),d=[];e:{var p=ZC.get(t);if(p!==void 0){var f=n0,h=t;switch(t){case"keypress":if(Gd(n)===0)break e;case"keydown":case"keyup":f=lA;break;case"focusin":h="focus",f=im;break;case"focusout":h="blur",f=im;break;case"beforeblur":case"afterblur":f=im;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=c1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=QR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=pA;break;case qC:case XC:case YC:f=eA;break;case QC:f=hA;break;case"scroll":f=XR;break;case"wheel":f=gA;break;case"copy":case"cut":case"paste":f=nA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=p1}var y=(e&4)!==0,x=!y&&t==="scroll",g=y?p!==null?p+"Capture":null:p;y=[];for(var v=c,w;v!==null;){w=v;var S=w.stateNode;if(w.tag===5&&S!==null&&(w=S,g!==null&&(S=Wl(v,g),S!=null&&y.push(Xl(v,S,w)))),x)break;v=v.return}0<y.length&&(p=new f(p,h,null,n,l),d.push({event:p,listeners:y}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",p&&n!==ig&&(h=n.relatedTarget||n.fromElement)&&($o(h)||h[qs]))break e;if((f||p)&&(p=l.window===l?l:(p=l.ownerDocument)?p.defaultView||p.parentWindow:window,f?(h=n.relatedTarget||n.toElement,f=c,h=h?$o(h):null,h!==null&&(x=ti(h),h!==x||h.tag!==5&&h.tag!==6)&&(h=null)):(f=null,h=c),f!==h)){if(y=c1,S="onMouseLeave",g="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(y=p1,S="onPointerLeave",g="onPointerEnter",v="pointer"),x=f==null?p:Ui(f),w=h==null?p:Ui(h),p=new y(S,v+"leave",f,n,l),p.target=x,p.relatedTarget=w,S=null,$o(l)===c&&(y=new y(g,v+"enter",h,n,l),y.target=w,y.relatedTarget=x,S=y),x=S,f&&h)t:{for(y=f,g=h,v=0,w=y;w;w=Ai(w))v++;for(w=0,S=g;S;S=Ai(S))w++;for(;0<v-w;)y=Ai(y),v--;for(;0<w-v;)g=Ai(g),w--;for(;v--;){if(y===g||g!==null&&y===g.alternate)break t;y=Ai(y),g=Ai(g)}y=null}else y=null;f!==null&&C1(d,p,f,y,!1),h!==null&&x!==null&&C1(d,x,h,y,!0)}}e:{if(p=c?Ui(c):window,f=p.nodeName&&p.nodeName.toLowerCase(),f==="select"||f==="input"&&p.type==="file")var $=CA;else if(m1(p))if(UC)$=NA;else{$=$A;var k=IA}else(f=p.nodeName)&&f.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&($=_A);if($&&($=$(t,c))){WC(d,$,n,l);break e}k&&k(t,p,c),t==="focusout"&&(k=p._wrapperState)&&k.controlled&&p.type==="number"&&ng(p,"number",p.value)}switch(k=c?Ui(c):window,t){case"focusin":(m1(k)||k.contentEditable==="true")&&(zi=k,hg=c,Rl=null);break;case"focusout":Rl=hg=zi=null;break;case"mousedown":mg=!0;break;case"contextmenu":case"mouseup":case"dragend":mg=!1,w1(d,n,l);break;case"selectionchange":if(TA)break;case"keydown":case"keyup":w1(d,n,l)}var T;if(s0)e:{switch(t){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Vi?VC(t,n)&&(A="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(A="onCompositionStart");A&&(BC&&n.locale!=="ko"&&(Vi||A!=="onCompositionStart"?A==="onCompositionEnd"&&Vi&&(T=MC()):(Ca=l,t0="value"in Ca?Ca.value:Ca.textContent,Vi=!0)),k=dp(c,A),0<k.length&&(A=new d1(A,t,null,n,l),d.push({event:A,listeners:k}),T?A.data=T:(T=zC(n),T!==null&&(A.data=T)))),(T=xA?vA(t,n):wA(t,n))&&(c=dp(c,"onBeforeInput"),0<c.length&&(l=new d1("onBeforeInput","beforeinput",null,n,l),d.push({event:l,listeners:c}),l.data=T))}JC(d,e)})}function Xl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function dp(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=Wl(t,n),a!=null&&r.unshift(Xl(t,a,s)),a=Wl(t,e),a!=null&&r.push(Xl(t,a,s))),t=t.return}return r}function Ai(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function C1(t,e,n,r,s){for(var a=e._reactName,o=[];n!==null&&n!==r;){var i=n,u=i.alternate,c=i.stateNode;if(u!==null&&u===r)break;i.tag===5&&c!==null&&(i=c,s?(u=Wl(n,a),u!=null&&o.unshift(Xl(n,u,i))):s||(u=Wl(n,a),u!=null&&o.push(Xl(n,u,i)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var DA=/\r\n?/g,PA=/\u0000|\uFFFD/g;function I1(t){return(typeof t=="string"?t:""+t).replace(DA,`
`).replace(PA,"")}function yd(t,e,n){if(e=I1(e),I1(t)!==e&&n)throw Error(ne(425))}function pp(){}var gg=null,yg=null;function xg(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var vg=typeof setTimeout=="function"?setTimeout:void 0,FA=typeof clearTimeout=="function"?clearTimeout:void 0,$1=typeof Promise=="function"?Promise:void 0,LA=typeof queueMicrotask=="function"?queueMicrotask:typeof $1<"u"?function(t){return $1.resolve(null).then(t).catch(MA)}:vg;function MA(t){setTimeout(function(){throw t})}function mm(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Hl(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Hl(e)}function Ta(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function _1(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Eu=Math.random().toString(36).slice(2),bs="__reactFiber$"+Eu,Yl="__reactProps$"+Eu,qs="__reactContainer$"+Eu,wg="__reactEvents$"+Eu,BA="__reactListeners$"+Eu,VA="__reactHandles$"+Eu;function $o(t){var e=t[bs];if(e)return e;for(var n=t.parentNode;n;){if(e=n[qs]||n[bs]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=_1(t);t!==null;){if(n=t[bs])return n;t=_1(t)}return e}t=n,n=t.parentNode}return null}function Nc(t){return t=t[bs]||t[qs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ui(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ne(33))}function sf(t){return t[Yl]||null}var bg=[],Gi=-1;function Xa(t){return{current:t}}function pt(t){0>Gi||(t.current=bg[Gi],bg[Gi]=null,Gi--)}function it(t,e){Gi++,bg[Gi]=t.current,t.current=e}var Ba={},yn=Xa(Ba),Hn=Xa(!1),Fo=Ba;function cu(t,e){var n=t.type.contextTypes;if(!n)return Ba;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in n)s[a]=e[a];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function jn(t){return t=t.childContextTypes,t!=null}function fp(){pt(Hn),pt(yn)}function N1(t,e,n){if(yn.current!==Ba)throw Error(ne(168));it(yn,e),it(Hn,n)}function tI(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(ne(108,IR(t)||"Unknown",s));return St({},n,r)}function hp(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ba,Fo=yn.current,it(yn,t),it(Hn,Hn.current),!0}function k1(t,e,n){var r=t.stateNode;if(!r)throw Error(ne(169));n?(t=tI(t,e,Fo),r.__reactInternalMemoizedMergedChildContext=t,pt(Hn),pt(yn),it(yn,t)):pt(Hn),it(Hn,n)}var Ms=null,af=!1,gm=!1;function nI(t){Ms===null?Ms=[t]:Ms.push(t)}function zA(t){af=!0,nI(t)}function Ya(){if(!gm&&Ms!==null){gm=!0;var t=0,e=tt;try{var n=Ms;for(tt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ms=null,af=!1}catch(s){throw Ms!==null&&(Ms=Ms.slice(t+1)),NC(Qy,Ya),s}finally{tt=e,gm=!1}}return null}var Hi=[],ji=0,mp=null,gp=0,_r=[],Nr=0,Lo=null,Us=1,Gs="";function xo(t,e){Hi[ji++]=gp,Hi[ji++]=mp,mp=t,gp=e}function rI(t,e,n){_r[Nr++]=Us,_r[Nr++]=Gs,_r[Nr++]=Lo,Lo=t;var r=Us;t=Gs;var s=32-es(r)-1;r&=~(1<<s),n+=1;var a=32-es(e)+s;if(30<a){var o=s-s%5;a=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Us=1<<32-es(e)+s|n<<s|r,Gs=a+t}else Us=1<<a|n<<s|r,Gs=t}function o0(t){t.return!==null&&(xo(t,1),rI(t,1,0))}function i0(t){for(;t===mp;)mp=Hi[--ji],Hi[ji]=null,gp=Hi[--ji],Hi[ji]=null;for(;t===Lo;)Lo=_r[--Nr],_r[Nr]=null,Gs=_r[--Nr],_r[Nr]=null,Us=_r[--Nr],_r[Nr]=null}var ur=null,or=null,mt=!1,Yr=null;function sI(t,e){var n=Er(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function E1(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ur=t,or=Ta(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ur=t,or=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Lo!==null?{id:Us,overflow:Gs}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Er(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ur=t,or=null,!0):!1;default:return!1}}function Sg(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Cg(t){if(mt){var e=or;if(e){var n=e;if(!E1(t,e)){if(Sg(t))throw Error(ne(418));e=Ta(n.nextSibling);var r=ur;e&&E1(t,e)?sI(r,n):(t.flags=t.flags&-4097|2,mt=!1,ur=t)}}else{if(Sg(t))throw Error(ne(418));t.flags=t.flags&-4097|2,mt=!1,ur=t}}}function T1(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ur=t}function xd(t){if(t!==ur)return!1;if(!mt)return T1(t),mt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!xg(t.type,t.memoizedProps)),e&&(e=or)){if(Sg(t))throw aI(),Error(ne(418));for(;e;)sI(t,e),e=Ta(e.nextSibling)}if(T1(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ne(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){or=Ta(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}or=null}}else or=ur?Ta(t.stateNode.nextSibling):null;return!0}function aI(){for(var t=or;t;)t=Ta(t.nextSibling)}function du(){or=ur=null,mt=!1}function u0(t){Yr===null?Yr=[t]:Yr.push(t)}var WA=ra.ReactCurrentBatchConfig;function ul(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ne(309));var r=n.stateNode}if(!r)throw Error(ne(147,t));var s=r,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(o){var i=s.refs;o===null?delete i[a]:i[a]=o},e._stringRef=a,e)}if(typeof t!="string")throw Error(ne(284));if(!n._owner)throw Error(ne(290,t))}return t}function vd(t,e){throw t=Object.prototype.toString.call(e),Error(ne(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function R1(t){var e=t._init;return e(t._payload)}function oI(t){function e(g,v){if(t){var w=g.deletions;w===null?(g.deletions=[v],g.flags|=16):w.push(v)}}function n(g,v){if(!t)return null;for(;v!==null;)e(g,v),v=v.sibling;return null}function r(g,v){for(g=new Map;v!==null;)v.key!==null?g.set(v.key,v):g.set(v.index,v),v=v.sibling;return g}function s(g,v){return g=Da(g,v),g.index=0,g.sibling=null,g}function a(g,v,w){return g.index=w,t?(w=g.alternate,w!==null?(w=w.index,w<v?(g.flags|=2,v):w):(g.flags|=2,v)):(g.flags|=1048576,v)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function i(g,v,w,S){return v===null||v.tag!==6?(v=Cm(w,g.mode,S),v.return=g,v):(v=s(v,w),v.return=g,v)}function u(g,v,w,S){var $=w.type;return $===Bi?l(g,v,w.props.children,S,w.key):v!==null&&(v.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===ga&&R1($)===v.type)?(S=s(v,w.props),S.ref=ul(g,v,w),S.return=g,S):(S=Qd(w.type,w.key,w.props,null,g.mode,S),S.ref=ul(g,v,w),S.return=g,S)}function c(g,v,w,S){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=Im(w,g.mode,S),v.return=g,v):(v=s(v,w.children||[]),v.return=g,v)}function l(g,v,w,S,$){return v===null||v.tag!==7?(v=Ao(w,g.mode,S,$),v.return=g,v):(v=s(v,w),v.return=g,v)}function d(g,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Cm(""+v,g.mode,w),v.return=g,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case ud:return w=Qd(v.type,v.key,v.props,null,g.mode,w),w.ref=ul(g,null,v),w.return=g,w;case Mi:return v=Im(v,g.mode,w),v.return=g,v;case ga:var S=v._init;return d(g,S(v._payload),w)}if(vl(v)||rl(v))return v=Ao(v,g.mode,w,null),v.return=g,v;vd(g,v)}return null}function p(g,v,w,S){var $=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return $!==null?null:i(g,v,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ud:return w.key===$?u(g,v,w,S):null;case Mi:return w.key===$?c(g,v,w,S):null;case ga:return $=w._init,p(g,v,$(w._payload),S)}if(vl(w)||rl(w))return $!==null?null:l(g,v,w,S,null);vd(g,w)}return null}function f(g,v,w,S,$){if(typeof S=="string"&&S!==""||typeof S=="number")return g=g.get(w)||null,i(v,g,""+S,$);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case ud:return g=g.get(S.key===null?w:S.key)||null,u(v,g,S,$);case Mi:return g=g.get(S.key===null?w:S.key)||null,c(v,g,S,$);case ga:var k=S._init;return f(g,v,w,k(S._payload),$)}if(vl(S)||rl(S))return g=g.get(w)||null,l(v,g,S,$,null);vd(v,S)}return null}function h(g,v,w,S){for(var $=null,k=null,T=v,A=v=0,B=null;T!==null&&A<w.length;A++){T.index>A?(B=T,T=null):B=T.sibling;var L=p(g,T,w[A],S);if(L===null){T===null&&(T=B);break}t&&T&&L.alternate===null&&e(g,T),v=a(L,v,A),k===null?$=L:k.sibling=L,k=L,T=B}if(A===w.length)return n(g,T),mt&&xo(g,A),$;if(T===null){for(;A<w.length;A++)T=d(g,w[A],S),T!==null&&(v=a(T,v,A),k===null?$=T:k.sibling=T,k=T);return mt&&xo(g,A),$}for(T=r(g,T);A<w.length;A++)B=f(T,g,A,w[A],S),B!==null&&(t&&B.alternate!==null&&T.delete(B.key===null?A:B.key),v=a(B,v,A),k===null?$=B:k.sibling=B,k=B);return t&&T.forEach(function(z){return e(g,z)}),mt&&xo(g,A),$}function y(g,v,w,S){var $=rl(w);if(typeof $!="function")throw Error(ne(150));if(w=$.call(w),w==null)throw Error(ne(151));for(var k=$=null,T=v,A=v=0,B=null,L=w.next();T!==null&&!L.done;A++,L=w.next()){T.index>A?(B=T,T=null):B=T.sibling;var z=p(g,T,L.value,S);if(z===null){T===null&&(T=B);break}t&&T&&z.alternate===null&&e(g,T),v=a(z,v,A),k===null?$=z:k.sibling=z,k=z,T=B}if(L.done)return n(g,T),mt&&xo(g,A),$;if(T===null){for(;!L.done;A++,L=w.next())L=d(g,L.value,S),L!==null&&(v=a(L,v,A),k===null?$=L:k.sibling=L,k=L);return mt&&xo(g,A),$}for(T=r(g,T);!L.done;A++,L=w.next())L=f(T,g,A,L.value,S),L!==null&&(t&&L.alternate!==null&&T.delete(L.key===null?A:L.key),v=a(L,v,A),k===null?$=L:k.sibling=L,k=L);return t&&T.forEach(function(Y){return e(g,Y)}),mt&&xo(g,A),$}function x(g,v,w,S){if(typeof w=="object"&&w!==null&&w.type===Bi&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case ud:e:{for(var $=w.key,k=v;k!==null;){if(k.key===$){if($=w.type,$===Bi){if(k.tag===7){n(g,k.sibling),v=s(k,w.props.children),v.return=g,g=v;break e}}else if(k.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===ga&&R1($)===k.type){n(g,k.sibling),v=s(k,w.props),v.ref=ul(g,k,w),v.return=g,g=v;break e}n(g,k);break}else e(g,k);k=k.sibling}w.type===Bi?(v=Ao(w.props.children,g.mode,S,w.key),v.return=g,g=v):(S=Qd(w.type,w.key,w.props,null,g.mode,S),S.ref=ul(g,v,w),S.return=g,g=S)}return o(g);case Mi:e:{for(k=w.key;v!==null;){if(v.key===k)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){n(g,v.sibling),v=s(v,w.children||[]),v.return=g,g=v;break e}else{n(g,v);break}else e(g,v);v=v.sibling}v=Im(w,g.mode,S),v.return=g,g=v}return o(g);case ga:return k=w._init,x(g,v,k(w._payload),S)}if(vl(w))return h(g,v,w,S);if(rl(w))return y(g,v,w,S);vd(g,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(n(g,v.sibling),v=s(v,w),v.return=g,g=v):(n(g,v),v=Cm(w,g.mode,S),v.return=g,g=v),o(g)):n(g,v)}return x}var pu=oI(!0),iI=oI(!1),yp=Xa(null),xp=null,Ki=null,l0=null;function c0(){l0=Ki=xp=null}function d0(t){var e=yp.current;pt(yp),t._currentValue=e}function Ig(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function tu(t,e){xp=t,l0=Ki=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Un=!0),t.firstContext=null)}function Pr(t){var e=t._currentValue;if(l0!==t)if(t={context:t,memoizedValue:e,next:null},Ki===null){if(xp===null)throw Error(ne(308));Ki=t,xp.dependencies={lanes:0,firstContext:t}}else Ki=Ki.next=t;return e}var _o=null;function p0(t){_o===null?_o=[t]:_o.push(t)}function uI(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,p0(e)):(n.next=s.next,s.next=n),e.interleaved=n,Xs(t,r)}function Xs(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ya=!1;function f0(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lI(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function js(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ra(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,He&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Xs(t,n)}return s=r.interleaved,s===null?(e.next=e,p0(r)):(e.next=s.next,s.next=e),r.interleaved=e,Xs(t,n)}function Hd(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Zy(t,n)}}function A1(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?s=a=o:a=a.next=o,n=n.next}while(n!==null);a===null?s=a=e:a=a.next=e}else s=a=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function vp(t,e,n,r){var s=t.updateQueue;ya=!1;var a=s.firstBaseUpdate,o=s.lastBaseUpdate,i=s.shared.pending;if(i!==null){s.shared.pending=null;var u=i,c=u.next;u.next=null,o===null?a=c:o.next=c,o=u;var l=t.alternate;l!==null&&(l=l.updateQueue,i=l.lastBaseUpdate,i!==o&&(i===null?l.firstBaseUpdate=c:i.next=c,l.lastBaseUpdate=u))}if(a!==null){var d=s.baseState;o=0,l=c=u=null,i=a;do{var p=i.lane,f=i.eventTime;if((r&p)===p){l!==null&&(l=l.next={eventTime:f,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var h=t,y=i;switch(p=e,f=n,y.tag){case 1:if(h=y.payload,typeof h=="function"){d=h.call(f,d,p);break e}d=h;break e;case 3:h.flags=h.flags&-65537|128;case 0:if(h=y.payload,p=typeof h=="function"?h.call(f,d,p):h,p==null)break e;d=St({},d,p);break e;case 2:ya=!0}}i.callback!==null&&i.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[i]:p.push(i))}else f={eventTime:f,lane:p,tag:i.tag,payload:i.payload,callback:i.callback,next:null},l===null?(c=l=f,u=d):l=l.next=f,o|=p;if(i=i.next,i===null){if(i=s.shared.pending,i===null)break;p=i,i=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(l===null&&(u=d),s.baseState=u,s.firstBaseUpdate=c,s.lastBaseUpdate=l,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else a===null&&(s.shared.lanes=0);Bo|=o,t.lanes=o,t.memoizedState=d}}function O1(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(ne(191,s));s.call(r)}}}var kc={},_s=Xa(kc),Ql=Xa(kc),Zl=Xa(kc);function No(t){if(t===kc)throw Error(ne(174));return t}function h0(t,e){switch(it(Zl,e),it(Ql,t),it(_s,kc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:sg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=sg(e,t)}pt(_s),it(_s,e)}function fu(){pt(_s),pt(Ql),pt(Zl)}function cI(t){No(Zl.current);var e=No(_s.current),n=sg(e,t.type);e!==n&&(it(Ql,t),it(_s,n))}function m0(t){Ql.current===t&&(pt(_s),pt(Ql))}var wt=Xa(0);function wp(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ym=[];function g0(){for(var t=0;t<ym.length;t++)ym[t]._workInProgressVersionPrimary=null;ym.length=0}var jd=ra.ReactCurrentDispatcher,xm=ra.ReactCurrentBatchConfig,Mo=0,bt=null,Lt=null,Ut=null,bp=!1,Al=!1,Jl=0,UA=0;function cn(){throw Error(ne(321))}function y0(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!os(t[n],e[n]))return!1;return!0}function x0(t,e,n,r,s,a){if(Mo=a,bt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,jd.current=t===null||t.memoizedState===null?KA:qA,t=n(r,s),Al){a=0;do{if(Al=!1,Jl=0,25<=a)throw Error(ne(301));a+=1,Ut=Lt=null,e.updateQueue=null,jd.current=XA,t=n(r,s)}while(Al)}if(jd.current=Sp,e=Lt!==null&&Lt.next!==null,Mo=0,Ut=Lt=bt=null,bp=!1,e)throw Error(ne(300));return t}function v0(){var t=Jl!==0;return Jl=0,t}function xs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ut===null?bt.memoizedState=Ut=t:Ut=Ut.next=t,Ut}function Fr(){if(Lt===null){var t=bt.alternate;t=t!==null?t.memoizedState:null}else t=Lt.next;var e=Ut===null?bt.memoizedState:Ut.next;if(e!==null)Ut=e,Lt=t;else{if(t===null)throw Error(ne(310));Lt=t,t={memoizedState:Lt.memoizedState,baseState:Lt.baseState,baseQueue:Lt.baseQueue,queue:Lt.queue,next:null},Ut===null?bt.memoizedState=Ut=t:Ut=Ut.next=t}return Ut}function ec(t,e){return typeof e=="function"?e(t):e}function vm(t){var e=Fr(),n=e.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=t;var r=Lt,s=r.baseQueue,a=n.pending;if(a!==null){if(s!==null){var o=s.next;s.next=a.next,a.next=o}r.baseQueue=s=a,n.pending=null}if(s!==null){a=s.next,r=r.baseState;var i=o=null,u=null,c=a;do{var l=c.lane;if((Mo&l)===l)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var d={lane:l,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(i=u=d,o=r):u=u.next=d,bt.lanes|=l,Bo|=l}c=c.next}while(c!==null&&c!==a);u===null?o=r:u.next=i,os(r,e.memoizedState)||(Un=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do a=s.lane,bt.lanes|=a,Bo|=a,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function wm(t){var e=Fr(),n=e.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,a=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do a=t(a,o.action),o=o.next;while(o!==s);os(a,e.memoizedState)||(Un=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),n.lastRenderedState=a}return[a,r]}function dI(){}function pI(t,e){var n=bt,r=Fr(),s=e(),a=!os(r.memoizedState,s);if(a&&(r.memoizedState=s,Un=!0),r=r.queue,w0(mI.bind(null,n,r,t),[t]),r.getSnapshot!==e||a||Ut!==null&&Ut.memoizedState.tag&1){if(n.flags|=2048,tc(9,hI.bind(null,n,r,s,e),void 0,null),jt===null)throw Error(ne(349));Mo&30||fI(n,e,s)}return s}function fI(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=bt.updateQueue,e===null?(e={lastEffect:null,stores:null},bt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function hI(t,e,n,r){e.value=n,e.getSnapshot=r,gI(e)&&yI(t)}function mI(t,e,n){return n(function(){gI(e)&&yI(t)})}function gI(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!os(t,n)}catch{return!0}}function yI(t){var e=Xs(t,1);e!==null&&ts(e,t,1,-1)}function D1(t){var e=xs();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ec,lastRenderedState:t},e.queue=t,t=t.dispatch=jA.bind(null,bt,t),[e.memoizedState,t]}function tc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=bt.updateQueue,e===null?(e={lastEffect:null,stores:null},bt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function xI(){return Fr().memoizedState}function Kd(t,e,n,r){var s=xs();bt.flags|=t,s.memoizedState=tc(1|e,n,void 0,r===void 0?null:r)}function of(t,e,n,r){var s=Fr();r=r===void 0?null:r;var a=void 0;if(Lt!==null){var o=Lt.memoizedState;if(a=o.destroy,r!==null&&y0(r,o.deps)){s.memoizedState=tc(e,n,a,r);return}}bt.flags|=t,s.memoizedState=tc(1|e,n,a,r)}function P1(t,e){return Kd(8390656,8,t,e)}function w0(t,e){return of(2048,8,t,e)}function vI(t,e){return of(4,2,t,e)}function wI(t,e){return of(4,4,t,e)}function bI(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function SI(t,e,n){return n=n!=null?n.concat([t]):null,of(4,4,bI.bind(null,e,t),n)}function b0(){}function CI(t,e){var n=Fr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&y0(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function II(t,e){var n=Fr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&y0(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function $I(t,e,n){return Mo&21?(os(n,e)||(n=TC(),bt.lanes|=n,Bo|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Un=!0),t.memoizedState=n)}function GA(t,e){var n=tt;tt=n!==0&&4>n?n:4,t(!0);var r=xm.transition;xm.transition={};try{t(!1),e()}finally{tt=n,xm.transition=r}}function _I(){return Fr().memoizedState}function HA(t,e,n){var r=Oa(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},NI(t))kI(e,n);else if(n=uI(t,e,n,r),n!==null){var s=_n();ts(n,t,r,s),EI(n,e,r)}}function jA(t,e,n){var r=Oa(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(NI(t))kI(e,s);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var o=e.lastRenderedState,i=a(o,n);if(s.hasEagerState=!0,s.eagerState=i,os(i,o)){var u=e.interleaved;u===null?(s.next=s,p0(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=uI(t,e,s,r),n!==null&&(s=_n(),ts(n,t,r,s),EI(n,e,r))}}function NI(t){var e=t.alternate;return t===bt||e!==null&&e===bt}function kI(t,e){Al=bp=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function EI(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Zy(t,n)}}var Sp={readContext:Pr,useCallback:cn,useContext:cn,useEffect:cn,useImperativeHandle:cn,useInsertionEffect:cn,useLayoutEffect:cn,useMemo:cn,useReducer:cn,useRef:cn,useState:cn,useDebugValue:cn,useDeferredValue:cn,useTransition:cn,useMutableSource:cn,useSyncExternalStore:cn,useId:cn,unstable_isNewReconciler:!1},KA={readContext:Pr,useCallback:function(t,e){return xs().memoizedState=[t,e===void 0?null:e],t},useContext:Pr,useEffect:P1,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Kd(4194308,4,bI.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Kd(4194308,4,t,e)},useInsertionEffect:function(t,e){return Kd(4,2,t,e)},useMemo:function(t,e){var n=xs();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=xs();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=HA.bind(null,bt,t),[r.memoizedState,t]},useRef:function(t){var e=xs();return t={current:t},e.memoizedState=t},useState:D1,useDebugValue:b0,useDeferredValue:function(t){return xs().memoizedState=t},useTransition:function(){var t=D1(!1),e=t[0];return t=GA.bind(null,t[1]),xs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=bt,s=xs();if(mt){if(n===void 0)throw Error(ne(407));n=n()}else{if(n=e(),jt===null)throw Error(ne(349));Mo&30||fI(r,e,n)}s.memoizedState=n;var a={value:n,getSnapshot:e};return s.queue=a,P1(mI.bind(null,r,a,t),[t]),r.flags|=2048,tc(9,hI.bind(null,r,a,n,e),void 0,null),n},useId:function(){var t=xs(),e=jt.identifierPrefix;if(mt){var n=Gs,r=Us;n=(r&~(1<<32-es(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Jl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=UA++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},qA={readContext:Pr,useCallback:CI,useContext:Pr,useEffect:w0,useImperativeHandle:SI,useInsertionEffect:vI,useLayoutEffect:wI,useMemo:II,useReducer:vm,useRef:xI,useState:function(){return vm(ec)},useDebugValue:b0,useDeferredValue:function(t){var e=Fr();return $I(e,Lt.memoizedState,t)},useTransition:function(){var t=vm(ec)[0],e=Fr().memoizedState;return[t,e]},useMutableSource:dI,useSyncExternalStore:pI,useId:_I,unstable_isNewReconciler:!1},XA={readContext:Pr,useCallback:CI,useContext:Pr,useEffect:w0,useImperativeHandle:SI,useInsertionEffect:vI,useLayoutEffect:wI,useMemo:II,useReducer:wm,useRef:xI,useState:function(){return wm(ec)},useDebugValue:b0,useDeferredValue:function(t){var e=Fr();return Lt===null?e.memoizedState=t:$I(e,Lt.memoizedState,t)},useTransition:function(){var t=wm(ec)[0],e=Fr().memoizedState;return[t,e]},useMutableSource:dI,useSyncExternalStore:pI,useId:_I,unstable_isNewReconciler:!1};function qr(t,e){if(t&&t.defaultProps){e=St({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function $g(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:St({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var uf={isMounted:function(t){return(t=t._reactInternals)?ti(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=_n(),s=Oa(t),a=js(r,s);a.payload=e,n!=null&&(a.callback=n),e=Ra(t,a,s),e!==null&&(ts(e,t,s,r),Hd(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=_n(),s=Oa(t),a=js(r,s);a.tag=1,a.payload=e,n!=null&&(a.callback=n),e=Ra(t,a,s),e!==null&&(ts(e,t,s,r),Hd(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=_n(),r=Oa(t),s=js(n,r);s.tag=2,e!=null&&(s.callback=e),e=Ra(t,s,r),e!==null&&(ts(e,t,r,n),Hd(e,t,r))}};function F1(t,e,n,r,s,a,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,a,o):e.prototype&&e.prototype.isPureReactComponent?!Kl(n,r)||!Kl(s,a):!0}function TI(t,e,n){var r=!1,s=Ba,a=e.contextType;return typeof a=="object"&&a!==null?a=Pr(a):(s=jn(e)?Fo:yn.current,r=e.contextTypes,a=(r=r!=null)?cu(t,s):Ba),e=new e(n,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=uf,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=a),e}function L1(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&uf.enqueueReplaceState(e,e.state,null)}function _g(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},f0(t);var a=e.contextType;typeof a=="object"&&a!==null?s.context=Pr(a):(a=jn(e)?Fo:yn.current,s.context=cu(t,a)),s.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&($g(t,e,a,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&uf.enqueueReplaceState(s,s.state,null),vp(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function hu(t,e){try{var n="",r=e;do n+=CR(r),r=r.return;while(r);var s=n}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:s,digest:null}}function bm(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Ng(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var YA=typeof WeakMap=="function"?WeakMap:Map;function RI(t,e,n){n=js(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Ip||(Ip=!0,Lg=r),Ng(t,e)},n}function AI(t,e,n){n=js(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Ng(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){Ng(t,e),typeof r!="function"&&(Aa===null?Aa=new Set([this]):Aa.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function M1(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new YA;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=cO.bind(null,t,e,n),e.then(t,t))}function B1(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function V1(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=js(-1,1),e.tag=2,Ra(n,e,1))),n.lanes|=1),t)}var QA=ra.ReactCurrentOwner,Un=!1;function In(t,e,n,r){e.child=t===null?iI(e,null,n,r):pu(e,t.child,n,r)}function z1(t,e,n,r,s){n=n.render;var a=e.ref;return tu(e,s),r=x0(t,e,n,r,a,s),n=v0(),t!==null&&!Un?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ys(t,e,s)):(mt&&n&&o0(e),e.flags|=1,In(t,e,r,s),e.child)}function W1(t,e,n,r,s){if(t===null){var a=n.type;return typeof a=="function"&&!E0(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=a,OI(t,e,a,r,s)):(t=Qd(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&s)){var o=a.memoizedProps;if(n=n.compare,n=n!==null?n:Kl,n(o,r)&&t.ref===e.ref)return Ys(t,e,s)}return e.flags|=1,t=Da(a,r),t.ref=e.ref,t.return=e,e.child=t}function OI(t,e,n,r,s){if(t!==null){var a=t.memoizedProps;if(Kl(a,r)&&t.ref===e.ref)if(Un=!1,e.pendingProps=r=a,(t.lanes&s)!==0)t.flags&131072&&(Un=!0);else return e.lanes=t.lanes,Ys(t,e,s)}return kg(t,e,n,r,s)}function DI(t,e,n){var r=e.pendingProps,s=r.children,a=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},it(Xi,tr),tr|=n;else{if(!(n&1073741824))return t=a!==null?a.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,it(Xi,tr),tr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,it(Xi,tr),tr|=r}else a!==null?(r=a.baseLanes|n,e.memoizedState=null):r=n,it(Xi,tr),tr|=r;return In(t,e,s,n),e.child}function PI(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function kg(t,e,n,r,s){var a=jn(n)?Fo:yn.current;return a=cu(e,a),tu(e,s),n=x0(t,e,n,r,a,s),r=v0(),t!==null&&!Un?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ys(t,e,s)):(mt&&r&&o0(e),e.flags|=1,In(t,e,n,s),e.child)}function U1(t,e,n,r,s){if(jn(n)){var a=!0;hp(e)}else a=!1;if(tu(e,s),e.stateNode===null)qd(t,e),TI(e,n,r),_g(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,i=e.memoizedProps;o.props=i;var u=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=Pr(c):(c=jn(n)?Fo:yn.current,c=cu(e,c));var l=n.getDerivedStateFromProps,d=typeof l=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(i!==r||u!==c)&&L1(e,o,r,c),ya=!1;var p=e.memoizedState;o.state=p,vp(e,r,o,s),u=e.memoizedState,i!==r||p!==u||Hn.current||ya?(typeof l=="function"&&($g(e,n,l,r),u=e.memoizedState),(i=ya||F1(e,n,i,r,p,u,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=c,r=i):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,lI(t,e),i=e.memoizedProps,c=e.type===e.elementType?i:qr(e.type,i),o.props=c,d=e.pendingProps,p=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=Pr(u):(u=jn(n)?Fo:yn.current,u=cu(e,u));var f=n.getDerivedStateFromProps;(l=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(i!==d||p!==u)&&L1(e,o,r,u),ya=!1,p=e.memoizedState,o.state=p,vp(e,r,o,s);var h=e.memoizedState;i!==d||p!==h||Hn.current||ya?(typeof f=="function"&&($g(e,n,f,r),h=e.memoizedState),(c=ya||F1(e,n,c,r,p,h,u)||!1)?(l||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,h,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,h,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||i===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||i===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=h),o.props=r,o.state=h,o.context=u,r=c):(typeof o.componentDidUpdate!="function"||i===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||i===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return Eg(t,e,n,r,a,s)}function Eg(t,e,n,r,s,a){PI(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&k1(e,n,!1),Ys(t,e,a);r=e.stateNode,QA.current=e;var i=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=pu(e,t.child,null,a),e.child=pu(e,null,i,a)):In(t,e,i,a),e.memoizedState=r.state,s&&k1(e,n,!0),e.child}function FI(t){var e=t.stateNode;e.pendingContext?N1(t,e.pendingContext,e.pendingContext!==e.context):e.context&&N1(t,e.context,!1),h0(t,e.containerInfo)}function G1(t,e,n,r,s){return du(),u0(s),e.flags|=256,In(t,e,n,r),e.child}var Tg={dehydrated:null,treeContext:null,retryLane:0};function Rg(t){return{baseLanes:t,cachePool:null,transitions:null}}function LI(t,e,n){var r=e.pendingProps,s=wt.current,a=!1,o=(e.flags&128)!==0,i;if((i=o)||(i=t!==null&&t.memoizedState===null?!1:(s&2)!==0),i?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),it(wt,s&1),t===null)return Cg(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,a?(r=e.mode,a=e.child,o={mode:"hidden",children:o},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=df(o,r,0,null),t=Ao(t,r,n,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=Rg(n),e.memoizedState=Tg,t):S0(e,o));if(s=t.memoizedState,s!==null&&(i=s.dehydrated,i!==null))return ZA(t,e,o,r,i,s,n);if(a){a=r.fallback,o=e.mode,s=t.child,i=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Da(s,u),r.subtreeFlags=s.subtreeFlags&14680064),i!==null?a=Da(i,a):(a=Ao(a,o,n,null),a.flags|=2),a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,o=t.child.memoizedState,o=o===null?Rg(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=t.childLanes&~n,e.memoizedState=Tg,r}return a=t.child,t=a.sibling,r=Da(a,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function S0(t,e){return e=df({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function wd(t,e,n,r){return r!==null&&u0(r),pu(e,t.child,null,n),t=S0(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function ZA(t,e,n,r,s,a,o){if(n)return e.flags&256?(e.flags&=-257,r=bm(Error(ne(422))),wd(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=r.fallback,s=e.mode,r=df({mode:"visible",children:r.children},s,0,null),a=Ao(a,s,o,null),a.flags|=2,r.return=e,a.return=e,r.sibling=a,e.child=r,e.mode&1&&pu(e,t.child,null,o),e.child.memoizedState=Rg(o),e.memoizedState=Tg,a);if(!(e.mode&1))return wd(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var i=r.dgst;return r=i,a=Error(ne(419)),r=bm(a,r,void 0),wd(t,e,o,r)}if(i=(o&t.childLanes)!==0,Un||i){if(r=jt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,Xs(t,s),ts(r,t,s,-1))}return k0(),r=bm(Error(ne(421))),wd(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=dO.bind(null,t),s._reactRetry=e,null):(t=a.treeContext,or=Ta(s.nextSibling),ur=e,mt=!0,Yr=null,t!==null&&(_r[Nr++]=Us,_r[Nr++]=Gs,_r[Nr++]=Lo,Us=t.id,Gs=t.overflow,Lo=e),e=S0(e,r.children),e.flags|=4096,e)}function H1(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Ig(t.return,e,n)}function Sm(t,e,n,r,s){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=s)}function MI(t,e,n){var r=e.pendingProps,s=r.revealOrder,a=r.tail;if(In(t,e,r.children,n),r=wt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&H1(t,n,e);else if(t.tag===19)H1(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(it(wt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&wp(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Sm(e,!1,s,n,a);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&wp(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Sm(e,!0,n,null,a);break;case"together":Sm(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function qd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ys(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Bo|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ne(153));if(e.child!==null){for(t=e.child,n=Da(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Da(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function JA(t,e,n){switch(e.tag){case 3:FI(e),du();break;case 5:cI(e);break;case 1:jn(e.type)&&hp(e);break;case 4:h0(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;it(yp,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(it(wt,wt.current&1),e.flags|=128,null):n&e.child.childLanes?LI(t,e,n):(it(wt,wt.current&1),t=Ys(t,e,n),t!==null?t.sibling:null);it(wt,wt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return MI(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),it(wt,wt.current),r)break;return null;case 22:case 23:return e.lanes=0,DI(t,e,n)}return Ys(t,e,n)}var BI,Ag,VI,zI;BI=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Ag=function(){};VI=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,No(_s.current);var a=null;switch(n){case"input":s=eg(t,s),r=eg(t,r),a=[];break;case"select":s=St({},s,{value:void 0}),r=St({},r,{value:void 0}),a=[];break;case"textarea":s=rg(t,s),r=rg(t,r),a=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=pp)}ag(n,r);var o;n=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var i=s[c];for(o in i)i.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Vl.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in r){var u=r[c];if(i=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&u!==i&&(u!=null||i!=null))if(c==="style")if(i){for(o in i)!i.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&i[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(a||(a=[]),a.push(c,n)),n=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,i=i?i.__html:void 0,u!=null&&i!==u&&(a=a||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(a=a||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Vl.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&dt("scroll",t),a||i===u||(a=[])):(a=a||[]).push(c,u))}n&&(a=a||[]).push("style",n);var c=a;(e.updateQueue=c)&&(e.flags|=4)}};zI=function(t,e,n,r){n!==r&&(e.flags|=4)};function ll(t,e){if(!mt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function dn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function eO(t,e,n){var r=e.pendingProps;switch(i0(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dn(e),null;case 1:return jn(e.type)&&fp(),dn(e),null;case 3:return r=e.stateNode,fu(),pt(Hn),pt(yn),g0(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(xd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Yr!==null&&(Vg(Yr),Yr=null))),Ag(t,e),dn(e),null;case 5:m0(e);var s=No(Zl.current);if(n=e.type,t!==null&&e.stateNode!=null)VI(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ne(166));return dn(e),null}if(t=No(_s.current),xd(e)){r=e.stateNode,n=e.type;var a=e.memoizedProps;switch(r[bs]=e,r[Yl]=a,t=(e.mode&1)!==0,n){case"dialog":dt("cancel",r),dt("close",r);break;case"iframe":case"object":case"embed":dt("load",r);break;case"video":case"audio":for(s=0;s<bl.length;s++)dt(bl[s],r);break;case"source":dt("error",r);break;case"img":case"image":case"link":dt("error",r),dt("load",r);break;case"details":dt("toggle",r);break;case"input":e1(r,a),dt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},dt("invalid",r);break;case"textarea":n1(r,a),dt("invalid",r)}ag(n,a),s=null;for(var o in a)if(a.hasOwnProperty(o)){var i=a[o];o==="children"?typeof i=="string"?r.textContent!==i&&(a.suppressHydrationWarning!==!0&&yd(r.textContent,i,t),s=["children",i]):typeof i=="number"&&r.textContent!==""+i&&(a.suppressHydrationWarning!==!0&&yd(r.textContent,i,t),s=["children",""+i]):Vl.hasOwnProperty(o)&&i!=null&&o==="onScroll"&&dt("scroll",r)}switch(n){case"input":ld(r),t1(r,a,!0);break;case"textarea":ld(r),r1(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=pp)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=mC(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[bs]=e,t[Yl]=r,BI(t,e,!1,!1),e.stateNode=t;e:{switch(o=og(n,r),n){case"dialog":dt("cancel",t),dt("close",t),s=r;break;case"iframe":case"object":case"embed":dt("load",t),s=r;break;case"video":case"audio":for(s=0;s<bl.length;s++)dt(bl[s],t);s=r;break;case"source":dt("error",t),s=r;break;case"img":case"image":case"link":dt("error",t),dt("load",t),s=r;break;case"details":dt("toggle",t),s=r;break;case"input":e1(t,r),s=eg(t,r),dt("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=St({},r,{value:void 0}),dt("invalid",t);break;case"textarea":n1(t,r),s=rg(t,r),dt("invalid",t);break;default:s=r}ag(n,s),i=s;for(a in i)if(i.hasOwnProperty(a)){var u=i[a];a==="style"?xC(t,u):a==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&gC(t,u)):a==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&zl(t,u):typeof u=="number"&&zl(t,""+u):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Vl.hasOwnProperty(a)?u!=null&&a==="onScroll"&&dt("scroll",t):u!=null&&jy(t,a,u,o))}switch(n){case"input":ld(t),t1(t,r,!1);break;case"textarea":ld(t),r1(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ma(r.value));break;case"select":t.multiple=!!r.multiple,a=r.value,a!=null?Qi(t,!!r.multiple,a,!1):r.defaultValue!=null&&Qi(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=pp)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return dn(e),null;case 6:if(t&&e.stateNode!=null)zI(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ne(166));if(n=No(Zl.current),No(_s.current),xd(e)){if(r=e.stateNode,n=e.memoizedProps,r[bs]=e,(a=r.nodeValue!==n)&&(t=ur,t!==null))switch(t.tag){case 3:yd(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&yd(r.nodeValue,n,(t.mode&1)!==0)}a&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[bs]=e,e.stateNode=r}return dn(e),null;case 13:if(pt(wt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(mt&&or!==null&&e.mode&1&&!(e.flags&128))aI(),du(),e.flags|=98560,a=!1;else if(a=xd(e),r!==null&&r.dehydrated!==null){if(t===null){if(!a)throw Error(ne(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ne(317));a[bs]=e}else du(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;dn(e),a=!1}else Yr!==null&&(Vg(Yr),Yr=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||wt.current&1?Bt===0&&(Bt=3):k0())),e.updateQueue!==null&&(e.flags|=4),dn(e),null);case 4:return fu(),Ag(t,e),t===null&&ql(e.stateNode.containerInfo),dn(e),null;case 10:return d0(e.type._context),dn(e),null;case 17:return jn(e.type)&&fp(),dn(e),null;case 19:if(pt(wt),a=e.memoizedState,a===null)return dn(e),null;if(r=(e.flags&128)!==0,o=a.rendering,o===null)if(r)ll(a,!1);else{if(Bt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=wp(t),o!==null){for(e.flags|=128,ll(a,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)a=n,t=r,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,t=o.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return it(wt,wt.current&1|2),e.child}t=t.sibling}a.tail!==null&&Et()>mu&&(e.flags|=128,r=!0,ll(a,!1),e.lanes=4194304)}else{if(!r)if(t=wp(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ll(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!mt)return dn(e),null}else 2*Et()-a.renderingStartTime>mu&&n!==1073741824&&(e.flags|=128,r=!0,ll(a,!1),e.lanes=4194304);a.isBackwards?(o.sibling=e.child,e.child=o):(n=a.last,n!==null?n.sibling=o:e.child=o,a.last=o)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Et(),e.sibling=null,n=wt.current,it(wt,r?n&1|2:n&1),e):(dn(e),null);case 22:case 23:return N0(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?tr&1073741824&&(dn(e),e.subtreeFlags&6&&(e.flags|=8192)):dn(e),null;case 24:return null;case 25:return null}throw Error(ne(156,e.tag))}function tO(t,e){switch(i0(e),e.tag){case 1:return jn(e.type)&&fp(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return fu(),pt(Hn),pt(yn),g0(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return m0(e),null;case 13:if(pt(wt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ne(340));du()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return pt(wt),null;case 4:return fu(),null;case 10:return d0(e.type._context),null;case 22:case 23:return N0(),null;case 24:return null;default:return null}}var bd=!1,fn=!1,nO=typeof WeakSet=="function"?WeakSet:Set,ge=null;function qi(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){$t(t,e,r)}else n.current=null}function Og(t,e,n){try{n()}catch(r){$t(t,e,r)}}var j1=!1;function rO(t,e){if(gg=lp,t=jC(),a0(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var o=0,i=-1,u=-1,c=0,l=0,d=t,p=null;t:for(;;){for(var f;d!==n||s!==0&&d.nodeType!==3||(i=o+s),d!==a||r!==0&&d.nodeType!==3||(u=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(f=d.firstChild)!==null;)p=d,d=f;for(;;){if(d===t)break t;if(p===n&&++c===s&&(i=o),p===a&&++l===r&&(u=o),(f=d.nextSibling)!==null)break;d=p,p=d.parentNode}d=f}n=i===-1||u===-1?null:{start:i,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(yg={focusedElem:t,selectionRange:n},lp=!1,ge=e;ge!==null;)if(e=ge,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ge=t;else for(;ge!==null;){e=ge;try{var h=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var y=h.memoizedProps,x=h.memoizedState,g=e.stateNode,v=g.getSnapshotBeforeUpdate(e.elementType===e.type?y:qr(e.type,y),x);g.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ne(163))}}catch(S){$t(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,ge=t;break}ge=e.return}return h=j1,j1=!1,h}function Ol(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var a=s.destroy;s.destroy=void 0,a!==void 0&&Og(e,n,a)}s=s.next}while(s!==r)}}function lf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Dg(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function WI(t){var e=t.alternate;e!==null&&(t.alternate=null,WI(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[bs],delete e[Yl],delete e[wg],delete e[BA],delete e[VA])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function UI(t){return t.tag===5||t.tag===3||t.tag===4}function K1(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||UI(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Pg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=pp));else if(r!==4&&(t=t.child,t!==null))for(Pg(t,e,n),t=t.sibling;t!==null;)Pg(t,e,n),t=t.sibling}function Fg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Fg(t,e,n),t=t.sibling;t!==null;)Fg(t,e,n),t=t.sibling}var tn=null,Xr=!1;function ma(t,e,n){for(n=n.child;n!==null;)GI(t,e,n),n=n.sibling}function GI(t,e,n){if($s&&typeof $s.onCommitFiberUnmount=="function")try{$s.onCommitFiberUnmount(ef,n)}catch{}switch(n.tag){case 5:fn||qi(n,e);case 6:var r=tn,s=Xr;tn=null,ma(t,e,n),tn=r,Xr=s,tn!==null&&(Xr?(t=tn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):tn.removeChild(n.stateNode));break;case 18:tn!==null&&(Xr?(t=tn,n=n.stateNode,t.nodeType===8?mm(t.parentNode,n):t.nodeType===1&&mm(t,n),Hl(t)):mm(tn,n.stateNode));break;case 4:r=tn,s=Xr,tn=n.stateNode.containerInfo,Xr=!0,ma(t,e,n),tn=r,Xr=s;break;case 0:case 11:case 14:case 15:if(!fn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var a=s,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&Og(n,e,o),s=s.next}while(s!==r)}ma(t,e,n);break;case 1:if(!fn&&(qi(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(i){$t(n,e,i)}ma(t,e,n);break;case 21:ma(t,e,n);break;case 22:n.mode&1?(fn=(r=fn)||n.memoizedState!==null,ma(t,e,n),fn=r):ma(t,e,n);break;default:ma(t,e,n)}}function q1(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new nO),e.forEach(function(r){var s=pO.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Kr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var a=t,o=e,i=o;e:for(;i!==null;){switch(i.tag){case 5:tn=i.stateNode,Xr=!1;break e;case 3:tn=i.stateNode.containerInfo,Xr=!0;break e;case 4:tn=i.stateNode.containerInfo,Xr=!0;break e}i=i.return}if(tn===null)throw Error(ne(160));GI(a,o,s),tn=null,Xr=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(c){$t(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)HI(e,t),e=e.sibling}function HI(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Kr(e,t),ys(t),r&4){try{Ol(3,t,t.return),lf(3,t)}catch(y){$t(t,t.return,y)}try{Ol(5,t,t.return)}catch(y){$t(t,t.return,y)}}break;case 1:Kr(e,t),ys(t),r&512&&n!==null&&qi(n,n.return);break;case 5:if(Kr(e,t),ys(t),r&512&&n!==null&&qi(n,n.return),t.flags&32){var s=t.stateNode;try{zl(s,"")}catch(y){$t(t,t.return,y)}}if(r&4&&(s=t.stateNode,s!=null)){var a=t.memoizedProps,o=n!==null?n.memoizedProps:a,i=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{i==="input"&&a.type==="radio"&&a.name!=null&&fC(s,a),og(i,o);var c=og(i,a);for(o=0;o<u.length;o+=2){var l=u[o],d=u[o+1];l==="style"?xC(s,d):l==="dangerouslySetInnerHTML"?gC(s,d):l==="children"?zl(s,d):jy(s,l,d,c)}switch(i){case"input":tg(s,a);break;case"textarea":hC(s,a);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var f=a.value;f!=null?Qi(s,!!a.multiple,f,!1):p!==!!a.multiple&&(a.defaultValue!=null?Qi(s,!!a.multiple,a.defaultValue,!0):Qi(s,!!a.multiple,a.multiple?[]:"",!1))}s[Yl]=a}catch(y){$t(t,t.return,y)}}break;case 6:if(Kr(e,t),ys(t),r&4){if(t.stateNode===null)throw Error(ne(162));s=t.stateNode,a=t.memoizedProps;try{s.nodeValue=a}catch(y){$t(t,t.return,y)}}break;case 3:if(Kr(e,t),ys(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Hl(e.containerInfo)}catch(y){$t(t,t.return,y)}break;case 4:Kr(e,t),ys(t);break;case 13:Kr(e,t),ys(t),s=t.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||($0=Et())),r&4&&q1(t);break;case 22:if(l=n!==null&&n.memoizedState!==null,t.mode&1?(fn=(c=fn)||l,Kr(e,t),fn=c):Kr(e,t),ys(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!l&&t.mode&1)for(ge=t,l=t.child;l!==null;){for(d=ge=l;ge!==null;){switch(p=ge,f=p.child,p.tag){case 0:case 11:case 14:case 15:Ol(4,p,p.return);break;case 1:qi(p,p.return);var h=p.stateNode;if(typeof h.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,h.props=e.memoizedProps,h.state=e.memoizedState,h.componentWillUnmount()}catch(y){$t(r,n,y)}}break;case 5:qi(p,p.return);break;case 22:if(p.memoizedState!==null){Y1(d);continue}}f!==null?(f.return=p,ge=f):Y1(d)}l=l.sibling}e:for(l=null,d=t;;){if(d.tag===5){if(l===null){l=d;try{s=d.stateNode,c?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(i=d.stateNode,u=d.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,i.style.display=yC("display",o))}catch(y){$t(t,t.return,y)}}}else if(d.tag===6){if(l===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(y){$t(t,t.return,y)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;l===d&&(l=null),d=d.return}l===d&&(l=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Kr(e,t),ys(t),r&4&&q1(t);break;case 21:break;default:Kr(e,t),ys(t)}}function ys(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(UI(n)){var r=n;break e}n=n.return}throw Error(ne(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(zl(s,""),r.flags&=-33);var a=K1(t);Fg(t,a,s);break;case 3:case 4:var o=r.stateNode.containerInfo,i=K1(t);Pg(t,i,o);break;default:throw Error(ne(161))}}catch(u){$t(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function sO(t,e,n){ge=t,jI(t)}function jI(t,e,n){for(var r=(t.mode&1)!==0;ge!==null;){var s=ge,a=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||bd;if(!o){var i=s.alternate,u=i!==null&&i.memoizedState!==null||fn;i=bd;var c=fn;if(bd=o,(fn=u)&&!c)for(ge=s;ge!==null;)o=ge,u=o.child,o.tag===22&&o.memoizedState!==null?Q1(s):u!==null?(u.return=o,ge=u):Q1(s);for(;a!==null;)ge=a,jI(a),a=a.sibling;ge=s,bd=i,fn=c}X1(t)}else s.subtreeFlags&8772&&a!==null?(a.return=s,ge=a):X1(t)}}function X1(t){for(;ge!==null;){var e=ge;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:fn||lf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!fn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:qr(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&O1(e,a,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}O1(e,o,n)}break;case 5:var i=e.stateNode;if(n===null&&e.flags&4){n=i;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var l=c.memoizedState;if(l!==null){var d=l.dehydrated;d!==null&&Hl(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ne(163))}fn||e.flags&512&&Dg(e)}catch(p){$t(e,e.return,p)}}if(e===t){ge=null;break}if(n=e.sibling,n!==null){n.return=e.return,ge=n;break}ge=e.return}}function Y1(t){for(;ge!==null;){var e=ge;if(e===t){ge=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ge=n;break}ge=e.return}}function Q1(t){for(;ge!==null;){var e=ge;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{lf(4,e)}catch(u){$t(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){$t(e,s,u)}}var a=e.return;try{Dg(e)}catch(u){$t(e,a,u)}break;case 5:var o=e.return;try{Dg(e)}catch(u){$t(e,o,u)}}}catch(u){$t(e,e.return,u)}if(e===t){ge=null;break}var i=e.sibling;if(i!==null){i.return=e.return,ge=i;break}ge=e.return}}var aO=Math.ceil,Cp=ra.ReactCurrentDispatcher,C0=ra.ReactCurrentOwner,Dr=ra.ReactCurrentBatchConfig,He=0,jt=null,At=null,rn=0,tr=0,Xi=Xa(0),Bt=0,nc=null,Bo=0,cf=0,I0=0,Dl=null,zn=null,$0=0,mu=1/0,Ls=null,Ip=!1,Lg=null,Aa=null,Sd=!1,Ia=null,$p=0,Pl=0,Mg=null,Xd=-1,Yd=0;function _n(){return He&6?Et():Xd!==-1?Xd:Xd=Et()}function Oa(t){return t.mode&1?He&2&&rn!==0?rn&-rn:WA.transition!==null?(Yd===0&&(Yd=TC()),Yd):(t=tt,t!==0||(t=window.event,t=t===void 0?16:LC(t.type)),t):1}function ts(t,e,n,r){if(50<Pl)throw Pl=0,Mg=null,Error(ne(185));$c(t,n,r),(!(He&2)||t!==jt)&&(t===jt&&(!(He&2)&&(cf|=n),Bt===4&&ba(t,rn)),Kn(t,r),n===1&&He===0&&!(e.mode&1)&&(mu=Et()+500,af&&Ya()))}function Kn(t,e){var n=t.callbackNode;WR(t,e);var r=up(t,t===jt?rn:0);if(r===0)n!==null&&o1(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&o1(n),e===1)t.tag===0?zA(Z1.bind(null,t)):nI(Z1.bind(null,t)),LA(function(){!(He&6)&&Ya()}),n=null;else{switch(RC(r)){case 1:n=Qy;break;case 4:n=kC;break;case 16:n=ip;break;case 536870912:n=EC;break;default:n=ip}n=e2(n,KI.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function KI(t,e){if(Xd=-1,Yd=0,He&6)throw Error(ne(327));var n=t.callbackNode;if(nu()&&t.callbackNode!==n)return null;var r=up(t,t===jt?rn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=_p(t,r);else{e=r;var s=He;He|=2;var a=XI();(jt!==t||rn!==e)&&(Ls=null,mu=Et()+500,Ro(t,e));do try{uO();break}catch(i){qI(t,i)}while(!0);c0(),Cp.current=a,He=s,At!==null?e=0:(jt=null,rn=0,e=Bt)}if(e!==0){if(e===2&&(s=dg(t),s!==0&&(r=s,e=Bg(t,s))),e===1)throw n=nc,Ro(t,0),ba(t,r),Kn(t,Et()),n;if(e===6)ba(t,r);else{if(s=t.current.alternate,!(r&30)&&!oO(s)&&(e=_p(t,r),e===2&&(a=dg(t),a!==0&&(r=a,e=Bg(t,a))),e===1))throw n=nc,Ro(t,0),ba(t,r),Kn(t,Et()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(ne(345));case 2:vo(t,zn,Ls);break;case 3:if(ba(t,r),(r&130023424)===r&&(e=$0+500-Et(),10<e)){if(up(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){_n(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=vg(vo.bind(null,t,zn,Ls),e);break}vo(t,zn,Ls);break;case 4:if(ba(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-es(r);a=1<<o,o=e[o],o>s&&(s=o),r&=~a}if(r=s,r=Et()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*aO(r/1960))-r,10<r){t.timeoutHandle=vg(vo.bind(null,t,zn,Ls),r);break}vo(t,zn,Ls);break;case 5:vo(t,zn,Ls);break;default:throw Error(ne(329))}}}return Kn(t,Et()),t.callbackNode===n?KI.bind(null,t):null}function Bg(t,e){var n=Dl;return t.current.memoizedState.isDehydrated&&(Ro(t,e).flags|=256),t=_p(t,e),t!==2&&(e=zn,zn=n,e!==null&&Vg(e)),t}function Vg(t){zn===null?zn=t:zn.push.apply(zn,t)}function oO(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],a=s.getSnapshot;s=s.value;try{if(!os(a(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ba(t,e){for(e&=~I0,e&=~cf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-es(e),r=1<<n;t[n]=-1,e&=~r}}function Z1(t){if(He&6)throw Error(ne(327));nu();var e=up(t,0);if(!(e&1))return Kn(t,Et()),null;var n=_p(t,e);if(t.tag!==0&&n===2){var r=dg(t);r!==0&&(e=r,n=Bg(t,r))}if(n===1)throw n=nc,Ro(t,0),ba(t,e),Kn(t,Et()),n;if(n===6)throw Error(ne(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,vo(t,zn,Ls),Kn(t,Et()),null}function _0(t,e){var n=He;He|=1;try{return t(e)}finally{He=n,He===0&&(mu=Et()+500,af&&Ya())}}function Vo(t){Ia!==null&&Ia.tag===0&&!(He&6)&&nu();var e=He;He|=1;var n=Dr.transition,r=tt;try{if(Dr.transition=null,tt=1,t)return t()}finally{tt=r,Dr.transition=n,He=e,!(He&6)&&Ya()}}function N0(){tr=Xi.current,pt(Xi)}function Ro(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,FA(n)),At!==null)for(n=At.return;n!==null;){var r=n;switch(i0(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&fp();break;case 3:fu(),pt(Hn),pt(yn),g0();break;case 5:m0(r);break;case 4:fu();break;case 13:pt(wt);break;case 19:pt(wt);break;case 10:d0(r.type._context);break;case 22:case 23:N0()}n=n.return}if(jt=t,At=t=Da(t.current,null),rn=tr=e,Bt=0,nc=null,I0=cf=Bo=0,zn=Dl=null,_o!==null){for(e=0;e<_o.length;e++)if(n=_o[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,a=n.pending;if(a!==null){var o=a.next;a.next=s,r.next=o}n.pending=r}_o=null}return t}function qI(t,e){do{var n=At;try{if(c0(),jd.current=Sp,bp){for(var r=bt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}bp=!1}if(Mo=0,Ut=Lt=bt=null,Al=!1,Jl=0,C0.current=null,n===null||n.return===null){Bt=1,nc=e,At=null;break}e:{var a=t,o=n.return,i=n,u=e;if(e=rn,i.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,l=i,d=l.tag;if(!(l.mode&1)&&(d===0||d===11||d===15)){var p=l.alternate;p?(l.updateQueue=p.updateQueue,l.memoizedState=p.memoizedState,l.lanes=p.lanes):(l.updateQueue=null,l.memoizedState=null)}var f=B1(o);if(f!==null){f.flags&=-257,V1(f,o,i,a,e),f.mode&1&&M1(a,c,e),e=f,u=c;var h=e.updateQueue;if(h===null){var y=new Set;y.add(u),e.updateQueue=y}else h.add(u);break e}else{if(!(e&1)){M1(a,c,e),k0();break e}u=Error(ne(426))}}else if(mt&&i.mode&1){var x=B1(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),V1(x,o,i,a,e),u0(hu(u,i));break e}}a=u=hu(u,i),Bt!==4&&(Bt=2),Dl===null?Dl=[a]:Dl.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var g=RI(a,u,e);A1(a,g);break e;case 1:i=u;var v=a.type,w=a.stateNode;if(!(a.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Aa===null||!Aa.has(w)))){a.flags|=65536,e&=-e,a.lanes|=e;var S=AI(a,i,e);A1(a,S);break e}}a=a.return}while(a!==null)}QI(n)}catch($){e=$,At===n&&n!==null&&(At=n=n.return);continue}break}while(!0)}function XI(){var t=Cp.current;return Cp.current=Sp,t===null?Sp:t}function k0(){(Bt===0||Bt===3||Bt===2)&&(Bt=4),jt===null||!(Bo&268435455)&&!(cf&268435455)||ba(jt,rn)}function _p(t,e){var n=He;He|=2;var r=XI();(jt!==t||rn!==e)&&(Ls=null,Ro(t,e));do try{iO();break}catch(s){qI(t,s)}while(!0);if(c0(),He=n,Cp.current=r,At!==null)throw Error(ne(261));return jt=null,rn=0,Bt}function iO(){for(;At!==null;)YI(At)}function uO(){for(;At!==null&&!OR();)YI(At)}function YI(t){var e=JI(t.alternate,t,tr);t.memoizedProps=t.pendingProps,e===null?QI(t):At=e,C0.current=null}function QI(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=tO(n,e),n!==null){n.flags&=32767,At=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Bt=6,At=null;return}}else if(n=eO(n,e,tr),n!==null){At=n;return}if(e=e.sibling,e!==null){At=e;return}At=e=t}while(e!==null);Bt===0&&(Bt=5)}function vo(t,e,n){var r=tt,s=Dr.transition;try{Dr.transition=null,tt=1,lO(t,e,n,r)}finally{Dr.transition=s,tt=r}return null}function lO(t,e,n,r){do nu();while(Ia!==null);if(He&6)throw Error(ne(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ne(177));t.callbackNode=null,t.callbackPriority=0;var a=n.lanes|n.childLanes;if(UR(t,a),t===jt&&(At=jt=null,rn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Sd||(Sd=!0,e2(ip,function(){return nu(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=Dr.transition,Dr.transition=null;var o=tt;tt=1;var i=He;He|=4,C0.current=null,rO(t,n),HI(n,t),EA(yg),lp=!!gg,yg=gg=null,t.current=n,sO(n),DR(),He=i,tt=o,Dr.transition=a}else t.current=n;if(Sd&&(Sd=!1,Ia=t,$p=s),a=t.pendingLanes,a===0&&(Aa=null),LR(n.stateNode),Kn(t,Et()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Ip)throw Ip=!1,t=Lg,Lg=null,t;return $p&1&&t.tag!==0&&nu(),a=t.pendingLanes,a&1?t===Mg?Pl++:(Pl=0,Mg=t):Pl=0,Ya(),null}function nu(){if(Ia!==null){var t=RC($p),e=Dr.transition,n=tt;try{if(Dr.transition=null,tt=16>t?16:t,Ia===null)var r=!1;else{if(t=Ia,Ia=null,$p=0,He&6)throw Error(ne(331));var s=He;for(He|=4,ge=t.current;ge!==null;){var a=ge,o=a.child;if(ge.flags&16){var i=a.deletions;if(i!==null){for(var u=0;u<i.length;u++){var c=i[u];for(ge=c;ge!==null;){var l=ge;switch(l.tag){case 0:case 11:case 15:Ol(8,l,a)}var d=l.child;if(d!==null)d.return=l,ge=d;else for(;ge!==null;){l=ge;var p=l.sibling,f=l.return;if(WI(l),l===c){ge=null;break}if(p!==null){p.return=f,ge=p;break}ge=f}}}var h=a.alternate;if(h!==null){var y=h.child;if(y!==null){h.child=null;do{var x=y.sibling;y.sibling=null,y=x}while(y!==null)}}ge=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,ge=o;else e:for(;ge!==null;){if(a=ge,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Ol(9,a,a.return)}var g=a.sibling;if(g!==null){g.return=a.return,ge=g;break e}ge=a.return}}var v=t.current;for(ge=v;ge!==null;){o=ge;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,ge=w;else e:for(o=v;ge!==null;){if(i=ge,i.flags&2048)try{switch(i.tag){case 0:case 11:case 15:lf(9,i)}}catch($){$t(i,i.return,$)}if(i===o){ge=null;break e}var S=i.sibling;if(S!==null){S.return=i.return,ge=S;break e}ge=i.return}}if(He=s,Ya(),$s&&typeof $s.onPostCommitFiberRoot=="function")try{$s.onPostCommitFiberRoot(ef,t)}catch{}r=!0}return r}finally{tt=n,Dr.transition=e}}return!1}function J1(t,e,n){e=hu(n,e),e=RI(t,e,1),t=Ra(t,e,1),e=_n(),t!==null&&($c(t,1,e),Kn(t,e))}function $t(t,e,n){if(t.tag===3)J1(t,t,n);else for(;e!==null;){if(e.tag===3){J1(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Aa===null||!Aa.has(r))){t=hu(n,t),t=AI(e,t,1),e=Ra(e,t,1),t=_n(),e!==null&&($c(e,1,t),Kn(e,t));break}}e=e.return}}function cO(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=_n(),t.pingedLanes|=t.suspendedLanes&n,jt===t&&(rn&n)===n&&(Bt===4||Bt===3&&(rn&130023424)===rn&&500>Et()-$0?Ro(t,0):I0|=n),Kn(t,e)}function ZI(t,e){e===0&&(t.mode&1?(e=pd,pd<<=1,!(pd&130023424)&&(pd=4194304)):e=1);var n=_n();t=Xs(t,e),t!==null&&($c(t,e,n),Kn(t,n))}function dO(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),ZI(t,n)}function pO(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ne(314))}r!==null&&r.delete(e),ZI(t,n)}var JI;JI=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Hn.current)Un=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Un=!1,JA(t,e,n);Un=!!(t.flags&131072)}else Un=!1,mt&&e.flags&1048576&&rI(e,gp,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;qd(t,e),t=e.pendingProps;var s=cu(e,yn.current);tu(e,n),s=x0(null,e,r,t,s,n);var a=v0();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,jn(r)?(a=!0,hp(e)):a=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,f0(e),s.updater=uf,e.stateNode=s,s._reactInternals=e,_g(e,r,t,n),e=Eg(null,e,r,!0,a,n)):(e.tag=0,mt&&a&&o0(e),In(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(qd(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=hO(r),t=qr(r,t),s){case 0:e=kg(null,e,r,t,n);break e;case 1:e=U1(null,e,r,t,n);break e;case 11:e=z1(null,e,r,t,n);break e;case 14:e=W1(null,e,r,qr(r.type,t),n);break e}throw Error(ne(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qr(r,s),kg(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qr(r,s),U1(t,e,r,s,n);case 3:e:{if(FI(e),t===null)throw Error(ne(387));r=e.pendingProps,a=e.memoizedState,s=a.element,lI(t,e),vp(e,r,null,n);var o=e.memoizedState;if(r=o.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){s=hu(Error(ne(423)),e),e=G1(t,e,r,n,s);break e}else if(r!==s){s=hu(Error(ne(424)),e),e=G1(t,e,r,n,s);break e}else for(or=Ta(e.stateNode.containerInfo.firstChild),ur=e,mt=!0,Yr=null,n=iI(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(du(),r===s){e=Ys(t,e,n);break e}In(t,e,r,n)}e=e.child}return e;case 5:return cI(e),t===null&&Cg(e),r=e.type,s=e.pendingProps,a=t!==null?t.memoizedProps:null,o=s.children,xg(r,s)?o=null:a!==null&&xg(r,a)&&(e.flags|=32),PI(t,e),In(t,e,o,n),e.child;case 6:return t===null&&Cg(e),null;case 13:return LI(t,e,n);case 4:return h0(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=pu(e,null,r,n):In(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qr(r,s),z1(t,e,r,s,n);case 7:return In(t,e,e.pendingProps,n),e.child;case 8:return In(t,e,e.pendingProps.children,n),e.child;case 12:return In(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,a=e.memoizedProps,o=s.value,it(yp,r._currentValue),r._currentValue=o,a!==null)if(os(a.value,o)){if(a.children===s.children&&!Hn.current){e=Ys(t,e,n);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var i=a.dependencies;if(i!==null){o=a.child;for(var u=i.firstContext;u!==null;){if(u.context===r){if(a.tag===1){u=js(-1,n&-n),u.tag=2;var c=a.updateQueue;if(c!==null){c=c.shared;var l=c.pending;l===null?u.next=u:(u.next=l.next,l.next=u),c.pending=u}}a.lanes|=n,u=a.alternate,u!==null&&(u.lanes|=n),Ig(a.return,n,e),i.lanes|=n;break}u=u.next}}else if(a.tag===10)o=a.type===e.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(ne(341));o.lanes|=n,i=o.alternate,i!==null&&(i.lanes|=n),Ig(o,n,e),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===e){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}In(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,tu(e,n),s=Pr(s),r=r(s),e.flags|=1,In(t,e,r,n),e.child;case 14:return r=e.type,s=qr(r,e.pendingProps),s=qr(r.type,s),W1(t,e,r,s,n);case 15:return OI(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qr(r,s),qd(t,e),e.tag=1,jn(r)?(t=!0,hp(e)):t=!1,tu(e,n),TI(e,r,s),_g(e,r,s,n),Eg(null,e,r,!0,t,n);case 19:return MI(t,e,n);case 22:return DI(t,e,n)}throw Error(ne(156,e.tag))};function e2(t,e){return NC(t,e)}function fO(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Er(t,e,n,r){return new fO(t,e,n,r)}function E0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function hO(t){if(typeof t=="function")return E0(t)?1:0;if(t!=null){if(t=t.$$typeof,t===qy)return 11;if(t===Xy)return 14}return 2}function Da(t,e){var n=t.alternate;return n===null?(n=Er(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Qd(t,e,n,r,s,a){var o=2;if(r=t,typeof t=="function")E0(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Bi:return Ao(n.children,s,a,e);case Ky:o=8,s|=8;break;case Ym:return t=Er(12,n,e,s|2),t.elementType=Ym,t.lanes=a,t;case Qm:return t=Er(13,n,e,s),t.elementType=Qm,t.lanes=a,t;case Zm:return t=Er(19,n,e,s),t.elementType=Zm,t.lanes=a,t;case cC:return df(n,s,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case uC:o=10;break e;case lC:o=9;break e;case qy:o=11;break e;case Xy:o=14;break e;case ga:o=16,r=null;break e}throw Error(ne(130,t==null?t:typeof t,""))}return e=Er(o,n,e,s),e.elementType=t,e.type=r,e.lanes=a,e}function Ao(t,e,n,r){return t=Er(7,t,r,e),t.lanes=n,t}function df(t,e,n,r){return t=Er(22,t,r,e),t.elementType=cC,t.lanes=n,t.stateNode={isHidden:!1},t}function Cm(t,e,n){return t=Er(6,t,null,e),t.lanes=n,t}function Im(t,e,n){return e=Er(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function mO(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=sm(0),this.expirationTimes=sm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=sm(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function T0(t,e,n,r,s,a,o,i,u){return t=new mO(t,e,n,i,u),e===1?(e=1,a===!0&&(e|=8)):e=0,a=Er(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},f0(a),t}function gO(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Mi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function t2(t){if(!t)return Ba;t=t._reactInternals;e:{if(ti(t)!==t||t.tag!==1)throw Error(ne(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(jn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ne(171))}if(t.tag===1){var n=t.type;if(jn(n))return tI(t,n,e)}return e}function n2(t,e,n,r,s,a,o,i,u){return t=T0(n,r,!0,t,s,a,o,i,u),t.context=t2(null),n=t.current,r=_n(),s=Oa(n),a=js(r,s),a.callback=e??null,Ra(n,a,s),t.current.lanes=s,$c(t,s,r),Kn(t,r),t}function pf(t,e,n,r){var s=e.current,a=_n(),o=Oa(s);return n=t2(n),e.context===null?e.context=n:e.pendingContext=n,e=js(a,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ra(s,e,o),t!==null&&(ts(t,s,o,a),Hd(t,s,o)),o}function Np(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function eb(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function R0(t,e){eb(t,e),(t=t.alternate)&&eb(t,e)}function yO(){return null}var r2=typeof reportError=="function"?reportError:function(t){console.error(t)};function A0(t){this._internalRoot=t}ff.prototype.render=A0.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ne(409));pf(t,e,null,null)};ff.prototype.unmount=A0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Vo(function(){pf(null,t,null,null)}),e[qs]=null}};function ff(t){this._internalRoot=t}ff.prototype.unstable_scheduleHydration=function(t){if(t){var e=DC();t={blockedOn:null,target:t,priority:e};for(var n=0;n<wa.length&&e!==0&&e<wa[n].priority;n++);wa.splice(n,0,t),n===0&&FC(t)}};function O0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function hf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function tb(){}function xO(t,e,n,r,s){if(s){if(typeof r=="function"){var a=r;r=function(){var c=Np(o);a.call(c)}}var o=n2(e,r,t,0,null,!1,!1,"",tb);return t._reactRootContainer=o,t[qs]=o.current,ql(t.nodeType===8?t.parentNode:t),Vo(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var i=r;r=function(){var c=Np(u);i.call(c)}}var u=T0(t,0,!1,null,null,!1,!1,"",tb);return t._reactRootContainer=u,t[qs]=u.current,ql(t.nodeType===8?t.parentNode:t),Vo(function(){pf(e,u,n,r)}),u}function mf(t,e,n,r,s){var a=n._reactRootContainer;if(a){var o=a;if(typeof s=="function"){var i=s;s=function(){var u=Np(o);i.call(u)}}pf(e,o,t,s)}else o=xO(n,e,t,s,r);return Np(o)}AC=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=wl(e.pendingLanes);n!==0&&(Zy(e,n|1),Kn(e,Et()),!(He&6)&&(mu=Et()+500,Ya()))}break;case 13:Vo(function(){var r=Xs(t,1);if(r!==null){var s=_n();ts(r,t,1,s)}}),R0(t,1)}};Jy=function(t){if(t.tag===13){var e=Xs(t,134217728);if(e!==null){var n=_n();ts(e,t,134217728,n)}R0(t,134217728)}};OC=function(t){if(t.tag===13){var e=Oa(t),n=Xs(t,e);if(n!==null){var r=_n();ts(n,t,e,r)}R0(t,e)}};DC=function(){return tt};PC=function(t,e){var n=tt;try{return tt=t,e()}finally{tt=n}};ug=function(t,e,n){switch(e){case"input":if(tg(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=sf(r);if(!s)throw Error(ne(90));pC(r),tg(r,s)}}}break;case"textarea":hC(t,n);break;case"select":e=n.value,e!=null&&Qi(t,!!n.multiple,e,!1)}};bC=_0;SC=Vo;var vO={usingClientEntryPoint:!1,Events:[Nc,Ui,sf,vC,wC,_0]},cl={findFiberByHostInstance:$o,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wO={bundleType:cl.bundleType,version:cl.version,rendererPackageName:cl.rendererPackageName,rendererConfig:cl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ra.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=$C(t),t===null?null:t.stateNode},findFiberByHostInstance:cl.findFiberByHostInstance||yO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cd.isDisabled&&Cd.supportsFiber)try{ef=Cd.inject(wO),$s=Cd}catch{}}pr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vO;pr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!O0(e))throw Error(ne(200));return gO(t,e,null,n)};pr.createRoot=function(t,e){if(!O0(t))throw Error(ne(299));var n=!1,r="",s=r2;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=T0(t,1,!1,null,null,n,!1,r,s),t[qs]=e.current,ql(t.nodeType===8?t.parentNode:t),new A0(e)};pr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ne(188)):(t=Object.keys(t).join(","),Error(ne(268,t)));return t=$C(e),t=t===null?null:t.stateNode,t};pr.flushSync=function(t){return Vo(t)};pr.hydrate=function(t,e,n){if(!hf(e))throw Error(ne(200));return mf(null,t,e,!0,n)};pr.hydrateRoot=function(t,e,n){if(!O0(t))throw Error(ne(405));var r=n!=null&&n.hydratedSources||null,s=!1,a="",o=r2;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=n2(e,null,t,1,n??null,s,!1,a,o),t[qs]=e.current,ql(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new ff(e)};pr.render=function(t,e,n){if(!hf(e))throw Error(ne(200));return mf(null,t,e,!1,n)};pr.unmountComponentAtNode=function(t){if(!hf(t))throw Error(ne(40));return t._reactRootContainer?(Vo(function(){mf(null,null,t,!1,function(){t._reactRootContainer=null,t[qs]=null})}),!0):!1};pr.unstable_batchedUpdates=_0;pr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!hf(n))throw Error(ne(200));if(t==null||t._reactInternals===void 0)throw Error(ne(38));return mf(t,e,n,!1,r)};pr.version="18.3.1-next-f1338f8080-20240426";function s2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s2)}catch(t){console.error(t)}}s2(),sC.exports=pr;var gf=sC.exports,nb=gf;qm.createRoot=nb.createRoot,qm.hydrateRoot=nb.hydrateRoot;function bO(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function a2(...t){return e=>t.forEach(n=>bO(n,e))}function ni(...t){return G.useCallback(a2(...t),t)}var ri=G.forwardRef((t,e)=>{const{children:n,...r}=t,s=G.Children.toArray(n),a=s.find(SO);if(a){const o=a.props.children,i=s.map(u=>u===a?G.Children.count(o)>1?G.Children.only(null):G.isValidElement(o)?o.props.children:null:u);return Ee.jsx(zg,{...r,ref:e,children:G.isValidElement(o)?G.cloneElement(o,void 0,i):null})}return Ee.jsx(zg,{...r,ref:e,children:n})});ri.displayName="Slot";var zg=G.forwardRef((t,e)=>{const{children:n,...r}=t;if(G.isValidElement(n)){const s=IO(n);return G.cloneElement(n,{...CO(r,n.props),ref:e?a2(e,s):s})}return G.Children.count(n)>1?G.Children.only(null):null});zg.displayName="SlotClone";var o2=({children:t})=>Ee.jsx(Ee.Fragment,{children:t});function SO(t){return G.isValidElement(t)&&t.type===o2}function CO(t,e){const n={...e};for(const r in e){const s=t[r],a=e[r];/^on[A-Z]/.test(r)?s&&a?n[r]=(...i)=>{a(...i),s(...i)}:s&&(n[r]=s):r==="style"?n[r]={...s,...a}:r==="className"&&(n[r]=[s,a].filter(Boolean).join(" "))}return{...t,...n}}function IO(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var $O=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],si=$O.reduce((t,e)=>{const n=G.forwardRef((r,s)=>{const{asChild:a,...o}=r,i=a?ri:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),Ee.jsx(i,{...o,ref:s})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function _O(t,e){t&&gf.flushSync(()=>t.dispatchEvent(e))}var NO="VisuallyHidden",i2=G.forwardRef((t,e)=>Ee.jsx(si.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));i2.displayName=NO;var kO=i2,u2={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var r=[],s=0;s<arguments.length;s++){var a=arguments[s];if(a){var o=typeof a;if(o==="string"||o==="number")r.push(a);else if(Array.isArray(a)){if(a.length){var i=n.apply(null,a);i&&r.push(i)}}else if(o==="object"){if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]")){r.push(a.toString());continue}for(var u in a)e.call(a,u)&&a[u]&&r.push(u)}}}return r.join(" ")}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(u2);var EO=u2.exports;const Hs=jS(EO);function l2(t,e=[]){let n=[];function r(a,o){const i=G.createContext(o),u=n.length;n=[...n,o];function c(d){const{scope:p,children:f,...h}=d,y=(p==null?void 0:p[t][u])||i,x=G.useMemo(()=>h,Object.values(h));return Ee.jsx(y.Provider,{value:x,children:f})}function l(d,p){const f=(p==null?void 0:p[t][u])||i,h=G.useContext(f);if(h)return h;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${a}\``)}return c.displayName=a+"Provider",[c,l]}const s=()=>{const a=n.map(o=>G.createContext(o));return function(i){const u=(i==null?void 0:i[t])||a;return G.useMemo(()=>({[`__scope${t}`]:{...i,[t]:u}}),[i,u])}};return s.scopeName=t,[r,TO(s,...e)]}function TO(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(a){const o=r.reduce((i,{useScope:u,scopeName:c})=>{const d=u(a)[`__scope${c}`];return{...i,...d}},{});return G.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function Bs(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}var rc=globalThis!=null&&globalThis.document?G.useLayoutEffect:()=>{};function yf(t){const e=G.useRef(t);return G.useEffect(()=>{e.current=t}),G.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function RO(t,e=globalThis==null?void 0:globalThis.document){const n=yf(t);G.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var AO="DismissableLayer",Wg="dismissableLayer.update",OO="dismissableLayer.pointerDownOutside",DO="dismissableLayer.focusOutside",rb,c2=G.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),d2=G.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:a,onInteractOutside:o,onDismiss:i,...u}=t,c=G.useContext(c2),[l,d]=G.useState(null),p=(l==null?void 0:l.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,f]=G.useState({}),h=ni(e,T=>d(T)),y=Array.from(c.layers),[x]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),g=y.indexOf(x),v=l?y.indexOf(l):-1,w=c.layersWithOutsidePointerEventsDisabled.size>0,S=v>=g,$=LO(T=>{const A=T.target,B=[...c.branches].some(L=>L.contains(A));!S||B||(s==null||s(T),o==null||o(T),T.defaultPrevented||i==null||i())},p),k=MO(T=>{const A=T.target;[...c.branches].some(L=>L.contains(A))||(a==null||a(T),o==null||o(T),T.defaultPrevented||i==null||i())},p);return RO(T=>{v===c.layers.size-1&&(r==null||r(T),!T.defaultPrevented&&i&&(T.preventDefault(),i()))},p),G.useEffect(()=>{if(l)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(rb=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(l)),c.layers.add(l),sb(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=rb)}},[l,p,n,c]),G.useEffect(()=>()=>{l&&(c.layers.delete(l),c.layersWithOutsidePointerEventsDisabled.delete(l),sb())},[l,c]),G.useEffect(()=>{const T=()=>f({});return document.addEventListener(Wg,T),()=>document.removeEventListener(Wg,T)},[]),Ee.jsx(si.div,{...u,ref:h,style:{pointerEvents:w?S?"auto":"none":void 0,...t.style},onFocusCapture:Bs(t.onFocusCapture,k.onFocusCapture),onBlurCapture:Bs(t.onBlurCapture,k.onBlurCapture),onPointerDownCapture:Bs(t.onPointerDownCapture,$.onPointerDownCapture)})});d2.displayName=AO;var PO="DismissableLayerBranch",FO=G.forwardRef((t,e)=>{const n=G.useContext(c2),r=G.useRef(null),s=ni(e,r);return G.useEffect(()=>{const a=r.current;if(a)return n.branches.add(a),()=>{n.branches.delete(a)}},[n.branches]),Ee.jsx(si.div,{...t,ref:s})});FO.displayName=PO;function LO(t,e=globalThis==null?void 0:globalThis.document){const n=yf(t),r=G.useRef(!1),s=G.useRef(()=>{});return G.useEffect(()=>{const a=i=>{if(i.target&&!r.current){let u=function(){p2(OO,n,c,{discrete:!0})};const c={originalEvent:i};i.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=u,e.addEventListener("click",s.current,{once:!0})):u()}else e.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",a),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function MO(t,e=globalThis==null?void 0:globalThis.document){const n=yf(t),r=G.useRef(!1);return G.useEffect(()=>{const s=a=>{a.target&&!r.current&&p2(DO,n,{originalEvent:a},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function sb(){const t=new CustomEvent(Wg);document.dispatchEvent(t)}function p2(t,e,n,{discrete:r}){const s=n.originalEvent.target,a=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?_O(s,a):s.dispatchEvent(a)}function BO(t,e){return G.useReducer((n,r)=>e[n][r]??n,t)}var f2=t=>{const{present:e,children:n}=t,r=VO(e),s=typeof n=="function"?n({present:r.isPresent}):G.Children.only(n),a=ni(r.ref,zO(s));return typeof n=="function"||r.isPresent?G.cloneElement(s,{ref:a}):null};f2.displayName="Presence";function VO(t){const[e,n]=G.useState(),r=G.useRef({}),s=G.useRef(t),a=G.useRef("none"),o=t?"mounted":"unmounted",[i,u]=BO(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return G.useEffect(()=>{const c=Id(r.current);a.current=i==="mounted"?c:"none"},[i]),rc(()=>{const c=r.current,l=s.current;if(l!==t){const p=a.current,f=Id(c);t?u("MOUNT"):f==="none"||(c==null?void 0:c.display)==="none"?u("UNMOUNT"):u(l&&p!==f?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,u]),rc(()=>{if(e){const c=d=>{const f=Id(r.current).includes(d.animationName);d.target===e&&f&&gf.flushSync(()=>u("ANIMATION_END"))},l=d=>{d.target===e&&(a.current=Id(r.current))};return e.addEventListener("animationstart",l),e.addEventListener("animationcancel",c),e.addEventListener("animationend",c),()=>{e.removeEventListener("animationstart",l),e.removeEventListener("animationcancel",c),e.removeEventListener("animationend",c)}}else u("ANIMATION_END")},[e,u]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:G.useCallback(c=>{c&&(r.current=getComputedStyle(c)),n(c)},[])}}function Id(t){return(t==null?void 0:t.animationName)||"none"}function zO(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}const Ec={asChild:{type:"boolean"}},WO={width:{type:"string",className:"rt-r-w",customProperties:["--width"],responsive:!0},minWidth:{type:"string",className:"rt-r-min-w",customProperties:["--min-width"],responsive:!0},maxWidth:{type:"string",className:"rt-r-max-w",customProperties:["--max-width"],responsive:!0}},UO={height:{type:"string",className:"rt-r-h",customProperties:["--height"],responsive:!0},minHeight:{type:"string",className:"rt-r-min-h",customProperties:["--min-height"],responsive:!0},maxHeight:{type:"string",className:"rt-r-max-h",customProperties:["--max-height"],responsive:!0}},h2=["gray","gold","bronze","brown","yellow","amber","orange","tomato","red","ruby","crimson","pink","plum","purple","violet","iris","indigo","blue","cyan","teal","jade","green","grass","lime","mint","sky"],GO=["auto","gray","mauve","slate","sage","olive","sand"],HO={color:{type:"enum",values:h2,default:void 0}},jO={highContrast:{type:"boolean",className:"rt-high-contrast",default:void 0}},KO=["normal","start","end","both"],qO={trim:{type:"enum",className:"rt-r-lt",values:KO,responsive:!0}},XO=["left","center","right"],YO={align:{type:"enum",className:"rt-r-ta",values:XO,responsive:!0}},QO=["wrap","nowrap","pretty","balance"],ZO={wrap:{type:"enum",className:"rt-r-tw",values:QO,responsive:!0}},JO={truncate:{type:"boolean",className:"rt-truncate"}},eD=["light","regular","medium","bold"],tD={weight:{type:"enum",className:"rt-r-weight",values:eD,responsive:!0}},D0=["initial","xs","sm","md","lg","xl"];function m2(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Fl(t){return typeof t=="object"&&Object.keys(t).some(e=>D0.includes(e))}function nD({className:t,customProperties:e,...n}){const r=g2({allowArbitraryValues:!0,className:t,...n}),s=rD({customProperties:e,...n});return[r,s]}function g2({allowArbitraryValues:t,value:e,className:n,propValues:r,parseValue:s=a=>a}){const a=[];if(e){if(typeof e=="string"&&r.includes(e))return ab(n,e,s);if(Fl(e)){const o=e;for(const i in o){if(!m2(o,i)||!D0.includes(i))continue;const u=o[i];if(u!==void 0){if(r.includes(u)){const c=ab(n,u,s),l=i==="initial"?c:`${i}:${c}`;a.push(l)}else if(t){const c=i==="initial"?n:`${i}:${n}`;a.push(c)}}}return a.join(" ")}if(t)return n}}function ab(t,e,n){const r=t?"-":"",s=n(e),a=s==null?void 0:s.startsWith("-"),o=a?"-":"",i=a?s==null?void 0:s.substring(1):s;return`${o}${t}${r}${i}`}function rD({customProperties:t,value:e,propValues:n,parseValue:r=s=>s}){let s={};if(!(!e||typeof e=="string"&&n.includes(e))){if(typeof e=="string"&&(s=Object.fromEntries(t.map(a=>[a,e]))),Fl(e)){const a=e;for(const o in a){if(!m2(a,o)||!D0.includes(o))continue;const i=a[o];if(!n.includes(i))for(const u of t)s={[o==="initial"?u:`${u}-${o}`]:i,...s}}}for(const a in s){const o=s[a];o!==void 0&&(s[a]=r(o))}return s}}function ob(...t){let e={};for(const n of t)n&&(e={...e,...n});return Object.keys(e).length?e:void 0}function sD(...t){return Object.assign({},...t)}function xf(t,...e){let n,r;const s={...t},a=sD(...e);for(const o in a){let i=s[o];const u=a[o];if(u.default!==void 0&&i===void 0&&(i=u.default),u.type==="enum"&&![u.default,...u.values].includes(i)&&!Fl(i)&&(i=u.default),s[o]=i,"className"in u&&u.className){delete s[o];const c="responsive"in u;if(!i||Fl(i)&&!c)continue;if(Fl(i)&&(u.default!==void 0&&i.initial===void 0&&(i.initial=u.default),u.type==="enum"&&([u.default,...u.values].includes(i.initial)||(i.initial=u.default))),u.type==="enum"){const l=g2({allowArbitraryValues:!1,value:i,className:u.className,propValues:u.values,parseValue:u.parseValue});n=Hs(n,l);continue}if(u.type==="string"||u.type==="enum | string"){const l=u.type==="string"?[]:u.values,[d,p]=nD({className:u.className,customProperties:u.customProperties,propValues:l,parseValue:u.parseValue,value:i});r=ob(r,p),n=Hs(n,d);continue}if(u.type==="boolean"&&i){n=Hs(n,u.className);continue}}}return s.className=Hs(n,t.className),s.style=ob(r,t.style),s}const ho=["0","1","2","3","4","5","6","7","8","9","-1","-2","-3","-4","-5","-6","-7","-8","-9"],vf={m:{type:"enum | string",values:ho,responsive:!0,className:"rt-r-m",customProperties:["--m"]},mx:{type:"enum | string",values:ho,responsive:!0,className:"rt-r-mx",customProperties:["--ml","--mr"]},my:{type:"enum | string",values:ho,responsive:!0,className:"rt-r-my",customProperties:["--mt","--mb"]},mt:{type:"enum | string",values:ho,responsive:!0,className:"rt-r-mt",customProperties:["--mt"]},mr:{type:"enum | string",values:ho,responsive:!0,className:"rt-r-mr",customProperties:["--mr"]},mb:{type:"enum | string",values:ho,responsive:!0,className:"rt-r-mb",customProperties:["--mb"]},ml:{type:"enum | string",values:ho,responsive:!0,className:"rt-r-ml",customProperties:["--ml"]}},aD=["span","div","label","p"],oD=["1","2","3","4","5","6","7","8","9"],iD={as:{type:"enum",values:aD,default:"span"},...Ec,size:{type:"enum",className:"rt-r-size",values:oD,responsive:!0},...tD,...YO,...qO,...JO,...ZO,...HO,...jO},y2=G.forwardRef((t,e)=>{const{children:n,className:r,asChild:s,as:a="span",color:o,...i}=xf(t,iD,vf);return G.createElement(ri,{"data-accent-color":o,...i,ref:e,className:Hs("rt-Text",r)},s?n:G.createElement(a,null,n))});y2.displayName="Text";const uD=["top","right","bottom","left"],Ss=Math.min,ar=Math.max,kp=Math.round,$d=Math.floor,Va=t=>({x:t,y:t}),lD={left:"right",right:"left",bottom:"top",top:"bottom"},cD={start:"end",end:"start"};function Ug(t,e,n){return ar(t,Ss(e,n))}function Qs(t,e){return typeof t=="function"?t(e):t}function Zs(t){return t.split("-")[0]}function Tu(t){return t.split("-")[1]}function P0(t){return t==="x"?"y":"x"}function F0(t){return t==="y"?"height":"width"}function za(t){return["top","bottom"].includes(Zs(t))?"y":"x"}function L0(t){return P0(za(t))}function dD(t,e,n){n===void 0&&(n=!1);const r=Tu(t),s=L0(t),a=F0(s);let o=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[a]>e.floating[a]&&(o=Ep(o)),[o,Ep(o)]}function pD(t){const e=Ep(t);return[Gg(t),e,Gg(e)]}function Gg(t){return t.replace(/start|end/g,e=>cD[e])}function fD(t,e,n){const r=["left","right"],s=["right","left"],a=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?s:r:e?r:s;case"left":case"right":return e?a:o;default:return[]}}function hD(t,e,n,r){const s=Tu(t);let a=fD(Zs(t),n==="start",r);return s&&(a=a.map(o=>o+"-"+s),e&&(a=a.concat(a.map(Gg)))),a}function Ep(t){return t.replace(/left|right|bottom|top/g,e=>lD[e])}function mD(t){return{top:0,right:0,bottom:0,left:0,...t}}function x2(t){return typeof t!="number"?mD(t):{top:t,right:t,bottom:t,left:t}}function Tp(t){const{x:e,y:n,width:r,height:s}=t;return{width:r,height:s,top:n,left:e,right:e+r,bottom:n+s,x:e,y:n}}function ib(t,e,n){let{reference:r,floating:s}=t;const a=za(e),o=L0(e),i=F0(o),u=Zs(e),c=a==="y",l=r.x+r.width/2-s.width/2,d=r.y+r.height/2-s.height/2,p=r[i]/2-s[i]/2;let f;switch(u){case"top":f={x:l,y:r.y-s.height};break;case"bottom":f={x:l,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:d};break;case"left":f={x:r.x-s.width,y:d};break;default:f={x:r.x,y:r.y}}switch(Tu(e)){case"start":f[o]-=p*(n&&c?-1:1);break;case"end":f[o]+=p*(n&&c?-1:1);break}return f}const gD=async(t,e,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:a=[],platform:o}=n,i=a.filter(Boolean),u=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:s}),{x:l,y:d}=ib(c,r,u),p=r,f={},h=0;for(let y=0;y<i.length;y++){const{name:x,fn:g}=i[y],{x:v,y:w,data:S,reset:$}=await g({x:l,y:d,initialPlacement:r,placement:p,strategy:s,middlewareData:f,rects:c,platform:o,elements:{reference:t,floating:e}});l=v??l,d=w??d,f={...f,[x]:{...f[x],...S}},$&&h<=50&&(h++,typeof $=="object"&&($.placement&&(p=$.placement),$.rects&&(c=$.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:s}):$.rects),{x:l,y:d}=ib(c,p,u)),y=-1)}return{x:l,y:d,placement:p,strategy:s,middlewareData:f}};async function sc(t,e){var n;e===void 0&&(e={});const{x:r,y:s,platform:a,rects:o,elements:i,strategy:u}=t,{boundary:c="clippingAncestors",rootBoundary:l="viewport",elementContext:d="floating",altBoundary:p=!1,padding:f=0}=Qs(e,t),h=x2(f),x=i[p?d==="floating"?"reference":"floating":d],g=Tp(await a.getClippingRect({element:(n=await(a.isElement==null?void 0:a.isElement(x)))==null||n?x:x.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(i.floating)),boundary:c,rootBoundary:l,strategy:u})),v=d==="floating"?{x:r,y:s,width:o.floating.width,height:o.floating.height}:o.reference,w=await(a.getOffsetParent==null?void 0:a.getOffsetParent(i.floating)),S=await(a.isElement==null?void 0:a.isElement(w))?await(a.getScale==null?void 0:a.getScale(w))||{x:1,y:1}:{x:1,y:1},$=Tp(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:i,rect:v,offsetParent:w,strategy:u}):v);return{top:(g.top-$.top+h.top)/S.y,bottom:($.bottom-g.bottom+h.bottom)/S.y,left:(g.left-$.left+h.left)/S.x,right:($.right-g.right+h.right)/S.x}}const yD=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:s,rects:a,platform:o,elements:i,middlewareData:u}=e,{element:c,padding:l=0}=Qs(t,e)||{};if(c==null)return{};const d=x2(l),p={x:n,y:r},f=L0(s),h=F0(f),y=await o.getDimensions(c),x=f==="y",g=x?"top":"left",v=x?"bottom":"right",w=x?"clientHeight":"clientWidth",S=a.reference[h]+a.reference[f]-p[f]-a.floating[h],$=p[f]-a.reference[f],k=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let T=k?k[w]:0;(!T||!await(o.isElement==null?void 0:o.isElement(k)))&&(T=i.floating[w]||a.floating[h]);const A=S/2-$/2,B=T/2-y[h]/2-1,L=Ss(d[g],B),z=Ss(d[v],B),Y=L,Q=T-y[h]-z,re=T/2-y[h]/2+A,Z=Ug(Y,re,Q),de=!u.arrow&&Tu(s)!=null&&re!==Z&&a.reference[h]/2-(re<Y?L:z)-y[h]/2<0,ce=de?re<Y?re-Y:re-Q:0;return{[f]:p[f]+ce,data:{[f]:Z,centerOffset:re-Z-ce,...de&&{alignmentOffset:ce}},reset:de}}}),xD=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:s,middlewareData:a,rects:o,initialPlacement:i,platform:u,elements:c}=e,{mainAxis:l=!0,crossAxis:d=!0,fallbackPlacements:p,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:h="none",flipAlignment:y=!0,...x}=Qs(t,e);if((n=a.arrow)!=null&&n.alignmentOffset)return{};const g=Zs(s),v=za(i),w=Zs(i)===i,S=await(u.isRTL==null?void 0:u.isRTL(c.floating)),$=p||(w||!y?[Ep(i)]:pD(i)),k=h!=="none";!p&&k&&$.push(...hD(i,y,h,S));const T=[i,...$],A=await sc(e,x),B=[];let L=((r=a.flip)==null?void 0:r.overflows)||[];if(l&&B.push(A[g]),d){const re=dD(s,o,S);B.push(A[re[0]],A[re[1]])}if(L=[...L,{placement:s,overflows:B}],!B.every(re=>re<=0)){var z,Y;const re=(((z=a.flip)==null?void 0:z.index)||0)+1,Z=T[re];if(Z)return{data:{index:re,overflows:L},reset:{placement:Z}};let de=(Y=L.filter(ce=>ce.overflows[0]<=0).sort((ce,j)=>ce.overflows[1]-j.overflows[1])[0])==null?void 0:Y.placement;if(!de)switch(f){case"bestFit":{var Q;const ce=(Q=L.filter(j=>{if(k){const ee=za(j.placement);return ee===v||ee==="y"}return!0}).map(j=>[j.placement,j.overflows.filter(ee=>ee>0).reduce((ee,me)=>ee+me,0)]).sort((j,ee)=>j[1]-ee[1])[0])==null?void 0:Q[0];ce&&(de=ce);break}case"initialPlacement":de=i;break}if(s!==de)return{reset:{placement:de}}}return{}}}};function ub(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function lb(t){return uD.some(e=>t[e]>=0)}const vD=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...s}=Qs(t,e);switch(r){case"referenceHidden":{const a=await sc(e,{...s,elementContext:"reference"}),o=ub(a,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:lb(o)}}}case"escaped":{const a=await sc(e,{...s,altBoundary:!0}),o=ub(a,n.floating);return{data:{escapedOffsets:o,escaped:lb(o)}}}default:return{}}}}};async function wD(t,e){const{placement:n,platform:r,elements:s}=t,a=await(r.isRTL==null?void 0:r.isRTL(s.floating)),o=Zs(n),i=Tu(n),u=za(n)==="y",c=["left","top"].includes(o)?-1:1,l=a&&u?-1:1,d=Qs(e,t);let{mainAxis:p,crossAxis:f,alignmentAxis:h}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return i&&typeof h=="number"&&(f=i==="end"?h*-1:h),u?{x:f*l,y:p*c}:{x:p*c,y:f*l}}const bD=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:s,y:a,placement:o,middlewareData:i}=e,u=await wD(e,t);return o===((n=i.offset)==null?void 0:n.placement)&&(r=i.arrow)!=null&&r.alignmentOffset?{}:{x:s+u.x,y:a+u.y,data:{...u,placement:o}}}}},SD=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:s}=e,{mainAxis:a=!0,crossAxis:o=!1,limiter:i={fn:x=>{let{x:g,y:v}=x;return{x:g,y:v}}},...u}=Qs(t,e),c={x:n,y:r},l=await sc(e,u),d=za(Zs(s)),p=P0(d);let f=c[p],h=c[d];if(a){const x=p==="y"?"top":"left",g=p==="y"?"bottom":"right",v=f+l[x],w=f-l[g];f=Ug(v,f,w)}if(o){const x=d==="y"?"top":"left",g=d==="y"?"bottom":"right",v=h+l[x],w=h-l[g];h=Ug(v,h,w)}const y=i.fn({...e,[p]:f,[d]:h});return{...y,data:{x:y.x-n,y:y.y-r}}}}},CD=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:s,rects:a,middlewareData:o}=e,{offset:i=0,mainAxis:u=!0,crossAxis:c=!0}=Qs(t,e),l={x:n,y:r},d=za(s),p=P0(d);let f=l[p],h=l[d];const y=Qs(i,e),x=typeof y=="number"?{mainAxis:y,crossAxis:0}:{mainAxis:0,crossAxis:0,...y};if(u){const w=p==="y"?"height":"width",S=a.reference[p]-a.floating[w]+x.mainAxis,$=a.reference[p]+a.reference[w]-x.mainAxis;f<S?f=S:f>$&&(f=$)}if(c){var g,v;const w=p==="y"?"width":"height",S=["top","left"].includes(Zs(s)),$=a.reference[d]-a.floating[w]+(S&&((g=o.offset)==null?void 0:g[d])||0)+(S?0:x.crossAxis),k=a.reference[d]+a.reference[w]+(S?0:((v=o.offset)==null?void 0:v[d])||0)-(S?x.crossAxis:0);h<$?h=$:h>k&&(h=k)}return{[p]:f,[d]:h}}}},ID=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){const{placement:n,rects:r,platform:s,elements:a}=e,{apply:o=()=>{},...i}=Qs(t,e),u=await sc(e,i),c=Zs(n),l=Tu(n),d=za(n)==="y",{width:p,height:f}=r.floating;let h,y;c==="top"||c==="bottom"?(h=c,y=l===(await(s.isRTL==null?void 0:s.isRTL(a.floating))?"start":"end")?"left":"right"):(y=c,h=l==="end"?"top":"bottom");const x=f-u.top-u.bottom,g=p-u.left-u.right,v=Ss(f-u[h],x),w=Ss(p-u[y],g),S=!e.middlewareData.shift;let $=v,k=w;if(d?k=l||S?Ss(w,g):g:$=l||S?Ss(v,x):x,S&&!l){const A=ar(u.left,0),B=ar(u.right,0),L=ar(u.top,0),z=ar(u.bottom,0);d?k=p-2*(A!==0||B!==0?A+B:ar(u.left,u.right)):$=f-2*(L!==0||z!==0?L+z:ar(u.top,u.bottom))}await o({...e,availableWidth:k,availableHeight:$});const T=await s.getDimensions(a.floating);return p!==T.width||f!==T.height?{reset:{rects:!0}}:{}}}};function Ru(t){return v2(t)?(t.nodeName||"").toLowerCase():"#document"}function lr(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function sa(t){var e;return(e=(v2(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function v2(t){return t instanceof Node||t instanceof lr(t).Node}function is(t){return t instanceof Element||t instanceof lr(t).Element}function Es(t){return t instanceof HTMLElement||t instanceof lr(t).HTMLElement}function cb(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof lr(t).ShadowRoot}function Tc(t){const{overflow:e,overflowX:n,overflowY:r,display:s}=us(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(s)}function $D(t){return["table","td","th"].includes(Ru(t))}function wf(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function M0(t){const e=B0(),n=is(t)?us(t):t;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function _D(t){let e=Wa(t);for(;Es(e)&&!gu(e);){if(M0(e))return e;if(wf(e))return null;e=Wa(e)}return null}function B0(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function gu(t){return["html","body","#document"].includes(Ru(t))}function us(t){return lr(t).getComputedStyle(t)}function bf(t){return is(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Wa(t){if(Ru(t)==="html")return t;const e=t.assignedSlot||t.parentNode||cb(t)&&t.host||sa(t);return cb(e)?e.host:e}function w2(t){const e=Wa(t);return gu(e)?t.ownerDocument?t.ownerDocument.body:t.body:Es(e)&&Tc(e)?e:w2(e)}function ac(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const s=w2(t),a=s===((r=t.ownerDocument)==null?void 0:r.body),o=lr(s);return a?e.concat(o,o.visualViewport||[],Tc(s)?s:[],o.frameElement&&n?ac(o.frameElement):[]):e.concat(s,ac(s,[],n))}function b2(t){const e=us(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=Es(t),a=s?t.offsetWidth:n,o=s?t.offsetHeight:r,i=kp(n)!==a||kp(r)!==o;return i&&(n=a,r=o),{width:n,height:r,$:i}}function V0(t){return is(t)?t:t.contextElement}function ru(t){const e=V0(t);if(!Es(e))return Va(1);const n=e.getBoundingClientRect(),{width:r,height:s,$:a}=b2(e);let o=(a?kp(n.width):n.width)/r,i=(a?kp(n.height):n.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!i||!Number.isFinite(i))&&(i=1),{x:o,y:i}}const ND=Va(0);function S2(t){const e=lr(t);return!B0()||!e.visualViewport?ND:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function kD(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==lr(t)?!1:e}function zo(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const s=t.getBoundingClientRect(),a=V0(t);let o=Va(1);e&&(r?is(r)&&(o=ru(r)):o=ru(t));const i=kD(a,n,r)?S2(a):Va(0);let u=(s.left+i.x)/o.x,c=(s.top+i.y)/o.y,l=s.width/o.x,d=s.height/o.y;if(a){const p=lr(a),f=r&&is(r)?lr(r):r;let h=p,y=h.frameElement;for(;y&&r&&f!==h;){const x=ru(y),g=y.getBoundingClientRect(),v=us(y),w=g.left+(y.clientLeft+parseFloat(v.paddingLeft))*x.x,S=g.top+(y.clientTop+parseFloat(v.paddingTop))*x.y;u*=x.x,c*=x.y,l*=x.x,d*=x.y,u+=w,c+=S,h=lr(y),y=h.frameElement}}return Tp({width:l,height:d,x:u,y:c})}function ED(t){let{elements:e,rect:n,offsetParent:r,strategy:s}=t;const a=s==="fixed",o=sa(r),i=e?wf(e.floating):!1;if(r===o||i&&a)return n;let u={scrollLeft:0,scrollTop:0},c=Va(1);const l=Va(0),d=Es(r);if((d||!d&&!a)&&((Ru(r)!=="body"||Tc(o))&&(u=bf(r)),Es(r))){const p=zo(r);c=ru(r),l.x=p.x+r.clientLeft,l.y=p.y+r.clientTop}return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-u.scrollLeft*c.x+l.x,y:n.y*c.y-u.scrollTop*c.y+l.y}}function TD(t){return Array.from(t.getClientRects())}function C2(t){return zo(sa(t)).left+bf(t).scrollLeft}function RD(t){const e=sa(t),n=bf(t),r=t.ownerDocument.body,s=ar(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),a=ar(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+C2(t);const i=-n.scrollTop;return us(r).direction==="rtl"&&(o+=ar(e.clientWidth,r.clientWidth)-s),{width:s,height:a,x:o,y:i}}function AD(t,e){const n=lr(t),r=sa(t),s=n.visualViewport;let a=r.clientWidth,o=r.clientHeight,i=0,u=0;if(s){a=s.width,o=s.height;const c=B0();(!c||c&&e==="fixed")&&(i=s.offsetLeft,u=s.offsetTop)}return{width:a,height:o,x:i,y:u}}function OD(t,e){const n=zo(t,!0,e==="fixed"),r=n.top+t.clientTop,s=n.left+t.clientLeft,a=Es(t)?ru(t):Va(1),o=t.clientWidth*a.x,i=t.clientHeight*a.y,u=s*a.x,c=r*a.y;return{width:o,height:i,x:u,y:c}}function db(t,e,n){let r;if(e==="viewport")r=AD(t,n);else if(e==="document")r=RD(sa(t));else if(is(e))r=OD(e,n);else{const s=S2(t);r={...e,x:e.x-s.x,y:e.y-s.y}}return Tp(r)}function I2(t,e){const n=Wa(t);return n===e||!is(n)||gu(n)?!1:us(n).position==="fixed"||I2(n,e)}function DD(t,e){const n=e.get(t);if(n)return n;let r=ac(t,[],!1).filter(i=>is(i)&&Ru(i)!=="body"),s=null;const a=us(t).position==="fixed";let o=a?Wa(t):t;for(;is(o)&&!gu(o);){const i=us(o),u=M0(o);!u&&i.position==="fixed"&&(s=null),(a?!u&&!s:!u&&i.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||Tc(o)&&!u&&I2(t,o))?r=r.filter(l=>l!==o):s=i,o=Wa(o)}return e.set(t,r),r}function PD(t){let{element:e,boundary:n,rootBoundary:r,strategy:s}=t;const o=[...n==="clippingAncestors"?wf(e)?[]:DD(e,this._c):[].concat(n),r],i=o[0],u=o.reduce((c,l)=>{const d=db(e,l,s);return c.top=ar(d.top,c.top),c.right=Ss(d.right,c.right),c.bottom=Ss(d.bottom,c.bottom),c.left=ar(d.left,c.left),c},db(e,i,s));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function FD(t){const{width:e,height:n}=b2(t);return{width:e,height:n}}function LD(t,e,n){const r=Es(e),s=sa(e),a=n==="fixed",o=zo(t,!0,a,e);let i={scrollLeft:0,scrollTop:0};const u=Va(0);if(r||!r&&!a)if((Ru(e)!=="body"||Tc(s))&&(i=bf(e)),r){const d=zo(e,!0,a,e);u.x=d.x+e.clientLeft,u.y=d.y+e.clientTop}else s&&(u.x=C2(s));const c=o.left+i.scrollLeft-u.x,l=o.top+i.scrollTop-u.y;return{x:c,y:l,width:o.width,height:o.height}}function $m(t){return us(t).position==="static"}function pb(t,e){return!Es(t)||us(t).position==="fixed"?null:e?e(t):t.offsetParent}function $2(t,e){const n=lr(t);if(wf(t))return n;if(!Es(t)){let s=Wa(t);for(;s&&!gu(s);){if(is(s)&&!$m(s))return s;s=Wa(s)}return n}let r=pb(t,e);for(;r&&$D(r)&&$m(r);)r=pb(r,e);return r&&gu(r)&&$m(r)&&!M0(r)?n:r||_D(t)||n}const MD=async function(t){const e=this.getOffsetParent||$2,n=this.getDimensions,r=await n(t.floating);return{reference:LD(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function BD(t){return us(t).direction==="rtl"}const VD={convertOffsetParentRelativeRectToViewportRelativeRect:ED,getDocumentElement:sa,getClippingRect:PD,getOffsetParent:$2,getElementRects:MD,getClientRects:TD,getDimensions:FD,getScale:ru,isElement:is,isRTL:BD};function zD(t,e){let n=null,r;const s=sa(t);function a(){var i;clearTimeout(r),(i=n)==null||i.disconnect(),n=null}function o(i,u){i===void 0&&(i=!1),u===void 0&&(u=1),a();const{left:c,top:l,width:d,height:p}=t.getBoundingClientRect();if(i||e(),!d||!p)return;const f=$d(l),h=$d(s.clientWidth-(c+d)),y=$d(s.clientHeight-(l+p)),x=$d(c),v={rootMargin:-f+"px "+-h+"px "+-y+"px "+-x+"px",threshold:ar(0,Ss(1,u))||1};let w=!0;function S($){const k=$[0].intersectionRatio;if(k!==u){if(!w)return o();k?o(!1,k):r=setTimeout(()=>{o(!1,1e-7)},1e3)}w=!1}try{n=new IntersectionObserver(S,{...v,root:s.ownerDocument})}catch{n=new IntersectionObserver(S,v)}n.observe(t)}return o(!0),a}function WD(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:a=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:i=typeof IntersectionObserver=="function",animationFrame:u=!1}=r,c=V0(t),l=s||a?[...c?ac(c):[],...ac(e)]:[];l.forEach(g=>{s&&g.addEventListener("scroll",n,{passive:!0}),a&&g.addEventListener("resize",n)});const d=c&&i?zD(c,n):null;let p=-1,f=null;o&&(f=new ResizeObserver(g=>{let[v]=g;v&&v.target===c&&f&&(f.unobserve(e),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var w;(w=f)==null||w.observe(e)})),n()}),c&&!u&&f.observe(c),f.observe(e));let h,y=u?zo(t):null;u&&x();function x(){const g=zo(t);y&&(g.x!==y.x||g.y!==y.y||g.width!==y.width||g.height!==y.height)&&n(),y=g,h=requestAnimationFrame(x)}return n(),()=>{var g;l.forEach(v=>{s&&v.removeEventListener("scroll",n),a&&v.removeEventListener("resize",n)}),d==null||d(),(g=f)==null||g.disconnect(),f=null,u&&cancelAnimationFrame(h)}}const UD=bD,GD=SD,HD=xD,jD=ID,KD=vD,fb=yD,qD=CD,XD=(t,e,n)=>{const r=new Map,s={platform:VD,...n},a={...s.platform,_c:r};return gD(t,e,{...s,platform:a})};var Zd=typeof document<"u"?G.useLayoutEffect:G.useEffect;function Rp(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!Rp(t[r],e[r]))return!1;return!0}if(s=Object.keys(t),n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=n;r--!==0;){const a=s[r];if(!(a==="_owner"&&t.$$typeof)&&!Rp(t[a],e[a]))return!1}return!0}return t!==t&&e!==e}function _2(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function hb(t,e){const n=_2(t);return Math.round(e*n)/n}function mb(t){const e=G.useRef(t);return Zd(()=>{e.current=t}),e}function YD(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:a,floating:o}={},transform:i=!0,whileElementsMounted:u,open:c}=t,[l,d]=G.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[p,f]=G.useState(r);Rp(p,r)||f(r);const[h,y]=G.useState(null),[x,g]=G.useState(null),v=G.useCallback(ce=>{ce!==k.current&&(k.current=ce,y(ce))},[]),w=G.useCallback(ce=>{ce!==T.current&&(T.current=ce,g(ce))},[]),S=a||h,$=o||x,k=G.useRef(null),T=G.useRef(null),A=G.useRef(l),B=u!=null,L=mb(u),z=mb(s),Y=G.useCallback(()=>{if(!k.current||!T.current)return;const ce={placement:e,strategy:n,middleware:p};z.current&&(ce.platform=z.current),XD(k.current,T.current,ce).then(j=>{const ee={...j,isPositioned:!0};Q.current&&!Rp(A.current,ee)&&(A.current=ee,gf.flushSync(()=>{d(ee)}))})},[p,e,n,z]);Zd(()=>{c===!1&&A.current.isPositioned&&(A.current.isPositioned=!1,d(ce=>({...ce,isPositioned:!1})))},[c]);const Q=G.useRef(!1);Zd(()=>(Q.current=!0,()=>{Q.current=!1}),[]),Zd(()=>{if(S&&(k.current=S),$&&(T.current=$),S&&$){if(L.current)return L.current(S,$,Y);Y()}},[S,$,Y,L,B]);const re=G.useMemo(()=>({reference:k,floating:T,setReference:v,setFloating:w}),[v,w]),Z=G.useMemo(()=>({reference:S,floating:$}),[S,$]),de=G.useMemo(()=>{const ce={position:n,left:0,top:0};if(!Z.floating)return ce;const j=hb(Z.floating,l.x),ee=hb(Z.floating,l.y);return i?{...ce,transform:"translate("+j+"px, "+ee+"px)",..._2(Z.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:j,top:ee}},[n,i,Z.floating,l.x,l.y]);return G.useMemo(()=>({...l,update:Y,refs:re,elements:Z,floatingStyles:de}),[l,Y,re,Z,de])}const QD=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:s}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?fb({element:r.current,padding:s}).fn(n):{}:r?fb({element:r,padding:s}).fn(n):{}}}},ZD=(t,e)=>({...UD(t),options:[t,e]}),JD=(t,e)=>({...GD(t),options:[t,e]}),eP=(t,e)=>({...qD(t),options:[t,e]}),tP=(t,e)=>({...HD(t),options:[t,e]}),nP=(t,e)=>({...jD(t),options:[t,e]}),rP=(t,e)=>({...KD(t),options:[t,e]}),sP=(t,e)=>({...QD(t),options:[t,e]});var aP="Arrow",N2=G.forwardRef((t,e)=>{const{children:n,width:r=10,height:s=5,...a}=t;return Ee.jsx(si.svg,{...a,ref:e,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:Ee.jsx("polygon",{points:"0,0 30,0 15,10"})})});N2.displayName=aP;var oP=N2;function iP(t){const[e,n]=G.useState(void 0);return rc(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const a=s[0];let o,i;if("borderBoxSize"in a){const u=a.borderBoxSize,c=Array.isArray(u)?u[0]:u;o=c.inlineSize,i=c.blockSize}else o=t.offsetWidth,i=t.offsetHeight;n({width:o,height:i})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var k2="Popper",[E2,T2]=l2(k2),[Oie,R2]=E2(k2),A2="PopperAnchor",O2=G.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...s}=t,a=R2(A2,n),o=G.useRef(null),i=ni(e,o);return G.useEffect(()=>{a.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:Ee.jsx(si.div,{...s,ref:i})});O2.displayName=A2;var z0="PopperContent",[uP,lP]=E2(z0),D2=G.forwardRef((t,e)=>{var wn,rt,Dn,zr,Zn,mr;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:a="center",alignOffset:o=0,arrowPadding:i=0,avoidCollisions:u=!0,collisionBoundary:c=[],collisionPadding:l=0,sticky:d="partial",hideWhenDetached:p=!1,updatePositionStrategy:f="optimized",onPlaced:h,...y}=t,x=R2(z0,n),[g,v]=G.useState(null),w=ni(e,Xe=>v(Xe)),[S,$]=G.useState(null),k=iP(S),T=(k==null?void 0:k.width)??0,A=(k==null?void 0:k.height)??0,B=r+(a!=="center"?"-"+a:""),L=typeof l=="number"?l:{top:0,right:0,bottom:0,left:0,...l},z=Array.isArray(c)?c:[c],Y=z.length>0,Q={padding:L,boundary:z.filter(dP),altBoundary:Y},{refs:re,floatingStyles:Z,placement:de,isPositioned:ce,middlewareData:j}=YD({strategy:"fixed",placement:B,whileElementsMounted:(...Xe)=>WD(...Xe,{animationFrame:f==="always"}),elements:{reference:x.anchor},middleware:[ZD({mainAxis:s+A,alignmentAxis:o}),u&&JD({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?eP():void 0,...Q}),u&&tP({...Q}),nP({...Q,apply:({elements:Xe,rects:Qe,availableWidth:gr,availableHeight:kt})=>{const{width:ps,height:Rs}=Qe.reference,yr=Xe.floating.style;yr.setProperty("--radix-popper-available-width",`${gr}px`),yr.setProperty("--radix-popper-available-height",`${kt}px`),yr.setProperty("--radix-popper-anchor-width",`${ps}px`),yr.setProperty("--radix-popper-anchor-height",`${Rs}px`)}}),S&&sP({element:S,padding:i}),pP({arrowWidth:T,arrowHeight:A}),p&&rP({strategy:"referenceHidden",...Q})]}),[ee,me]=L2(de),Ie=yf(h);rc(()=>{ce&&(Ie==null||Ie())},[ce,Ie]);const Pe=(wn=j.arrow)==null?void 0:wn.x,Ge=(rt=j.arrow)==null?void 0:rt.y,_t=((Dn=j.arrow)==null?void 0:Dn.centerOffset)!==0,[Pt,Nt]=G.useState();return rc(()=>{g&&Nt(window.getComputedStyle(g).zIndex)},[g]),Ee.jsx("div",{ref:re.setFloating,"data-radix-popper-content-wrapper":"",style:{...Z,transform:ce?Z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Pt,"--radix-popper-transform-origin":[(zr=j.transformOrigin)==null?void 0:zr.x,(Zn=j.transformOrigin)==null?void 0:Zn.y].join(" "),...((mr=j.hide)==null?void 0:mr.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:Ee.jsx(uP,{scope:n,placedSide:ee,onArrowChange:$,arrowX:Pe,arrowY:Ge,shouldHideArrow:_t,children:Ee.jsx(si.div,{"data-side":ee,"data-align":me,...y,ref:w,style:{...y.style,animation:ce?void 0:"none"}})})})});D2.displayName=z0;var P2="PopperArrow",cP={top:"bottom",right:"left",bottom:"top",left:"right"},F2=G.forwardRef(function(e,n){const{__scopePopper:r,...s}=e,a=lP(P2,r),o=cP[a.placedSide];return Ee.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:Ee.jsx(oP,{...s,ref:n,style:{...s.style,display:"block"}})})});F2.displayName=P2;function dP(t){return t!==null}var pP=t=>({name:"transformOrigin",options:t,fn(e){var x,g,v;const{placement:n,rects:r,middlewareData:s}=e,o=((x=s.arrow)==null?void 0:x.centerOffset)!==0,i=o?0:t.arrowWidth,u=o?0:t.arrowHeight,[c,l]=L2(n),d={start:"0%",center:"50%",end:"100%"}[l],p=(((g=s.arrow)==null?void 0:g.x)??0)+i/2,f=(((v=s.arrow)==null?void 0:v.y)??0)+u/2;let h="",y="";return c==="bottom"?(h=o?d:`${p}px`,y=`${-u}px`):c==="top"?(h=o?d:`${p}px`,y=`${r.floating.height+u}px`):c==="right"?(h=`${-u}px`,y=o?d:`${f}px`):c==="left"&&(h=`${r.floating.width+u}px`,y=o?d:`${f}px`),{data:{x:h,y}}}});function L2(t){const[e,n="center"]=t.split("-");return[e,n]}var fP=O2,hP=D2,mP=F2,[Sf,Die]=l2("Tooltip",[T2]),W0=T2(),M2="TooltipProvider",gP=700,gb="tooltip.open",[yP,B2]=Sf(M2),V2=t=>{const{__scopeTooltip:e,delayDuration:n=gP,skipDelayDuration:r=300,disableHoverableContent:s=!1,children:a}=t,[o,i]=G.useState(!0),u=G.useRef(!1),c=G.useRef(0);return G.useEffect(()=>{const l=c.current;return()=>window.clearTimeout(l)},[]),Ee.jsx(yP,{scope:e,isOpenDelayed:o,delayDuration:n,onOpen:G.useCallback(()=>{window.clearTimeout(c.current),i(!1)},[]),onClose:G.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>i(!0),r)},[r]),isPointerInTransitRef:u,onPointerInTransitChange:G.useCallback(l=>{u.current=l},[]),disableHoverableContent:s,children:a})};V2.displayName=M2;var z2="Tooltip",[Pie,Cf]=Sf(z2),Hg="TooltipTrigger",xP=G.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,s=Cf(Hg,n),a=B2(Hg,n),o=W0(n),i=G.useRef(null),u=ni(e,i,s.onTriggerChange),c=G.useRef(!1),l=G.useRef(!1),d=G.useCallback(()=>c.current=!1,[]);return G.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),Ee.jsx(fP,{asChild:!0,...o,children:Ee.jsx(si.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...r,ref:u,onPointerMove:Bs(t.onPointerMove,p=>{p.pointerType!=="touch"&&!l.current&&!a.isPointerInTransitRef.current&&(s.onTriggerEnter(),l.current=!0)}),onPointerLeave:Bs(t.onPointerLeave,()=>{s.onTriggerLeave(),l.current=!1}),onPointerDown:Bs(t.onPointerDown,()=>{c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:Bs(t.onFocus,()=>{c.current||s.onOpen()}),onBlur:Bs(t.onBlur,s.onClose),onClick:Bs(t.onClick,s.onClose)})})});xP.displayName=Hg;var vP="TooltipPortal",[Fie,wP]=Sf(vP,{forceMount:void 0}),yu="TooltipContent",bP=G.forwardRef((t,e)=>{const n=wP(yu,t.__scopeTooltip),{forceMount:r=n.forceMount,side:s="top",...a}=t,o=Cf(yu,t.__scopeTooltip);return Ee.jsx(f2,{present:r||o.open,children:o.disableHoverableContent?Ee.jsx(W2,{side:s,...a,ref:e}):Ee.jsx(SP,{side:s,...a,ref:e})})}),SP=G.forwardRef((t,e)=>{const n=Cf(yu,t.__scopeTooltip),r=B2(yu,t.__scopeTooltip),s=G.useRef(null),a=ni(e,s),[o,i]=G.useState(null),{trigger:u,onClose:c}=n,l=s.current,{onPointerInTransitChange:d}=r,p=G.useCallback(()=>{i(null),d(!1)},[d]),f=G.useCallback((h,y)=>{const x=h.currentTarget,g={x:h.clientX,y:h.clientY},v=_P(g,x.getBoundingClientRect()),w=NP(g,v),S=kP(y.getBoundingClientRect()),$=TP([...w,...S]);i($),d(!0)},[d]);return G.useEffect(()=>()=>p(),[p]),G.useEffect(()=>{if(u&&l){const h=x=>f(x,l),y=x=>f(x,u);return u.addEventListener("pointerleave",h),l.addEventListener("pointerleave",y),()=>{u.removeEventListener("pointerleave",h),l.removeEventListener("pointerleave",y)}}},[u,l,f,p]),G.useEffect(()=>{if(o){const h=y=>{const x=y.target,g={x:y.clientX,y:y.clientY},v=(u==null?void 0:u.contains(x))||(l==null?void 0:l.contains(x)),w=!EP(g,o);v?p():w&&(p(),c())};return document.addEventListener("pointermove",h),()=>document.removeEventListener("pointermove",h)}},[u,l,o,c,p]),Ee.jsx(W2,{...t,ref:a})}),[CP,IP]=Sf(z2,{isInside:!1}),W2=G.forwardRef((t,e)=>{const{__scopeTooltip:n,children:r,"aria-label":s,onEscapeKeyDown:a,onPointerDownOutside:o,...i}=t,u=Cf(yu,n),c=W0(n),{onClose:l}=u;return G.useEffect(()=>(document.addEventListener(gb,l),()=>document.removeEventListener(gb,l)),[l]),G.useEffect(()=>{if(u.trigger){const d=p=>{const f=p.target;f!=null&&f.contains(u.trigger)&&l()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[u.trigger,l]),Ee.jsx(d2,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:a,onPointerDownOutside:o,onFocusOutside:d=>d.preventDefault(),onDismiss:l,children:Ee.jsxs(hP,{"data-state":u.stateAttribute,...c,...i,ref:e,style:{...i.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[Ee.jsx(o2,{children:r}),Ee.jsx(CP,{scope:n,isInside:!0,children:Ee.jsx(kO,{id:u.contentId,role:"tooltip",children:s||r})})]})})});bP.displayName=yu;var U2="TooltipArrow",$P=G.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,s=W0(n);return IP(U2,n).isInside?null:Ee.jsx(mP,{...s,...r,ref:e})});$P.displayName=U2;function _P(t,e){const n=Math.abs(e.top-t.y),r=Math.abs(e.bottom-t.y),s=Math.abs(e.right-t.x),a=Math.abs(e.left-t.x);switch(Math.min(n,r,s,a)){case a:return"left";case s:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function NP(t,e,n=5){const r=[];switch(e){case"top":r.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":r.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":r.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":r.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return r}function kP(t){const{top:e,right:n,bottom:r,left:s}=t;return[{x:s,y:e},{x:n,y:e},{x:n,y:r},{x:s,y:r}]}function EP(t,e){const{x:n,y:r}=t;let s=!1;for(let a=0,o=e.length-1;a<e.length;o=a++){const i=e[a].x,u=e[a].y,c=e[o].x,l=e[o].y;u>r!=l>r&&n<(c-i)*(r-u)/(l-u)+i&&(s=!s)}return s}function TP(t){const e=t.slice();return e.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),RP(e)}function RP(t){if(t.length<=1)return t.slice();const e=[];for(let r=0;r<t.length;r++){const s=t[r];for(;e.length>=2;){const a=e[e.length-1],o=e[e.length-2];if((a.x-o.x)*(s.y-o.y)>=(a.y-o.y)*(s.x-o.x))e.pop();else break}e.push(s)}e.pop();const n=[];for(let r=t.length-1;r>=0;r--){const s=t[r];for(;n.length>=2;){const a=n[n.length-1],o=n[n.length-2];if((a.x-o.x)*(s.y-o.y)>=(a.y-o.y)*(s.x-o.x))n.pop();else break}n.push(s)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var AP=V2,OP=G.createContext(void 0),DP=t=>{const{dir:e,children:n}=t;return Ee.jsx(OP.Provider,{value:e,children:n})};function PP(t){switch(t){case"tomato":case"red":case"ruby":case"crimson":case"pink":case"plum":case"purple":case"violet":return"mauve";case"iris":case"indigo":case"blue":case"sky":case"cyan":return"slate";case"teal":case"jade":case"mint":case"green":return"sage";case"grass":case"lime":return"olive";case"yellow":case"amber":case"orange":case"brown":case"gold":case"bronze":return"sand";case"gray":return"gray"}}const FP=["none","small","medium","large","full"],LP=["inherit","light","dark"],MP=["solid","translucent"],BP=["90%","95%","100%","105%","110%"],rr={...Ec,hasBackground:{type:"boolean",default:!0},appearance:{type:"enum",values:LP,default:"inherit"},accentColor:{type:"enum",values:h2,default:"indigo"},grayColor:{type:"enum",values:GO,default:"auto"},panelBackground:{type:"enum",values:MP,default:"translucent"},radius:{type:"enum",values:FP,default:"medium"},scaling:{type:"enum",values:BP,default:"100%"}},Oi=()=>{},jg=G.createContext(void 0),G2=G.forwardRef((t,e)=>G.useContext(jg)===void 0?G.createElement(AP,{delayDuration:200},G.createElement(DP,{dir:"ltr"},G.createElement(H2,{...t,ref:e}))):G.createElement(U0,{...t,ref:e}));G2.displayName="Theme";const H2=G.forwardRef((t,e)=>{const{appearance:n=rr.appearance.default,accentColor:r=rr.accentColor.default,grayColor:s=rr.grayColor.default,panelBackground:a=rr.panelBackground.default,radius:o=rr.radius.default,scaling:i=rr.scaling.default,hasBackground:u=rr.hasBackground.default,...c}=t,[l,d]=G.useState(n);G.useEffect(()=>d(n),[n]);const[p,f]=G.useState(r);G.useEffect(()=>f(r),[r]);const[h,y]=G.useState(s);G.useEffect(()=>y(s),[s]);const[x,g]=G.useState(a);G.useEffect(()=>g(a),[a]);const[v,w]=G.useState(o);G.useEffect(()=>w(o),[o]);const[S,$]=G.useState(i);return G.useEffect(()=>$(i),[i]),G.createElement(U0,{...c,ref:e,isRoot:!0,hasBackground:u,appearance:l,accentColor:p,grayColor:h,panelBackground:x,radius:v,scaling:S,onAppearanceChange:d,onAccentColorChange:f,onGrayColorChange:y,onPanelBackgroundChange:g,onRadiusChange:w,onScalingChange:$})});H2.displayName="ThemeRoot";const U0=G.forwardRef((t,e)=>{const n=G.useContext(jg),{asChild:r,isRoot:s,hasBackground:a,appearance:o=(n==null?void 0:n.appearance)??rr.appearance.default,accentColor:i=(n==null?void 0:n.accentColor)??rr.accentColor.default,grayColor:u=(n==null?void 0:n.resolvedGrayColor)??rr.grayColor.default,panelBackground:c=(n==null?void 0:n.panelBackground)??rr.panelBackground.default,radius:l=(n==null?void 0:n.radius)??rr.radius.default,scaling:d=(n==null?void 0:n.scaling)??rr.scaling.default,onAppearanceChange:p=Oi,onAccentColorChange:f=Oi,onGrayColorChange:h=Oi,onPanelBackgroundChange:y=Oi,onRadiusChange:x=Oi,onScalingChange:g=Oi,...v}=t,w=r?ri:"div",S=u==="auto"?PP(i):u,$=t.appearance==="light"||t.appearance==="dark",k=a===void 0?s||$:a;return G.createElement(jg.Provider,{value:G.useMemo(()=>({appearance:o,accentColor:i,grayColor:u,resolvedGrayColor:S,panelBackground:c,radius:l,scaling:d,onAppearanceChange:p,onAccentColorChange:f,onGrayColorChange:h,onPanelBackgroundChange:y,onRadiusChange:x,onScalingChange:g}),[o,i,u,S,c,l,d,p,f,h,y,x,g])},G.createElement(w,{"data-is-root-theme":s?"true":"false","data-accent-color":i,"data-gray-color":S,"data-has-background":k?"true":"false","data-panel-background":c,"data-radius":l,"data-scaling":d,ref:e,...v,className:Hs("radix-themes",{light:o==="light",dark:o==="dark"},v.className)}))});U0.displayName="ThemeImpl";const VP=["div","span"],zP=["none","inline","inline-block","block"],WP={as:{type:"enum",values:VP,default:"div"},...Ec,display:{type:"enum",className:"rt-r-display",values:zP,responsive:!0}},mo=["0","1","2","3","4","5","6","7","8","9"],UP={p:{type:"enum | string",className:"rt-r-p",customProperties:["--p"],values:mo,responsive:!0},px:{type:"enum | string",className:"rt-r-px",customProperties:["--pl","--pr"],values:mo,responsive:!0},py:{type:"enum | string",className:"rt-r-py",customProperties:["--pt","--pb"],values:mo,responsive:!0},pt:{type:"enum | string",className:"rt-r-pt",customProperties:["--pt"],values:mo,responsive:!0},pr:{type:"enum | string",className:"rt-r-pr",customProperties:["--pr"],values:mo,responsive:!0},pb:{type:"enum | string",className:"rt-r-pb",customProperties:["--pb"],values:mo,responsive:!0},pl:{type:"enum | string",className:"rt-r-pl",customProperties:["--pl"],values:mo,responsive:!0}},_m=["visible","hidden","clip","scroll","auto"],GP=["static","relative","absolute","fixed","sticky"],dl=["0","1","2","3","4","5","6","7","8","9","-1","-2","-3","-4","-5","-6","-7","-8","-9"],HP=["0","1"],jP=["0","1"],G0={...UP,...WO,...UO,position:{type:"enum",className:"rt-r-position",values:GP,responsive:!0},inset:{type:"enum | string",className:"rt-r-inset",customProperties:["--inset"],values:dl,responsive:!0},top:{type:"enum | string",className:"rt-r-top",customProperties:["--top"],values:dl,responsive:!0},right:{type:"enum | string",className:"rt-r-right",customProperties:["--right"],values:dl,responsive:!0},bottom:{type:"enum | string",className:"rt-r-bottom",customProperties:["--bottom"],values:dl,responsive:!0},left:{type:"enum | string",className:"rt-r-left",customProperties:["--left"],values:dl,responsive:!0},overflow:{type:"enum",className:"rt-r-overflow",values:_m,responsive:!0},overflowX:{type:"enum",className:"rt-r-ox",values:_m,responsive:!0},overflowY:{type:"enum",className:"rt-r-oy",values:_m,responsive:!0},flexBasis:{type:"string",className:"rt-r-fb",customProperties:["--flex-basis"],responsive:!0},flexShrink:{type:"enum | string",className:"rt-r-fs",customProperties:["--flex-shrink"],values:HP,responsive:!0},flexGrow:{type:"enum | string",className:"rt-r-fg",customProperties:["--flex-grow"],values:jP,responsive:!0},gridColumn:{type:"string",className:"rt-r-gc",customProperties:["--grid-column"],responsive:!0},gridColumnStart:{type:"string",className:"rt-r-gcs",customProperties:["--grid-column-start"],responsive:!0},gridColumnEnd:{type:"string",className:"rt-r-gce",customProperties:["--grid-column-end"],responsive:!0},gridRow:{type:"string",className:"rt-r-gr",customProperties:["--grid-row"],responsive:!0},gridRowStart:{type:"string",className:"rt-r-grs",customProperties:["--grid-row-start"],responsive:!0},gridRowEnd:{type:"string",className:"rt-r-gre",customProperties:["--grid-row-end"],responsive:!0}},j2=G.forwardRef((t,e)=>{const{className:n,asChild:r,as:s="div",...a}=xf(t,WP,G0,vf);return G.createElement(r?ri:s,{...a,ref:e,className:Hs("rt-Box",n)})});j2.displayName="Box";const Nm=["0","1","2","3","4","5","6","7","8","9"],K2={gap:{type:"enum | string",className:"rt-r-gap",customProperties:["--gap"],values:Nm,responsive:!0},gapX:{type:"enum | string",className:"rt-r-cg",customProperties:["--column-gap"],values:Nm,responsive:!0},gapY:{type:"enum | string",className:"rt-r-rg",customProperties:["--row-gap"],values:Nm,responsive:!0}},KP=["div","span"],qP=["none","inline-flex","flex"],XP=["row","column","row-reverse","column-reverse"],YP=["start","center","end","baseline","stretch"],QP=["start","center","end","between"],ZP=["nowrap","wrap","wrap-reverse"],JP={as:{type:"enum",values:KP,default:"div"},...Ec,display:{type:"enum",className:"rt-r-display",values:qP,responsive:!0},direction:{type:"enum",className:"rt-r-fd",values:XP,responsive:!0},align:{type:"enum",className:"rt-r-ai",values:YP,responsive:!0},justify:{type:"enum",className:"rt-r-jc",values:QP,parseValue:eF,responsive:!0},wrap:{type:"enum",className:"rt-r-fw",values:ZP,responsive:!0},...K2};function eF(t){return t==="between"?"space-between":t}const q2=G.forwardRef((t,e)=>{const{className:n,asChild:r,as:s="div",...a}=xf(t,JP,G0,vf);return G.createElement(r?ri:s,{...a,ref:e,className:Hs("rt-Flex",n)})});q2.displayName="Flex";const tF=["div","span"],nF=["none","inline-grid","grid"],rF=["1","2","3","4","5","6","7","8","9"],sF=["1","2","3","4","5","6","7","8","9"],aF=["row","column","dense","row-dense","column-dense"],oF=["start","center","end","baseline","stretch"],iF=["start","center","end","between"],X2={as:{type:"enum",values:tF,default:"div"},...Ec,display:{type:"enum",className:"rt-r-display",values:nF,responsive:!0},columns:{type:"enum | string",className:"rt-r-gtc",customProperties:["--grid-template-columns"],values:rF,parseValue:yb,responsive:!0},rows:{type:"enum | string",className:"rt-r-gtr",customProperties:["--grid-template-rows"],values:sF,parseValue:yb,responsive:!0},flow:{type:"enum",className:"rt-r-gaf",values:aF,responsive:!0},align:{type:"enum",className:"rt-r-ai",values:oF,responsive:!0},justify:{type:"enum",className:"rt-r-jc",values:iF,parseValue:uF,responsive:!0},...K2};function yb(t){return X2.columns.values.includes(t)?t:t!=null&&t.match(/^\d+$/)?`repeat(${t}, minmax(0, 1fr))`:t}function uF(t){return t==="between"?"space-between":t}const Y2=G.forwardRef((t,e)=>{const{className:n,asChild:r,as:s="div",...a}=xf(t,X2,G0,vf);return G.createElement(r?ri:s,{...a,ref:e,className:Hs("rt-Grid",n)})});Y2.displayName="Grid";function _d({color:t}){const[e,n]=G.useState(!1);return Ee.jsx(j2,{is:"vgesturable",vgesturable:"true",as:"button",onClick:()=>{n(r=>!r)},width:"100%",height:"100%",style:{backgroundColor:t},class:e?"transition box clicked":"transition box",children:Ee.jsx(q2,{width:"100%",height:"100%",align:"center",justify:"center",children:Ee.jsx(y2,{weight:"bold",style:{color:"white"},className:e?"transition clicked-t":"transition ",children:e?"You've Just Clicked!!!":"Click Me!"})})})}function H0(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(r){if(r!=="default"&&!(r in t)){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}})}),Object.freeze(t)}var qn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Rc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function lF(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}(function(){var t;function e(m){var b=0;return function(){return b<m.length?{done:!1,value:m[b++]}:{done:!0}}}var n=typeof Object.defineProperties=="function"?Object.defineProperty:function(m,b,I){return m==Array.prototype||m==Object.prototype||(m[b]=I.value),m};function r(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof qn=="object"&&qn];for(var b=0;b<m.length;++b){var I=m[b];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var s=r(this);function a(m,b){if(b)e:{var I=s;m=m.split(".");for(var _=0;_<m.length-1;_++){var R=m[_];if(!(R in I))break e;I=I[R]}m=m[m.length-1],_=I[m],b=b(_),b!=_&&b!=null&&n(I,m,{configurable:!0,writable:!0,value:b})}}a("Symbol",function(m){function b(P){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new I(_+(P||"")+"_"+R++,P)}function I(P,O){this.h=P,n(this,"description",{configurable:!0,writable:!0,value:O})}if(m)return m;I.prototype.toString=function(){return this.h};var _="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",R=0;return b}),a("Symbol.iterator",function(m){if(m)return m;m=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),I=0;I<b.length;I++){var _=s[b[I]];typeof _=="function"&&typeof _.prototype[m]!="function"&&n(_.prototype,m,{configurable:!0,writable:!0,value:function(){return o(e(this))}})}return m});function o(m){return m={next:m},m[Symbol.iterator]=function(){return this},m}function i(m){var b=typeof Symbol<"u"&&Symbol.iterator&&m[Symbol.iterator];return b?b.call(m):{next:e(m)}}function u(m){if(!(m instanceof Array)){m=i(m);for(var b,I=[];!(b=m.next()).done;)I.push(b.value);m=I}return m}var c=typeof Object.assign=="function"?Object.assign:function(m,b){for(var I=1;I<arguments.length;I++){var _=arguments[I];if(_)for(var R in _)Object.prototype.hasOwnProperty.call(_,R)&&(m[R]=_[R])}return m};a("Object.assign",function(m){return m||c});var l=typeof Object.create=="function"?Object.create:function(m){function b(){}return b.prototype=m,new b},d;if(typeof Object.setPrototypeOf=="function")d=Object.setPrototypeOf;else{var p;e:{var f={a:!0},h={};try{h.__proto__=f,p=h.a;break e}catch{}p=!1}d=p?function(m,b){if(m.__proto__=b,m.__proto__!==b)throw new TypeError(m+" is not extensible");return m}:null}var y=d;function x(m,b){if(m.prototype=l(b.prototype),m.prototype.constructor=m,y)y(m,b);else for(var I in b)if(I!="prototype")if(Object.defineProperties){var _=Object.getOwnPropertyDescriptor(b,I);_&&Object.defineProperty(m,I,_)}else m[I]=b[I];m.ya=b.prototype}function g(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function v(m){if(m.m)throw new TypeError("Generator is already running");m.m=!0}g.prototype.u=function(m){this.i=m};function w(m,b){m.l={ma:b,na:!0},m.h=m.s||m.v}g.prototype.return=function(m){this.l={return:m},this.h=this.v};function S(m,b,I){return m.h=I,{value:b}}function $(m){this.h=new g,this.i=m}function k(m,b){v(m.h);var I=m.h.j;return I?T(m,"return"in I?I.return:function(_){return{value:_,done:!0}},b,m.h.return):(m.h.return(b),A(m))}function T(m,b,I,_){try{var R=b.call(m.h.j,I);if(!(R instanceof Object))throw new TypeError("Iterator result "+R+" is not an object");if(!R.done)return m.h.m=!1,R;var P=R.value}catch(O){return m.h.j=null,w(m.h,O),A(m)}return m.h.j=null,_.call(m.h,P),A(m)}function A(m){for(;m.h.h;)try{var b=m.i(m.h);if(b)return m.h.m=!1,{value:b.value,done:!1}}catch(I){m.h.i=void 0,w(m.h,I)}if(m.h.m=!1,m.h.l){if(b=m.h.l,m.h.l=null,b.na)throw b.ma;return{value:b.return,done:!0}}return{value:void 0,done:!0}}function B(m){this.next=function(b){return v(m.h),m.h.j?b=T(m,m.h.j.next,b,m.h.u):(m.h.u(b),b=A(m)),b},this.throw=function(b){return v(m.h),m.h.j?b=T(m,m.h.j.throw,b,m.h.u):(w(m.h,b),b=A(m)),b},this.return=function(b){return k(m,b)},this[Symbol.iterator]=function(){return this}}function L(m){function b(_){return m.next(_)}function I(_){return m.throw(_)}return new Promise(function(_,R){function P(O){O.done?_(O.value):Promise.resolve(O.value).then(b,I).then(P,R)}P(m.next())})}function z(m){return L(new B(new $(m)))}a("Promise",function(m){function b(O){this.i=0,this.j=void 0,this.h=[],this.u=!1;var V=this.l();try{O(V.resolve,V.reject)}catch(H){V.reject(H)}}function I(){this.h=null}function _(O){return O instanceof b?O:new b(function(V){V(O)})}if(m)return m;I.prototype.i=function(O){if(this.h==null){this.h=[];var V=this;this.j(function(){V.m()})}this.h.push(O)};var R=s.setTimeout;I.prototype.j=function(O){R(O,0)},I.prototype.m=function(){for(;this.h&&this.h.length;){var O=this.h;this.h=[];for(var V=0;V<O.length;++V){var H=O[V];O[V]=null;try{H()}catch(J){this.l(J)}}}this.h=null},I.prototype.l=function(O){this.j(function(){throw O})},b.prototype.l=function(){function O(J){return function(ue){H||(H=!0,J.call(V,ue))}}var V=this,H=!1;return{resolve:O(this.I),reject:O(this.m)}},b.prototype.I=function(O){if(O===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(O instanceof b)this.L(O);else{e:switch(typeof O){case"object":var V=O!=null;break e;case"function":V=!0;break e;default:V=!1}V?this.F(O):this.s(O)}},b.prototype.F=function(O){var V=void 0;try{V=O.then}catch(H){this.m(H);return}typeof V=="function"?this.M(V,O):this.s(O)},b.prototype.m=function(O){this.v(2,O)},b.prototype.s=function(O){this.v(1,O)},b.prototype.v=function(O,V){if(this.i!=0)throw Error("Cannot settle("+O+", "+V+"): Promise already settled in state"+this.i);this.i=O,this.j=V,this.i===2&&this.K(),this.H()},b.prototype.K=function(){var O=this;R(function(){if(O.D()){var V=s.console;typeof V<"u"&&V.error(O.j)}},1)},b.prototype.D=function(){if(this.u)return!1;var O=s.CustomEvent,V=s.Event,H=s.dispatchEvent;return typeof H>"u"?!0:(typeof O=="function"?O=new O("unhandledrejection",{cancelable:!0}):typeof V=="function"?O=new V("unhandledrejection",{cancelable:!0}):(O=s.document.createEvent("CustomEvent"),O.initCustomEvent("unhandledrejection",!1,!0,O)),O.promise=this,O.reason=this.j,H(O))},b.prototype.H=function(){if(this.h!=null){for(var O=0;O<this.h.length;++O)P.i(this.h[O]);this.h=null}};var P=new I;return b.prototype.L=function(O){var V=this.l();O.T(V.resolve,V.reject)},b.prototype.M=function(O,V){var H=this.l();try{O.call(V,H.resolve,H.reject)}catch(J){H.reject(J)}},b.prototype.then=function(O,V){function H(we,he){return typeof we=="function"?function(Ne){try{J(we(Ne))}catch(Oe){ue(Oe)}}:he}var J,ue,_e=new b(function(we,he){J=we,ue=he});return this.T(H(O,J),H(V,ue)),_e},b.prototype.catch=function(O){return this.then(void 0,O)},b.prototype.T=function(O,V){function H(){switch(J.i){case 1:O(J.j);break;case 2:V(J.j);break;default:throw Error("Unexpected state: "+J.i)}}var J=this;this.h==null?P.i(H):this.h.push(H),this.u=!0},b.resolve=_,b.reject=function(O){return new b(function(V,H){H(O)})},b.race=function(O){return new b(function(V,H){for(var J=i(O),ue=J.next();!ue.done;ue=J.next())_(ue.value).T(V,H)})},b.all=function(O){var V=i(O),H=V.next();return H.done?_([]):new b(function(J,ue){function _e(Ne){return function(Oe){we[Ne]=Oe,he--,he==0&&J(we)}}var we=[],he=0;do we.push(void 0),he++,_(H.value).T(_e(we.length-1),ue),H=V.next();while(!H.done)})},b});function Y(m,b){m instanceof String&&(m+="");var I=0,_=!1,R={next:function(){if(!_&&I<m.length){var P=I++;return{value:b(P,m[P]),done:!1}}return _=!0,{done:!0,value:void 0}}};return R[Symbol.iterator]=function(){return R},R}a("Array.prototype.keys",function(m){return m||function(){return Y(this,function(b){return b})}}),a("Array.prototype.fill",function(m){return m||function(b,I,_){var R=this.length||0;for(0>I&&(I=Math.max(0,R+I)),(_==null||_>R)&&(_=R),_=Number(_),0>_&&(_=Math.max(0,R+_)),I=Number(I||0);I<_;I++)this[I]=b;return this}});function Q(m){return m||Array.prototype.fill}a("Int8Array.prototype.fill",Q),a("Uint8Array.prototype.fill",Q),a("Uint8ClampedArray.prototype.fill",Q),a("Int16Array.prototype.fill",Q),a("Uint16Array.prototype.fill",Q),a("Int32Array.prototype.fill",Q),a("Uint32Array.prototype.fill",Q),a("Float32Array.prototype.fill",Q),a("Float64Array.prototype.fill",Q),a("Object.is",function(m){return m||function(b,I){return b===I?b!==0||1/b===1/I:b!==b&&I!==I}}),a("Array.prototype.includes",function(m){return m||function(b,I){var _=this;_ instanceof String&&(_=String(_));var R=_.length;for(I=I||0,0>I&&(I=Math.max(I+R,0));I<R;I++){var P=_[I];if(P===b||Object.is(P,b))return!0}return!1}}),a("String.prototype.includes",function(m){return m||function(b,I){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(b,I||0)!==-1}});var re=this||self;function Z(m,b){m=m.split(".");var I=re;m[0]in I||typeof I.execScript>"u"||I.execScript("var "+m[0]);for(var _;m.length&&(_=m.shift());)m.length||b===void 0?I[_]&&I[_]!==Object.prototype[_]?I=I[_]:I=I[_]={}:I[_]=b}function de(m){var b;e:{if((b=re.navigator)&&(b=b.userAgent))break e;b=""}return b.indexOf(m)!=-1}var ce=Array.prototype.map?function(m,b){return Array.prototype.map.call(m,b,void 0)}:function(m,b){for(var I=m.length,_=Array(I),R=typeof m=="string"?m.split(""):m,P=0;P<I;P++)P in R&&(_[P]=b.call(void 0,R[P],P,m));return _},j={},ee=null;function me(m){var b=m.length,I=3*b/4;I%3?I=Math.floor(I):"=.".indexOf(m[b-1])!=-1&&(I="=.".indexOf(m[b-2])!=-1?I-2:I-1);var _=new Uint8Array(I),R=0;return Ie(m,function(P){_[R++]=P}),R!==I?_.subarray(0,R):_}function Ie(m,b){function I(H){for(;_<m.length;){var J=m.charAt(_++),ue=ee[J];if(ue!=null)return ue;if(!/^[\s\xa0]*$/.test(J))throw Error("Unknown base64 encoding at char: "+J)}return H}Pe();for(var _=0;;){var R=I(-1),P=I(0),O=I(64),V=I(64);if(V===64&&R===-1)break;b(R<<2|P>>4),O!=64&&(b(P<<4&240|O>>2),V!=64&&b(O<<6&192|V))}}function Pe(){if(!ee){ee={};for(var m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),b=["+/=","+/","-_=","-_.","-_"],I=0;5>I;I++){var _=m.concat(b[I].split(""));j[I]=_;for(var R=0;R<_.length;R++){var P=_[R];ee[P]===void 0&&(ee[P]=R)}}}}var Ge=typeof Uint8Array<"u",_t=!(de("Trident")||de("MSIE"))&&typeof re.btoa=="function";function Pt(m){if(!_t){var b;b===void 0&&(b=0),Pe(),b=j[b];for(var I=Array(Math.floor(m.length/3)),_=b[64]||"",R=0,P=0;R<m.length-2;R+=3){var O=m[R],V=m[R+1],H=m[R+2],J=b[O>>2];O=b[(O&3)<<4|V>>4],V=b[(V&15)<<2|H>>6],H=b[H&63],I[P++]=J+O+V+H}switch(J=0,H=_,m.length-R){case 2:J=m[R+1],H=b[(J&15)<<2]||_;case 1:m=m[R],I[P]=b[m>>2]+b[(m&3)<<4|J>>4]+H+_}return I.join("")}for(b="";10240<m.length;)b+=String.fromCharCode.apply(null,m.subarray(0,10240)),m=m.subarray(10240);return b+=String.fromCharCode.apply(null,m),btoa(b)}var Nt=RegExp("[-_.]","g");function wn(m){switch(m){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function rt(m){if(!_t)return me(m);Nt.test(m)&&(m=m.replace(Nt,wn)),m=atob(m);for(var b=new Uint8Array(m.length),I=0;I<m.length;I++)b[I]=m.charCodeAt(I);return b}var Dn;function zr(){return Dn||(Dn=new Uint8Array(0))}var Zn={},mr=typeof Uint8Array.prototype.slice=="function",Xe=0,Qe=0;function gr(m){var b=0>m;m=Math.abs(m);var I=m>>>0;m=Math.floor((m-I)/4294967296),b&&(I=i(ps(I,m)),b=I.next().value,m=I.next().value,I=b),Xe=I>>>0,Qe=m>>>0}var kt=typeof BigInt=="function";function ps(m,b){return b=~b,m?m=~m+1:b+=1,[m,b]}function Rs(m,b){this.i=m>>>0,this.h=b>>>0}function yr(m){if(!m)return As||(As=new Rs(0,0));if(!/^-?\d+$/.test(m))return null;if(16>m.length)gr(Number(m));else if(kt)m=BigInt(m),Xe=Number(m&BigInt(4294967295))>>>0,Qe=Number(m>>BigInt(32)&BigInt(4294967295));else{var b=+(m[0]==="-");Qe=Xe=0;for(var I=m.length,_=b,R=(I-b)%6+b;R<=I;_=R,R+=6)_=Number(m.slice(_,R)),Qe*=1e6,Xe=1e6*Xe+_,4294967296<=Xe&&(Qe+=Xe/4294967296|0,Xe%=4294967296);b&&(b=i(ps(Xe,Qe)),m=b.next().value,b=b.next().value,Xe=m,Qe=b)}return new Rs(Xe,Qe)}var As;function la(m,b){return Error("Invalid wire type: "+m+" (at position "+b+")")}function ca(){return Error("Failed to read varint, encoding is invalid.")}function ao(m,b){return Error("Tried to read past the end of the data "+b+" > "+m)}function Wr(){throw Error("Invalid UTF8")}function hi(m,b){return b=String.fromCharCode.apply(null,b),m==null?b:m+b}var da=void 0,Jn,Os=typeof TextDecoder<"u",mi,Gu=typeof TextEncoder<"u",fs;function gi(m){if(m!==Zn)throw Error("illegal external caller")}function Ur(m,b){if(gi(b),this.V=m,m!=null&&m.length===0)throw Error("ByteString should be constructed with non-empty values")}function hs(){return fs||(fs=new Ur(null,Zn))}function Ft(m){gi(Zn);var b=m.V;return b=b==null||Ge&&b!=null&&b instanceof Uint8Array?b:typeof b=="string"?rt(b):null,b==null?b:m.V=b}function yi(m){if(typeof m=="string")return{buffer:rt(m),C:!1};if(Array.isArray(m))return{buffer:new Uint8Array(m),C:!1};if(m.constructor===Uint8Array)return{buffer:m,C:!1};if(m.constructor===ArrayBuffer)return{buffer:new Uint8Array(m),C:!1};if(m.constructor===Ur)return{buffer:Ft(m)||zr(),C:!0};if(m instanceof Uint8Array)return{buffer:new Uint8Array(m.buffer,m.byteOffset,m.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function oo(m,b){this.i=null,this.m=!1,this.h=this.j=this.l=0,pa(this,m,b)}function pa(m,b,I){I=I===void 0?{}:I,m.S=I.S===void 0?!1:I.S,b&&(b=yi(b),m.i=b.buffer,m.m=b.C,m.l=0,m.j=m.i.length,m.h=m.l)}oo.prototype.reset=function(){this.h=this.l};function xr(m,b){if(m.h=b,b>m.j)throw ao(m.j,b)}function bn(m){var b=m.i,I=m.h,_=b[I++],R=_&127;if(_&128&&(_=b[I++],R|=(_&127)<<7,_&128&&(_=b[I++],R|=(_&127)<<14,_&128&&(_=b[I++],R|=(_&127)<<21,_&128&&(_=b[I++],R|=_<<28,_&128&&b[I++]&128&&b[I++]&128&&b[I++]&128&&b[I++]&128&&b[I++]&128)))))throw ca();return xr(m,I),R}function Ds(m,b){if(0>b)throw Error("Tried to read a negative byte length: "+b);var I=m.h,_=I+b;if(_>m.j)throw ao(b,m.j-I);return m.h=_,I}var io=[];function Gr(){this.h=[]}Gr.prototype.length=function(){return this.h.length},Gr.prototype.end=function(){var m=this.h;return this.h=[],m};function ms(m,b,I){for(;0<I||127<b;)m.h.push(b&127|128),b=(b>>>7|I<<25)>>>0,I>>>=7;m.h.push(b)}function vr(m,b){for(;127<b;)m.h.push(b&127|128),b>>>=7;m.h.push(b)}function q(m,b){if(io.length){var I=io.pop();pa(I,m,b),m=I}else m=new oo(m,b);this.h=m,this.j=this.h.h,this.i=this.l=-1,this.setOptions(b)}q.prototype.setOptions=function(m){m=m===void 0?{}:m,this.ca=m.ca===void 0?!1:m.ca},q.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function te(m){var b=m.h;if(b.h==b.j)return!1;m.j=m.h.h;var I=bn(m.h)>>>0;if(b=I>>>3,I&=7,!(0<=I&&5>=I))throw la(I,m.j);if(1>b)throw Error("Invalid field number: "+b+" (at position "+m.j+")");return m.l=b,m.i=I,!0}function ve(m){switch(m.i){case 0:if(m.i!=0)ve(m);else e:{m=m.h;for(var b=m.h,I=b+10,_=m.i;b<I;)if(!(_[b++]&128)){xr(m,b);break e}throw ca()}break;case 1:m=m.h,xr(m,m.h+8);break;case 2:m.i!=2?ve(m):(b=bn(m.h)>>>0,m=m.h,xr(m,m.h+b));break;case 5:m=m.h,xr(m,m.h+4);break;case 3:b=m.l;do{if(!te(m))throw Error("Unmatched start-group tag: stream EOF");if(m.i==4){if(m.l!=b)throw Error("Unmatched end-group tag");break}ve(m)}while(!0);break;default:throw la(m.i,m.j)}}var oe=[];function Ze(){this.j=[],this.i=0,this.h=new Gr}function je(m,b){b.length!==0&&(m.j.push(b),m.i+=b.length)}function Te(m,b){if(b=b.R){je(m,m.h.end());for(var I=0;I<b.length;I++)je(m,Ft(b[I])||zr())}}var Se=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function Je(m,b){return Se?m[Se]|=b:m.A!==void 0?m.A|=b:(Object.defineProperties(m,{A:{value:b,configurable:!0,writable:!0,enumerable:!1}}),b)}function un(m,b){Se?m[Se]&&(m[Se]&=~b):m.A!==void 0&&(m.A&=~b)}function qe(m){var b;return Se?b=m[Se]:b=m.A,b??0}function Sn(m,b){Se?m[Se]=b:m.A!==void 0?m.A=b:Object.defineProperties(m,{A:{value:b,configurable:!0,writable:!0,enumerable:!1}})}function Ps(m){return Je(m,1),m}function xi(m,b){Sn(b,(m|0)&-51)}function It(m,b){Sn(b,(m|18)&-41)}var wr={};function Fs(m){return m!==null&&typeof m=="object"&&!Array.isArray(m)&&m.constructor===Object}var uo,vi=[];Sn(vi,23),uo=Object.freeze(vi);function Hu(m){if(qe(m.o)&2)throw Error("Cannot mutate an immutable Message")}function ju(m){var b=m.length;(b=b?m[b-1]:void 0)&&Fs(b)?b.g=1:(b={},m.push((b.g=1,b)))}function jc(m){var b=m.i+m.G;return m.B||(m.B=m.o[b]={})}function Zt(m,b){return b===-1?null:b>=m.i?m.B?m.B[b]:void 0:m.o[b+m.G]}function br(m,b,I,_){Hu(m),lo(m,b,I,_)}function lo(m,b,I,_){m.j&&(m.j=void 0),b>=m.i||_?jc(m)[b]=I:(m.o[b+m.G]=I,(m=m.B)&&b in m&&delete m[b])}function wi(m,b,I,_){var R=Zt(m,b);Array.isArray(R)||(R=uo);var P=qe(R);if(P&1||Ps(R),_)P&2||Je(R,2),I&1||Object.freeze(R);else{_=!(I&2);var O=P&2;I&1||!O?_&&P&16&&!O&&un(R,16):(R=Ps(Array.prototype.slice.call(R)),lo(m,b,R))}return R}function Ku(m,b){var I=Zt(m,b),_=I==null?I:typeof I=="number"||I==="NaN"||I==="Infinity"||I==="-Infinity"?Number(I):void 0;return _!=null&&_!==I&&lo(m,b,_),_}function bi(m,b,I,_,R){m.h||(m.h={});var P=m.h[I],O=wi(m,I,3,R);if(!P){var V=O;P=[];var H=!!(qe(m.o)&16);O=!!(qe(V)&2);var J=V;!R&&O&&(V=Array.prototype.slice.call(V));for(var ue=O,_e=0;_e<V.length;_e++){var we=V[_e],he=b,Ne=!1;if(Ne=Ne===void 0?!1:Ne,we=Array.isArray(we)?new he(we):Ne?new he:void 0,we!==void 0){he=we.o;var Oe=Ne=qe(he);O&&(Oe|=2),H&&(Oe|=16),Oe!=Ne&&Sn(he,Oe),he=Oe,ue=ue||!!(2&he),P.push(we)}}return m.h[I]=P,H=qe(V),b=H|33,b=ue?b&-9:b|8,H!=b&&(ue=V,Object.isFrozen(ue)&&(ue=Array.prototype.slice.call(ue)),Sn(ue,b),V=ue),J!==V&&lo(m,I,V),(R||_&&O)&&Je(P,2),_&&Object.freeze(P),P}return R||(R=Object.isFrozen(P),_&&!R?Object.freeze(P):!_&&R&&(P=Array.prototype.slice.call(P),m.h[I]=P)),P}function Si(m,b,I){var _=!!(qe(m.o)&2);if(b=bi(m,b,I,_,_),m=wi(m,I,3,_),!(_||qe(m)&8)){for(_=0;_<b.length;_++){if(I=b[_],qe(I.o)&2){var R=Yu(I,!1);R.j=I}else R=I;I!==R&&(b[_]=R,m[_]=R.o)}Je(m,8)}return b}function Sr(m,b,I){if(I!=null&&typeof I!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof I+": "+I);br(m,b,I)}function Kc(m,b,I,_,R){Hu(m);var P=bi(m,I,b,!1,!1);return I=_??new I,m=wi(m,b,2,!1),R!=null?(P.splice(R,0,I),m.splice(R,0,I.o)):(P.push(I),m.push(I.o)),I.C()&&un(m,8),I}function Hr(m,b){return m??b}function Pn(m,b,I){return I=I===void 0?0:I,Hr(Ku(m,b),I)}var Ci;function Xh(m){switch(typeof m){case"number":return isFinite(m)?m:String(m);case"object":if(m)if(Array.isArray(m)){if(qe(m)&128)return m=Array.prototype.slice.call(m),ju(m),m}else{if(Ge&&m!=null&&m instanceof Uint8Array)return Pt(m);if(m instanceof Ur){var b=m.V;return b==null?"":typeof b=="string"?b:m.V=Pt(b)}}}return m}function qc(m,b,I,_){if(m!=null){if(Array.isArray(m))m=qu(m,b,I,_!==void 0);else if(Fs(m)){var R={},P;for(P in m)R[P]=qc(m[P],b,I,_);m=R}else m=b(m,_);return m}}function qu(m,b,I,_){var R=qe(m);_=_?!!(R&16):void 0,m=Array.prototype.slice.call(m);for(var P=0;P<m.length;P++)m[P]=qc(m[P],b,I,_);return I(R,m),m}function Xc(m){return m.ja===wr?m.toJSON():Xh(m)}function Yc(m,b){m&128&&ju(b)}function Qc(m,b,I){if(I=I===void 0?It:I,m!=null){if(Ge&&m instanceof Uint8Array)return m.length?new Ur(new Uint8Array(m),Zn):hs();if(Array.isArray(m)){var _=qe(m);return _&2?m:b&&!(_&32)&&(_&16||_===0)?(Sn(m,_|2),m):(m=qu(m,Qc,_&4?It:I,!0),b=qe(m),b&4&&b&2&&Object.freeze(m),m)}return m.ja===wr?Xu(m):m}}function Zc(m,b,I,_,R,P,O){if(m=m.h&&m.h[I]){if(_=qe(m),_&2?_=m:(P=ce(m,Xu),It(_,P),Object.freeze(P),_=P),Hu(b),O=_==null?uo:Ps([]),_!=null){for(P=!!_.length,m=0;m<_.length;m++){var V=_[m];P=P&&!(qe(V.o)&2),O[m]=V.o}P=(P?8:0)|1,m=qe(O),(m&P)!==P&&(Object.isFrozen(O)&&(O=Array.prototype.slice.call(O)),Sn(O,m|P)),b.h||(b.h={}),b.h[I]=_}else b.h&&(b.h[I]=void 0);lo(b,I,O,R)}else br(b,I,Qc(_,P,O),R)}function Xu(m){return qe(m.o)&2||(m=Yu(m,!0),Je(m.o,2)),m}function Yu(m,b){var I=m.o,_=[];Je(_,16);var R=m.constructor.h;if(R&&_.push(R),R=m.B,R){_.length=I.length,_.fill(void 0,_.length,I.length);var P={};_[_.length-1]=P}qe(I)&128&&ju(_),b=b||m.C()?It:xi,P=m.constructor,Ci=_,_=new P(_),Ci=void 0,m.R&&(_.R=m.R.slice()),P=!!(qe(I)&16);for(var O=R?I.length-1:I.length,V=0;V<O;V++)Zc(m,_,V-m.G,I[V],!1,P,b);if(R)for(var H in R)Zc(m,_,+H,R[H],!0,P,b);return _}function ln(m,b,I){m==null&&(m=Ci),Ci=void 0;var _=this.constructor.i||0,R=0<_,P=this.constructor.h,O=!1;if(m==null){m=P?[P]:[];var V=48,H=!0;R&&(_=0,V|=128),Sn(m,V)}else{if(!Array.isArray(m)||P&&P!==m[0])throw Error();var J=V=Je(m,0);if((H=(16&J)!==0)&&((O=(32&J)!==0)||(J|=32)),R){if(128&J)_=0;else if(0<m.length){var ue=m[m.length-1];if(Fs(ue)&&"g"in ue){_=0,J|=128,delete ue.g;var _e=!0,we;for(we in ue){_e=!1;break}_e&&m.pop()}}}else if(128&J)throw Error();V!==J&&Sn(m,J)}this.G=(P?0:-1)-_,this.h=void 0,this.o=m;e:{if(P=this.o.length,_=P-1,P&&(P=this.o[_],Fs(P))){this.B=P,this.i=_-this.G;break e}b!==void 0&&-1<b?(this.i=Math.max(b,_+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE}if(!R&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(I){b=H&&!O&&!0,R=this.i;var he;for(H=0;H<I.length;H++)O=I[H],O<R?(O+=this.G,(_=m[O])?Jc(_,b):m[O]=uo):(he||(he=jc(this)),(_=he[O])?Jc(_,b):he[O]=uo)}}ln.prototype.toJSON=function(){return qu(this.o,Xc,Yc)},ln.prototype.C=function(){return!!(qe(this.o)&2)};function Jc(m,b){if(Array.isArray(m)){var I=qe(m),_=1;!b||I&2||(_|=16),(I&_)!==_&&Sn(m,I|_)}}ln.prototype.ja=wr,ln.prototype.toString=function(){return this.o.toString()};function ed(m,b,I){if(I){var _={},R;for(R in I){var P=I[R],O=P.qa;O||(_.J=P.wa||P.oa.W,P.ia?(_.aa=Ju(P.ia),O=function(V){return function(H,J,ue){return V.J(H,J,ue,V.aa)}}(_)):P.ka?(_.Z=_i(P.da.P,P.ka),O=function(V){return function(H,J,ue){return V.J(H,J,ue,V.Z)}}(_)):O=_.J,P.qa=O),O(b,m,P.da),_={J:_.J,aa:_.aa,Z:_.Z}}}Te(b,m)}var Ii=Symbol();function Qu(m,b,I){return m[Ii]||(m[Ii]=function(_,R){return b(_,R,I)})}function co(m){var b=m[Ii];if(!b){var I=$e(m);b=function(_,R){return ke(_,R,I)},m[Ii]=b}return b}function td(m){var b=m.ia;if(b)return co(b);if(b=m.va)return Qu(m.da.P,b,m.ka)}function nd(m){var b=td(m),I=m.da,_=m.oa.U;return b?function(R,P){return _(R,P,I,b)}:function(R,P){return _(R,P,I)}}function Zu(m,b){var I=m[b];return typeof I=="function"&&I.length===0&&(I=I(),m[b]=I),Array.isArray(I)&&(fo in I||gs in I||0<I.length&&typeof I[0]=="function")?I:void 0}function $i(m,b,I,_,R,P){b.P=m[0];var O=1;if(m.length>O&&typeof m[O]!="number"){var V=m[O++];I(b,V)}for(;O<m.length;){I=m[O++];for(var H=O+1;H<m.length&&typeof m[H]!="number";)H++;switch(V=m[O++],H-=O,H){case 0:_(b,I,V);break;case 1:(H=Zu(m,O))?(O++,R(b,I,V,H)):_(b,I,V,m[O++]);break;case 2:H=O++,H=Zu(m,H),R(b,I,V,H,m[O++]);break;case 3:P(b,I,V,m[O++],m[O++],m[O++]);break;case 4:P(b,I,V,m[O++],m[O++],m[O++],m[O++]);break;default:throw Error("unexpected number of binary field arguments: "+H)}}return b}var po=Symbol();function Ju(m){var b=m[po];if(!b){var I=fa(m);b=function(_,R){return pe(_,R,I)},m[po]=b}return b}function _i(m,b){var I=m[po];return I||(I=function(_,R){return ed(_,R,b)},m[po]=I),I}var gs=Symbol();function Ni(m,b){m.push(b)}function ki(m,b,I){m.push(b,I.W)}function rd(m,b,I,_){var R=Ju(_),P=fa(_).P,O=I.W;m.push(b,function(V,H,J){return O(V,H,J,P,R)})}function Ei(m,b,I,_,R,P){var O=_i(_,P),V=I.W;m.push(b,function(H,J,ue){return V(H,J,ue,_,O)})}function fa(m){var b=m[gs];return b||(b=$i(m,m[gs]=[],Ni,ki,rd,Ei),fo in m&&gs in m&&(m.length=0),b)}var fo=Symbol();function D(m,b){m[0]=b}function W(m,b,I,_){var R=I.U;m[b]=_?function(P,O,V){return R(P,O,V,_)}:R}function se(m,b,I,_,R){var P=I.U,O=co(_),V=$e(_).P;m[b]=function(H,J,ue){return P(H,J,ue,V,O,R)}}function Ce(m,b,I,_,R,P,O){var V=I.U,H=Qu(_,R,P);m[b]=function(J,ue,_e){return V(J,ue,_e,_,H,O)}}function $e(m){var b=m[fo];return b||(b=$i(m,m[fo]={},D,W,se,Ce),fo in m&&gs in m&&(m.length=0),b)}function ke(m,b,I){for(;te(b)&&b.i!=4;){var _=b.l,R=I[_];if(!R){var P=I[0];P&&(P=P[_])&&(R=I[_]=nd(P))}if(!R||!R(b,m,_)){R=b,_=m,P=R.j,ve(R);var O=R;if(!O.ca){if(R=O.h.h-P,O.h.h=P,O=O.h,R==0)R=hs();else{if(P=Ds(O,R),O.S&&O.m)R=O.i.subarray(P,P+R);else{O=O.i;var V=P;R=P+R,R=V===R?zr():mr?O.slice(V,R):new Uint8Array(O.subarray(V,R))}R=R.length==0?hs():new Ur(R,Zn)}(P=_.R)?P.push(R):_.R=[R]}}}return m}function pe(m,b,I){for(var _=I.length,R=_%2==1,P=R?1:0;P<_;P+=2)(0,I[P+1])(b,m,I[P]);ed(m,b,R?I[0]:void 0)}function ye(m,b){return{U:m,W:b}}var Be=ye(function(m,b,I){if(m.i!==5)return!1;m=m.h;var _=m.i,R=m.h,P=_[R],O=_[R+1],V=_[R+2];return _=_[R+3],xr(m,m.h+4),O=(P<<0|O<<8|V<<16|_<<24)>>>0,m=2*(O>>31)+1,P=O>>>23&255,O&=8388607,br(b,I,P==255?O?NaN:1/0*m:P==0?m*Math.pow(2,-149)*O:m*Math.pow(2,P-150)*(O+Math.pow(2,23))),!0},function(m,b,I){if(b=Ku(b,I),b!=null){vr(m.h,8*I+5),m=m.h;var _=+b;_===0?0<1/_?Xe=Qe=0:(Qe=0,Xe=2147483648):isNaN(_)?(Qe=0,Xe=2147483647):(_=(I=0>_?-2147483648:0)?-_:_,34028234663852886e22<_?(Qe=0,Xe=(I|2139095040)>>>0):11754943508222875e-54>_?(_=Math.round(_/Math.pow(2,-149)),Qe=0,Xe=(I|_)>>>0):(b=Math.floor(Math.log(_)/Math.LN2),_*=Math.pow(2,-b),_=Math.round(8388608*_),16777216<=_&&++b,Qe=0,Xe=(I|b+127<<23|_&8388607)>>>0)),I=Xe,m.h.push(I>>>0&255),m.h.push(I>>>8&255),m.h.push(I>>>16&255),m.h.push(I>>>24&255)}}),Cn=ye(function(m,b,I){if(m.i!==0)return!1;var _=m.h,R=0,P=m=0,O=_.i,V=_.h;do{var H=O[V++];R|=(H&127)<<P,P+=7}while(32>P&&H&128);for(32<P&&(m|=(H&127)>>4),P=3;32>P&&H&128;P+=7)H=O[V++],m|=(H&127)<<P;if(xr(_,V),128>H)_=R>>>0,H=m>>>0,(m=H&2147483648)&&(_=~_+1>>>0,H=~H>>>0,_==0&&(H=H+1>>>0)),_=4294967296*H+(_>>>0);else throw ca();return br(b,I,m?-_:_),!0},function(m,b,I){b=Zt(b,I),b!=null&&(typeof b=="string"&&yr(b),b!=null&&(vr(m.h,8*I),typeof b=="number"?(m=m.h,gr(b),ms(m,Xe,Qe)):(I=yr(b),ms(m.h,I.i,I.h))))}),jr=ye(function(m,b,I){return m.i!==0?!1:(br(b,I,bn(m.h)),!0)},function(m,b,I){if(b=Zt(b,I),b!=null&&b!=null)if(vr(m.h,8*I),m=m.h,I=b,0<=I)vr(m,I);else{for(b=0;9>b;b++)m.h.push(I&127|128),I>>=7;m.h.push(1)}}),el=ye(function(m,b,I){if(m.i!==2)return!1;var _=bn(m.h)>>>0;m=m.h;var R=Ds(m,_);if(m=m.i,Os){var P=m,O;(O=Jn)||(O=Jn=new TextDecoder("utf-8",{fatal:!0})),m=R+_,P=R===0&&m===P.length?P:P.subarray(R,m);try{var V=O.decode(P)}catch(_e){if(da===void 0){try{O.decode(new Uint8Array([128]))}catch{}try{O.decode(new Uint8Array([97])),da=!0}catch{da=!1}}throw!da&&(Jn=void 0),_e}}else{V=R,_=V+_,R=[];for(var H=null,J,ue;V<_;)J=m[V++],128>J?R.push(J):224>J?V>=_?Wr():(ue=m[V++],194>J||(ue&192)!==128?(V--,Wr()):R.push((J&31)<<6|ue&63)):240>J?V>=_-1?Wr():(ue=m[V++],(ue&192)!==128||J===224&&160>ue||J===237&&160<=ue||((P=m[V++])&192)!==128?(V--,Wr()):R.push((J&15)<<12|(ue&63)<<6|P&63)):244>=J?V>=_-2?Wr():(ue=m[V++],(ue&192)!==128||(J<<28)+(ue-144)>>30||((P=m[V++])&192)!==128||((O=m[V++])&192)!==128?(V--,Wr()):(J=(J&7)<<18|(ue&63)<<12|(P&63)<<6|O&63,J-=65536,R.push((J>>10&1023)+55296,(J&1023)+56320))):Wr(),8192<=R.length&&(H=hi(H,R),R.length=0);V=hi(H,R)}return br(b,I,V),!0},function(m,b,I){if(b=Zt(b,I),b!=null){var _=!1;if(_=_===void 0?!1:_,Gu){if(_&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(b))throw Error("Found an unpaired surrogate");b=(mi||(mi=new TextEncoder)).encode(b)}else{for(var R=0,P=new Uint8Array(3*b.length),O=0;O<b.length;O++){var V=b.charCodeAt(O);if(128>V)P[R++]=V;else{if(2048>V)P[R++]=V>>6|192;else{if(55296<=V&&57343>=V){if(56319>=V&&O<b.length){var H=b.charCodeAt(++O);if(56320<=H&&57343>=H){V=1024*(V-55296)+H-56320+65536,P[R++]=V>>18|240,P[R++]=V>>12&63|128,P[R++]=V>>6&63|128,P[R++]=V&63|128;continue}else O--}if(_)throw Error("Found an unpaired surrogate");V=65533}P[R++]=V>>12|224,P[R++]=V>>6&63|128}P[R++]=V&63|128}}b=R===P.length?P:P.subarray(0,R)}vr(m.h,8*I+2),vr(m.h,b.length),je(m,m.h.end()),je(m,b)}}),Ti=ye(function(m,b,I,_,R){if(m.i!==2)return!1;b=Kc(b,I,_),I=m.h.j,_=bn(m.h)>>>0;var P=m.h.h+_,O=P-I;if(0>=O&&(m.h.j=P,R(b,m,void 0,void 0,void 0),O=P-m.h.h),O)throw Error("Message parsing ended unexpectedly. Expected to read "+(_+" bytes, instead read "+(_-O)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return m.h.h=P,m.h.j=I,!0},function(m,b,I,_,R){if(b=Si(b,_,I),b!=null)for(_=0;_<b.length;_++){var P=m;vr(P.h,8*I+2);var O=P.h.end();je(P,O),O.push(P.i),P=O,R(b[_],m),O=m;var V=P.pop();for(V=O.i+O.h.length()-V;127<V;)P.push(V&127|128),V>>>=7,O.i++;P.push(V),O.i++}});function tl(m){return function(b,I){e:{if(oe.length){var _=oe.pop();_.setOptions(I),pa(_.h,b,I),b=_}else b=new q(b,I);try{var R=$e(m),P=ke(new R.P,b,R);break e}finally{R=b.h,R.i=null,R.m=!1,R.l=0,R.j=0,R.h=0,R.S=!1,b.l=-1,b.i=-1,100>oe.length&&oe.push(b)}P=void 0}return P}}function zt(m){return function(){var b=new Ze;pe(this,b,fa(m)),je(b,b.h.end());for(var I=new Uint8Array(b.i),_=b.j,R=_.length,P=0,O=0;O<R;O++){var V=_[O];I.set(V,P),P+=V.length}return b.j=[I],I}}function er(m){ln.call(this,m)}x(er,ln);var nl=[er,1,jr,2,Be,3,el,4,el];er.prototype.l=zt(nl);function Yh(m){ln.call(this,m,-1,ET)}x(Yh,ln),Yh.prototype.addClassification=function(m,b){return Kc(this,1,er,m,b),this};var ET=[1],Pw=tl([Yh,1,Ti,nl]);function Ri(m){ln.call(this,m)}x(Ri,ln);var Fw=[Ri,1,Be,2,Be,3,Be,4,Be,5,Be];Ri.prototype.l=zt(Fw);function Lw(m){ln.call(this,m,-1,TT)}x(Lw,ln);var TT=[1],Mw=tl([Lw,1,Ti,Fw]);function sd(m){ln.call(this,m)}x(sd,ln);var Bw=[sd,1,Be,2,Be,3,Be,4,Be,5,Be,6,Cn],RT=tl(Bw);sd.prototype.l=zt(Bw);function Vw(m,b,I){if(I=m.createShader(I===0?m.VERTEX_SHADER:m.FRAGMENT_SHADER),m.shaderSource(I,b),m.compileShader(I),!m.getShaderParameter(I,m.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+m.getShaderInfoLog(I));return I}function zw(m){return Si(m,er,1).map(function(b){var I=Zt(b,1);return{index:I??0,score:Pn(b,2),label:Zt(b,3)!=null?Hr(Zt(b,3),""):void 0,displayName:Zt(b,4)!=null?Hr(Zt(b,4),""):void 0}})}function Ww(m){return{x:Pn(m,1),y:Pn(m,2),z:Pn(m,3),visibility:Ku(m,4)!=null?Pn(m,4):void 0}}function Uw(m){return m.map(function(b){return Si(Mw(b),Ri,1).map(Ww)})}function Qh(m,b){this.i=m,this.h=b,this.m=0}function Gw(m,b,I){return AT(m,b),typeof m.h.canvas.transferToImageBitmap=="function"?Promise.resolve(m.h.canvas.transferToImageBitmap()):I?Promise.resolve(m.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(m.h.canvas):(m.j===void 0&&(m.j=document.createElement("canvas")),new Promise(function(_){m.j.height=m.h.canvas.height,m.j.width=m.h.canvas.width,m.j.getContext("2d",{}).drawImage(m.h.canvas,0,0,m.h.canvas.width,m.h.canvas.height),_(m.j)}))}function AT(m,b){var I=m.h;if(m.s===void 0){var _=Vw(I,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),R=Vw(I,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),P=I.createProgram();if(I.attachShader(P,_),I.attachShader(P,R),I.linkProgram(P),!I.getProgramParameter(P,I.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+I.getProgramInfoLog(P));_=m.s=P,I.useProgram(_),R=I.getUniformLocation(_,"sampler0"),m.l={O:I.getAttribLocation(_,"aVertex"),N:I.getAttribLocation(_,"aTex"),xa:R},m.v=I.createBuffer(),I.bindBuffer(I.ARRAY_BUFFER,m.v),I.enableVertexAttribArray(m.l.O),I.vertexAttribPointer(m.l.O,2,I.FLOAT,!1,0,0),I.bufferData(I.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),I.STATIC_DRAW),I.bindBuffer(I.ARRAY_BUFFER,null),m.u=I.createBuffer(),I.bindBuffer(I.ARRAY_BUFFER,m.u),I.enableVertexAttribArray(m.l.N),I.vertexAttribPointer(m.l.N,2,I.FLOAT,!1,0,0),I.bufferData(I.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),I.STATIC_DRAW),I.bindBuffer(I.ARRAY_BUFFER,null),I.uniform1i(R,0)}_=m.l,I.useProgram(m.s),I.canvas.width=b.width,I.canvas.height=b.height,I.viewport(0,0,b.width,b.height),I.activeTexture(I.TEXTURE0),m.i.bindTexture2d(b.glName),I.enableVertexAttribArray(_.O),I.bindBuffer(I.ARRAY_BUFFER,m.v),I.vertexAttribPointer(_.O,2,I.FLOAT,!1,0,0),I.enableVertexAttribArray(_.N),I.bindBuffer(I.ARRAY_BUFFER,m.u),I.vertexAttribPointer(_.N,2,I.FLOAT,!1,0,0),I.bindFramebuffer(I.DRAW_FRAMEBUFFER?I.DRAW_FRAMEBUFFER:I.FRAMEBUFFER,null),I.clearColor(0,0,0,0),I.clear(I.COLOR_BUFFER_BIT),I.colorMask(!0,!0,!0,!0),I.drawArrays(I.TRIANGLE_FAN,0,4),I.disableVertexAttribArray(_.O),I.disableVertexAttribArray(_.N),I.bindBuffer(I.ARRAY_BUFFER,null),m.i.bindTexture2d(0)}function OT(m){this.h=m}var DT=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function PT(m,b){return b+m}function Hw(m,b){window[m]=b}function FT(m){var b=document.createElement("script");return b.setAttribute("src",m),b.setAttribute("crossorigin","anonymous"),new Promise(function(I){b.addEventListener("load",function(){I()},!1),b.addEventListener("error",function(){I()},!1),document.body.appendChild(b)})}function LT(){return z(function(m){switch(m.h){case 1:return m.s=2,S(m,WebAssembly.instantiate(DT),4);case 4:m.h=3,m.s=0;break;case 2:return m.s=0,m.l=null,m.return(!1);case 3:return m.return(!0)}})}function Zh(m){if(this.h=m,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=m&&m.locateFile||PT,typeof window=="object")var b=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")b=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ha=b,m.options){b=i(Object.keys(m.options));for(var I=b.next();!I.done;I=b.next()){I=I.value;var _=m.options[I].default;_!==void 0&&(this.l[I]=typeof _=="function"?_():_)}}}t=Zh.prototype,t.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function MT(m){var b,I,_,R,P,O,V,H,J,ue,_e;return z(function(we){switch(we.h){case 1:return m.ga?(b=m.h.files===void 0?[]:typeof m.h.files=="function"?m.h.files(m.l):m.h.files,S(we,LT(),2)):we.return();case 2:if(I=we.i,typeof window=="object")return Hw("createMediapipeSolutionsWasm",{locateFile:m.locateFile}),Hw("createMediapipeSolutionsPackedAssets",{locateFile:m.locateFile}),O=b.filter(function(he){return he.data!==void 0}),V=b.filter(function(he){return he.data===void 0}),H=Promise.all(O.map(function(he){var Ne=ad(m,he.url);if(he.path!==void 0){var Oe=he.path;Ne=Ne.then(function(ct){return m.overrideFile(Oe,ct),Promise.resolve(ct)})}return Ne})),J=Promise.all(V.map(function(he){return he.simd===void 0||he.simd&&I||!he.simd&&!I?FT(m.locateFile(he.url,m.ha)):Promise.resolve()})).then(function(){var he,Ne,Oe;return z(function(ct){if(ct.h==1)return he=window.createMediapipeSolutionsWasm,Ne=window.createMediapipeSolutionsPackedAssets,Oe=m,S(ct,he(Ne),2);Oe.i=ct.i,ct.h=0})}),ue=function(){return z(function(he){return m.h.graph&&m.h.graph.url?he=S(he,ad(m,m.h.graph.url),0):(he.h=0,he=void 0),he})}(),S(we,Promise.all([J,H,ue]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return _=b.filter(function(he){return he.simd===void 0||he.simd&&I||!he.simd&&!I}).map(function(he){return m.locateFile(he.url,m.ha)}),importScripts.apply(null,u(_)),R=m,S(we,createMediapipeSolutionsWasm(Module),6);case 6:R.i=we.i,m.m=new OffscreenCanvas(1,1),m.i.canvas=m.m,P=m.i.GL.createContext(m.m,{antialias:!1,alpha:!1,ua:typeof WebGL2RenderingContext<"u"?2:1}),m.i.GL.makeContextCurrent(P),we.h=4;break;case 7:if(m.m=document.createElement("canvas"),_e=m.m.getContext("webgl2",{}),!_e&&(_e=m.m.getContext("webgl",{}),!_e))return alert("Failed to create WebGL canvas context when passing video frame."),we.return();m.K=_e,m.i.canvas=m.m,m.i.createContext(m.m,!0,!0,{});case 4:m.j=new m.i.SolutionWasm,m.ga=!1,we.h=0}})}function BT(m){var b,I,_,R,P,O,V,H;return z(function(J){if(J.h==1){if(m.h.graph&&m.h.graph.url&&m.fa===m.h.graph.url)return J.return();if(m.u=!0,!m.h.graph||!m.h.graph.url){J.h=2;return}return m.fa=m.h.graph.url,S(J,ad(m,m.h.graph.url),3)}for(J.h!=2&&(b=J.i,m.j.loadGraph(b)),I=i(Object.keys(m.D)),_=I.next();!_.done;_=I.next())R=_.value,m.j.overrideFile(R,m.D[R]);if(m.D={},m.h.listeners)for(P=i(m.h.listeners),O=P.next();!O.done;O=P.next())V=O.value,UT(m,V);H=m.l,m.l={},m.setOptions(H),J.h=0})}t.reset=function(){var m=this;return z(function(b){m.j&&(m.j.reset(),m.s={},m.v={}),b.h=0})},t.setOptions=function(m,b){var I=this;if(b=b||this.h.options){for(var _=[],R=[],P={},O=i(Object.keys(m)),V=O.next();!V.done;P={X:P.X,Y:P.Y},V=O.next())if(V=V.value,!(V in this.l&&this.l[V]===m[V])){this.l[V]=m[V];var H=b[V];H!==void 0&&(H.onChange&&(P.X=H.onChange,P.Y=m[V],_.push(function(J){return function(){var ue;return z(function(_e){if(_e.h==1)return S(_e,J.X(J.Y),2);ue=_e.i,ue===!0&&(I.u=!0),_e.h=0})}}(P))),H.graphOptionXref&&(V=Object.assign({},{calculatorName:"",calculatorIndex:0},H.graphOptionXref,{valueNumber:H.type===1?m[V]:0,valueBoolean:H.type===0?m[V]:!1,valueString:H.type===2?m[V]:""}),R.push(V)))}(_.length!==0||R.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(R),this.F=(this.F===void 0?[]:this.F).concat(_))}};function VT(m){var b,I,_,R,P,O,V;return z(function(H){switch(H.h){case 1:if(!m.u)return H.return();if(!m.F){H.h=2;break}b=i(m.F),I=b.next();case 3:if(I.done){H.h=5;break}return _=I.value,S(H,_(),4);case 4:I=b.next(),H.h=3;break;case 5:m.F=void 0;case 2:if(m.H){for(R=new m.i.GraphOptionChangeRequestList,P=i(m.H),O=P.next();!O.done;O=P.next())V=O.value,R.push_back(V);m.j.changeOptions(R),R.delete(),m.H=void 0}m.u=!1,H.h=0}})}t.initialize=function(){var m=this;return z(function(b){return b.h==1?S(b,MT(m),2):b.h!=3?S(b,BT(m),3):S(b,VT(m),0)})};function ad(m,b){var I,_;return z(function(R){return b in m.L?R.return(m.L[b]):(I=m.locateFile(b,""),_=fetch(I).then(function(P){return P.arrayBuffer()}),m.L[b]=_,R.return(_))})}t.overrideFile=function(m,b){this.j?this.j.overrideFile(m,b):this.D[m]=b},t.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},t.send=function(m,b){var I=this,_,R,P,O,V,H,J,ue,_e;return z(function(we){switch(we.h){case 1:return I.h.inputs?(_=1e3*(b??performance.now()),S(we,I.I,2)):we.return();case 2:return S(we,I.initialize(),3);case 3:for(R=new I.i.PacketDataList,P=i(Object.keys(m)),O=P.next();!O.done;O=P.next())if(V=O.value,H=I.h.inputs[V]){e:{var he=m[V];switch(H.type){case"video":var Ne=I.s[H.stream];if(Ne||(Ne=new Qh(I.i,I.K),I.s[H.stream]=Ne),Ne.m===0&&(Ne.m=Ne.i.createTexture()),typeof HTMLVideoElement<"u"&&he instanceof HTMLVideoElement)var Oe=he.videoWidth,ct=he.videoHeight;else typeof HTMLImageElement<"u"&&he instanceof HTMLImageElement?(Oe=he.naturalWidth,ct=he.naturalHeight):(Oe=he.width,ct=he.height);ct={glName:Ne.m,width:Oe,height:ct},Oe=Ne.h,Oe.canvas.width=ct.width,Oe.canvas.height=ct.height,Oe.activeTexture(Oe.TEXTURE0),Ne.i.bindTexture2d(Ne.m),Oe.texImage2D(Oe.TEXTURE_2D,0,Oe.RGBA,Oe.RGBA,Oe.UNSIGNED_BYTE,he),Ne.i.bindTexture2d(0),Ne=ct;break e;case"detections":for(Ne=I.s[H.stream],Ne||(Ne=new OT(I.i),I.s[H.stream]=Ne),Ne.data||(Ne.data=new Ne.h.DetectionListData),Ne.data.reset(he.length),ct=0;ct<he.length;++ct){Oe=he[ct];var at=Ne.data,Jt=at.setBoundingBox,Cr=ct,Fn=Oe.la,Ke=new sd;if(Sr(Ke,1,Fn.ra),Sr(Ke,2,Fn.sa),Sr(Ke,3,Fn.height),Sr(Ke,4,Fn.width),Sr(Ke,5,Fn.rotation),br(Ke,6,Fn.pa),Fn=Ke.l(),Jt.call(at,Cr,Fn),Oe.ea)for(at=0;at<Oe.ea.length;++at){Ke=Oe.ea[at],Jt=Ne.data,Cr=Jt.addNormalizedLandmark,Fn=ct,Ke=Object.assign({},Ke,{visibility:Ke.visibility?Ke.visibility:0});var en=new Ri;Sr(en,1,Ke.x),Sr(en,2,Ke.y),Sr(en,3,Ke.z),Ke.visibility&&Sr(en,4,Ke.visibility),Ke=en.l(),Cr.call(Jt,Fn,Ke)}if(Oe.ba)for(at=0;at<Oe.ba.length;++at)Jt=Ne.data,Cr=Jt.addClassification,Fn=ct,Ke=Oe.ba[at],en=new er,Sr(en,2,Ke.score),Ke.index&&br(en,1,Ke.index),Ke.label&&br(en,3,Ke.label),Ke.displayName&&br(en,4,Ke.displayName),Ke=en.l(),Cr.call(Jt,Fn,Ke)}Ne=Ne.data;break e;default:Ne={}}}switch(J=Ne,ue=H.stream,H.type){case"video":R.pushTexture2d(Object.assign({},J,{stream:ue,timestamp:_}));break;case"detections":_e=J,_e.stream=ue,_e.timestamp=_,R.pushDetectionList(_e);break;default:throw Error("Unknown input config type: '"+H.type+"'")}}return I.j.send(R),S(we,I.I,4);case 4:R.delete(),we.h=0}})};function zT(m,b,I){var _,R,P,O,V,H,J,ue,_e,we,he,Ne,Oe,ct;return z(function(at){switch(at.h){case 1:if(!I)return at.return(b);for(_={},R=0,P=i(Object.keys(I)),O=P.next();!O.done;O=P.next())V=O.value,H=I[V],typeof H!="string"&&H.type==="texture"&&b[H.stream]!==void 0&&++R;1<R&&(m.M=!1),J=i(Object.keys(I)),O=J.next();case 2:if(O.done){at.h=4;break}if(ue=O.value,_e=I[ue],typeof _e=="string")return Oe=_,ct=ue,S(at,WT(m,ue,b[_e]),14);if(we=b[_e.stream],_e.type==="detection_list"){if(we){for(var Jt=we.getRectList(),Cr=we.getLandmarksList(),Fn=we.getClassificationsList(),Ke=[],en=0;en<Jt.size();++en){var ha=RT(Jt.get(en)),GT=Pn(ha,1),HT=Pn(ha,2),jT=Pn(ha,3),KT=Pn(ha,4),qT=Pn(ha,5,0),od=void 0;od=od===void 0?0:od,ha={la:{ra:GT,sa:HT,height:jT,width:KT,rotation:qT,pa:Hr(Zt(ha,6),od)},ea:Si(Mw(Cr.get(en)),Ri,1).map(Ww),ba:zw(Pw(Fn.get(en)))},Ke.push(ha)}Jt=Ke}else Jt=[];_[ue]=Jt,at.h=7;break}if(_e.type==="proto_list"){if(we){for(Jt=Array(we.size()),Cr=0;Cr<we.size();Cr++)Jt[Cr]=we.get(Cr);we.delete()}else Jt=[];_[ue]=Jt,at.h=7;break}if(we===void 0){at.h=3;break}if(_e.type==="float_list"){_[ue]=we,at.h=7;break}if(_e.type==="proto"){_[ue]=we,at.h=7;break}if(_e.type!=="texture")throw Error("Unknown output config type: '"+_e.type+"'");return he=m.v[ue],he||(he=new Qh(m.i,m.K),m.v[ue]=he),S(at,Gw(he,we,m.M),13);case 13:Ne=at.i,_[ue]=Ne;case 7:_e.transform&&_[ue]&&(_[ue]=_e.transform(_[ue])),at.h=3;break;case 14:Oe[ct]=at.i;case 3:O=J.next(),at.h=2;break;case 4:return at.return(_)}})}function WT(m,b,I){var _;return z(function(R){return typeof I=="number"||I instanceof Uint8Array||I instanceof m.i.Uint8BlobList?R.return(I):I instanceof m.i.Texture2dDataOut?(_=m.v[b],_||(_=new Qh(m.i,m.K),m.v[b]=_),R.return(Gw(_,I,m.M))):R.return(void 0)})}function UT(m,b){for(var I=b.name||"$",_=[].concat(u(b.wants)),R=new m.i.StringList,P=i(b.wants),O=P.next();!O.done;O=P.next())R.push_back(O.value);P=m.i.PacketListener.implement({onResults:function(V){for(var H={},J=0;J<b.wants.length;++J)H[_[J]]=V.get(J);var ue=m.listeners[I];ue&&(m.I=zT(m,H,b.outs).then(function(_e){_e=ue(_e);for(var we=0;we<b.wants.length;++we){var he=H[_[we]];typeof he=="object"&&he.hasOwnProperty&&he.hasOwnProperty("delete")&&he.delete()}_e&&(m.I=_e)}))}}),m.j.attachMultiListener(R,P),R.delete()}t.onResults=function(m,b){this.listeners[b||"$"]=m},Z("Solution",Zh),Z("OptionType",{BOOL:0,NUMBER:1,ta:2,0:"BOOL",1:"NUMBER",2:"STRING"});function jw(m){return m===void 0&&(m=0),m===1?"hand_landmark_full.tflite":"hand_landmark_lite.tflite"}function Kw(m){var b=this;m=m||{},this.h=new Zh({locateFile:m.locateFile,files:function(I){return[{url:"hands_solution_packed_assets_loader.js"},{simd:!1,url:"hands_solution_wasm_bin.js"},{simd:!0,url:"hands_solution_simd_wasm_bin.js"},{data:!0,url:jw(I.modelComplexity)}]},graph:{url:"hands.binarypb"},inputs:{image:{type:"video",stream:"input_frames_gpu"}},listeners:[{wants:["multi_hand_landmarks","multi_hand_world_landmarks","image_transformed","multi_handedness"],outs:{image:"image_transformed",multiHandLandmarks:{type:"proto_list",stream:"multi_hand_landmarks",transform:Uw},multiHandWorldLandmarks:{type:"proto_list",stream:"multi_hand_world_landmarks",transform:Uw},multiHandedness:{type:"proto_list",stream:"multi_handedness",transform:function(I){return I.map(function(_){return zw(Pw(_))[0]})}}}}],options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumHands:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculator",fieldName:"int_value"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(I){var _,R,P;return z(function(O){return O.h==1?(_=jw(I),R="third_party/mediapipe/modules/hand_landmark/"+_,S(O,ad(b.h,_),2)):(P=O.i,b.h.overrideFile(R,P),O.return(!0))})}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"handlandmarktrackinggpu__palmdetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"handlandmarktrackinggpu__handlandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}}}})}t=Kw.prototype,t.close=function(){return this.h.close(),Promise.resolve()},t.onResults=function(m){this.h.onResults(m)},t.initialize=function(){var m=this;return z(function(b){return S(b,m.h.initialize(),0)})},t.reset=function(){this.h.reset()},t.send=function(m){var b=this;return z(function(I){return S(I,b.h.send(m),0)})},t.setOptions=function(m){this.h.setOptions(m)},Z("Hands",Kw),Z("HAND_CONNECTIONS",[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]]),Z("VERSION","0.4.1675469240")}).call(qn);var cF=Hands;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dF=1e-7,pF=1e-4;class Q2{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class j0{refCount(e){return Ln("refCount")}incRef(e){return Ln("incRef")}timerAvailable(){return!0}time(e){return Ln("time")}read(e){return Ln("read")}readSync(e){return Ln("readSync")}readToGPU(e,n){return Ln("readToGPU")}numDataIds(){return Ln("numDataIds")}disposeData(e,n){return Ln("disposeData")}write(e,n,r){return Ln("write")}move(e,n,r,s,a){return Ln("move")}createTensorFromGPUData(e,n,r){return Ln("createTensorFromGPUData")}memory(){return Ln("memory")}floatPrecision(){return Ln("floatPrecision")}epsilon(){return this.floatPrecision()===32?dF:pF}dispose(){return Ln("dispose")}}function Ln(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ap(t,e,n){return Math.max(t,Math.min(e,n))}function K0(t){return t%2===0?t:t+1}function pl(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function fF(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function E(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function Yn(t,e,n=""){E(yt(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function Au(t){E(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function K(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function hF(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==null&&e[n]!==null&&t[n]!==e[n])return!1;return!0}function yt(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function xu(t){return t%1===0}function Kg(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function su(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function xb(t,e=s=>0,n,r){return new Promise((s,a)=>{let o=0;const i=()=>{if(t()){s();return}o++;const u=e(o);if(n!=null&&o>=n){a();return}r!=null?r(i,u):setTimeout(i,u)};i()})}function Z2(t,e){let n=1,r=-1;for(let a=0;a<t.length;++a)if(t[a]>=0)n*=t[a];else if(t[a]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${a}`);r=a}else if(t[a]<0)throw Error(`Shapes can not be < 0. Found ${t[a]} at dim ${a}`);if(r===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const s=t.slice();return s[r]=e/n,s}function vt(t,e){const n=e.length;return t=t==null?e.map((r,s)=>s):[].concat(t),E(t.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),E(t.every(r=>xu(r)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(r=>r<0?n+r:r)}function Qa(t,e){const n=[],r=[],s=e!=null&&Array.isArray(e)&&e.length===0,a=e==null||s?null:vt(e,t).sort();let o=0;for(let i=0;i<t.length;++i){if(a!=null){if(a[o]===i&&t[i]!==1)throw new Error(`Can't squeeze axis ${i} since its dim '${t[i]}' is not 1`);(a[o]==null||a[o]>i)&&t[i]===1&&(n.push(t[i]),r.push(i)),a[o]<=i&&o++}t[i]!==1&&(n.push(t[i]),r.push(i))}return{newShape:n,keptDims:r}}function Ua(t,e){return Vt(t,e)}function Vt(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function mF(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function gF(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function yF(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function vu(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function xF(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function If(t){return typeof t=="string"||t instanceof String}function vF(t){return typeof t=="boolean"}function wF(t){return typeof t=="number"}function Ou(t){return Array.isArray(t)?Ou(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":wF(t)?"float32":If(t)?"string":vF(t)?"bool":"float32"}function qg(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Xg(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function Ye(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function J2(t,e,n,r=!1){const s=new Array;if(e.length===1){const a=e[0]*(r?2:1);for(let o=0;o<a;o++)s[o]=n[t+o]}else{const a=e[0],o=e.slice(1),i=o.reduce((u,c)=>u*c)*(r?2:1);for(let u=0;u<a;u++)s[u]=J2(t+u*i,o,n,r)}return s}function Yg(t,e,n=!1){if(t.length===0)return e[0];const r=t.reduce((s,a)=>s*a)*(n?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return J2(0,t,e,n)}function e$(t,e){const n=Ga(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function Ga(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function hr(t){t.forEach(e=>{E(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function Qg(t,e,n){if(e===0)return 0;if(e===1)return t[0];let r=t[t.length-1];for(let s=0;s<t.length-1;++s)r+=n[s]*t[s];return r}function q0(t,e,n){if(e===0)return[];if(e===1)return[t];const r=new Array(e);for(let s=0;s<r.length-1;++s)r[s]=Math.floor(t/n[s]),t-=r[s]*n[s];return r[r.length-1]=t,r}function Wo(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vb="tfjsflags";class bF{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=SF,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(U().getBool("IS_TEST")||U().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){const s=this.urlFlags[e];U().getBool("IS_TEST")||U().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${s}.`),this.set(e,s)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(Wo(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);vb in e&&e[vb].split(",").forEach(r=>{const[s,a]=r.split(":");this.urlFlags[s]=IF(s,a)})}}function SF(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(CF(e,r[0],r[1]),r.join("="))),e}function CF(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function IF(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function U(){return t$}let t$=null;function $F(t){t$=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let km;function n$(){if(km==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");km=t}return km}function _F(){const t=n$();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function X0(t,e){const n=_F();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const Y0="Abs",Q0="Acos",Z0="Acosh",$f="Add",_f="AddN",Nf="All",kf="Any",J0="ArgMax",ex="ArgMin",tx="Asin",nx="Asinh",rx="Atan",sx="Atanh",ax="Atan2",Ef="AvgPool",r$="AvgPoolGrad",ox="AvgPool3D",s$="AvgPool3DGrad",Tf="BatchMatMul",ix="BatchToSpaceND",Rf="Bincount",ux="BitwiseAnd",lx="BroadcastArgs",Af="Cast",cx="Ceil",Of="ClipByValue",a$="Complex",o$="ComplexAbs",dx="Concat",Df="Conv2D",i$="Conv2DBackpropFilter",Pf="Conv2DBackpropInput",Ff="Conv3D",px="Conv3DBackpropFilterV2",Lf="Conv3DBackpropInputV2",fx="Cos",hx="Cosh",Mf="Cumprod",Bf="Cumsum",Vf="CropAndResize",mx="DenseBincount",zf="DepthToSpace",Wf="DepthwiseConv2dNative",u$="DepthwiseConv2dNativeBackpropFilter",l$="DepthwiseConv2dNativeBackpropInput",gx="Diag",Uf="Dilation2D",c$="Dilation2DBackpropInput",d$="Dilation2DBackpropFilter",yx="RealDiv",p$="Einsum",xx="Elu",vx="EluGrad",wx="Erf",bx="Equal",Sx="Exp",Cx="ExpandDims",Ix="Expm1",f$="FFT",$x="Fill",Gf="FlipLeftRight",_x="Floor",Nx="FloorDiv",Hf="FusedBatchNorm",kx="GatherV2",jf="GatherNd",Ex="Greater",Tx="GreaterEqual",Kf="Identity",h$="IFFT",m$="Imag",Rx="IsFinite",Ax="IsInf",Ox="IsNan",qf="LeakyRelu",Dx="Less",Px="LessEqual",Xf="LinSpace",Fx="Log",Lx="Log1p",Mx="LogicalAnd",Bx="LogicalNot",Vx="LogicalOr",NF="LogicalXor",Yf="LRN",zx="LRNGrad",Qf="Max",Wx="Maximum",Zf="MaxPool",g$="MaxPoolGrad",Ux="MaxPool3D",y$="MaxPool3DGrad",Gx="MaxPoolWithArgmax",Jf="Mean",eh="Min",Hx="Minimum",th="MirrorPad",jx="Mod",nh="Multinomial",Kx="Multiply",qx="Neg",Xx="NotEqual",rh="NonMaxSuppressionV3",sh="NonMaxSuppressionV4",ah="NonMaxSuppressionV5",Yx="OnesLike",oh="OneHot",Qx="Pack",ih="PadV2",Zx="Pow",uh="Prelu",lh="Prod",x$="RaggedGather",v$="RaggedRange",w$="RaggedTensorToTensor",Jx="Range",b$="Real",ev="Reciprocal",tv="Relu",nv="Reshape",ch="ResizeNearestNeighbor",rv="ResizeNearestNeighborGrad",dh="ResizeBilinear",sv="ResizeBilinearGrad",av="Relu6",ph="Reverse",ov="Round",iv="Rsqrt",fh="ScatterNd",hh="TensorScatterUpdate",mh="SearchSorted",uv="Select",lv="Selu",cv="Slice",dv="Sin",pv="Sinh",fv="Sign",hv="Sigmoid",mv="Softplus",gv="Sqrt",gh="Sum",yv="SpaceToBatchND",xv="SplitV",yh="Softmax",vv="SparseFillEmptyRows",xh="SparseReshape",wv="SparseSegmentMean",bv="SparseSegmentSum",vh="SparseToDense",Sv="SquaredDifference",S$="Square",C$="StaticRegexReplace",wh="StridedSlice",Cv="StringNGrams",Iv="StringSplit",$v="StringToHashBucketFast",_v="Sub",Nv="Tan",kv="Tanh",Ac="Tile",bh="TopK",Sh="Transform",au="Transpose",Ev="Unique",Tv="Unpack",I$="UnsortedSegmentSum",Rv="ZerosLike",Ch="Step",Zg="FromPixels",Ih="RotateWithOffset",oc="_FusedMatMul",ic="FusedConv2D",uc="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jr(...t){U().getBool("IS_TEST")||U().getBool("PROD")||console.warn(...t)}function kF(...t){U().getBool("IS_TEST")||U().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Op=X0("kernelRegistry",()=>new Map),EF=X0("gradRegistry",()=>new Map);function Jg(t,e){const n=_$(t,e);return Op.get(n)}function wb(t){return EF.get(t)}function bb(t){const e=Op.entries(),n=[];for(;;){const{done:r,value:s}=e.next();if(r)break;const[a,o]=s,[i]=a.split("_");i===t&&n.push(o)}return n}function $$(t){const{kernelName:e,backendName:n}=t,r=_$(e,n);Op.has(r)&&Jr(`The kernel '${e}' for backend '${n}' is already registered`),Op.set(r,t)}function _$(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N$(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var k$=ut,Tr=null;try{Tr=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function ut(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}ut.prototype.__isLong__;Object.defineProperty(ut.prototype,"__isLong__",{value:!0});function Qn(t){return(t&&t.__isLong__)===!0}ut.isLong=Qn;var Sb={},Cb={};function ai(t,e){var n,r,s;return e?(t>>>=0,(s=0<=t&&t<256)&&(r=Cb[t],r)?r:(n=lt(t,(t|0)<0?-1:0,!0),s&&(Cb[t]=n),n)):(t|=0,(s=-128<=t&&t<128)&&(r=Sb[t],r)?r:(n=lt(t,t<0?-1:0,!1),s&&(Sb[t]=n),n))}ut.fromInt=ai;function Rr(t,e){if(isNaN(t))return e?ko:Ar;if(e){if(t<0)return ko;if(t>=E$)return A$}else{if(t<=-$b)return Gn;if(t+1>=$b)return R$}return t<0?Rr(-t,e).neg():lt(t%wu|0,t/wu|0,e)}ut.fromNumber=Rr;function lt(t,e,n){return new ut(t,e,n)}ut.fromBits=lt;var Dp=Math.pow;function Av(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return Ar;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return Av(t.substring(1),e,n).neg();for(var s=Rr(Dp(n,8)),a=Ar,o=0;o<t.length;o+=8){var i=Math.min(8,t.length-o),u=parseInt(t.substring(o,o+i),n);if(i<8){var c=Rr(Dp(n,i));a=a.mul(c).add(Rr(u))}else a=a.mul(s),a=a.add(Rr(u))}return a.unsigned=e,a}ut.fromString=Av;function cs(t,e){return typeof t=="number"?Rr(t,e):typeof t=="string"?Av(t,e):lt(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}ut.fromValue=cs;var Ib=65536,TF=1<<24,wu=Ib*Ib,E$=wu*wu,$b=E$/2,_b=ai(TF),Ar=ai(0);ut.ZERO=Ar;var ko=ai(0,!0);ut.UZERO=ko;var Yi=ai(1);ut.ONE=Yi;var T$=ai(1,!0);ut.UONE=T$;var ey=ai(-1);ut.NEG_ONE=ey;var R$=lt(-1,2147483647,!1);ut.MAX_VALUE=R$;var A$=lt(-1,-1,!0);ut.MAX_UNSIGNED_VALUE=A$;var Gn=lt(0,-2147483648,!1);ut.MIN_VALUE=Gn;var le=ut.prototype;le.toInt=function(){return this.unsigned?this.low>>>0:this.low};le.toNumber=function(){return this.unsigned?(this.high>>>0)*wu+(this.low>>>0):this.high*wu+(this.low>>>0)};le.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Gn)){var n=Rr(e),r=this.div(n),s=r.mul(n).sub(this);return r.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var a=Rr(Dp(e,6),this.unsigned),o=this,i="";;){var u=o.div(a),c=o.sub(u.mul(a)).toInt()>>>0,l=c.toString(e);if(o=u,o.isZero())return l+i;for(;l.length<6;)l="0"+l;i=""+l+i}};le.getHighBits=function(){return this.high};le.getHighBitsUnsigned=function(){return this.high>>>0};le.getLowBits=function(){return this.low};le.getLowBitsUnsigned=function(){return this.low>>>0};le.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Gn)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};le.isZero=function(){return this.high===0&&this.low===0};le.eqz=le.isZero;le.isNegative=function(){return!this.unsigned&&this.high<0};le.isPositive=function(){return this.unsigned||this.high>=0};le.isOdd=function(){return(this.low&1)===1};le.isEven=function(){return(this.low&1)===0};le.equals=function(e){return Qn(e)||(e=cs(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};le.eq=le.equals;le.notEquals=function(e){return!this.eq(e)};le.neq=le.notEquals;le.ne=le.notEquals;le.lessThan=function(e){return this.comp(e)<0};le.lt=le.lessThan;le.lessThanOrEqual=function(e){return this.comp(e)<=0};le.lte=le.lessThanOrEqual;le.le=le.lessThanOrEqual;le.greaterThan=function(e){return this.comp(e)>0};le.gt=le.greaterThan;le.greaterThanOrEqual=function(e){return this.comp(e)>=0};le.gte=le.greaterThanOrEqual;le.ge=le.greaterThanOrEqual;le.compare=function(e){if(Qn(e)||(e=cs(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};le.comp=le.compare;le.negate=function(){return!this.unsigned&&this.eq(Gn)?Gn:this.not().add(Yi)};le.neg=le.negate;le.add=function(e){Qn(e)||(e=cs(e));var n=this.high>>>16,r=this.high&65535,s=this.low>>>16,a=this.low&65535,o=e.high>>>16,i=e.high&65535,u=e.low>>>16,c=e.low&65535,l=0,d=0,p=0,f=0;return f+=a+c,p+=f>>>16,f&=65535,p+=s+u,d+=p>>>16,p&=65535,d+=r+i,l+=d>>>16,d&=65535,l+=n+o,l&=65535,lt(p<<16|f,l<<16|d,this.unsigned)};le.subtract=function(e){return Qn(e)||(e=cs(e)),this.add(e.neg())};le.sub=le.subtract;le.multiply=function(e){if(this.isZero())return Ar;if(Qn(e)||(e=cs(e)),Tr){var n=Tr.mul(this.low,this.high,e.low,e.high);return lt(n,Tr.get_high(),this.unsigned)}if(e.isZero())return Ar;if(this.eq(Gn))return e.isOdd()?Gn:Ar;if(e.eq(Gn))return this.isOdd()?Gn:Ar;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(_b)&&e.lt(_b))return Rr(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,s=this.high&65535,a=this.low>>>16,o=this.low&65535,i=e.high>>>16,u=e.high&65535,c=e.low>>>16,l=e.low&65535,d=0,p=0,f=0,h=0;return h+=o*l,f+=h>>>16,h&=65535,f+=a*l,p+=f>>>16,f&=65535,f+=o*c,p+=f>>>16,f&=65535,p+=s*l,d+=p>>>16,p&=65535,p+=a*c,d+=p>>>16,p&=65535,p+=o*u,d+=p>>>16,p&=65535,d+=r*l+s*c+a*u+o*i,d&=65535,lt(f<<16|h,d<<16|p,this.unsigned)};le.mul=le.multiply;le.divide=function(e){if(Qn(e)||(e=cs(e)),e.isZero())throw Error("division by zero");if(Tr){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?Tr.div_u:Tr.div_s)(this.low,this.high,e.low,e.high);return lt(n,Tr.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?ko:Ar;var r,s,a;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return ko;if(e.gt(this.shru(1)))return T$;a=ko}else{if(this.eq(Gn)){if(e.eq(Yi)||e.eq(ey))return Gn;if(e.eq(Gn))return Yi;var o=this.shr(1);return r=o.div(e).shl(1),r.eq(Ar)?e.isNegative()?Yi:ey:(s=this.sub(e.mul(r)),a=r.add(s.div(e)),a)}else if(e.eq(Gn))return this.unsigned?ko:Ar;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();a=Ar}for(s=this;s.gte(e);){r=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(r)/Math.LN2),u=i<=48?1:Dp(2,i-48),c=Rr(r),l=c.mul(e);l.isNegative()||l.gt(s);)r-=u,c=Rr(r,this.unsigned),l=c.mul(e);c.isZero()&&(c=Yi),a=a.add(c),s=s.sub(l)}return a};le.div=le.divide;le.modulo=function(e){if(Qn(e)||(e=cs(e)),Tr){var n=(this.unsigned?Tr.rem_u:Tr.rem_s)(this.low,this.high,e.low,e.high);return lt(n,Tr.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};le.mod=le.modulo;le.rem=le.modulo;le.not=function(){return lt(~this.low,~this.high,this.unsigned)};le.and=function(e){return Qn(e)||(e=cs(e)),lt(this.low&e.low,this.high&e.high,this.unsigned)};le.or=function(e){return Qn(e)||(e=cs(e)),lt(this.low|e.low,this.high|e.high,this.unsigned)};le.xor=function(e){return Qn(e)||(e=cs(e)),lt(this.low^e.low,this.high^e.high,this.unsigned)};le.shiftLeft=function(e){return Qn(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?lt(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):lt(0,this.low<<e-32,this.unsigned)};le.shl=le.shiftLeft;le.shiftRight=function(e){return Qn(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?lt(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):lt(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};le.shr=le.shiftRight;le.shiftRightUnsigned=function(e){if(Qn(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var r=this.low;return lt(r>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?lt(n,0,this.unsigned):lt(n>>>e-32,0,this.unsigned)};le.shru=le.shiftRightUnsigned;le.shr_u=le.shiftRightUnsigned;le.toSigned=function(){return this.unsigned?lt(this.low,this.high,!1):this};le.toUnsigned=function(){return this.unsigned?this:lt(this.low,this.high,!0)};le.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};le.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};le.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};ut.fromBytes=function(e,n,r){return r?ut.fromBytesLE(e,n):ut.fromBytesBE(e,n)};ut.fromBytesLE=function(e,n){return new ut(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};ut.fromBytesBE=function(e,n){return new ut(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};var O$=Rc(k$),RF=H0({__proto__:null,default:O$},[k$]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bo=O$||RF;function $h(t){return bo.fromString(t,!0,16)}const D$=$h("c3a5c85c97cb3127"),wo=$h("b492b66fbe98f273"),hn=$h("9ae16a3b2f90404f");function ty(t){return t.xor(t.shru(47))}function P$(t,e,n){const r=t.slice(e,e+n);return bo.fromBytes(Array.from(r),!0,!0)}function st(t,e){return P$(t,e,8)}function Nb(t,e){return P$(t,e,4)}function Mt(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function Pa(t,e,n=$h("9ddfea08eb382d69")){let r=t.xor(e).mul(n);r=r.xor(r.shru(47));let s=e.xor(r).mul(n);return s=s.xor(s.shru(47)),s=s.mul(n),s}function AF(t,e,n,r,s,a){s=s.add(t),a=Mt(a.add(s).add(r),21);const o=s;return s=s.add(e),s=s.add(n),a=a.add(Mt(s,44)),[s.add(r),a.add(o)]}function Nd(t,e,n,r){return AF(st(t,e),st(t,e+8),st(t,e+16),st(t,e+24),n,r)}function OF(t,e=t.length){if(e>=8){const n=hn.add(e*2),r=st(t,0).add(hn),s=st(t,e-8),a=Mt(s,37).mul(n).add(r),o=Mt(r,25).add(s).mul(n);return Pa(a,o,n)}if(e>=4){const n=hn.add(e*2),r=Nb(t,0);return Pa(r.shl(3).add(e),Nb(t,e-4),n)}if(e>0){const n=t[0],r=t[e>>1],s=t[e-1],a=n+(r<<8),o=e+(s<<2);return ty(hn.mul(a).xor(D$.mul(o))).mul(hn)}return hn}function DF(t,e=t.length){const n=hn.add(e*2),r=st(t,0).mul(wo),s=st(t,8),a=st(t,e-8).mul(n),o=st(t,e-16).mul(hn);return Pa(Mt(r.add(s),43).add(Mt(a,30)).add(o),r.add(Mt(s.add(hn),18)).add(a),n)}function PF(t,e=t.length){const n=hn.add(e*2),r=st(t,0).mul(hn),s=st(t,8),a=st(t,e-8).mul(n),o=st(t,e-16).mul(hn),i=Mt(r.add(s),43).add(Mt(a,30)).add(o),u=Pa(i,r.add(Mt(s.add(hn),18)).add(a),n),c=st(t,16).mul(n),l=st(t,24),d=i.add(st(t,e-32)).mul(n),p=u.add(st(t,e-24)).mul(n);return Pa(Mt(c.add(l),43).add(Mt(d,30)).add(p),c.add(Mt(l.add(r),18)).add(d),n)}function FF(t,e=t.length){const n=bo.fromNumber(81,!0);if(e<=32)return e<=16?OF(t,e):DF(t,e);if(e<=64)return PF(t,e);let r=n,s=n.mul(wo).add(113),a=ty(s.mul(hn).add(113)).mul(hn),o=[bo.UZERO,bo.UZERO],i=[bo.UZERO,bo.UZERO];r=r.mul(hn).add(st(t,0));let u=0;const c=(e-1>>6)*64,l=c+(e-1&63)-63;do r=Mt(r.add(s).add(o[0]).add(st(t,u+8)),37).mul(wo),s=Mt(s.add(o[1]).add(st(t,u+48)),42).mul(wo),r=r.xor(i[1]),s=s.add(o[0]).add(st(t,u+40)),a=Mt(a.add(i[0]),33).mul(wo),o=Nd(t,u,o[1].mul(wo),r.add(i[0])),i=Nd(t,u+32,a.add(i[1]),s.add(st(t,u+16))),[a,r]=[r,a],u+=64;while(u!==c);const d=wo.add(a.and(255).shl(1));return u=l,i[0]=i[0].add(e-1&63),o[0]=o[0].add(i[0]),i[0]=i[0].add(o[0]),r=Mt(r.add(s).add(o[0]).add(st(t,u+8)),37).mul(d),s=Mt(s.add(o[1]).add(st(t,u+48)),42).mul(d),r=r.xor(i[1].mul(9)),s=s.add(o[0].mul(9).add(st(t,u+40))),a=Mt(a.add(i[0]),33).mul(d),o=Nd(t,u,o[1].mul(d),r.add(i[0])),i=Nd(t,u+32,a.add(i[1]),s.add(st(t,u+16))),[a,r]=[r,a],Pa(Pa(o[0],i[0],d).add(ty(s).mul(D$)).add(a),Pa(o[1],i[1],d).add(r),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Du(t,e){return e==="string"?Oo(t):_h([t],e)}function LF(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function _h(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=Uo(t)),U().getBool("DEBUG")&&mF(t,e),LF(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let r=0;r<n.length;++r)Math.round(t[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${e}`)}function sr(){return U().platform.now()}function MF(t,e){return U().platform.fetch(t,e)}function Oo(t,e="utf-8"){return e=e||"utf-8",U().platform.encode(t,e)}function bu(t,e="utf-8"){return e=e||"utf-8",U().platform.decode(t,e)}function Lr(t){return U().platform.isTypedArray!=null?U().platform.isTypedArray(t):N$(t)}function Uo(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||Wo(t)||t==null||Lr(t)&&n)e.push(t);else if(Array.isArray(t)||Lr(t))for(let r=0;r<t.length;++r)Uo(t[r],e,n);else{let r=-1;for(const s of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(s)&&(r=Math.max(r,Number(s)));for(let s=0;s<=r;s++)Uo(t[s],e,n)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BF{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new zF)}profileKernel(e,n,r){let s;const a=()=>{s=r()};let o;const i=sr();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(a);else{a();for(const c of s)c.dataSync();o=Promise.resolve({kernelMs:sr()-i})}if(U().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<s.length;c++){const l=s[c];l.data().then(d=>{VF(d,l.dtype,e)})}return{kernelName:e,outputs:s,inputs:n,timeMs:o.then(c=>c.kernelMs),extraInfo:o.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:r,timeMs:s,inputs:a,extraInfo:o}=e;r.forEach(i=>{Promise.all([i.data(),s,o]).then(u=>{this.logger.logKernelProfile(n,i,u[0],u[1],a,u[2])})})}}function VF(t,e,n){if(e!=="float32")return!1;for(let r=0;r<t.length;r++){const s=t[r];if(isNaN(s)||!isFinite(s))return console.warn(`Found ${s} in the result of '${n}'`),!0}return!1}class zF{logKernelProfile(e,n,r,s,a,o){const i=typeof s=="number"?su(`${s}ms`,9):s.error,u=su(e,25),c=n.rank,l=n.size,d=su(n.shape.toString(),14);let p="";for(const f in a){const h=a[f];if(h!=null){const y=h.shape||n.shape,x=y.length;p+=`${f}: ${x}D ${x>0?y:""} `}}console.log(`%c${u}	%c${i}	%c${c}D ${d}	%c${l}	%c${p}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WF(t,e,n){const r={},s={};for(let u=0;u<e.length;u++)r[e[u].id]=!0;for(let u=0;u<t.length;u++){const c=t[u],l=c.inputs;for(const d in l){const p=l[d];let f=!1;for(let h=0;h<e.length;h++)if(r[p.id]){c.outputs.forEach(y=>r[y.id]=!0),f=!0,s[c.id]=!0;break}if(f)break}}const a={};a[n.id]=!0;const o={};for(let u=t.length-1;u>=0;u--){const c=t[u],l=c.inputs;for(let d=0;d<c.outputs.length;d++)if(a[c.outputs[d].id]){for(const p in l)a[l[p].id]=!0,o[c.id]=!0;break}}const i=[];for(let u=0;u<t.length;u++){const c=t[u];if(s[c.id]&&o[c.id]){const l={};for(const p in c.inputs){const f=c.inputs[p];r[f.id]&&(l[p]=f)}const d=Object.assign({},c);d.inputs=l,d.outputs=c.outputs,i.push(d)}}return i}function UF(t,e,n,r){for(let s=e.length-1;s>=0;s--){const a=e[s],o=[];if(a.outputs.forEach(u=>{const c=t[u.id];c!=null?o.push(c):o.push(null)}),a.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${a.kernelName}.`);const i=a.gradient(o);for(const u in a.inputs){if(!(u in i))throw new Error(`Cannot backprop through input ${u}. Available gradients found: ${Object.keys(i)}.`);const c=n(()=>i[u]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input ${u} must have 'float32' dtype, but has '${c.dtype}'`);const l=a.inputs[u];if(!yt(c.shape,l.shape))throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input '${u}' has shape '${c.shape}', which does not match the shape of the input '${l.shape}'`);if(t[l.id]==null)t[l.id]=c;else{const d=t[l.id];t[l.id]=r(d,c),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kb=20,fl=3,Em=7;function GF(t,e,n,r){const s=Ye(e),a=HF(t,e,n,s),o=e.length,i=Jd(t,e,n,s,a),u=["Tensor"];return r&&(u.push(`  dtype: ${n}`),u.push(`  rank: ${o}`),u.push(`  shape: [${e}]`),u.push("  values:")),u.push(i.map(c=>"    "+c).join(`
`)),u.join(`
`)}function HF(t,e,n,r){const s=K(e),a=r[r.length-1],o=new Array(a).fill(0),i=e.length,u=n==="complex64"?Cl(t):t;if(i>1)for(let c=0;c<s/a;c++){const l=c*a;for(let d=0;d<a;d++)o[d]=Math.max(o[d],Sl(u[l+d],0,n).length)}return o}function Sl(t,e,n){let r;return Array.isArray(t)?r=`${parseFloat(t[0].toFixed(Em))} + ${parseFloat(t[1].toFixed(Em))}j`:If(t)?r=`'${t}'`:n==="bool"?r=F$(t):r=parseFloat(t.toFixed(Em)).toString(),su(r,e)}function F$(t){return t===0?"false":"true"}function Jd(t,e,n,r,s,a=!0){const o=n==="complex64"?2:1,i=e[0],u=e.length;if(u===0){if(n==="complex64"){const y=Cl(t);return[Sl(y[0],0,n)]}return n==="bool"?[F$(t[0])]:[t[0].toString()]}if(u===1){if(i>kb){const x=fl*o;let g=Array.from(t.slice(0,x)),v=Array.from(t.slice((i-fl)*o,i*o));return n==="complex64"&&(g=Cl(g),v=Cl(v)),["["+g.map((w,S)=>Sl(w,s[S],n)).join(", ")+", ..., "+v.map((w,S)=>Sl(w,s[i-fl+S],n)).join(", ")+"]"]}return["["+(n==="complex64"?Cl(t):Array.from(t)).map((x,g)=>Sl(x,s[g],n)).join(", ")+"]"]}const c=e.slice(1),l=r.slice(1),d=r[0]*o,p=[];if(i>kb){for(let y=0;y<fl;y++){const x=y*d,g=x+d;p.push(...Jd(t.slice(x,g),c,n,l,s,!1))}p.push("...");for(let y=i-fl;y<i;y++){const x=y*d,g=x+d;p.push(...Jd(t.slice(x,g),c,n,l,s,y===i-1))}}else for(let y=0;y<i;y++){const x=y*d,g=x+d;p.push(...Jd(t.slice(x,g),c,n,l,s,y===i-1))}const f=u===2?",":"";p[0]="["+(i>0?p[0]+f:"");for(let y=1;y<p.length-1;y++)p[y]=" "+p[y]+f;let h=`,
`;for(let y=2;y<u;y++)h+=`
`;return p[p.length-1]=" "+p[p.length-1]+"]"+(a?"":h),p}function Cl(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Su{constructor(e,n,r){if(this.dtype=n,this.shape=e.slice(),this.size=K(e),r!=null){const s=r.length;E(s===this.size,()=>`Length of values '${s}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Vt(n,this.size),this.strides=Ye(e)}set(e,...n){n.length===0&&(n=[0]),E(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const s of e){if(s<0||s>=this.shape[n]){const a=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(a)}n++}let r=e[e.length-1];for(let s=0;s<e.length-1;++s)r+=this.strides[s]*e[s];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return Qr().makeTensor(this.values,this.shape,this.dtype)}}let Qr=null,Pi=null;function jF(t){Qr=t}function KF(t){Pi=t}class Rt{constructor(e,n,r,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=K(e),this.strides=Ye(e),this.dataId=r,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Pi.buffer(this.shape,this.dtype,e)}bufferSync(){return Pi.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Yg(this.shape,e,this.dtype==="complex64")}arraySync(){return Yg(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Qr().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(r=>bu(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Qr().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Qr().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>bu(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Qr().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Qr().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Pi.print(this,e)}clone(){return this.throwIfDisposed(),Pi.clone(this)}toString(e=!1){const n=this.dataSync();return GF(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Pi.cast(this,e)}variable(e=!0,n,r){return this.throwIfDisposed(),Qr().makeVariable(this,e,n,r)}}Object.defineProperty(Rt,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function L$(){return X0("Tensor",()=>Rt)}L$();class Pp extends Rt{constructor(e,n,r,s){super(e.shape,e.dtype,e.dataId,s),this.trainable=n,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!yt(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Qr().disposeTensor(this),this.dataId=e.dataId,Qr().incRef(this,null)}dispose(){Qr().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Pp,Symbol.hasInstance,{value:t=>t instanceof Rt&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Eb;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(Eb||(Eb={}));var ny;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(ny||(ny={}));var ry;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(ry||(ry={}));var sy;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(sy||(sy={}));var ay;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(ay||(ay={}));const qF={float32:sy,int32:ny,bool:ry,complex64:ay};function Ts(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return qF[t][e]}function Ov(t){return Ts(t,"int32")}function M$(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function B$(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ct(t,e){if(t.dtype===e.dtype)return[t,e];const n=Ts(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function XF(t,e){E(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function V$(t){const e=[];return z$(t,e,new Set),e}function z$(t,e,n){if(t==null)return;if(t instanceof Rt){e.push(t);return}if(!YF(t))return;const r=t;for(const s in r){const a=r[s];n.has(a)||(n.add(a),z$(a,e,n))}}function YF(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tm(t){return t.kernelName!=null}class Tb{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Cu{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Tb}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,r=1){return e in this.registryFactory?(Jr(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(e);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new BF(this.backendInstance),!0}setupRegisteredKernels(){bb(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){bb(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof j0)&&typeof r.then=="function"){const s=++this.pendingBackendInitId,a=r.then(o=>s<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,Jr(`Initialization of backend ${e} failed`),Jr(o.stack||o.message)),!1));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return Jr(`Initialization of backend ${e} failed`),Jr(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n],{success:s,asyncInit:a}=this.initializeBackend(r);if(a||s)return{name:r,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const r=this.state.tensorInfo.get(n),s=r.backend,a=this.readSync(n),o=s.refCount(n);s.disposeData(n,!0),r.backend=e,e.move(n,a,r.shape,r.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let r=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let s;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(s),()=>(s=n(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,n,r){e();try{const s=r();return n(),s}catch(s){throw n(),s}}nextTensorId(){return Cu.nextTensorId++}nextVariableId(){return Cu.nextVariableId++}clone(e){const n=M.runKernel(Kf,{x:e}),r={x:e},s=o=>({x:()=>{const i="float32",u={x:o},c={dtype:i};return M.runKernel(Af,u,c)}}),a=[];return this.addTapeNode(this.state.activeScope.name,r,[n],s,a,{}),n}runKernel(e,n,r){if(this.backendName==null&&this.backend,!(Jg(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,r){const s=this.backend.numDataIds();let a=0;r.forEach(u=>{a+=u.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],i=s-n-a-o;if(i>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${i} data ids) after running '${e}'`)}runKernelFunc(e){let n,r=[];const s=this.isTapeOn(),a=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let i;this.backendName==null&&this.backend;let u;const c=Tm(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(Tm(e)){const{kernelName:h,inputs:y,attrs:x}=e;this.backendName==null&&this.backend;const g=Jg(h,this.backendName);E(g!=null,()=>`Cannot find registered kernel '${h}' for backend '${this.backendName}'`),i=()=>{const v=this.backend.numDataIds();u=g.kernelFunc({inputs:y,attrs:x,backend:this.backend});const w=Array.isArray(u)?u:[u];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(h,v,w);const S=w.map($=>$.rank!=null?$:this.makeTensorFromTensorInfo($));if(s){const $=this.getTensorsForGradient(h,y,S);r=this.saveTensorsForBackwardMode($)}return S}}else{const{forwardFunc:h}=e,y=x=>{s&&(r=x.map(g=>this.keep(this.clone(g))))};i=()=>{const x=this.backend.numDataIds();u=this.tidy(()=>h(this.backend,y));const g=Array.isArray(u)?u:[u];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,x,g),g}}const{inputs:l,attrs:d}=e,p=Tm(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=i():(f=this.profiler.profileKernel(c,l,()=>i()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),s&&this.addTapeNode(c,l,n,p,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(l).map(h=>l[h]!=null?l[h].shape:null),outputShapes:n.map(h=>h.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(u)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,n,r){const s=wb(e);if(s!=null){const a=s.inputsToSave||[],o=s.outputsToSave||[];let i;s.saveAllInputs?(E(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),i=Object.keys(n).map(c=>n[c])):i=a.map(c=>n[c]);const u=r.filter((c,l)=>o[l]);return i.concat(u)}return[]}makeTensor(e,n,r,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",s=s||this.backend;let a=e;r==="string"&&If(e[0])&&(a=e.map(u=>Oo(u)));const o=s.write(a,n,r),i=new Rt(n,r,o,this.nextTensorId());if(this.trackTensor(i,s),r==="string"){const u=this.state.tensorInfo.get(o),c=xF(a);this.state.numBytes+=c-u.bytes,u.bytes=c}return i}makeTensorFromDataId(e,n,r,s){r=r||"float32";const a={dataId:e,shape:n,dtype:r};return this.makeTensorFromTensorInfo(a,s)}makeTensorFromTensorInfo(e,n){const{dataId:r,shape:s,dtype:a}=e,o=new Rt(s,a,r,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(e,n=!0,r,s){r=r||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));const a=new Pp(e,n,r,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error(`Variable with name ${a.name} was already registered`);return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*vu(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof Pp||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*vu(e.dtype);this.state.numBytes-=r}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const s of this.state.activeProfile.kernels)s.kernelTimeMs=await s.kernelTimeMs,s.extraInfo=await s.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,r,s,a,o){const i={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:a},u=wb(e);u!=null&&(s=u.gradFunc),s!=null&&(i.gradient=c=>(c=c.map((l,d)=>{if(l==null){const p=r[d],f=Ga(p.size,p.dtype);return this.makeTensor(f,p.shape,p.dtype)}return l}),s(c.length>1?c:c[0],a,o))),this.state.activeTape.push(i)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=V$(e),r=new Set(n.map(a=>a.id));for(let a=0;a<this.state.activeScope.track.length;a++){const o=this.state.activeScope.track[a];!o.kept&&!r.has(o.id)&&o.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(a=>{!a.kept&&a.scopeId===s.id&&this.track(a)})}gradients(e,n,r,s=!1){if(E(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));E(a instanceof Rt,()=>"The result y returned by f() must be a tensor.");const o=WF(this.state.activeTape,n,a);if(!s&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const i={};i[a.id]=r??QF(a.shape),UF(i,o,c=>this.tidy(c),ZF);const u=n.map(c=>i[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const l of c.saved)l.dispose()}),this.state.activeTape=null),{value:a,grads:u}})}customGrad(e){return E(qg(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{E(n.every(i=>i instanceof Rt),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const s={};n.forEach((i,u)=>{s[u]=i});const a=(i,u)=>(r=e(...n,u),E(r.value instanceof Rt,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),E(qg(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),o=(i,u)=>{const c=r.gradFunc(i,u),l=Array.isArray(c)?c:[c];E(l.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),E(l.every(p=>p instanceof Rt),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return l.forEach((p,f)=>{d[f]=()=>p}),d};return this.runKernelFunc({forwardFunc:a,backwardsFunc:o,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=sr(),r=await this.backend.time(e);return r.wallMs=sr()-n,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Tb;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Cu.nextTensorId=0;Cu.nextVariableId=0;function QF(t){const e=e$(K(t),"float32");return M.makeTensor(e,t,"float32")}function W$(){const t=n$();if(t._tfengine==null){const e=new bF(t);t._tfengine=new Cu(e)}return $F(t._tfengine.ENV),jF(()=>t._tfengine),t._tfengine}const M=W$();function ZF(t,e){const n={a:t,b:e};return M.runKernel($f,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JF(){return typeof navigator<"u"&&navigator!=null}function U$(t){if(t||JF()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function G$(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kn=U();kn.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});kn.registerFlag("IS_BROWSER",()=>G$());kn.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");kn.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));kn.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));kn.registerFlag("PROD",()=>!1);kn.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>kn.getBool("DEBUG"));kn.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);kn.registerFlag("IS_TEST",()=>!1);kn.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>kn.getBool("DEBUG"));kn.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);kn.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);kn.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Za(t,e){let n=t;if(Lr(t))return e==="string"?[]:[t.length];if(M$(t)){const s=t.channels||"RGBA";return[t.height,t.width*s.length]}else if(B$(t))return[t.buffer.size/(e==null?4:vu(e))];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||Lr(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&U().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&H$(t,r,[]),r}function H$(t,e,n){if(n=n||[],!Array.isArray(t)&&!Lr(t)){E(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}E(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),E(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const r=e.slice(1);for(let s=0;s<t.length;++s)H$(t[s],r,n.concat(s))}function Rb(t,e,n,r){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function N(t,e,n,r="numeric"){if(t instanceof L$())return Rb(r,t.dtype,e,n),t;let s=Ou(t);if(s!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(s=r),Rb(r,s,e,n),t==null||!Lr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const u=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${u}'`)}const a=Za(t,s);!Lr(t)&&!Array.isArray(t)&&(t=[t]);const i=s!=="string"?_h(t,s):Uo(t,[],!0);return M.makeTensor(i,a,s)}function Fp(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((a,o)=>N(a,`${e}[${o}]`,n,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j$="__op";function F(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+j$;const s=(...a)=>{M.startScope(n);try{const o=r(...a);return Wo(o)&&console.error("Cannot return a Promise inside of tidy."),M.endScope(o),o}catch(o){throw M.endScope(null),o}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e3(t,e){const n=N(t,"real","complex"),r=N(e,"imag","complex");Yn(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const s={real:n,imag:r};return M.runKernel(a$,s)}const Ha=F({complex_:e3});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ja(t,e,n,r){if(r==null)r=Ou(t);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(B$(t)||M$(t)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return M.backend.createTensorFromGPUData(t,e||n,r)}if(!Lr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){hr(e);const s=K(e),a=K(n);E(s===a,()=>`Based on the provided shape, [${e}], the tensor should have ${s} values but has ${a}`);for(let o=0;o<n.length;++o){const i=n[o],u=o===n.length-1?i!==K(e.slice(o)):!0;E(n[o]===e[o]||!u,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!Lr(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=r!=="string"?_h(t,r):Uo(t,[],!0),M.makeTensor(t,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ns(t,e,n){const r=Za(t,n);return Ja(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Go={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class ds{static join(e){return new ds(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(r=>Lr(r)?r.buffer:r),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let r=0;r<e.length;r++){const s=e[r];r!==e.length-1&&s.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const a=n+s.byteLength;this.shards.push({buffer:s,start:n,end:a}),n=a}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const r=this.findShardForByte(e);if(r===-1)throw new Error(`Could not find start shard for byte ${e}`);const s=n-e,a=new ArrayBuffer(s),o=new Uint8Array(a);let i=0;for(let u=r;u<this.shards.length;u++){const c=this.shards[u],d=e+i-c.start,p=i,h=Math.min(n,c.end)-c.start,y=new Uint8Array(c.buffer,d,h-d);if(o.set(y,p),i+=y.length,n<c.end)break}return a}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(s){return e<s.start?-1:e>=s.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=t3(this.shards,n);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function t3(t,e){let n=0,r=t.length;for(;n<=r;){const s=Math.floor((r-n)/2)+n,a=e(t[s]);if(a===0)return s;a<0?r=s:n=s+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vs(){return M}function De(t,e){return M.tidy(t,e)}function ht(t){V$(t).forEach(n=>n.dispose())}function Cs(t){return M.keep(t)}function n3(t){return M.setBackend(t)}function r3(){return M.backendName}function s3(t){M.removeBackend(t)}function a3(t){return M.findBackendFactory(t)}function Dv(t,e,n=1){return M.registerBackend(t,e,n)}function o3(){return M.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ja=4;async function i3(t,e){const n=[],r=[],s=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);for(let o=0;o<s.length;++o){const i=s[o],u=Array.isArray(t)?t[o].tensor:t[i];if(u.dtype!=="float32"&&u.dtype!=="int32"&&u.dtype!=="bool"&&u.dtype!=="string"&&u.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${i}': ${u.dtype}`);const c={name:i,shape:u.shape,dtype:u.dtype};if(u.dtype==="string"){const l=new Promise(async d=>{const p=await u.bytes(),f=p.reduce((x,g)=>x+g.length,0)+ja*p.length,h=new Uint8Array(f);let y=0;for(let x=0;x<p.length;x++){const g=p[x],v=new Uint8Array(new Uint32Array([g.length]).buffer);h.set(v,y),y+=ja,h.set(g,y),y+=g.length}d(h)});r.push(l)}else r.push(u.data());e!=null&&(c.group=e),n.push(c)}const a=await Promise.all(r);return{data:c3(a),specs:n}}function K$(t,e){const n=new ds(t),r={};let s=0;for(const a of e){const o=u3(a,(i,u)=>n.slice(s+i,s+u));r[a.name]=q$(a,n.slice(s,s+o)),s+=o}return r}function u3(t,e){const n=K(t.shape);let r;if("quantization"in t){const s=t.quantization;r=Go[s.dtype]}else if(t.dtype==="string"){let s=0;for(let a=0;a<n;a++)s+=ja+new Uint32Array(e(s,s+ja))[0];return s}else r=Go[t.dtype];return n*r}async function l3(t,e){const n=K(t.shape);let r;if("quantization"in t){const s=t.quantization;r=Go[s.dtype]}else if(t.dtype==="string"){let s=0;for(let a=0;a<n;a++)s+=ja+new Uint32Array(await e(s,s+ja))[0];return s}else r=Go[t.dtype];return n*r}function q$(t,e){const n=t.name,r=t.dtype,s=t.shape,a=K(s);let o,i=0;if("quantization"in t){const u=t.quantization;if(u.dtype==="uint8"||u.dtype==="uint16"){if(!("min"in u&&"scale"in u))throw new Error(`Weight ${t.name} with quantization ${u.dtype} doesn't have corresponding metadata min and scale.`)}else if(u.dtype==="float16"){if(r!=="float32")throw new Error(`Weight ${t.name} is quantized with ${u.dtype} which only supports weights of type float32 not ${r}.`)}else throw new Error(`Weight ${t.name} has unknown quantization dtype ${u.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const c=Go[u.dtype],l=u.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(r==="float32")if(u.dtype==="uint8"||u.dtype==="uint16"){o=new Float32Array(l.length);for(let d=0;d<l.length;d++){const p=l[d];o[d]=p*u.scale+u.min}}else if(u.dtype==="float16")o=y3()(l);else throw new Error(`Unsupported quantization type ${u.dtype} for weight type float32.`);else if(r==="int32"){if(u.dtype!=="uint8"&&u.dtype!=="uint16")throw new Error(`Unsupported quantization type ${u.dtype} for weight type int32.`);o=new Int32Array(l.length);for(let d=0;d<l.length;d++){const p=l[d];o[d]=Math.round(p*u.scale+u.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);i+=a*c}else if(r==="string"){const u=K(t.shape);o=[];for(let c=0;c<u;c++){const l=new Uint32Array(e.slice(i,i+ja))[0];i+=ja;const d=new Uint8Array(e.slice(i,i+l));o.push(d),i+=l}}else{const u=Go[r];if(r==="float32")o=new Float32Array(e);else if(r==="int32")o=new Int32Array(e);else if(r==="bool")o=new Uint8Array(e);else if(r==="complex64"){o=new Float32Array(e);const c=new Float32Array(o.length/2),l=new Float32Array(o.length/2);for(let h=0;h<c.length;h++)c[h]=o[h*2],l[h]=o[h*2+1];const d=ns(c,s,"float32"),p=ns(l,s,"float32"),f=Ha(d,p);return d.dispose(),p.dispose(),f}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);i+=a*u}return ns(o,s,r)}async function Ab(t,e,n){let r=new Uint8Array(e);for(;r.byteLength<n;){const{done:s,value:a}=await t.read();if(s&&a==null){const i=n-r.byteLength;throw new Error(`Reader is done but ${i} bytes are still expected`)}const o=new Uint8Array(r.length+a.byteLength);o.set(r,0),o.set(new Uint8Array(a),r.length),r=o}return r.buffer}async function X$(t,e){const n={},r=t.getReader();let s=new ArrayBuffer(0);for(const a of e){const o=await l3(a,async(c,l)=>(s=await Ab(r,s,l),s.slice(c,l)));s=await Ab(r,s,o);const i=s.slice(0,o);s=s.slice(o);const u=q$(a,i);if(n[a.name]=u,r3()==="webgpu"){const c=o3();"uploadToGPU"in c&&K(u.shape)>=U().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&c.uploadToGPU(u.dataId)}}return n}function c3(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(a=>{if(e+=a.byteLength,n.push(a.byteLength===a.buffer.byteLength?a:new a.constructor(a)),!(a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${a.constructor.name}`)});const r=new Uint8Array(e);let s=0;return n.forEach(a=>{r.set(new Uint8Array(a.buffer),s),s+=a.byteLength}),r.buffer}const Pv=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function Ob(t){return Pv?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function d3(t){if(Pv)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,s=e.length;r<s;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function p3(t){if(Pv){const r=Buffer.from(t,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function f3(t){return ds.join(t)}function Db(t){const e="/";for(t=t.trim();t.endsWith(e);)t=t.slice(0,t.length-1);const n=t.split(e);return n[n.length-1]}function Y$(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function Q$(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(r.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return t.signature!=null&&(r.signature=t.signature),t.userDefinedMetadata!=null&&(r.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(r.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(r.initializerSignature=t.initializerSignature),r}async function Fv(t,e){let n,r;return t.weightsManifest!=null&&([n,r]=await e(t.weightsManifest)),Q$(t,n,r)}function Oc(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:Ob(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:Ob(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new ds(t.weightData).byteLength}}function oy(t){const e=[];for(const n of t)e.push(...n.weights);return e}function h3(){const t=n=>{let r=n<<13,s=0;for(;!(r&8388608);)s-=8388608,r<<=1;return r&=-8388609,s+=947912704,r|s},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function m3(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function g3(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function y3(){const t=h3(),e=m3(),n=g3();return r=>{const s=new ArrayBuffer(4*r.length),a=new Uint32Array(s);for(let o=0;o<r.length;o++){const i=r[o],u=t[n[i>>10]+(i&1023)]+e[i>>10];a[o]=u}return new Float32Array(s)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ft{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return ft.instance==null&&(ft.instance=new ft),ft.instance}static registerSaveRouter(e){ft.getInstance().saveRouters.push(e)}static registerLoadRouter(e){ft.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return ft.getHandlers(e,"save")}static getLoadHandlers(e,n){return ft.getHandlers(e,"load",n)}static getHandlers(e,n,r){const s=[];return(n==="load"?ft.getInstance().loadRouters:ft.getInstance().saveRouters).forEach(o=>{const i=o(e,r);i!==null&&s.push(i)}),s}}const x3=t=>ft.registerSaveRouter(t),v3=t=>ft.registerLoadRouter(t),w3=t=>ft.getSaveHandlers(t),b3=(t,e)=>ft.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iy="tensorflowjs",uy=1,Eo="models_store",$a="model_info_store";function Z$(){if(!U().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function ly(t){const e=t.result;e.createObjectStore(Eo,{keyPath:"modelPath"}),e.createObjectStore($a,{keyPath:"modelPath"})}class Ho{constructor(e){if(this.indexedDB=Z$(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((r,s)=>{const a=this.indexedDB.open(iy,uy);a.onupgradeneeded=()=>ly(a),a.onsuccess=()=>{const o=a.result;if(n==null){const i=o.transaction(Eo,"readonly"),c=i.objectStore(Eo).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return o.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(c.result.modelArtifacts)},c.onerror=l=>(o.close(),s(c.error)),i.oncomplete=()=>o.close()}else{n.weightData=ds.join(n.weightData);const i=Oc(n),u=o.transaction($a,"readwrite");let c=u.objectStore($a),l;try{l=c.put({modelPath:this.modelPath,modelArtifactsInfo:i})}catch(p){return s(p)}let d;l.onsuccess=()=>{d=o.transaction(Eo,"readwrite");const p=d.objectStore(Eo);let f;try{f=p.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:i})}catch(h){return s(h)}f.onsuccess=()=>r({modelArtifactsInfo:i}),f.onerror=h=>{c=u.objectStore($a);const y=c.delete(this.modelPath);y.onsuccess=()=>(o.close(),s(f.error)),y.onerror=x=>(o.close(),s(f.error))}},l.onerror=p=>(o.close(),s(l.error)),u.oncomplete=()=>{d==null?o.close():d.oncomplete=()=>o.close()}}},a.onerror=o=>s(a.error)})}}Ho.URL_SCHEME="indexeddb://";const J$=t=>U().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Ho.URL_SCHEME)?S3(t.slice(Ho.URL_SCHEME.length)):null;ft.registerSaveRouter(J$);ft.registerLoadRouter(J$);function S3(t){return new Ho(t)}function C3(t){return t.startsWith(Ho.URL_SCHEME)?t.slice(Ho.URL_SCHEME.length):t}class I3{constructor(){this.indexedDB=Z$()}async listModels(){return new Promise((e,n)=>{const r=this.indexedDB.open(iy,uy);r.onupgradeneeded=()=>ly(r),r.onsuccess=()=>{const s=r.result,a=s.transaction($a,"readonly"),i=a.objectStore($a).getAll();i.onsuccess=()=>{const u={};for(const c of i.result)u[c.modelPath]=c.modelArtifactsInfo;e(u)},i.onerror=u=>(s.close(),n(i.error)),a.oncomplete=()=>s.close()},r.onerror=s=>n(r.error)})}async removeModel(e){return e=C3(e),new Promise((n,r)=>{const s=this.indexedDB.open(iy,uy);s.onupgradeneeded=()=>ly(s),s.onsuccess=()=>{const a=s.result,o=a.transaction($a,"readwrite"),i=o.objectStore($a),u=i.get(e);let c;u.onsuccess=()=>{if(u.result==null)return a.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const l=i.delete(e),d=()=>{c=a.transaction(Eo,"readwrite");const f=c.objectStore(Eo).delete(e);f.onsuccess=()=>n(u.result.modelArtifactsInfo),f.onerror=h=>r(u.error)};l.onsuccess=d,l.onerror=p=>(d(),a.close(),r(u.error))}},u.onerror=l=>(a.close(),r(u.error)),o.oncomplete=()=>{c==null?a.close():c.oncomplete=()=>a.close()}},s.onerror=a=>r(s.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ws="/",Fi="tensorflowjs_models",e_="info",$3="model_topology",_3="weight_specs",N3="weight_data",k3="model_metadata";function t_(t){return{info:[Fi,t,e_].join(Ws),topology:[Fi,t,$3].join(Ws),weightSpecs:[Fi,t,_3].join(Ws),weightData:[Fi,t,N3].join(Ws),modelMetadata:[Fi,t,k3].join(Ws)}}function n_(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function E3(t){const e=t.split(Ws);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(Ws)}function T3(t){return t.startsWith(jo.URL_SCHEME)?t.slice(jo.URL_SCHEME.length):t}class jo{constructor(e){if(!U().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=t_(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),s=Oc(e),a=ds.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,d3(a));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:s}}catch{throw n_(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=s;const a=this.LS.getItem(this.keys.modelMetadata);if(a!=null){const i=JSON.parse(a);n.format=i.format,n.generatedBy=i.generatedBy,n.convertedBy=i.convertedBy,i.signature!=null&&(n.signature=i.signature),i.userDefinedMetadata!=null&&(n.userDefinedMetadata=i.userDefinedMetadata),i.modelInitializer!=null&&(n.modelInitializer=i.modelInitializer),i.initializerSignature!=null&&(n.initializerSignature=i.initializerSignature),i.trainingConfig!=null&&(n.trainingConfig=i.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=p3(o),n}}jo.URL_SCHEME="localstorage://";const r_=t=>U().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(jo.URL_SCHEME)?R3(t.slice(jo.URL_SCHEME.length)):null;ft.registerSaveRouter(r_);ft.registerLoadRouter(r_);function R3(t){return new jo(t)}class A3{constructor(){E(U().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),E(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=Fi+Ws,r=Ws+e_;for(let s=0;s<this.LS.length;++s){const a=this.LS.key(s);if(a.startsWith(n)&&a.endsWith(r)){const o=E3(a);e[o]=JSON.parse(this.LS.getItem(a))}}return e}async removeModel(e){e=T3(e);const n=t_(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return n_(n),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ou="://";class pn{constructor(){this.managers={}}static getInstance(){return pn.instance==null&&(pn.instance=new pn),pn.instance}static registerManager(e,n){E(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(ou)&&(e=e.slice(0,e.indexOf(ou))),E(e.length>0,()=>"scheme must not be an empty string.");const r=pn.getInstance();E(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=n}static getManager(e){const n=pn.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(pn.getInstance().managers)}}function ep(t){if(t.indexOf(ou)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${pn.getSchemes().join(",")}`);return{scheme:t.split(ou)[0],path:t.split(ou)[1]}}async function s_(t,e,n=!1){E(t!==e,()=>`Old path and new path are the same: '${t}'`);const r=ft.getLoadHandlers(t);E(r.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),E(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${t}.`);const s=r[0],a=ft.getSaveHandlers(e);E(a.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),E(a.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${e}.`);const o=a[0],i=ep(t).scheme,u=ep(t).path,c=i===ep(t).scheme,l=await s.load();n&&c&&await pn.getManager(i).removeModel(u);const d=await o.save(l);return n&&!c&&await pn.getManager(i).removeModel(u),d.modelArtifactsInfo}async function O3(){const t=pn.getSchemes(),e={};for(const n of t){const r=await pn.getManager(n).listModels();for(const s in r){const a=n+ou+s;e[a]=r[s]}}return e}async function D3(t){const e=ep(t);return pn.getManager(e.scheme).removeModel(e.path)}async function P3(t,e){return s_(t,e,!1)}async function F3(t,e){return s_(t,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class L3{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!U().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const s=this.functionRefs[r.data.index];s(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return N$(e)}}if(U().get("IS_BROWSER")){U().setPlatform("browser",new L3);try{pn.registerManager(jo.URL_SCHEME,new A3)}catch{}try{pn.registerManager(Ho.URL_SCHEME,new I3)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M3={importFetch:()=>require("node-fetch")};let Rm;class B3{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return U().global.fetch!=null?U().global.fetch(e,n):(Rm==null&&(Rm=M3.importFetch()),Rm(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}U().get("IS_NODE")&&!U().get("IS_BROWSER")&&U().setPlatform("node",new B3);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xt(t,e="float32",n){return e=e||"float32",hr(t),new Su(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V3(t,e){const n=N(t,"x","cast");if(!gF(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},s={dtype:e};return M.runKernel(Af,r,s)}const gt=F({cast_:V3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z3(t){const n={x:N(t,"x","clone","string_or_numeric")};return M.runKernel(Kf,n)}const Fa=F({clone_:z3});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a_(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */W$();const W3={buffer:xt,cast:gt,clone:Fa,print:a_};KF(W3);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U3(t,e){let n=N(t,"a","add"),r=N(e,"b","add");[n,r]=Ct(n,r);const s={a:n,b:r};return M.runKernel($f,s)}const be=F({add_:U3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G3(t,e){let n=N(t,"a","floorDiv"),r=N(e,"b","floorDiv");[n,r]=Ct(n,r);const s={a:n,b:r};return M.runKernel(Nx,s)}const o_=F({floorDiv_:G3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H3(t,e){let n=N(t,"a","div"),r=N(e,"b","div");if([n,r]=Ct(n,r),n.dtype==="int32"&&r.dtype==="int32")return o_(n,r);const s={a:n,b:r},a={};return M.runKernel(yx,s,a)}const Fe=F({div_:H3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j3(t,e){let n=N(t,"a","mul"),r=N(e,"b","mul");[n,r]=Ct(n,r);const s={a:n,b:r};return M.runKernel(Kx,s)}const ae=F({mul_:j3});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K3(t){const e=N(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return M.runKernel(o$,n)}else{const n={x:e};return M.runKernel(Y0,n)}}const nr=F({abs_:K3});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q3(t){const n={x:N(t,"x","acos")};return M.runKernel(Q0,n)}const X3=F({acos_:q3});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y3(t){const n={x:N(t,"x","acosh")};return M.runKernel(Z0,n)}const Q3=F({acosh_:Y3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z3(t){E(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),E(t.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`);const e=t.map((s,a)=>N(s,`tensors${a}`,"addN")),n=e[0];e.forEach(s=>{if(s.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(s=>{if(!yt(s.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=e;return M.runKernel(_f,r)}const J3=F({addN_:Z3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eL(t,e=null,n=!1){const s={x:N(t,"x","all","bool")},a={axis:e,keepDims:n};return M.runKernel(Nf,s,a)}const tL=F({all_:eL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nL(t,e=null,n=!1){const s={x:N(t,"x","any","bool")},a={axis:e,keepDims:n};return M.runKernel(kf,s,a)}const rL=F({any_:nL});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sL(t,e=0){const r={x:N(t,"x","argMax")},s={axis:e};return M.runKernel(J0,r,s)}const aL=F({argMax_:sL});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oL(t,e=0){const r={x:N(t,"x","argMin")},s={axis:e};return M.runKernel(ex,r,s)}const iL=F({argMin_:oL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uL(t){const n={x:N(t,"x","asin")};return M.runKernel(tx,n)}const lL=F({asin_:uL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cL(t){const n={x:N(t,"x","asinh")};return M.runKernel(nx,n)}const dL=F({asinh_:cL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pL(t){const n={x:N(t,"x","atan")};return M.runKernel(rx,n)}const fL=F({atan_:pL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hL(t,e){let n=N(t,"a","atan2"),r=N(e,"b","atan2");[n,r]=Ct(n,r);const s={a:n,b:r};return M.runKernel(ax,s)}const mL=F({atan2_:hL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gL(t){const n={x:N(t,"x","atanh")};return M.runKernel(sx,n)}const yL=F({atanh_:gL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dc(t,e,n,r,s="NHWC",a){const o=t[3],i=[...e,o],u=to(s);return qt(t,i,n,a,r,null,null,u)}function Mr(t,e,n,r,s,a,o="channelsLast"){const[i,u]=lc(e);let c;if(o==="channelsLast")c=[i,u,t[3],t[3]];else if(o==="channelsFirst")c=[i,u,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return qt(t,c,n,r,s,a,!1,o)}function aa(t,e,n,r,s,a,o="NDHWC"){const[i,u,c]=cy(e);let l,d;if(o==="NDHWC")d="channelsLast",l=[i,u,c,t[4],t[4]];else if(o==="NCDHW")d="channelsFirst",l=[i,u,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return eo(t,l,n,r,s,!1,d,a)}function qt(t,e,n,r,s,a,o=!1,i="channelsLast"){let[u,c,l,d]=[-1,-1,-1,-1];if(i==="channelsLast")[u,c,l,d]=t;else if(i==="channelsFirst")[u,d,c,l]=t;else throw new Error(`Unknown dataFormat ${i}`);const[p,f,,h]=e,[y,x]=lc(n),[g,v]=lc(r),w=iu(p,g),S=iu(f,v),{padInfo:$,outHeight:k,outWidth:T}=wL(s,c,l,y,x,w,S,a,i),A=o?h*d:h;let B;return i==="channelsFirst"?B=[u,A,k,T]:i==="channelsLast"&&(B=[u,k,T,A]),{batchSize:u,dataFormat:i,inHeight:c,inWidth:l,inChannels:d,outHeight:k,outWidth:T,outChannels:A,padInfo:$,strideHeight:y,strideWidth:x,filterHeight:p,filterWidth:f,effectiveFilterHeight:w,effectiveFilterWidth:S,dilationHeight:g,dilationWidth:v,inShape:t,outShape:B,filterShape:e}}function eo(t,e,n,r,s,a=!1,o="channelsLast",i){let[u,c,l,d,p]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[u,c,l,d,p]=t;else if(o==="channelsFirst")[u,p,c,l,d]=t;else throw new Error(`Unknown dataFormat ${o}`);const[f,h,y,,x]=e,[g,v,w]=cy(n),[S,$,k]=cy(r),T=iu(f,S),A=iu(h,$),B=iu(y,k),{padInfo:L,outDepth:z,outHeight:Y,outWidth:Q}=bL(s,c,l,d,g,v,w,T,A,B,i),re=a?x*p:x;let Z;return o==="channelsFirst"?Z=[u,re,z,Y,Q]:o==="channelsLast"&&(Z=[u,z,Y,Q,re]),{batchSize:u,dataFormat:o,inDepth:c,inHeight:l,inWidth:d,inChannels:p,outDepth:z,outHeight:Y,outWidth:Q,outChannels:re,padInfo:L,strideDepth:g,strideHeight:v,strideWidth:w,filterDepth:f,filterHeight:h,filterWidth:y,effectiveFilterDepth:T,effectiveFilterHeight:A,effectiveFilterWidth:B,dilationDepth:S,dilationHeight:$,dilationWidth:k,inShape:t,outShape:Z,filterShape:e}}function xL(t,e,n,r,s){r==null&&(r=Lv(t,e,n));const a=t[0],o=t[1],i=cc((a-e+2*r)/n+1,s),u=cc((o-e+2*r)/n+1,s);return[i,u]}function vL(t,e,n,r,s,a){s==null&&(s=Lv(t,e[0],r[0]));const o=[0,0,0,n];for(let i=0;i<3;i++)t[i]+2*s>=e[i]&&(o[i]=cc((t[i]-e[i]+2*s)/r[i]+1,a));return o}function Lv(t,e,n,r=1){const s=iu(e,r);return Math.floor((t[0]*(n-1)-n+s)/2)}function lc(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function cy(t){return typeof t=="number"?[t,t,t]:t}function iu(t,e){return e<=1?t:t+(t-1)*(e-1)}function wL(t,e,n,r,s,a,o,i,u){let c,l,d;if(typeof t=="number"){c={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const f=xL([e,n],a,r,t,i);l=f[0],d=f[1]}else if(t==="same"){l=Math.ceil(e/r),d=Math.ceil(n/s);const p=Math.max(0,(l-1)*r+a-e),f=Math.max(0,(d-1)*s+o-n),h=Math.floor(p/2),y=p-h,x=Math.floor(f/2),g=f-x;c={top:h,bottom:y,left:x,right:g,type:"SAME"}}else if(t==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((e-a+1)/r),d=Math.ceil((n-o+1)/s);else if(typeof t=="object"){const p=u==="channelsLast"?t[1][0]:t[2][0],f=u==="channelsLast"?t[1][1]:t[2][1],h=u==="channelsLast"?t[2][0]:t[3][0],y=u==="channelsLast"?t[2][1]:t[3][1];c={top:p,bottom:f,left:h,right:y,type:p===0&&f===0&&h===0&&y===0?"VALID":"EXPLICIT"},l=cc((e-a+p+f)/r+1,i),d=cc((n-o+h+y)/s+1,i)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:c,outHeight:l,outWidth:d}}function bL(t,e,n,r,s,a,o,i,u,c,l){let d,p,f,h;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const x=vL([e,n,r,1],[i,u,c],1,[s,a,o],t,l);p=x[0],f=x[1],h=x[2]}else if(t==="same"){p=Math.ceil(e/s),f=Math.ceil(n/a),h=Math.ceil(r/o);const y=(p-1)*s+i-e,x=(f-1)*a+u-n,g=(h-1)*o+c-r,v=Math.floor(y/2),w=y-v,S=Math.floor(x/2),$=x-S,k=Math.floor(g/2),T=g-k;d={top:S,bottom:$,left:k,right:T,front:v,back:w,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:p,outHeight:f,outWidth:h}}function cc(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function dc(t){const[e,n,r]=lc(t);return e===1&&n===1&&r===1}function Rn(t,e){return dc(t)||dc(e)}function Ko(t){return lc(t).every(e=>e>0)}function to(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function Br(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")E(xu(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(s=>{E(xu(s),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${s}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SL(t,e){const r={x:N(t,"x","reshape","string_or_numeric")},s={shape:e};return M.runKernel(nv,r,s)}const X=F({reshape_:SL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CL(t,e,n,r,s){const a=N(t,"x","avgPool","float32"),o=1;E(Rn(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let i=a,u=!1;a.rank===3&&(u=!0,i=X(a,[1,a.shape[0],a.shape[1],a.shape[2]])),E(i.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${i.rank}.`),Br("avgPool",r,s);const c={x:i},l={filterSize:e,strides:n,pad:r,dimRoundingMode:s};let d=M.runKernel(Ef,c,l);return d=gt(d,a.dtype),u?X(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const i_=F({avgPool_:CL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IL(t,e,n,r,s,a="NDHWC"){const o=N(t,"x","avgPool3d","float32");let i=o,u=!1;o.rank===4&&(u=!0,i=X(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),E(i.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${i.rank}.`),E(a==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),E(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),Br("avgPool3d",r,s);const c={x:i},l={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:a};let d=M.runKernel(ox,c,l);return d=gt(d,i.dtype),u?X(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const $L=F({avgPool3d_:IL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _L(t,e=0){E(t.length>=1,()=>"Pass at least one tensor to concat");const n=Fp(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(a=>{if(a.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${a.dtype}. `)}),n.length===1)return Fa(n[0]);const r=n,s={axis:e};return M.runKernel(dx,r,s)}const Kt=F({concat_:_L});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NL(t,e,n=!1,r=!1){let s=N(t,"a","matMul"),a=N(e,"b","matMul");[s,a]=Ct(s,a);const o={a:s,b:a},i={transposeA:n,transposeB:r};return M.runKernel(Tf,o,i)}const et=F({matMul_:NL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kL(t){const n={x:N(t,"x","sigmoid","float32")};return M.runKernel(hv,n)}const Do=F({sigmoid_:kL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EL(t,e,n){const r=N(t,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const s={x:r},a={begin:e,size:n};return M.runKernel(cv,s,a)}const Re=F({slice_:EL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TL(t){const n={x:N(t,"x","tanh","float32")};return M.runKernel(kv,n)}const dy=F({tanh_:TL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RL(t,e,n,r,s,a){const o=N(t,"forgetBias","basicLSTMCell"),i=N(e,"lstmKernel","basicLSTMCell"),u=N(n,"lstmBias","basicLSTMCell"),c=N(r,"data","basicLSTMCell"),l=N(s,"c","basicLSTMCell"),d=N(a,"h","basicLSTMCell"),p=Kt([c,d],1),f=et(p,i),h=be(f,u),y=h.shape[0],x=h.shape[1]/4,g=[y,x],v=Re(h,[0,0],g),w=Re(h,[0,x],g),S=Re(h,[0,x*2],g),$=Re(h,[0,x*3],g),k=be(ae(Do(v),dy(w)),ae(l,Do(be(o,S)))),T=ae(dy(k),Do($));return[k,T]}const AL=F({basicLSTMCell_:RL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OL(t,e,n){const r=N(t,"x","batchToSpaceND"),s=e.reduce((i,u)=>i*u);E(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),E(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),E(r.shape[0]%s===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${s}`);const a={x:r},o={blockShape:e,crops:n};return M.runKernel(ix,a,o)}const u_=F({batchToSpaceND_:OL});function DL(t){let e;return t.rank===0||t.rank===1?e=X(t,[1,1,1,t.size]):t.rank===2?e=X(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=X(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PL(t,e,n,r,s,a){a==null&&(a=.001);const o=N(t,"x","batchNorm"),i=N(e,"mean","batchNorm"),u=N(n,"variance","batchNorm");let c;s!=null&&(c=N(s,"scale","batchNorm"));let l;r!=null&&(l=N(r,"offset","batchNorm")),E(i.rank===u.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),E(l==null||i.rank===l.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),E(c==null||i.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const p={x:DL(o),scale:c,offset:l,mean:i,variance:u},f={varianceEpsilon:a},h=M.runKernel(Hf,p,f);return X(h,o.shape)}const Nh=F({batchNorm_:PL});function FL(t,e,n,r,s,a){const o=N(t,"x","batchNorm"),i=N(e,"mean","batchNorm"),u=N(n,"variance","batchNorm");let c;s!=null&&(c=N(s,"scale","batchNorm"));let l;return r!=null&&(l=N(r,"offset","batchNorm")),E(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),E(i.rank===2||i.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${i.rank}.`),E(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&E(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),l!=null&&E(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${l.rank}.`),Nh(o,i,u,l,c,a)}const LL=F({batchNorm2d_:FL});function ML(t,e,n,r,s,a){const o=N(t,"x","batchNorm"),i=N(e,"mean","batchNorm"),u=N(n,"variance","batchNorm");let c;s!=null&&(c=N(s,"scale","batchNorm"));let l;return r!=null&&(l=N(r,"offset","batchNorm")),E(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),E(i.rank===3||i.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${i.rank}.`),E(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&E(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),l!=null&&E(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${l.rank}.`),Nh(o,i,u,l,c,a)}const BL=F({batchNorm3d_:ML});function VL(t,e,n,r,s,a){const o=N(t,"x","batchNorm"),i=N(e,"mean","batchNorm"),u=N(n,"variance","batchNorm");let c;s!=null&&(c=N(s,"scale","batchNorm"));let l;return r!=null&&(l=N(r,"offset","batchNorm")),E(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),E(i.rank===4||i.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${i.rank}.`),E(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&E(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),l!=null&&E(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${l.rank}.`),Nh(o,i,u,l,c,a)}const zL=F({batchNorm4d_:VL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WL(t,e,n){const r=N(t,"x","bincount"),s=N(e,"weights","bincount");E(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),E(n>=0,()=>`size must be non-negative, but got ${n}.`),E(s.size===r.size||s.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${s.shape}.`);const a={x:r,weights:s},o={size:n};return M.runKernel(Rf,a,o)}const l_=F({bincount_:WL});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UL(t,e){const n=N(t,"x","bitwiseAnd"),r=N(e,"y","bitwiseAnd");if(!yt(n.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${r.shape}`);if(n.dtype!=="int32"||r.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${r.dtype}`);const s={a:n,b:r};return M.runKernel(ux,s)}const GL=F({bitwiseAnd_:UL});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HL(t,e){const n=N(t,"s0","broadcastArgs","int32"),r=N(e,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const s={s0:n,s1:r};return M.runKernel(lx,s)}const jL=F({broadcastArgs_:HL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KL(t,e){let n=N(t,"broadcastTo","x");const r=n.shape;if(hr(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const c=n.shape.slice();for(;c.length<e.length;)c.unshift(1);n=X(n,c)}const s=n.shape,a=Array.from(e);for(let c=e.length-1;c>=0;c--)if(s[c]===e[c])a[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(a.map((c,l)=>c>1?l:-1).filter(c=>c>=0).length===0)return Fa(n);const i={x:n},u={reps:a};return M.runKernel(Ac,i,u)}const Ll=F({broadcastTo_:KL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qL(t){const n={x:N(t,"x","ceil","float32")};return M.runKernel(cx,n)}const XL=F({ceil_:qL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pc(t,e,n){hr(t),n=n||Ou(e);const r={shape:t,value:e,dtype:n};return M.runKernel($x,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YL(t,e,n){const r=N(t,"x","clipByValue");if(E(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return Pc(r.shape,e,r.dtype);const s={x:r},a={clipValueMin:e,clipValueMax:n};return M.runKernel(Of,s,a)}const c_=F({clipByValue_:YL});function QL(t){return Kt(t,0)}const ZL=F({concat1d_:QL});function JL(t,e){return Kt(t,e)}const eM=F({concat2d_:JL});function tM(t,e){return Kt(t,e)}const nM=F({concat3d_:tM});function rM(t,e){return Kt(t,e)}const sM=F({concat4d_:rM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aM(t,e,n,r,s="NHWC",a=[1,1],o){const i=N(t,"x","conv2d","float32"),u=N(e,"filter","conv2d","float32");let c=i,l=!1;i.rank===3&&(l=!0,c=X(i,[1,i.shape[0],i.shape[1],i.shape[2]])),E(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),E(u.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${u.rank}.`),Br("conv2d",r,o);const d=s==="NHWC"?c.shape[3]:c.shape[1];E(d===u.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${u.shape[2]}.`),E(Rn(n,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),E(Ko(a),()=>"Error in conv2D: Dilated rates should be larger than 0."),E(Ko(n),()=>"Error in conv2D: Strides should be larger than 0.");const p={x:c,filter:u},f={strides:n,pad:r,dataFormat:s,dilations:a,dimRoundingMode:o},h=M.runKernel(Df,p,f);return l?X(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const kh=F({conv2d_:aM});function oM(t,e,n,r,s="NWC",a=1,o){const i=N(t,"x","conv1d"),u=N(e,"filter","conv1d");let c=i,l=!1;i.rank===2&&(l=!0,c=X(i,[1,i.shape[0],i.shape[1]])),E(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),E(u.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${u.rank}.`),Br("conv1d",r,o),E(c.shape[2]===u.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${u.shape[1]}.`),E(Rn(n,a),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${a}'`),E(Ko(a),()=>"Error in conv1D: Dilated rates should be larger than 0."),E(Ko(n),()=>"Error in conv1D: Stride should be larger than 0."),E(s==="NWC",()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const d=X(u,[1,u.shape[0],u.shape[1],u.shape[2]]),p=X(c,[c.shape[0],1,c.shape[1],c.shape[2]]),x=kh(p,d,[1,n],r,"NHWC",[1,a],o);return l?X(x,[x.shape[2],x.shape[3]]):X(x,[x.shape[0],x.shape[2],x.shape[3]])}const iM=F({conv1d_:oM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uM(t,e,n,r,s,a="NHWC",o){E(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let i=t,u=e,c=!1;e.rank===3&&(c=!0,u=X(e,[1,e.shape[0],e.shape[1],e.shape[2]]),i=[1,t[0],t[1],t[2]]),E(i.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${i.length}.`),E(u.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${u.rank}`),E(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const l=a==="NHWC"?i[3]:i[1],d=a==="NHWC"?u.shape[3]:u.shape[1];E(l===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[2]}.`),E(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),Br("conv2dDerInput",s,o);const p={dy:u,filter:n},f={strides:r,pad:s,dataFormat:a,dimRoundingMode:o,inputShape:i},h=M.runKernel(Pf,p,f);return c?X(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const d_=F({conv2DBackpropInput_:uM});function lM(t,e,n,r,s,a){const o=N(t,"x","conv2dTranspose"),i=N(e,"filter","conv2dTranspose");return d_(n,o,i,r,s,"NHWC",a)}const cM=F({conv2dTranspose_:lM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dM(t,e,n,r,s="NDHWC",a=[1,1,1]){const o=N(t,"x","conv3d"),i=N(e,"filter","conv3d");let u=o,c=!1;o.rank===4&&(c=!0,u=X(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),E(u.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${u.rank}.`),E(i.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${i.rank}.`),E(u.shape[4]===i.shape[3],()=>`Error in conv3d: depth of input (${u.shape[4]}) must match input depth for filter ${i.shape[3]}.`),E(Rn(n,a),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),E(s==="NDHWC",()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`),E(Ko(a),()=>"Error in conv3D: Dilated rates should be larger than 0."),E(Ko(n),()=>"Error in conv3D: Strides should be larger than 0.");const l={x:u,filter:i},d={strides:n,pad:r,dataFormat:s,dilations:a},p=M.runKernel(Ff,l,d);return c?X(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const pM=F({conv3d_:dM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fM(t,e,n,r,s){E(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,o=e,i=!1;e.rank===4&&(i=!0,o=X(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),a=[1,t[0],t[1],t[2],t[3]]);const u=a[4],c=o.shape[4];E(a.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${a.length}.`),E(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),E(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),E(u===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[3]}.`),E(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const l={dy:o,filter:n},d={pad:s,strides:r,inputShape:a},p=M.runKernel(Lf,l,d);return i?X(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const hM=F({conv3DBackpropInput_:fM});function mM(t,e,n,r,s){const a=N(t,"x","conv3dTranspose"),o=N(e,"filter","conv3dTranspose");return hM(n,a,o,r,s)}const gM=F({conv3dTranspose_:mM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yM(t){const n={x:N(t,"x","cos","float32")};return M.runKernel(fx,n)}const xM=F({cos_:yM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vM(t){const n={x:N(t,"x","cosh","float32")};return M.runKernel(hx,n)}const wM=F({cosh_:vM});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bM(t,e=0,n=!1,r=!1){const a={x:N(t,"x","cumprod")},o={axis:e,exclusive:n,reverse:r};return M.runKernel(Mf,a,o)}const SM=F({cumprod_:bM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CM(t,e=0,n=!1,r=!1){const a={x:N(t,"x","cumsum")},o={axis:e,exclusive:n,reverse:r};return M.runKernel(Bf,a,o)}const IM=F({cumsum_:CM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $M(t,e,n,r=!1){const s=N(t,"x","denseBincount"),a=N(e,"weights","denseBincount");E(s.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${s.dtype}`),E(s.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`),E(n>=0,()=>`size must be non-negative, but got ${n}.`),E(a.size===s.size||a.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: ${a.shape}.`);const o={x:s,weights:a},i={size:n,binaryOutput:r};return M.runKernel(mx,o,i)}const _M=F({denseBincount_:$M});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NM(t,e,n="NHWC"){const r=N(t,"x","depthToSpace","float32"),s=n==="NHWC"?r.shape[1]:r.shape[2],a=n==="NHWC"?r.shape[2]:r.shape[3],o=n==="NHWC"?r.shape[3]:r.shape[1];E(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),E(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e}  for depthToSpace with input shape
    ${r.shape}`),E(a*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${e} for depthToSpace with input shape
        ${r.shape}`),E(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${r.shape}`);const i={x:r},u={blockSize:e,dataFormat:n};return M.runKernel(zf,i,u)}const kM=F({depthToSpace_:NM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EM(t,e,n,r,s="NHWC",a=[1,1],o){const i=N(t,"x","depthwiseConv2d","float32"),u=N(e,"filter","depthwiseConv2d","float32");let c=i,l=!1;i.rank===3&&(l=!0,c=X(i,[1,i.shape[0],i.shape[1],i.shape[2]])),E(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),E(u.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${u.rank}.`);const d=s==="NHWC"?c.shape[3]:c.shape[1];E(d===u.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${u.shape[2]}.`),Br("depthwiseConv2d",r,o);const p={x:c,filter:u},f={strides:n,pad:r,dataFormat:s,dilations:a,dimRoundingMode:o},h=M.runKernel(Wf,p,f);return l?X(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const Mv=F({depthwiseConv2d_:EM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TM(t){const n={x:N(t,"x","diag")};return M.runKernel(gx,n)}const RM=F({diag_:TM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AM(t,e,n,r,s=[1,1],a="NHWC"){const o=N(t,"x","dilation2d"),i=N(e,"filter","dilation2d");E(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),E(i.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${i.rank}.`),E(a==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${a}`);let u=o,c=!1;o.rank===3&&(u=X(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),E(u.shape[3]===i.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${u.shape[3]} vs ${i.shape[2]}`);const l={x:u,filter:i},d={strides:n,pad:r,dilations:s},p=M.runKernel(Uf,l,d);return c?X(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const OM=F({dilation2d_:AM});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lp(t,e){const n=t.length,r=[];for(let s=0;s<n;s++){const a=n-1-s,o=t[a]||1;(e[e.length-1-s]||1)>1&&o===1&&r.unshift(a)}return r}function p_(t,e){const n=[];for(let r=0;r<e.length;r++){const s=t[t.length-r-1],a=e.length-r-1,o=e[a];(s==null||s===1&&o>1)&&n.unshift(a)}return n}function Le(t,e){const n=Math.max(t.length,e.length),r=new Array(n);for(let s=0;s<n;s++){let a=t[t.length-s-1];a==null&&(a=1);let o=e[e.length-s-1];if(o==null&&(o=1),a===1)r[n-s-1]=o;else if(o===1)r[n-s-1]=a;else if(a!==o){const i=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(i)}else r[n-s-1]=a}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DM(t,e){let n=N(t,"a","equal","string_or_numeric"),r=N(e,"b","equal","string_or_numeric");[n,r]=Ct(n,r),Le(n.shape,r.shape);const s={a:n,b:r};return M.runKernel(bx,s)}const f_=F({equal_:DM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PM(t,e,n){const r=N(e,"a","where"),s=N(n,"b","where"),a=N(t,"condition","where","bool"),o=Le(Le(a.shape,r.shape),s.shape),i=Ll(a,o),u=Ll(r,o),c=Ll(s,o),l={condition:i,t:u,e:c};return M.runKernel(uv,l)}const La=F({where_:PM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FM(t){const n={x:N(t,"x","zerosLike")};return M.runKernel(Rv,n)}const cr=F({zerosLike_:FM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LM(t,e){let n=N(t,"a","div"),r=N(e,"b","div");[n,r]=Ct(n,r);const s=Fe(n,r),a=cr(s),o=f_(r,a);return La(o,a,s)}const MM=F({divNoNan_:LM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BM(t,e){const n=N(t,"t1","dot"),r=N(e,"t2","dot");E((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const s=n.rank===1?n.size:n.shape[1],a=r.rank===1?r.size:r.shape[0];if(E(s===a,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${a}.`),n.rank===1&&r.rank===1){const o=X(n,[1,-1]),i=X(r,[-1,1]),u=et(o,i);return X(u,[])}else if(n.rank===1&&r.rank===2){const o=X(n,[1,-1]),i=X(r,[r.shape[0],r.shape[1]]),u=et(o,i);return X(u,[u.size])}else if(n.rank===2&&r.rank===1){const o=X(r,[-1,1]),i=et(n,o);return X(i,[i.size])}else{const o=X(r,[r.shape[0],r.shape[1]]);return et(n,o)}}const VM=F({dot_:BM});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zM(t,...e){const n=e.map((s,a)=>N(s,`tensors${a}`,"einsum")),r={equation:t};return M.runKernel(p$,n,r)}const Li=F({einsum_:zM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WM(t){const n={x:N(t,"x","elu","float32")};return M.runKernel(xx,n)}const h_=F({elu_:WM});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UM(t,e){const n=N(t,"x","ensureShape","string_or_numeric");if(!hF(n.shape,e))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${e}`);return t}const GM=F({ensureShape_:UM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HM(t){let e=N(t,"x","erf");E(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=gt(e,"float32"));const n={x:e};return M.runKernel(wx,n)}const jM=F({erf_:HM});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bv(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function m_(t,e,n){const r=t.length+e.length,s=[];let a=0,o=0;for(let i=0;i<r;i++)n.indexOf(i)===-1?s.push(t[a++]):s.push(e[o++]);return s}function an(t,e){const n=[],r=t.length;for(let a=0;a<r;a++)e.indexOf(a)===-1&&n.push(t[a]);const s=e.map(a=>t[a]);return[n,s]}function Ot(t,e){const n=e.map(r=>1);return m_(t,n,e)}function Dt(t,e,n){E(Bv(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function An(t,e){if(Bv(t,e))return null;const n=[];for(let r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(r=>n.push(r)),n}function Fc(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function Xt(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KM(t,e=null,n=!1){const s={x:N(t,"x","max")},a={reductionIndices:e,keepDims:n};return M.runKernel(Qf,s,a)}const uu=F({max_:KM});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qM(t,e=null,n=!1){const s={x:N(t,"x","min")},a={axis:e,keepDims:n};return M.runKernel(eh,s,a)}const py=F({min_:qM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XM(t,e){let n=N(t,"base","pow"),r=N(e,"exp","pow");[n,r]=Ct(n,r);const s={a:n,b:r};return M.runKernel(Zx,s)}const pc=F({pow_:XM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ve(t,e){if((Lr(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Lr(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Ja(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YM(t){const n={x:N(t,"x","sqrt","float32")};return M.runKernel(gv,n)}const Js=F({sqrt_:YM});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QM(t){const e=N(t,"x","square"),n={};return M.runKernel("Square",{x:e},n)}const rs=F({square_:QM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZM(t,e=null,n=!1){let r=N(t,"x","sum");r.dtype==="bool"&&(r=gt(r,"int32"));const s={x:r},a={axis:e,keepDims:n};return M.runKernel(gh,s,a)}const ot=F({sum_:ZM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JM(t,e="euclidean",n=null,r=!1){t=N(t,"x","norm");const s=g_(t,e,n);let a=s.shape;if(r){const o=vt(n,t.shape);a=Ot(s.shape,o)}return X(s,a)}function g_(t,e,n=null){if(t.rank===0)return nr(t);if(t.rank!==1&&n===null)return g_(X(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return ot(nr(t),n);if(e===1/0)return uu(nr(t),n);if(e===-1/0)return py(nr(t),n);if(e==="euclidean"||e===2)return Js(ot(pc(nr(t),Ve(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return uu(ot(nr(t),n[0]),n[1]-1);if(e===1/0)return uu(ot(nr(t),n[1]),n[0]);if(e===-1/0)return py(ot(nr(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Js(ot(rs(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Eh=F({norm_:JM});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eB(t,e=null,n=!1){return Eh(t,"euclidean",e,n)}const tB=F({euclideanNorm_:eB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nB(t){const n={x:N(t,"x","exp")};return M.runKernel(Sx,n)}const ea=F({exp_:nB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rB(t,e=0){const n=N(t,"x","expandDims","string_or_numeric");E(e<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},s={dim:e};return M.runKernel(Cx,r,s)}const ws=F({expandDims_:rB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sB(t){const n={x:N(t,"x","expm1")};return M.runKernel(Ix,n)}const aB=F({expm1_:sB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oB(t,e){const n=N(t,"x","tile","string_or_numeric");E(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const r={x:n},s={reps:e};return M.runKernel(Ac,r,s)}const Ml=F({tile_:oB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iB(t,e,n,r="float32"){e==null&&(e=t);const s=xt([t,e],r),a=t<=e?t:e;for(let i=0;i<a;++i)s.set(1,i,i);const o=X(s.toTensor(),[t,e]);if(n==null)return o;if(n.length===1)return Ml(ws(o,0),[n[0],1,1]);if(n.length===2)return Ml(ws(ws(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return Ml(ws(ws(ws(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const y_=F({eye_:iB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uB(t){const n={x:N(t,"x","floor","float32")};return M.runKernel(_x,n)}const x_=F({floor_:uB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lB(t,e,n=0,r=0){const s=N(t,"x","gather"),a=N(e,"indices","gather","int32"),o={x:s,indices:a},i={axis:n,batchDims:r};return M.runKernel(kx,o,i)}const v_=F({gather_:lB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cB(t,e){let n=N(t,"a","greater","string_or_numeric"),r=N(e,"b","greater","string_or_numeric");[n,r]=Ct(n,r),Le(n.shape,r.shape);const s={a:n,b:r};return M.runKernel(Ex,s)}const Th=F({greater_:cB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dB(t,e){let n=N(t,"a","greaterEqual","string_or_numeric"),r=N(e,"b","greaterEqual","string_or_numeric");[n,r]=Ct(n,r),Le(n.shape,r.shape);const s={a:n,b:r};return M.runKernel(Tx,s)}const w_=F({greaterEqual_:dB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pB(t){const n={input:N(t,"input","imag")};return M.runKernel(m$,n)}const Rh=F({imag_:pB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fB(t){const n={x:N(t,"x","isFinite")};return M.runKernel(Rx,n)}const hB=F({isFinite_:fB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mB(t){const n={x:N(t,"x","isInf")};return M.runKernel(Ax,n)}const gB=F({isInf_:mB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yB(t){const n={x:N(t,"x","isNaN")};return M.runKernel(Ox,n)}const xB=F({isNaN_:yB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vB(t,e=.2){const r={x:N(t,"x","leakyRelu")},s={alpha:e};return M.runKernel(qf,r,s)}const b_=F({leakyRelu_:vB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wB(t,e){let n=N(t,"a","less","string_or_numeric"),r=N(e,"b","less","string_or_numeric");[n,r]=Ct(n,r),Le(n.shape,r.shape);const s={a:n,b:r};return M.runKernel(Dx,s)}const fy=F({less_:wB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bB(t,e){let n=N(t,"a","lessEqual","string_or_numeric"),r=N(e,"b","lessEqual","string_or_numeric");[n,r]=Ct(n,r),Le(n.shape,r.shape);const s={a:n,b:r};return M.runKernel(Px,s)}const Vv=F({lessEqual_:bB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SB(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:t,stop:e,num:n};return M.runKernel(Xf,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CB(t,e=5,n=1,r=1,s=.5){const a=N(t,"x","localResponseNormalization");E(a.rank===4||a.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${a.rank}.`),E(xu(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=a,i=!1;a.rank===3&&(i=!0,o=X(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const u={x:o},c={depthRadius:e,bias:n,alpha:r,beta:s},l=M.runKernel(Yf,u,c);return i?X(l,[l.shape[1],l.shape[2],l.shape[3]]):l}const IB=F({localResponseNormalization_:CB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $B(t){const n={x:N(t,"x","log","float32")};return M.runKernel(Fx,n)}const fc=F({log_:$B});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _B(t){const n={x:N(t,"x","log1p")};return M.runKernel(Lx,n)}const S_=F({log1p_:_B});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NB(t,e){E(qg(t),()=>"The f passed in variableGrads(f) must be a function"),E(e==null||Array.isArray(e)&&e.every(c=>c instanceof Pp),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const c in M.registeredVariables)e.push(M.registeredVariables[c])}const r=n?e.filter(c=>!c.trainable):null,s=e.length;e=e.filter(c=>c.trainable),E(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const a=!0,{value:o,grads:i}=M.gradients(t,e,null,a);E(i.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),E(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const u={};return e.forEach((c,l)=>{i[l]!=null&&(u[c.name]=i[l])}),r!=null&&r.forEach(c=>u[c.name]=null),{value:o,grads:u}}function ta(t){return M.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kB(t){const n={x:N(t,"x","neg")};return M.runKernel(qx,n)}const Ns=F({neg_:kB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EB(t){const n={x:N(t,"x","softplus")};return M.runKernel(mv,n)}const C_=F({softplus_:EB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TB(t){const e=N(t,"x","logSigmoid");return ta(r=>({value:Ns(C_(Ns(r))),gradFunc:o=>ae(o,Do(Ns(r)))}))(e)}const RB=F({logSigmoid_:TB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AB(t,e){let n=N(t,"a","sub"),r=N(e,"b","sub");[n,r]=Ct(n,r);const s={a:n,b:r};return M.runKernel(_v,s)}const Ae=F({sub_:AB});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OB(t,e=-1){const n=N(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return ta((s,a)=>{const i=uu(s,e,!0),u=Ae(s,i),c=Ae(gt(u,"float32"),fc(ot(ea(u),e,!0)));return a([c]),{value:c,gradFunc:(d,p)=>{const[f]=p,h=!0,y=ea(f);return Ae(d,ae(ot(d,e,h),y))}}})(n)}const DB=F({logSoftmax_:OB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PB(t,e=null,n=!1){const r=N(t,"x","logSumExp"),s=vt(e,r.shape),a=uu(r,s,!0),o=Ae(r,a),i=ea(o),u=ot(i,s),c=fc(u),l=be(X(a,c.shape),c);if(n){const d=Ot(l.shape,s);return X(l,d)}return l}const I_=F({logSumExp_:PB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FB(t,e){const n=N(t,"a","logicalAnd","bool"),r=N(e,"b","logicalAnd","bool");Le(n.shape,r.shape);const s={a:n,b:r};return M.runKernel(Mx,s)}const Mp=F({logicalAnd_:FB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LB(t){const n={x:N(t,"x","logicalNot","bool")};return M.runKernel(Bx,n)}const $_=F({logicalNot_:LB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MB(t,e){const n=N(t,"a","logicalOr","bool"),r=N(e,"b","logicalOr","bool");Le(n.shape,r.shape);const s={a:n,b:r};return M.runKernel(Vx,s)}const __=F({logicalOr_:MB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BB(t,e){const n=N(t,"a","logicalXor","bool"),r=N(e,"b","logicalXor","bool");return Le(n.shape,r.shape),Mp(__(t,e),$_(Mp(t,e)))}const VB=F({logicalXor_:BB});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kd=2147483648;function zB(t,e,n="left"){const r=N(t,"sortedSequence","searchSorted"),s=N(e,"values","searchSorted"),a=r.shape[r.shape.length-1],o=s.shape[s.shape.length-1],i=X(r,[-1,a]),u=X(s,[-1,o]);if(i.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(i.shape[0]!==u.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(K(u.shape)>=kd)throw new Error(`values tensor size must less than ${kd}`);if(i.shape[1]>=kd)throw new Error(`trailing dim_size must less than ${kd} for int32 output type, was ${i.shape[1]}`);const c={sortedSequence:i,values:u},l={side:n};return M.runKernel(mh,c,l)}const zv=F({searchSorted_:zB});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WB(t,e){return zv(t,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UB(t,e,n,r,s){const a=N(t,"x","maxPool"),o=1;let i=a,u=!1;a.rank===3&&(u=!0,i=X(a,[1,a.shape[0],a.shape[1],a.shape[2]])),E(i.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${i.rank}.`),E(Rn(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),Br("maxPool",r,s);const c={x:i},l={filterSize:e,strides:n,pad:r,dimRoundingMode:s},d=M.runKernel(Zf,c,l);return u?X(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const N_=F({maxPool_:UB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GB(t,e=[1,1,1],n,r,s,a="NDHWC"){const o=N(t,"x","maxPool3d");let i=o,u=!1;o.rank===4&&(u=!0,i=X(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),E(i.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${i.rank}.`),E(a==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),Br("maxPool3d",r,s);const c={x:i},l={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:a},d=M.runKernel(Ux,c,l);return u?X(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const HB=F({maxPool3d_:GB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jB(t,e,n,r,s=!1){const o={x:N(t,"x","maxPoolWithArgmax")},i={filterSize:e,strides:n,pad:r,includeBatchInIndex:s},u=M.runKernel(Gx,o,i);return{result:u[0],indexes:u[1]}}const KB=F({maxPoolWithArgmax_:jB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qB(t,e){let n=N(t,"a","maximum"),r=N(e,"b","maximum");[n,r]=Ct(n,r),n.dtype==="bool"&&(n=gt(n,"int32"),r=gt(r,"int32")),Le(n.shape,r.shape);const s={a:n,b:r};return M.runKernel(Wx,s)}const k_=F({maximum_:qB});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XB(t,e=null,n=!1){const s={x:N(t,"x","mean")},a={axis:e,keepDims:n};return M.runKernel(Jf,s,a)}const Bp=F({mean_:XB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qo(t,e="float32"){if(hr(t),e==="complex64"){const r=qo(t,"float32"),s=qo(t,"float32");return Ha(r,s)}const n=Ga(K(t),e);return M.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function To(t,e="float32"){if(hr(t),e==="complex64"){const r=To(t,"float32"),s=qo(t,"float32");return Ha(r,s)}const n=e$(K(t),e);return M.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YB(t,e,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(t===void 0)return[];let r=N(t,"x","meshgrid",t instanceof Rt?t.dtype:"float32");if(e===void 0)return[r];let s=N(e,"y","meshgrid",e instanceof Rt?e.dtype:"float32");const a=K(r.shape),o=K(s.shape);return n==="xy"?(r=X(r,[1,-1]),s=X(s,[-1,1]),[et(To([o,1],r.dtype),r),et(s,To([1,a],s.dtype))]):(r=X(r,[-1,1]),s=X(s,[1,-1]),[et(r,To([1,o],r.dtype)),et(To([a,1],s.dtype),s)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QB(t,e){let n=N(t,"a","minimum"),r=N(e,"b","minimum");[n,r]=Ct(n,r),n.dtype==="bool"&&(n=gt(n,"int32"),r=gt(r,"int32")),Le(n.shape,r.shape);const s={a:n,b:r};return M.runKernel(Hx,s)}const Vp=F({minimum_:QB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZB(t,e,n){E(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=N(t,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");E(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const s=n==="reflect"?1:0;for(let i=0;i<r.rank;i++)E(e[i].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),E(e[i][0]>=0&&e[i][0]<=r.shape[i]-s&&e[i][1]>=0&&e[i][1]<=r.shape[i]-s,()=>`Padding in dimension ${i} cannot be greater than or equal to ${r.shape[i]-s} or less than 0 for input of shape ${r.shape}`);const a={paddings:e,mode:n},o={x:r};return M.runKernel(th,o,a)}const JB=F({mirrorPad_:ZB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e4(t,e){let n=N(t,"a","mod"),r=N(e,"b","mod");[n,r]=Ct(n,r);const s={a:n,b:r};return M.runKernel(jx,s)}const t4=F({mod_:e4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n4(t,e=null,n=!1){t=N(t,"x","moments");const r=vt(e,t.shape),s=Bp(t,r,n);let a=s.shape;n||(a=Ot(s.shape,r));const o=rs(Ae(gt(t,"float32"),X(s,a))),i=Bp(o,r,n);return{mean:s,variance:i}}const r4=F({moments_:n4});function s4(t,e,n,r){const s=N(e,"data","multiRNNCell"),a=Fp(n,"c","multiRNNCell"),o=Fp(r,"h","multiRNNCell");let i=s;const u=[];for(let d=0;d<t.length;d++){const p=t[d](i,a[d],o[d]);u.push(p[0]),u.push(p[1]),i=p[1]}const c=[],l=[];for(let d=0;d<u.length;d+=2)c.push(u[d]),l.push(u[d+1]);return[c,l]}const a4=F({multiRNNCell_:s4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o4(t,e,n,r=!1){const s=N(t,"logits","multinomial"),a=s.size,o=s.rank;if(a<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${a}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);n=n||Math.random();const u={logits:o===1?X(s,[1,-1]):s},c={numSamples:e,seed:n,normalized:r},l=M.runKernel(nh,u,c);return o===1?X(l,[l.size]):l}const i4=F({multinomial_:o4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u4(t,e){let n=N(t,"a","notEqual","string_or_numeric"),r=N(e,"b","notEqual","string_or_numeric");[n,r]=Ct(n,r),Le(n.shape,r.shape);const s={a:n,b:r};return M.runKernel(Xx,s)}const E_=F({notEqual_:u4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l4(t,e,n=1,r=0,s="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:N(t,"indices","oneHot","int32")},i={dtype:s,depth:e,onValue:n,offValue:r};return M.runKernel(oh,o,i)}const c4=F({oneHot_:l4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d4(t){const n={x:N(t,"x","onesLike")};return M.runKernel(Yx,n)}const p4=F({onesLike_:d4});function f4(t,e){const n=N(t,"v1","outerProduct"),r=N(e,"v2","outerProduct");E(n.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);const s=X(n,[-1,1]),a=X(r,[1,-1]);return et(s,a)}const h4=F({outerProduct_:f4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m4(t,e,n=0){const r=N(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:n},a={x:r};return M.runKernel(ih,a,s)}const Lc=F({pad_:m4});function g4(t,e,n=0){return E(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),Lc(t,[e],n)}const y4=F({pad1d_:g4});function x4(t,e,n=0){return E(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Lc(t,e,n)}const v4=F({pad2d_:x4});function w4(t,e,n=0){return E(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Lc(t,e,n)}const b4=F({pad3d_:w4});function S4(t,e,n=0){return E(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Lc(t,e,n)}const C4=F({pad4d_:S4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I4(t,e,n){const r=N(t,"x","spaceToBatchND");E(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),E(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),E(r.shape.reduce((o,i,u)=>u>0&&u<=e.length?o&&(i+n[u-1][0]+n[u-1][1])%e[u-1]===0:o,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const s={x:r},a={blockShape:e,paddings:n};return M.runKernel(yv,s,a)}const T_=F({spaceToBatchND_:I4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $4(t,e,n,r,s,a,o){s==null&&(s=[1,1]),a==null&&(a=1),r===0&&(r="valid");const i=N(t,"x","maxPool");let u=i,c=!1;i.rank===3&&(c=!0,u=X(i,[1,i.shape[0],i.shape[1],i.shape[2]])),E(Rn(a,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${a} and dilations '${s}'`);const l=Mr(u.shape,e,a,s,r),d=[l.dilationHeight,l.dilationWidth];let p;r==="same"?p=N4([l.filterHeight,l.filterWidth],d):p=[[0,0],[0,0]];const f=d[0]===1&&d[1]===1,[h,y]=_4([l.inHeight,l.inWidth],d,p),x=f?r:"valid",g=f?u:T_(u,d,h),w=(n==="avg"?()=>i_(g,e,a,x,o):()=>N_(g,e,a,x,o))(),S=f?w:u_(w,d,y);return c?X(S,[S.shape[1],S.shape[2],S.shape[3]]):S}function _4(t,e,n){const r=n.map(l=>l[0]),s=n.map(l=>l[1]),a=t.concat(r,s),o=e.map((l,d)=>(l-a[d]%l)%l),i=s.map((l,d)=>l+o[d]),u=e.map((l,d)=>[r[d],i[d]]),c=e.map((l,d)=>[0,o[d]]);return[u,c]}function N4(t,e){const r=t.map((o,i)=>o+(o-1)*(e[i]-1)).map(o=>o-1),s=r.map(o=>Math.floor(o/2)),a=r.map((o,i)=>o-s[i]);return r.map((o,i)=>[s[i],a[i]])}const k4=F({pool_:$4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E4(t,e){const n=N(t,"x","prelu"),r=N(e,"alpha","prelu"),s={x:n,alpha:r};return M.runKernel(uh,s)}const R_=F({prelu_:E4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T4(t,e=null,n=!1){let r=N(t,"x","prod");r.dtype==="bool"&&(r=gt(r,"int32"));const s={x:r},a={axis:e,keepDims:n};return M.runKernel(lh,s,a)}const R4=F({prod_:T4});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A4(t,e,n,r){const s=t.map((l,d)=>N(l,`tensors${d}`,"raggedGather","int32")),a=N(e,"paramsDenseValues","raggedGather"),o=N(n,"indices","raggedGather","int32"),i={paramsNestedSplits:s,paramsDenseValues:a,indices:o},u={outputRaggedRank:r},c=M.runKernel(x$,i,u);return{outputNestedSplits:c.slice(0,c.length-1),outputDenseValues:c[c.length-1]}}const O4=F({raggedGather_:A4});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D4(t,e,n){const r=N(t,"starts","raggedRange"),s=N(e,"limits","raggedRange",r.dtype),a=N(n,"deltas","raggedRange",r.dtype),o={starts:r,limits:s,deltas:a},i=M.runKernel(v$,o);return{rtNestedSplits:i[0],rtDenseValues:i[1]}}const P4=F({raggedRange_:D4});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F4(t,e,n,r,s){const a=N(t,"shape","raggedTensorToTensor","int32"),o=N(e,"values","raggedTensorToTensor"),i=N(n,"defaultValue","raggedTensorToTensor",o.dtype),u=r.map((d,p)=>N(d,`tensors${p}`,"raggedTensorToTensor","int32")),c={shape:a,values:o,defaultValue:i,rowPartitionTensors:u},l={rowPartitionTypes:s};return M.runKernel(w$,c,l)}const L4=F({raggedTensorToTensor_:F4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M4(t,e,n){hr(t);const r=K(t);let s=null;if(n==null||n==="float32")s=new Float32Array(r);else if(n==="int32")s=new Int32Array(r);else if(n==="bool")s=new Uint8Array(r);else throw new Error(`Unknown data type ${n}`);for(let a=0;a<r;a++)s[a]=e();return M.makeTensor(s,t,n)}const B4=F({rand_:M4});var A_={exports:{}};(function(t){(function(e,n,r){function s(u){var c=this,l=i();c.next=function(){var d=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=d|0)},c.c=1,c.s0=l(" "),c.s1=l(" "),c.s2=l(" "),c.s0-=l(u),c.s0<0&&(c.s0+=1),c.s1-=l(u),c.s1<0&&(c.s1+=1),c.s2-=l(u),c.s2<0&&(c.s2+=1),l=null}function a(u,c){return c.c=u.c,c.s0=u.s0,c.s1=u.s1,c.s2=u.s2,c}function o(u,c){var l=new s(u),d=c&&c.state,p=l.next;return p.int32=function(){return l.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,d&&(typeof d=="object"&&a(d,l),p.state=function(){return a(l,{})}),p}function i(){var u=4022871197,c=function(l){l=String(l);for(var d=0;d<l.length;d++){u+=l.charCodeAt(d);var p=.02519603282416938*u;u=p>>>0,p-=u,p*=u,u=p>>>0,p-=u,u+=p*4294967296}return(u>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=o:this.alea=o})(qn,t)})(A_);var V4=A_.exports,O_={exports:{}};(function(t){(function(e,n,r){function s(i){var u=this,c="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var d=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^d^d>>>8},i===(i|0)?u.x=i:c+=i;for(var l=0;l<c.length+64;l++)u.x^=c.charCodeAt(l)|0,u.next()}function a(i,u){return u.x=i.x,u.y=i.y,u.z=i.z,u.w=i.w,u}function o(i,u){var c=new s(i),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,f=(c.next()>>>0)/4294967296,h=(p+f)/(1<<21);while(h===0);return h},d.int32=c.next,d.quick=d,l&&(typeof l=="object"&&a(l,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=o:this.xor128=o})(qn,t)})(O_);var z4=O_.exports,D_={exports:{}};(function(t){(function(e,n,r){function s(i){var u=this,c="";u.next=function(){var d=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^(d^d<<1))|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,i===(i|0)?u.x=i:c+=i;for(var l=0;l<c.length+64;l++)u.x^=c.charCodeAt(l)|0,l==c.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function a(i,u){return u.x=i.x,u.y=i.y,u.z=i.z,u.w=i.w,u.v=i.v,u.d=i.d,u}function o(i,u){var c=new s(i),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,f=(c.next()>>>0)/4294967296,h=(p+f)/(1<<21);while(h===0);return h},d.int32=c.next,d.quick=d,l&&(typeof l=="object"&&a(l,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=o:this.xorwow=o})(qn,t)})(D_);var W4=D_.exports,P_={exports:{}};(function(t){(function(e,n,r){function s(i){var u=this;u.next=function(){var l=u.x,d=u.i,p,f;return p=l[d],p^=p>>>7,f=p^p<<24,p=l[d+1&7],f^=p^p>>>10,p=l[d+3&7],f^=p^p>>>3,p=l[d+4&7],f^=p^p<<7,p=l[d+7&7],p=p^p<<13,f^=p^p<<9,l[d]=f,u.i=d+1&7,f};function c(l,d){var p,f=[];if(d===(d|0))f[0]=d;else for(d=""+d,p=0;p<d.length;++p)f[p&7]=f[p&7]<<15^d.charCodeAt(p)+f[p+1&7]<<13;for(;f.length<8;)f.push(0);for(p=0;p<8&&f[p]===0;++p);for(p==8?f[7]=-1:f[p],l.x=f,l.i=0,p=256;p>0;--p)l.next()}c(u,i)}function a(i,u){return u.x=i.x.slice(),u.i=i.i,u}function o(i,u){i==null&&(i=+new Date);var c=new s(i),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,f=(c.next()>>>0)/4294967296,h=(p+f)/(1<<21);while(h===0);return h},d.int32=c.next,d.quick=d,l&&(l.x&&a(l,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=o:this.xorshift7=o})(qn,t)})(P_);var U4=P_.exports,F_={exports:{}};(function(t){(function(e,n,r){function s(i){var u=this;u.next=function(){var l=u.w,d=u.X,p=u.i,f,h;return u.w=l=l+1640531527|0,h=d[p+34&127],f=d[p=p+1&127],h^=h<<13,f^=f<<17,h^=h>>>15,f^=f>>>12,h=d[p]=h^f,u.i=p,h+(l^l>>>16)|0};function c(l,d){var p,f,h,y,x,g=[],v=128;for(d===(d|0)?(f=d,d=null):(d=d+"\0",f=0,v=Math.max(v,d.length)),h=0,y=-32;y<v;++y)d&&(f^=d.charCodeAt((y+32)%d.length)),y===0&&(x=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,y>=0&&(x=x+1640531527|0,p=g[y&127]^=f+x,h=p==0?h+1:0);for(h>=128&&(g[(d&&d.length||0)&127]=-1),h=127,y=4*128;y>0;--y)f=g[h+34&127],p=g[h=h+1&127],f^=f<<13,p^=p<<17,f^=f>>>15,p^=p>>>12,g[h]=f^p;l.w=x,l.X=g,l.i=h}c(u,i)}function a(i,u){return u.i=i.i,u.w=i.w,u.X=i.X.slice(),u}function o(i,u){i==null&&(i=+new Date);var c=new s(i),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,f=(c.next()>>>0)/4294967296,h=(p+f)/(1<<21);while(h===0);return h},d.int32=c.next,d.quick=d,l&&(l.X&&a(l,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=o:this.xor4096=o})(qn,t)})(F_);var G4=F_.exports,L_={exports:{}};(function(t){(function(e,n,r){function s(i){var u=this,c="";u.next=function(){var d=u.b,p=u.c,f=u.d,h=u.a;return d=d<<25^d>>>7^p,p=p-f|0,f=f<<24^f>>>8^h,h=h-d|0,u.b=d=d<<20^d>>>12^p,u.c=p=p-f|0,u.d=f<<16^p>>>16^h,u.a=h-d|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,i===Math.floor(i)?(u.a=i/4294967296|0,u.b=i|0):c+=i;for(var l=0;l<c.length+20;l++)u.b^=c.charCodeAt(l)|0,u.next()}function a(i,u){return u.a=i.a,u.b=i.b,u.c=i.c,u.d=i.d,u}function o(i,u){var c=new s(i),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,f=(c.next()>>>0)/4294967296,h=(p+f)/(1<<21);while(h===0);return h},d.int32=c.next,d.quick=d,l&&(typeof l=="object"&&a(l,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=o:this.tychei=o})(qn,t)})(L_);var H4=L_.exports,M_={exports:{}},j4={},K4=Object.freeze({__proto__:null,default:j4}),Sa=lF(K4);(function(t){(function(e,n,r){var s=256,a=6,o=52,i="random",u=r.pow(s,a),c=r.pow(2,o),l=c*2,d=s-1,p;function f(S,$,k){var T=[];$=$==!0?{entropy:!0}:$||{};var A=g(x($.entropy?[S,w(n)]:S??v(),3),T),B=new h(T),L=function(){for(var z=B.g(a),Y=u,Q=0;z<c;)z=(z+Q)*s,Y*=s,Q=B.g(1);for(;z>=l;)z/=2,Y/=2,Q>>>=1;return(z+Q)/Y};return L.int32=function(){return B.g(4)|0},L.quick=function(){return B.g(4)/4294967296},L.double=L,g(w(B.S),n),($.pass||k||function(z,Y,Q,re){return re&&(re.S&&y(re,B),z.state=function(){return y(B,{})}),Q?(r[i]=z,Y):z})(L,A,"global"in $?$.global:this==r,$.state)}function h(S){var $,k=S.length,T=this,A=0,B=T.i=T.j=0,L=T.S=[];for(k||(S=[k++]);A<s;)L[A]=A++;for(A=0;A<s;A++)L[A]=L[B=d&B+S[A%k]+($=L[A])],L[B]=$;(T.g=function(z){for(var Y,Q=0,re=T.i,Z=T.j,de=T.S;z--;)Y=de[re=d&re+1],Q=Q*s+de[d&(de[re]=de[Z=d&Z+Y])+(de[Z]=Y)];return T.i=re,T.j=Z,Q})(s)}function y(S,$){return $.i=S.i,$.j=S.j,$.S=S.S.slice(),$}function x(S,$){var k=[],T=typeof S,A;if($&&T=="object")for(A in S)try{k.push(x(S[A],$-1))}catch{}return k.length?k:T=="string"?S:S+"\0"}function g(S,$){for(var k=S+"",T,A=0;A<k.length;)$[d&A]=d&(T^=$[d&A]*19)+k.charCodeAt(A++);return w($)}function v(){try{var S;return p&&(S=p.randomBytes)?S=S(s):(S=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(S)),w(S)}catch{var $=e.navigator,k=$&&$.plugins;return[+new Date,e,k,e.screen,w(n)]}}function w(S){return String.fromCharCode.apply(0,S)}if(g(r.random(),n),t.exports){t.exports=f;try{p=Sa}catch{}}else r["seed"+i]=f})(typeof self<"u"?self:qn,[],Math)})(M_);var q4=M_.exports,X4=V4,Y4=z4,Q4=W4,Z4=U4,J4=G4,eV=H4,oi=q4;oi.alea=X4;oi.xor128=Y4;oi.xorwow=Q4;oi.xorshift7=Z4;oi.xor4096=J4;oi.tychei=eV;var Wv=oi;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uv{constructor(e,n,r,s,a){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=a||Math.random();this.random=Wv.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const s=this.nextVal;return this.nextVal=NaN,s}let e,n,r=!1;for(;!r;){let s,a,o;do s=2*this.random()-1,a=2*this.random()-1,o=s*s+a*a;while(o>=1||o===0);const i=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*s*i,n=this.mean+this.stdDev*a*i,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class tV{constructor(e,n,r,s){this.alpha=e,this.beta=1/n,this.dtype=r;const a=s||Math.random();this.randu=Wv.alea(a.toString()),this.randn=new Uv(0,1,r,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,n,r,s,a,o;for(;;){do s=this.randn.nextValue(),o=1+this.c*s;while(o<=0);if(o*=o*o,e=s*s,n=1-.331*e*e,r=.5*e+this.d*(1-o+Math.log(o)),a=this.randu(),a<n||Math.log(a)<r)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class nV{constructor(e=0,n=1,r,s){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=r,s==null&&(s=Math.random()),typeof s=="number"&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=Wv.alea(s)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rV(t,e,n=1,r="float32",s){if(hr(t),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);const a=new tV(e,n,r,s),o=xt(t,r);for(let i=0;i<o.values.length;i++)o.values[i]=a.nextValue();return o.toTensor()}const sV=F({randomGamma_:rV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aV(t,e=0,n=1,r,s){if(hr(t),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const a=new Uv(e,n,r,!1,s),o=xt(t,r);for(let i=0;i<o.values.length;i++)o.values[i]=a.nextValue();return o.toTensor()}const B_=F({randomNormal_:aV});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oV(t,e,n){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return B_(t,0,1,e,n)}const iV=F({randomStandardNormal_:oV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uV(t,e=0,n=1,r="float32",s){hr(t);const a=xt(t,r),o=new nV(e,n,null,s);for(let i=0;i<a.values.length;i++)a.values[i]=o.nextValue();return a.toTensor()}const Gv=F({randomUniform_:uV});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lV(t,e,n,r){return Gv(t,e,n,"int32",r)}const cV=F({randomUniformInt_:lV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hc(t,e,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const s={start:t,stop:e,step:n,dtype:r};return M.runKernel(Jx,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dV(t){const n={input:N(t,"input","real")};return M.runKernel(b$,n)}const mc=F({real_:dV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pV(t){const n={x:N(t,"x","reciprocal")};return M.runKernel(ev,n)}const fV=F({reciprocal_:pV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hV(t){const n={x:N(t,"x","relu")};return M.runKernel(tv,n)}const Ah=F({relu_:hV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mV(t){const n={x:N(t,"x","relu6")};return M.runKernel(av,n)}const V_=F({relu6_:mV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gV(t,e){const r={x:N(t,"x","reverse")},s={dims:e};return M.runKernel(ph,r,s)}const Xo=F({reverse_:gV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yV(t){const e=N(t,"x","reverse");return E(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),Xo(e,0)}const xV=F({reverse1d_:yV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vV(t,e){const n=N(t,"x","reverse");return E(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),Xo(n,e)}const wV=F({reverse2d_:vV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bV(t,e){const n=N(t,"x","reverse");return E(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),Xo(n,e)}const SV=F({reverse3d_:bV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CV(t,e){const n=N(t,"x","reverse");return E(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),Xo(n,e)}const IV=F({reverse4d_:CV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $V(t){const n={x:N(t,"x","round")};return M.runKernel(ov,n)}const z_=F({round_:$V});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _V(t){const n={x:N(t,"x","rsqrt","float32")};return M.runKernel(iv,n)}const NV=F({rsqrt_:_V});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kV(t){const n={x:N(t,"x","selu")};return M.runKernel(lv,n)}const EV=F({selu_:kV});function TV(t,e,n,r,s,a=[1,1],o="NHWC"){const i=N(t,"x","separableConv2d"),u=N(e,"depthwiseFilter","separableConv2d"),c=N(n,"pointwiseFilter","separableConv2d");let l=i,d=!1;if(i.rank===3&&(d=!0,l=X(i,[1,i.shape[0],i.shape[1],i.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");E(l.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${l.rank}.`),E(u.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${u.rank}.`),E(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${u.rank}.`),E(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),E(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const p=u.shape[2],f=u.shape[3];E(c.shape[2]===p*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*f}, but got ${c.shape[2]}.`);const h=Mv(l,u,r,s,o,a),x=kh(h,c,1,"valid",o);return d?X(x,[x.shape[1],x.shape[2],x.shape[3]]):x}const RV=F({separableConv2d_:TV});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function AV(t,e){const n=N(t,"x","setdiff1d"),r=N(e,"y","setdiff1d");E(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),E(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),E(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);const s=await n.data(),a=await r.data(),o=new Set(a);let i=0;for(let l=0;l<s.length;l++)o.has(s[l])||i++;const u=new Su([i],n.dtype),c=new Su([i],"int32");for(let l=0,d=0;l<s.length;l++)o.has(s[l])||(u.values[d]=s[l],c.values[d]=l,d++);return[u.toTensor(),c.toTensor()]}const OV=AV;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DV(t){const n={x:N(t,"x","sign")};return M.runKernel(fv,n)}const PV=F({sign_:DV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FV(t){const n={x:N(t,"x","sin","float32")};return M.runKernel(dv,n)}const LV=F({sin_:FV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MV(t){const n={x:N(t,"x","sinh")};return M.runKernel(pv,n)}const BV=F({sinh_:MV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VV(t,e,n){const r=N(t,"x","slice1d");return E(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Re(r,[e],[n])}const zV=F({slice1d_:VV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WV(t,e,n){const r=N(t,"x","slice2d");return E(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Re(r,e,n)}const UV=F({slice2d_:WV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GV(t,e,n){const r=N(t,"x","slice3d");return E(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Re(r,e,n)}const HV=F({slice3d_:GV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jV(t,e,n){const r=N(t,"x","slice4d");return E(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Re(r,e,n)}const KV=F({slice4d_:jV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qV(t,e=-1){const n=N(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},s={dim:e};return M.runKernel(yh,r,s)}const XV=F({softmax_:qV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YV(t){E(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return M.runKernel(f$,e)}const Hv=F({fft_:YV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QV(t){E(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return M.runKernel(h$,e)}const zp=F({ifft_:QV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZV(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const s=X(t,[n,e]);r=zp(s)}else{const s=[n,2*(e-1)],a=X(mc(t),[n,e]),o=X(Rh(t),[n,e]),i=Xo(Re(a,[0,1],[n,e-2]),1),u=ae(Xo(Re(o,[0,1],[n,e-2]),1),Ve(-1)),c=Kt([a,i],1),l=Kt([o,u],1),d=X(Ha(c,l),[s[0],s[1]]);r=zp(d)}if(r=mc(r),t.rank===3&&t.shape[0]!==0){const s=r,a=t.shape[0];r=X(r,[a,r.shape[0]/a,r.shape[1]]),s.dispose()}return r}const W_=F({irfft_:ZV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JV(t,e,n=0){const s={x:N(t,"x","split")},a={numOrSizeSplits:e,axis:n};return M.runKernel(xv,s,a)}const gc=F({split_:JV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ez(t,e){E(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const r=t.size/n;let s;if(e!=null&&e<n){const h=t.shape.map(x=>0),y=t.shape.map(x=>x);y[t.shape.length-1]=e,s=Re(t,h,y),n=e}else if(e!=null&&e>n){const h=t.shape.map(y=>y);h[t.shape.length-1]=e-n,s=Kt([t,qo(h)],t.shape.length-1),n=e}else s=t;const a=cr(s),o=X(Ha(s,a),[r,n]),i=Hv(o),u=Math.floor(n/2)+1,c=mc(i),l=Rh(i),d=gc(c,[u,n-u],c.shape.length-1),p=gc(l,[u,n-u],l.shape.length-1),f=s.shape.slice();return f[s.shape.length-1]=u,X(Ha(d[0],p[0]),f)}const jv=F({rfft_:ez});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tz(t,e){let n=N(t,"a","squaredDifference"),r=N(e,"b","squaredDifference");[n,r]=Ct(n,r),Le(n.shape,r.shape);const s={a:n,b:r},a={};return M.runKernel(Sv,s,a)}const U_=F({squaredDifference_:tz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nz(t,e){const n=N(t,"x","squeeze","string_or_numeric");return X(n,Qa(n.shape,e).newShape)}const Wt=F({squeeze_:nz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rz(t,e=0){const n=Fp(t,"tensors","stack","string_or_numeric");E(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&E(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,s={axis:e};return M.runKernel(Qx,r,s)}const na=F({stack_:rz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sz(t,e=0){const r={x:N(t,"x","step")},s={alpha:e};return M.runKernel(Ch,r,s)}const G_=F({step_:sz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function az(t,e,n,r,s=0,a=0,o=0,i=0,u=0){const l={x:N(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:r,beginMask:s,endMask:a,ellipsisMask:o,newAxisMask:i,shrinkAxisMask:u};return M.runKernel(wh,l,d)}const oz=F({stridedSlice_:az});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iz(t){const n={x:N(t,"x","tan","float32")};return M.runKernel(Nv,n)}const uz=F({tan_:iz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nn(t,e){Au(t);const n=Za(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Ja(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Po(t,e,n){if(Au(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=Za(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Ja(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H_(t,e,n){if(Au(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=Za(t,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Ja(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lz(t,e,n){if(Au(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=Za(t,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Ja(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cz(t,e,n){if(Au(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const r=Za(t,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Ja(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dz(t,e,n){if(Au(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const r=Za(t,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,Ja(t,e,r,n)}function j_(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,s=e.rank>1?e.rank-1:1,a=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${s}.`;if(n.rank<s)throw new Error(a+` update.rank < ${s}. `);if(t.length<r+(n.rank-s))throw new Error(a+` Output shape length < ${r+(n.rank-s)}`);if(n.rank!==s+t.length-r)throw new Error(a+` update.rank != ${s+t.length-r}`);for(let o=0;o<s;++o)if(n.shape[o]!==e.shape[o])throw new Error(a+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<n.rank-s;++o)if(n.shape[o+s]!==t[o+r])throw new Error(a+` updates.shape[${o+s}] (${n.shape[o+s]}) != shape[${o+s}] (${t[o+s]})`)}function Kv(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}j_(n,e,t)}function ii(t,e,n){const r=e.shape.length,s=r>1?e.shape[r-1]:1,a=n.length;let o=1;for(let d=s;d<a;++d)o*=n[d];const i=s<1?1:s,u=K(e.shape)/i,c=[...Ye(n.slice(0,s)),1],l=K(n);return{sliceRank:s,numUpdates:u,sliceSize:o,strides:c,outputSize:l}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pz(t,e,n){const r=N(t,"tensor","tensorScatterupdate"),s=N(e,"indices","tensorScatterupdate","int32"),a=N(n,"updates","tensorScatterupdate");if(Kv(a,s,r.shape),r.dtype!==a.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${a.dtype}.`);const o={tensor:r,indices:s,updates:a},i={};return M.runKernel(hh,o,i)}const fz=F({tensorScatterUpdate_:pz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hz(t,e=1,n=!0){const r=N(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const s=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${e}`);const a={x:r},o={k:e,sorted:n},[i,u]=M.runKernel(bh,a,o);return{values:i,indices:u}}const mz=F({topk_:hz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gz(t,e=0,n=1,r,s){if(hr(t),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const a=new Uv(e,n,r,!0,s),o=xt(t,r);for(let i=0;i<o.values.length;i++)o.values[i]=a.nextValue();return o.toTensor()}const yz=F({truncatedNormal_:gz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xz(t,e=0){const n=N(t,"x","unique","string_or_numeric");E(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},s={axis:e},[a,o]=M.runKernel(Ev,r,s);return{values:a,indices:o}}const vz=F({unique_:xz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wz(t,e,n){const r=N(t,"x","unsortedSegmentSum"),s=N(e,"segmentIds","unsortedSegmentSum","int32");E(xu(n),()=>"numSegments must be of dtype int");const a={x:r,segmentIds:s},o={numSegments:n};return M.runKernel(I$,a,o)}const bz=F({unsortedSegmentSum_:wz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sz(t,e=0){const n=N(t,"x","unstack","string_or_numeric");E(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},s={axis:e};return M.runKernel(Tv,r,s)}const ui=F({unstack_:Sz});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cz(t,e){return zv(t,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iz(t,e=!0,n,r){return M.makeVariable(t,e,n,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K_(t,e){const n=[];for(let a=0;a<e.length;a++)e[a]&&n.push(a);const r=xt(t,"int32"),s=xt([n.length,t.length],"int32");for(let a=0;a<n.length;a++){const o=r.indexToLoc(n[a]),i=a*t.length;s.values.set(o,i)}return s.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function $z(t){const e=N(t,"condition","whereAsync","bool"),n=await e.data(),r=K_(e.shape,n);return t!==e&&e.dispose(),r}const q_=$z;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function _z(t,e,n){const r=N(t,"tensor","boolMask"),s=N(e,"mask","boolMask","bool"),a=n??0,o=s.rank,i=r.shape;E(o>0,()=>"mask cannot be scalar"),Yn(i.slice(a,a+o),s.shape,"mask's shape must match the first K dimensions of tensor's shape,");let u=1;for(let y=a;y<a+o;y++)u*=i[y];const c=i.slice(0,a).concat([u],i.slice(a+o)),l=X(r,c),d=X(s,[-1]),p=await q_(d),f=Wt(p,[1]),h=v_(l,f,a);return t!==r&&r.dispose(),e!==s&&s.dispose(),f.dispose(),l.dispose(),d.dispose(),p.dispose(),h}const Nz=_z;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kz(t,e,n){const r=N(t,"x","transpose");if(e==null&&(e=r.shape.map((o,i)=>i).reverse()),E(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(o=>{E(o>=0&&o<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const s={x:r},a={perm:e};return r.dtype==="complex64"?De(()=>{let o=mc(r),i=Rh(r);return o=M.runKernel(au,{x:o},a),i=M.runKernel(au,{x:i},a),n&&(i=Ns(i)),Ha(o,i)}):M.runKernel(au,s,a)}const hy=F({transpose_:kz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ez(t,e,n,r,s=!0){const a=N(t,"v","movingAverage"),o=N(e,"x","movingAverage"),i=N(n,"decay","movingAverage");XF(a,o),E(yt(a.shape,o.shape),()=>"Shape mismatch in v and x");const u=Ve(1),c=Ae(u,i);let l=ae(Ae(o,a),c);if(s){E(r!=null,()=>"When using zeroDebias: true, step is required.");const d=N(r,"step","movingAverage");l=Fe(l,Ae(u,pc(i,d)))}return be(a,l)}const Tz=F({movingAverage_:Ez});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rz(t,e,n){hr(n);const r=N(t,"indices","scatterND","int32"),s=N(e,"updates","scatterND");Kv(s,r,n);const a={indices:r,updates:s},o={shape:n};return M.runKernel(fh,a,o)}const Az=F({scatterND_:Rz});function Oz(t,e,n,r){if(t.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const s=t.rank>0?t.shape[0]:1,a=t.rank>1?t.shape[1]:1;if(n.length!==a)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${a}.`);const o=e.size;if(!(e.rank===0||e.rank===1&&o===s))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${s}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dz(t,e,n,r=0){hr(n);const s=N(t,"sparseIndices","sparseToDense","int32"),a=N(e,"sparseValues","sparseToDense","string_or_numeric"),o=N(r,"defaultValue","sparseToDense",a.dtype);Oz(s,a,n,o);const i={sparseIndices:s,sparseValues:a,defaultValue:o},u={outputShape:n};return M.runKernel(vh,i,u)}const Pz=F({sparseToDense_:Dz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fz(t,e){const n=N(e,"indices","gatherND","int32"),s={params:N(t,"x","gatherND","string_or_numeric"),indices:n};return M.runKernel(jf,s)}const Lz=F({gatherND_:Fz});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mz(t,e){if(e==null)return t.shape.slice();if(yt(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)e[r]==null&&t.shape[r]!=null?n.push(t.shape[r]):n.push(e[r]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bz(t,e,n,r){const s=N(t,"x","dropout");if(E(s.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),E(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof Rt?s.clone():s;const a=Mz(s,n),o=1-e,i=Fe(x_(be(Gv(a,0,1,"float32",r),o)),o);return ae(s,i)}const Vz=F({dropout_:Bz});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X_(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function qv(t,e,n){const r=1-t%2,s=new Float32Array(t);for(let a=0;a<t;++a){const o=2*Math.PI*a/(t+r-1);s[a]=e-n*Math.cos(o)}return nn(s,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function zz(t,e,n=1){const r=N(t,"predictions","inTopK"),s=N(e,"targets","inTopK");E(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),E(r.rank-1===s.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${s.rank}`),Yn(r.shape.slice(0,r.shape.length-1),s.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const a=r.shape[r.shape.length-1];E(n>0&&n<=a,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${a}), but got ${n}`);const o=await r.data(),i=await s.data(),[u,c]=[o.length/a,a],l=Ua("bool",u);for(let d=0;d<u;d++){const p=d*c,f=o.subarray(p,p+c),h=[];for(let y=0;y<f.length;y++)h.push({value:f[y],index:y});h.sort((y,x)=>x.value-y.value),l[d]=0;for(let y=0;y<n;y++)if(h[y].index===i[d]){l[d]=1;break}}return t!==r&&r.dispose(),e!==s&&s.dispose(),ns(l,s.shape,"bool")}const Wz=zz;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uz(t,e,n,r,s,a="NHWC",o){let i=t;t.rank===3&&(i=X(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let u=e;u.rank===3&&(u=X(e,[1,e.shape[0],e.shape[1],e.shape[2]])),E(i.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${i.shape}.`),E(u.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${u.shape}.`),E(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=a==="NHWC"?i.shape[3]:i.shape[1],l=a==="NHWC"?u.shape[3]:u.shape[1];E(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),E(l===n[3],()=>`Error in conv2dDerFilter: depth of dy (${l}) must match output depth for filter (${n[3]}).`),Br("conv2dDerFilter",s,o);const d={x:i,dy:u},p={strides:r,pad:s,dataFormat:a,dimRoundingMode:o,filterShape:n};return M.runKernel(i$,d,p)}const Gz=F({conv2DBackpropFilter_:Uz});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oh(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return ae(t,G_(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function Dh(t,e){let n=e;const r=p_(t.shape,e.shape);return r.length>0&&(n=ot(n,r)),X(n,t.shape)}function Ph(t,e,n,r){if(e==="linear")return t;if(e==="relu")return Ah(t);if(e==="elu")return h_(t);if(e==="relu6")return V_(t);if(e==="prelu")return R_(t,n);if(e==="leakyrelu")return b_(t,r);if(e==="sigmoid")return Do(t);throw new Error(`Unknown fused activation ${e}.`)}const Fh=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hz({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:a=[1,1],dimRoundingMode:o,bias:i,activation:u="linear",preluActivationWeights:c,leakyreluAlpha:l}){if(u=u||"linear",Fh(M.state.gradientDepth,u)===!1){E(s==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${s} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let k=kh(t,e,n,r,s,a,o);return i!=null&&(k=be(k,i)),Ph(k,u,c,l)}const d=N(t,"x","conv2d","float32"),p=N(e,"filter","conv2d","float32");let f=d,h=!1;d.rank===3&&(h=!0,f=X(d,[1,d.shape[0],d.shape[1],d.shape[2]])),E(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),E(p.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`),Br("fused conv2d",r,o);const y=s==="NHWC"?f.shape[3]:f.shape[1];E(p.shape[2]===y,()=>`Error in conv2d: depth of input (${y}) must match input depth for filter ${p.shape[2]}.`),E(Rn(n,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`);const x=qt(f.shape,p.shape,n,a,r,o);let g;i!=null&&(g=N(i,"bias","fused conv2d"),[g]=Ct(g,d),s==="NHWC"?Le(x.outShape,g.shape):(E(g.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${g.shape.length}.`),E(g.shape.length===0||g.shape[0]===x.outChannels||g.shape[0]===1,()=>`Error in fused conv2d: bias shape (${g.shape}) is not compatible with the number of output channels (${x.outChannels})`)));let v;if(c!=null){const k=c.shape;if(E(k.length<=1||k.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${k.length}.`),k.length===1)E(k[0]===1||k[0]===x.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${k}) is not compatible with the number of output channels (${x.outChannels}).`);else if(k.length===3)try{Le(k,x.outShape)}catch{const A=`Error in fused conv2d: PReLU activation weights (${k}) is not compatible with the output shape of the conv2d (${x.outShape}).`;throw Error(A)}v=N(c,"prelu weights","fused conv2d")}const w=(k,T)=>{E(s==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${s} but only NHWC is currently supported.`);const[A,B,L,z]=T,Y=Oh(k,L,u);E(dc(a),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`);const Q=d_(B.shape,Y,A,n,r),re=Gz(B,Y,A.shape,n,r),Z=[Q,re];if(z!=null){const de=Dh(z,Y);Z.push(de)}return Z},S={x:f,filter:p,bias:g,preluActivationWeights:v},$={strides:n,pad:r,dataFormat:s,dilations:a,dimRoundingMode:o,activation:u,leakyreluAlpha:l};return i==null?ta((T,A,B)=>{let L=M.runKernel(ic,S,$);return B([A,T,L]),h&&(L=X(L,[L.shape[1],L.shape[2],L.shape[3]])),{value:L,gradFunc:w}})(f,p):ta((T,A,B,L)=>{let z=M.runKernel(ic,S,$);return L([A,T,z,B]),h&&(z=X(z,[z.shape[1],z.shape[2],z.shape[3]])),{value:z,gradFunc:w}})(f,p,g)}const jz=F({fusedConv2d_:Hz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kz(t,e,n,r,s,a=[1,1],o){let i=t;t.rank===3&&(i=X(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let u=e;u.rank===3&&(u=X(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:i,dy:u},l={strides:r,pad:s,dimRoundingMode:o,dilations:a,filterShape:n};return M.runKernel(u$,c,l)}const qz=F({depthwiseConv2dNativeBackpropFilter_:Kz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xz(t,e,n,r,s,a=[1,1],o){let i=e,u=!1;e.rank===3&&(u=!0,i=X(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:i,filter:n},l={strides:r,pad:s,dimRoundingMode:o,dilations:a,inputShape:t},d=M.runKernel(l$,c,l);return u?X(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Yz=F({depthwiseConv2dNativeBackpropInput_:Xz});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qz({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:a=[1,1],dimRoundingMode:o,bias:i,activation:u="linear",preluActivationWeights:c,leakyreluAlpha:l}){if(Fh(M.state.gradientDepth,u)===!1){let $=Mv(t,e,n,r,s,a,o);return i!=null&&($=be($,i)),Ph($,u,c,l)}const d=N(t,"x","depthwiseConv2d","float32"),p=N(e,"filter","depthwiseConv2d","float32");let f=d,h=!1;d.rank===3&&(h=!0,f=X(d,[1,d.shape[0],d.shape[1],d.shape[2]])),E(f.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${f.rank}.`),E(p.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${p.rank}.`),E(f.shape[3]===p.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${f.shape[3]}) must match the inChannels dimension in filter ${p.shape[2]}.`),a==null&&(a=[1,1]),E(Rn(n,a),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),Br("fused depthwiseConv2d",r,o);const y=qt(f.shape,p.shape,n,a,r,o,!0);let x;i!=null&&(x=N(i,"bias","fused conv2d"),[x]=Ct(x,d),Le(y.outShape,x.shape));let g;c!=null&&(g=N(c,"prelu weights","fused depthwiseConv2d"));const v=($,k)=>{E(dc(a),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[T,A,B,L]=k,z=Oh($,B,u),Y=Yz(A.shape,z,T,n,r,a,o),Q=qz(A,z,T.shape,n,r,a,o);if(L!=null){const re=Dh(x,z);return[Y,Q,re]}return[Y,Q]},w={x:f,filter:p,bias:x,preluActivationWeights:g},S={strides:n,pad:r,dataFormat:s,dilations:a,dimRoundingMode:o,activation:u,leakyreluAlpha:l};return i==null?ta((k,T,A)=>{let B=M.runKernel(uc,w,S);return A([T,k,B]),h&&(B=X(B,[B.shape[1],B.shape[2],B.shape[3]])),{value:B,gradFunc:v}})(f,p):ta((k,T,A,B)=>{let L=M.runKernel(uc,w,S);return B([T,k,L,A]),h&&(L=X(L,[L.shape[1],L.shape[2],L.shape[3]])),{value:L,gradFunc:v}})(f,p,x)}const Zz=F({fusedDepthwiseConv2d_:Qz});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jz({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:s,activation:a="linear",preluActivationWeights:o,leakyreluAlpha:i=.2}){if(Fh(M.state.gradientDepth,a)===!1){let z=et(t,e,n,r);return s!=null&&(z=be(z,s)),Ph(z,a,o,i)}let u=N(t,"a","fused matMul"),c=N(e,"b","fused matMul");[u,c]=Ct(u,c);const l=n?u.shape[u.rank-2]:u.shape[u.rank-1],d=r?c.shape[c.rank-1]:c.shape[c.rank-2],p=n?u.shape[u.rank-1]:u.shape[u.rank-2],f=r?c.shape[c.rank-2]:c.shape[c.rank-1],h=u.shape.slice(0,-2),y=c.shape.slice(0,-2),x=K(h),g=K(y);E(l===d,()=>`Error in fused matMul: inner shapes (${l}) and (${d}) of Tensors with shapes ${u.shape} and ${c.shape} and transposeA=${n} and transposeB=${r} must match.`);const w=Le(u.shape.slice(0,-2),c.shape.slice(0,-2)).concat([p,f]),S=n?X(u,[x,l,p]):X(u,[x,p,l]),$=r?X(c,[g,f,d]):X(c,[g,d,f]);let k;s!=null&&(k=N(s,"bias","fused matMul"),[k]=Ct(k,u),Le(w,k.shape));let T;o!=null&&(T=N(o,"prelu weights","fused matMul"));const A=(z,Y)=>{const[Q,re,Z,de]=Y,ce=Oh(X(z,Z.shape),Z,a);let j,ee;if(!n&&!r?(j=et(ce,re,!1,!0),ee=et(Q,ce,!0,!1)):!n&&r?(j=et(ce,re,!1,!1),ee=et(ce,Q,!0,!1)):n&&!r?(j=et(re,ce,!1,!0),ee=et(Q,ce,!1,!1)):(j=et(re,ce,!0,!0),ee=et(ce,Q,!0,!0)),s!=null){const me=Dh(de,ce);return[j,ee,me]}else return[j,ee]},B={a:S,b:$,bias:k,preluActivationWeights:T},L={transposeA:n,transposeB:r,activation:a,leakyreluAlpha:i};return s==null?ta((Y,Q,re)=>{const Z=M.runKernel(oc,B,L);return re([Y,Q,Z]),{value:X(Z,w),gradFunc:A}})(S,$):ta((Y,Q,re,Z)=>{const de=M.runKernel(oc,B,L);return Z([Y,Q,de,re]),{value:X(de,w),gradFunc:A}})(S,$,k)}const eW=F({fusedMatMul_:Jz});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var tW=Object.freeze({__proto__:null,conv2d:jz,depthwiseConv2d:Zz,matMul:eW});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nW(t){return qv(t,.54,.46)}const rW=F({hammingWindow_:nW});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sW(t){return qv(t,.5,.5)}const Y_=F({hannWindow_:sW});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aW(t,e,n,r=!1,s=0){let a=0;const o=[];for(;a+e<=t.size;)o.push(Re(t,a,e)),a+=n;if(r)for(;a<t.size;){const i=a+e-t.size,u=Kt([Re(t,a,e-i),Pc([i],s)]);o.push(u),a+=n}return o.length===0?Po([],[0,e]):X(Kt(o),[o.length,e])}const Q_=F({frame_:aW});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oW(t,e,n,r,s=Y_){r==null&&(r=X_(e));const a=Q_(t,e,n),o=ae(a,s(e));return jv(o,r)}const iW=F({stft_:oW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uW(t,e,n,r,s="bilinear",a=0){const o=N(t,"image","cropAndResize"),i=N(e,"boxes","cropAndResize","float32"),u=N(n,"boxInd","cropAndResize","int32"),c=i.shape[0];E(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),E(i.rank===2&&i.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${i.shape}.`),E(u.rank===1&&u.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${i.shape}.`),E(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),E(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),E(s==="bilinear"||s==="nearest",()=>`method must be bilinear or nearest, but was ${s}`);const l={image:o,boxes:i,boxInd:u},d={method:s,extrapolationValue:a,cropSize:r};return M.runKernel(Vf,l,d)}const lW=F({cropAndResize_:uW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cW(t){const e=N(t,"image","flipLeftRight","float32");E(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return M.runKernel(Gf,n,{})}const dW=F({flipLeftRight_:cW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pW(t){const e=N(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];E(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),E(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const s=new Array(e.rank);return s.fill(1,0,n),s[n]=3,Ml(e,s)}const fW=F({grayscaleToRGB_:pW});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hW(t){const e=N(t,"image","RGBToGrayscale"),n=e.rank-1,r=e.shape[n];E(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),E(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const s=e.dtype,a=gt(e,"float32"),o=nn([.2989,.587,.114]);let i;switch(e.rank){case 2:i=Li("ij,j->i",a,o);break;case 3:i=Li("ijk,k->ij",a,o);break;case 4:i=Li("ijkl,l->ijk",a,o);break;case 5:i=Li("ijklm,m->ijkl",a,o);break;case 6:i=Li("ijklmn,n->ijklm",a,o);break;default:throw new Error("Not a valid tensor rank.")}return i=ws(i,-1),gt(i,s)}const mW=F({rgbToGrayscale_:hW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gW(t,e,n=0,r=.5){const s=N(t,"image","rotateWithOffset","float32");E(s.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`);const a={image:s},o={radians:e,fillValue:n,center:r};return M.runKernel(Ih,a,o)}const yW=F({rotateWithOffset_:gW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pu(t,e,n,r,s,a){r==null&&(r=.5),s==null&&(s=Number.NEGATIVE_INFINITY),a==null&&(a=0);const o=t.shape[0];return n=Math.min(n,o),E(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),E(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),E(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),E(e.rank===1,()=>"scores must be a 1D tensor"),E(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),E(0<=a&&a<=1,()=>`softNmsSigma must be in [0, 1], but was '${a}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xW(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const a=N(t,"boxes","nonMaxSuppression","float32"),o=N(e,"scores","nonMaxSuppression","float32"),i=Pu(a,o,n,r,s);n=i.maxOutputSize,r=i.iouThreshold,s=i.scoreThreshold;const u={maxOutputSize:n,iouThreshold:r,scoreThreshold:s};return M.runKernel(rh,{boxes:a,scores:o},u)}const vW=F({nonMaxSuppression_:xW});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wW(t,e,n){const r=bW(t,e,n),s=r<0?-(r+1):r;t.splice(s,0,e)}function bW(t,e,n){return CW(t,e,n||SW)}function SW(t,e){return t>e?1:t<e?-1:0}function CW(t,e,n){let r=0,s=t.length,a=0,o=!1;for(;r<s;){a=r+(s-r>>>1);const i=n(e,t[a]);i>0?r=a+1:(s=a,o=!i)}return o?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z_(t,e,n,r,s){return Xv(t,e,n,r,s,0)}function J_(t,e,n,r,s,a){return Xv(t,e,n,r,s,0,!1,a,!0)}function eN(t,e,n,r,s,a){return Xv(t,e,n,r,s,a,!0)}function Xv(t,e,n,r,s,a,o=!1,i=!1,u=!1){const c=[];for(let x=0;x<e.length;x++)e[x]>s&&c.push({score:e[x],boxIndex:x,suppressBeginIndex:0});c.sort(Pb);const l=a>0?-.5/a:0,d=[],p=[];for(;d.length<n&&c.length>0;){const x=c.pop(),{score:g,boxIndex:v,suppressBeginIndex:w}=x;if(g<s)break;let S=!1;for(let $=d.length-1;$>=w;--$){const k=IW(t,v,d[$]);if(k>=r){S=!0;break}if(x.score=x.score*$W(r,l,k),x.score<=s)break}x.suppressBeginIndex=d.length,S||(x.score===g?(d.push(v),p.push(x.score)):x.score>s&&wW(c,x,Pb))}const f=d.length,h=n-f;i&&h>0&&(d.push(...new Array(h).fill(0)),p.push(...new Array(h).fill(0)));const y={selectedIndices:d};return o&&(y.selectedScores=p),u&&(y.validOutputs=f),y}function IW(t,e,n){const r=t.subarray(e*4,e*4+4),s=t.subarray(n*4,n*4+4),a=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),i=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(s[0],s[2]),l=Math.min(s[1],s[3]),d=Math.max(s[0],s[2]),p=Math.max(s[1],s[3]),f=(i-a)*(u-o),h=(d-c)*(p-l);if(f<=0||h<=0)return 0;const y=Math.max(a,c),x=Math.max(o,l),g=Math.min(i,d),v=Math.min(u,p),w=Math.max(g-y,0)*Math.max(v-x,0);return w/(f+h-w)}function $W(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function Pb(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function _W(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const a=N(t,"boxes","nonMaxSuppressionAsync"),o=N(e,"scores","nonMaxSuppressionAsync"),i=Pu(a,o,n,r,s);n=i.maxOutputSize,r=i.iouThreshold,s=i.scoreThreshold;const u=await Promise.all([a.data(),o.data()]),c=u[0],l=u[1],{selectedIndices:d}=Z_(c,l,n,r,s);return a!==t&&a.dispose(),o!==e&&o.dispose(),nn(d,"int32")}const NW=_W;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kW(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,a=0){const o=N(t,"boxes","nonMaxSuppression"),i=N(e,"scores","nonMaxSuppression"),u=Pu(o,i,n,r,s,a);n=u.maxOutputSize,r=u.iouThreshold,s=u.scoreThreshold,a=u.softNmsSigma;const c={boxes:o,scores:i},l={maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:a},d=M.runKernel(ah,c,l);return{selectedIndices:d[0],selectedScores:d[1]}}const EW=F({nonMaxSuppressionWithScore_:kW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function TW(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,a=0){const o=N(t,"boxes","nonMaxSuppressionAsync"),i=N(e,"scores","nonMaxSuppressionAsync"),u=Pu(o,i,n,r,s,a);n=u.maxOutputSize,r=u.iouThreshold,s=u.scoreThreshold,a=u.softNmsSigma;const c=await Promise.all([o.data(),i.data()]),l=c[0],d=c[1],{selectedIndices:p,selectedScores:f}=eN(l,d,n,r,s,a);return o!==t&&o.dispose(),i!==e&&i.dispose(),{selectedIndices:nn(p,"int32"),selectedScores:nn(f)}}const RW=TW;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AW(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,a=!1){const o=N(t,"boxes","nonMaxSuppression"),i=N(e,"scores","nonMaxSuppression"),u=Pu(o,i,n,r,s,null),c=u.maxOutputSize,l=u.iouThreshold,d=u.scoreThreshold,p={boxes:o,scores:i},f={maxOutputSize:c,iouThreshold:l,scoreThreshold:d,padToMaxOutputSize:a},h=M.runKernel(sh,p,f);return{selectedIndices:h[0],validOutputs:h[1]}}const OW=F({nonMaxSuppressionPadded_:AW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function DW(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,a=!1){const o=N(t,"boxes","nonMaxSuppressionAsync"),i=N(e,"scores","nonMaxSuppressionAsync"),u=Pu(o,i,n,r,s,null),c=u.maxOutputSize,l=u.iouThreshold,d=u.scoreThreshold,[p,f]=await Promise.all([o.data(),i.data()]),{selectedIndices:h,validOutputs:y}=J_(p,f,c,l,d,a);return o!==t&&o.dispose(),i!==e&&i.dispose(),{selectedIndices:nn(h,"int32"),validOutputs:Ve(y,"int32")}}const PW=DW;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FW(t,e,n=!1,r=!1){const s=N(t,"images","resizeBilinear");E(s.rank===3||s.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),E(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),E(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let a=s,o=!1;s.rank===3&&(o=!0,a=X(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const i={images:a},u={alignCorners:n,halfPixelCenters:r,size:e},c=M.runKernel(dh,i,u);return o?X(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const LW=F({resizeBilinear_:FW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MW(t,e,n=!1,r=!1){const s=N(t,"images","resizeNearestNeighbor");E(s.rank===3||s.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),E(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),E(s.dtype==="float32"||s.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),E(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let a=s,o=!1;s.rank===3&&(o=!0,a=X(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const i={images:a},u={alignCorners:n,halfPixelCenters:r,size:e},c=M.runKernel(ch,i,u);return o?X(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const BW=F({resizeNearestNeighbor_:MW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VW(t,e="binary",n=!1,r=.5){const s=N(t,"image","threshold"),a=.2989,o=.587,i=.114,u=s.shape[0]*s.shape[1];let c=ae(nn([r]),255),l,d,p,f;if(E(s.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`),E(s.shape[2]===3||s.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`),E(s.dtype==="int32"||s.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`),E(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),s.shape[2]===3){[l,d,p]=gc(s,[1,1,1],-1);const x=ae(l,a),g=ae(d,o),v=ae(p,i);f=be(be(x,g),v)}else f=t;if(e==="otsu"){const x=l_(gt(z_(f),"int32"),ns([]),256);c=zW(x,u)}const h=n?Vv(f,c):Th(f,c);return gt(ae(h,255),"int32")}function zW(t,e){let n=nn([-1]),r=nn([0]),s=nn([0]),a,o,i,u,c,l;for(let d=0;d<t.size-1;d++){a=Re(t,0,d+1),o=Re(t,d+1),c=Fe(ot(a),e),l=Fe(ot(o),e);const p=ot(ae(a,hc(0,a.size)));i=Fe(p,ot(a));const f=Pc(o.shape,a.size),h=be(hc(0,o.size),f),y=ae(o,h);u=Fe(ot(y),ot(o));const x=Ae(i,u),g=Ae(i,u),v=ae(c,l);s=ae(ae(v,x),g);const w=Th(s,r);r=La(w,s,r),n=La(w,nn([d]),n)}return n}const WW=F({threshold_:VW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UW(t,e,n="nearest",r="constant",s=0,a){const o=N(t,"image","transform","float32"),i=N(e,"transforms","transform","float32");E(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),E(i.rank===2&&(i.shape[0]===o.shape[0]||i.shape[0]===1)&&i.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),E(a==null||a.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${a}.`);const u={image:o,transforms:i},c={interpolation:n,fillMode:r,fillValue:s,outputShape:a};return M.runKernel(Sh,u,c)}const GW=F({transform_:UW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HW(t,e,n){const r=N(t,"a","bandPart");E(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const s=r.shape,[a,o]=r.shape.slice(-2);let i,u;typeof e=="number"?(E(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),E(e<=a,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${a}).`),i=N(e<0?a:e,"numLower","bandPart")):(E(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),i=La(fy(e,0),a,Vp(e,a))),typeof n=="number"?(E(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),E(n<=o,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`),u=N(n<0?o:n,"numUpper","bandPart")):(E(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),u=La(fy(n,0),o,Vp(n,o)));const c=X(hc(0,a,1,"int32"),[-1,1]),l=hc(0,o,1,"int32"),d=Ae(c,l),p=Mp(Vv(d,i),w_(d,Ns(u))),f=qo([a,o],r.dtype);return X(na(ui(X(r,[-1,a,o])).map(h=>La(p,h,f))),s)}const jW=F({bandPart_:HW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KW(t){let e;if(Array.isArray(t)){e=!1,E(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const s=t[0].shape[0];for(let a=1;a<t.length;++a)E(t[a].shape[0]===s,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[a].shape[0]} vs. ${s})`)}else e=!0,t=gc(t,t.shape[0],0).map(s=>Wt(s,[0]));E(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let s=0;s<t.length;++s)n.push(M.tidy(()=>{let a=r[s];if(s>0)for(let o=0;o<s;++o){const i=ae(ot(ae(n[o],a)),n[o]);a=Ae(a,i)}return Fe(a,Eh(a,"euclidean"))}));return e?na(n,0):n}const qW=F({gramSchmidt_:KW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XW(t,e=!1){if(E(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return Fb(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((u,c)=>u*c),r=ui(X(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),s=[],a=[];r.forEach(u=>{const[c,l]=Fb(u,e);s.push(c),a.push(l)});const o=X(na(s,0),t.shape),i=X(na(a,0),t.shape);return[o,i]}}function Fb(t,e=!1){return M.tidy(()=>{E(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let s=y_(n),a=Fa(t);const o=Po([[1]],[1,1]);let i=Fa(o);const u=n>=r?r:n;for(let c=0;c<u;++c){const l=a,d=i,p=s;[i,a,s]=M.tidy(()=>{const f=Re(a,[c,c],[n-c,1]),h=Eh(f),y=Re(a,[c,c],[1,1]),x=La(Th(y,0),Po([[-1]]),Po([[1]])),g=Ae(y,ae(x,h)),v=Fe(f,g);v.shape[0]===1?i=Fa(o):i=Kt([o,Re(v,[1,0],[v.shape[0]-1,v.shape[1]])],0);const w=Ns(Fe(et(x,g),h)),S=Re(a,[c,0],[n-c,r]),$=ae(w,i),k=hy(i);if(c===0)a=Ae(S,et($,et(k,S)));else{const B=Ae(S,et($,et(k,S)));a=Kt([Re(a,[0,0],[c,r]),B],0)}const T=hy($),A=Re(s,[0,c],[n,s.shape[1]-c]);if(c===0)s=Ae(A,et(et(A,i),T));else{const B=Ae(A,et(et(A,i),T));s=Kt([Re(s,[0,0],[n,c]),B],1)}return[i,a,s]}),ht([l,d,p])}return!e&&n>r&&(s=Re(s,[0,0],[n,r]),a=Re(a,[0,0],[r,r])),[s,a]})}const YW=F({qr_:XW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var $n;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})($n||($n={}));function QW(t,e,n=$n.SUM_BY_NONZERO_WEIGHTS){const r=N(t,"losses","computeWeightedLoss");let s=null;e!=null&&(s=N(e,"weights","computeWeightedLoss"));const a=s==null?r:ae(r,s);if(n===$n.NONE)return a;if(n===$n.SUM)return ot(a);if(n===$n.MEAN){if(s==null)return Bp(a);{const o=r.size/s.size,i=Fe(ot(a),ot(s));return o>1?Fe(i,Ve(o)):i}}if(n===$n.SUM_BY_NONZERO_WEIGHTS){if(s==null)return Fe(ot(a),Ve(r.size));{const o=ae(s,To(r.shape)),i=gt(ot(E_(o,Ve(0))),"float32");return Fe(ot(a),i)}}throw Error(`Unknown reduction: ${n}`)}const oa=F({computeWeightedLoss_:QW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZW(t,e,n,r=$n.SUM_BY_NONZERO_WEIGHTS){const s=N(t,"labels","absoluteDifference"),a=N(e,"predictions","absoluteDifference");let o=null;n!=null&&(o=N(n,"weights","absoluteDifference")),Yn(s.shape,a.shape,"Error in absoluteDifference: ");const i=nr(Ae(s,a));return oa(i,o,r)}const JW=F({absoluteDifference_:ZW});function eU(t,e,n,r,s=$n.SUM_BY_NONZERO_WEIGHTS){const a=N(t,"labels","cosineDistance"),o=N(e,"predictions","cosineDistance");let i=null;r!=null&&(i=N(r,"weights","cosineDistance")),Yn(a.shape,o.shape,"Error in cosineDistance: ");const u=Ve(1),c=Ae(u,ot(ae(a,o),n,!0));return oa(c,i,s)}const tU=F({cosineDistance_:eU});function nU(t,e,n,r=$n.SUM_BY_NONZERO_WEIGHTS){let s=N(t,"labels","hingeLoss");const a=N(e,"predictions","hingeLoss");let o=null;n!=null&&(o=N(n,"weights","hingeLoss")),Yn(s.shape,a.shape,"Error in hingeLoss: ");const i=Ve(1);s=Ae(ae(Ve(2),s),i);const u=Ah(Ae(i,ae(s,a)));return oa(u,o,r)}const rU=F({hingeLoss_:nU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sU(t,e,n,r=1,s=$n.SUM_BY_NONZERO_WEIGHTS){const a=N(t,"labels","huberLoss"),o=N(e,"predictions","huberLoss");let i=null;n!=null&&(i=N(n,"weights","huberLoss")),Yn(a.shape,o.shape,"Error in huberLoss: ");const u=Ve(r),c=nr(Ae(o,a)),l=Vp(c,u),d=Ae(c,l),p=be(ae(Ve(.5),rs(l)),ae(u,d));return oa(p,i,s)}const aU=F({huberLoss_:sU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oU(t,e,n,r=1e-7,s=$n.SUM_BY_NONZERO_WEIGHTS){const a=N(t,"labels","logLoss"),o=N(e,"predictions","logLoss");let i=null;n!=null&&(i=N(n,"weights","logLoss")),Yn(a.shape,o.shape,"Error in logLoss: ");const u=Ve(1),c=Ve(r),l=Ns(ae(a,fc(be(o,c)))),d=ae(Ae(u,a),fc(be(Ae(u,o),c))),p=Ae(l,d);return oa(p,i,s)}const iU=F({logLoss_:oU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uU(t,e,n,r=$n.SUM_BY_NONZERO_WEIGHTS){const s=N(t,"labels","meanSquaredError"),a=N(e,"predictions","meanSquaredError");let o=null;n!=null&&(o=N(n,"weights","meanSquaredError")),Yn(s.shape,a.shape,"Error in meanSquaredError: ");const i=U_(s,a);return oa(i,o,r)}const lU=F({meanSquaredError_:uU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cU(t,e){const n=N(t,"labels","sigmoidCrossEntropyWithLogits"),r=N(e,"logits","sigmoidCrossEntropyWithLogits");Yn(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const s=Ah(r),a=ae(r,n),o=S_(ea(Ns(nr(r))));return be(Ae(s,a),o)}function dU(t,e,n,r=0,s=$n.SUM_BY_NONZERO_WEIGHTS){let a=N(t,"multiClassLabels","sigmoidCrossEntropy");const o=N(e,"logits","sigmoidCrossEntropy");let i=null;if(n!=null&&(i=N(n,"weights","sigmoidCrossEntropy")),Yn(a.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){const c=Ve(r),l=Ve(1),d=Ve(.5);a=be(ae(a,Ae(l,c)),ae(d,c))}const u=cU(a,o);return oa(u,i,s)}const pU=F({sigmoidCrossEntropy_:dU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fU(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return ta((s,a,o)=>{const u=I_(a,[n],!0),c=Ae(gt(a,"float32"),u);o([s,c]);const l=Ns(ae(c,s));return{value:ot(l,[n]),gradFunc:(f,h)=>{const[y,x]=h,g=Ot(f.shape,[n]);return[ae(X(f,g),Ae(gt(y,"float32"),ea(x))),ae(X(f,g),Ae(ea(x),gt(y,"float32")))]}}})(t,e)}function hU(t,e,n,r=0,s=$n.SUM_BY_NONZERO_WEIGHTS){let a=N(t,"onehotLabels","softmaxCrossEntropy");const o=N(e,"logits","softmaxCrossEntropy");let i=null;if(n!=null&&(i=N(n,"weights","softmaxCrossEntropy")),Yn(a.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){const c=Ve(r),l=Ve(1),d=Ve(a.shape[1]);a=be(ae(a,Ae(l,c)),Fe(c,d))}const u=fU(a,o);return oa(u,i,s)}const mU=F({softmaxCrossEntropy_:hU});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gU(t,e,n,r){const s=N(t,"indices","sparseFillEmptyRows","int32"),a=N(e,"values","sparseFillEmptyRows"),o=N(n,"denseShape","sparseFillEmptyRows","int32"),i=N(r,"defaultValue","sparseFillEmptyRows",a.dtype);if(s.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${s.shape}`);if(a.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${a.shape}`);if(o.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(i.rank!==0)throw new Error(`Default value should be a scalar but received shape ${i.shape}`);const u={indices:s,values:a,denseShape:o,defaultValue:i},c=M.runKernel(vv,u);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}const yU=F({sparseFillEmptyRows_:gU});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xU(t,e,n){const r=N(t,"inputIndices","sparseReshape","int32"),s=N(e,"inputShape","sparseReshape","int32"),a=N(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(s.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${s.shape}`);if(a.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${a.shape}`);const o={inputIndices:r,inputShape:s,newShape:a},i=M.runKernel(xh,o);return{outputIndices:i[0],outputShape:i[1]}}const vU=F({sparseReshape_:xU});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wU(t,e,n){const r=N(t,"data","sparseSegmentMean"),s=N(e,"indices","sparseSegmentMean","int32"),a=N(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${s.shape}`);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${a.shape}`);const o={data:r,indices:s,segmentIds:a};return M.runKernel(wv,o)}const bU=F({sparseSegmentMean_:wU});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SU(t,e,n){const r=N(t,"data","sparseSegmentSum"),s=N(e,"indices","sparseSegmentSum","int32"),a=N(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${s.shape}`);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${a.shape}`);const o={data:r,indices:s,segmentIds:a};return M.runKernel(bv,o)}const CU=F({sparseSegmentSum_:SU});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IU(t,e,n,r,s,a,o,i){const u=N(t,"data","stringNGrams","string");if(u.dtype!=="string")throw new Error("Data must be of datatype string");if(u.shape.length!==1)throw new Error(`Data must be a vector, saw: ${u.shape}`);const c=N(e,"dataSplits","stringNGrams");if(c.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const l={separator:n,nGramWidths:r,leftPad:s,rightPad:a,padWidth:o,preserveShortSequences:i},d={data:u,dataSplits:c},p=M.runKernel(Cv,d,l);return{nGrams:p[0],nGramsSplits:p[1]}}const $U=F({stringNGrams_:IU});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _U(t,e,n=!0){const r=N(t,"input","stringSplit","string"),s=N(e,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(s.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${s.shape}`);const a={skipEmpty:n},o={input:r,delimiter:s},i=M.runKernel(Iv,o,a);return{indices:i[0],values:i[1],shape:i[2]}}const NU=F({stringSplit_:_U});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kU(t,e){const n=N(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const s={input:n};return M.runKernel($v,s,r)}const EU=F({stringToHashBucketFast_:kU});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TU(t,e,n,r=!0){const s=N(t,"input","staticRegexReplace","string"),a={pattern:e,rewrite:n,replaceGlobal:r};return M.runKernel(C$,{x:s},a)}const RU=F({staticRegexReplace_:TU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AU={fft:Hv,ifft:zp,rfft:jv,irfft:W_},OU={hammingWindow:rW,hannWindow:Y_,frame:Q_,stft:iW},Lh={flipLeftRight:dW,grayscaleToRGB:fW,resizeNearestNeighbor:BW,resizeBilinear:LW,rgbToGrayscale:mW,rotateWithOffset:yW,cropAndResize:lW,nonMaxSuppression:vW,nonMaxSuppressionAsync:NW,nonMaxSuppressionWithScore:EW,nonMaxSuppressionWithScoreAsync:RW,nonMaxSuppressionPadded:OW,nonMaxSuppressionPaddedAsync:PW,threshold:WW,transform:GW},DU={bandPart:jW,gramSchmidt:qW,qr:YW},PU={absoluteDifference:JW,computeWeightedLoss:oa,cosineDistance:tU,hingeLoss:rU,huberLoss:aU,logLoss:iU,meanSquaredError:lU,sigmoidCrossEntropy:pU,softmaxCrossEntropy:mU},FU={sparseFillEmptyRows:yU,sparseReshape:vU,sparseSegmentMean:bU,sparseSegmentSum:CU},LU={stringNGrams:$U,stringSplit:NU,stringToHashBucketFast:EU,staticRegexReplace:RU};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MU=new Map,BU=new Map;class VU{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class So{constructor(){this.classNameMap={}}static getMap(){return So.instance==null&&(So.instance=new So),So.instance}static register(e){So.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function zU(t,e,n){E(t.className!=null,()=>"Class being registered does not have the static className property defined."),E(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),E(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const r=n,s=e+">"+r;return So.register(t),MU.set(s,t),BU.set(t,s),t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class li extends VU{minimize(e,n=!1,r){const{value:s,grads:a}=this.computeGradients(e,r);if(r!=null){const o=r.map(i=>({name:i.name,tensor:a[i.name]}));this.applyGradients(o)}else this.applyGradients(a);return ht(a),n?s:(s.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return NB(e,n)}dispose(){this.iterations_!=null&&ht(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Ve(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(li,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WU extends li{static get className(){return"Adadelta"}constructor(e,n,r=null){super(),this.learningRate=e,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=M.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const a=M.registeredVariables[r],o=!1;this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accum_grad`,variable:De(()=>cr(a).variable(o))}),this.accumulatedUpdates[s]==null&&(this.accumulatedUpdates[s]={originalName:`${r}/accum_var`,variable:De(()=>cr(a).variable(o))});const i=Array.isArray(e)?e[s].tensor:e[r];if(i==null)return;const u=this.accumulatedGrads[s].variable,c=this.accumulatedUpdates[s].variable;De(()=>{const l=be(ae(u,this.rho),ae(rs(i),1-this.rho)),d=ae(Fe(Js(be(c,this.epsilon)),Js(be(u,this.epsilon))),i),p=be(ae(c,this.rho),ae(rs(d),1-this.rho));u.assign(l),c.assign(p);const f=be(ae(d,-this.learningRate),a);a.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(ht(this.accumulatedGrads.map(e=>e.variable)),ht(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedUpdates=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UU extends li{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const a=M.registeredVariables[r];this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accumulator`,variable:De(()=>Pc(a.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(e)?e[s].tensor:e[r];if(o==null)return;const i=this.accumulatedGrads[s].variable;De(()=>{const u=be(i,rs(o));i.assign(u);const c=be(ae(Fe(o,Js(be(u,M.backend.epsilon()))),-this.learningRate),a);a.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&ht(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GU extends li{static get className(){return"Adam"}constructor(e,n,r,s=null){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],De(()=>{this.accBeta1=Ve(n).variable(),this.accBeta2=Ve(r).variable()}),s==null&&(this.epsilon=M.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);De(()=>{const r=Ae(1,this.accBeta1),s=Ae(1,this.accBeta2);n.forEach((a,o)=>{const i=M.registeredVariables[a],u=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${a}/m`,variable:De(()=>cr(i).variable(u))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${a}/v`,variable:De(()=>cr(i).variable(u))});const c=Array.isArray(e)?e[o].tensor:e[a];if(c==null)return;const l=this.accumulatedFirstMoment[o].variable,d=this.accumulatedSecondMoment[o].variable,p=be(ae(l,this.beta1),ae(c,1-this.beta1)),f=be(ae(d,this.beta2),ae(rs(c),1-this.beta2)),h=Fe(p,r),y=Fe(f,s);l.assign(p),d.assign(f);const x=be(ae(Fe(h,be(Js(y),this.epsilon)),-this.learningRate),i);i.assign(x)}),this.accBeta1.assign(ae(this.accBeta1,this.beta1)),this.accBeta2.assign(ae(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&ht(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&ht(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),De(()=>{this.accBeta1.assign(pc(this.beta1,this.iterations_+1)),this.accBeta2.assign(pc(this.beta2,this.iterations_+1))});const n=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HU extends li{static get className(){return"Adamax"}constructor(e,n,r,s=null,a=0){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],De(()=>{this.iteration=Ve(0).variable(),this.accBeta1=Ve(n).variable()}),s==null&&(this.epsilon=M.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);De(()=>{const r=Ae(1,this.accBeta1),s=Fe(-this.learningRate,be(ae(this.iteration,this.decay),1));n.forEach((a,o)=>{const i=M.registeredVariables[a],u=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${a}/m`,variable:cr(i).variable(u)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${a}/v`,variable:cr(i).variable(u)});const c=Array.isArray(e)?e[o].tensor:e[a];if(c==null)return;const l=this.accumulatedFirstMoment[o].variable,d=this.accumulatedWeightedInfNorm[o].variable,p=be(ae(l,this.beta1),ae(c,1-this.beta1)),f=ae(d,this.beta2),h=nr(c),y=k_(f,h);l.assign(p),d.assign(y);const x=be(ae(Fe(s,r),Fe(p,be(y,this.epsilon))),i);i.assign(x)}),this.iteration.assign(be(this.iteration,1)),this.accBeta1.assign(ae(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&ht(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&ht(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tN extends li{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const o=M.registeredVariables[r];De(()=>{const i=be(ae(this.c,a),o);o.assign(i)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Cs(Ve(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jU extends tN{static get className(){return"Momentum"}constructor(e,n,r=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=Ve(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const a=M.registeredVariables[r];this.accumulations[s]==null&&(this.accumulations[s]={originalName:`${r}/momentum`,variable:De(()=>cr(a).variable(!1))});const o=this.accumulations[s].variable,i=Array.isArray(e)?e[s].tensor:e[r];i!=null&&De(()=>{let u;const c=be(ae(this.m,o),i);this.useNesterov?u=be(ae(this.c,be(i,ae(c,this.m))),a):u=be(ae(this.c,c),a),o.assign(c),a.assign(u)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&ht(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KU extends li{static get className(){return"RMSProp"}constructor(e,n=.9,r=0,s=null,a=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=r,this.epsilon=s,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,s==null&&(this.epsilon=M.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const a=M.registeredVariables[r],o=!1;this.accumulatedMeanSquares[s]==null&&(this.accumulatedMeanSquares[s]={originalName:`${r}/rms`,variable:De(()=>cr(a).variable(o))}),this.accumulatedMoments[s]==null&&(this.accumulatedMoments[s]={originalName:`${r}/momentum`,variable:De(()=>cr(a).variable(o))}),this.accumulatedMeanGrads[s]==null&&this.centered&&(this.accumulatedMeanGrads[s]={originalName:`${r}/mg`,variable:De(()=>cr(a).variable(o))});const i=Array.isArray(e)?e[s].tensor:e[r];if(i==null)return;const u=this.accumulatedMeanSquares[s].variable,c=this.accumulatedMoments[s].variable;De(()=>{const l=be(ae(u,this.decay),ae(rs(i),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[s].variable,p=be(ae(d,this.decay),ae(i,1-this.decay)),f=Fe(ae(i,this.learningRate),Js(Ae(l,be(rs(p),this.epsilon)))),h=be(ae(c,this.momentum),f);u.assign(l),d.assign(p),c.assign(h);const y=Ae(a,h);a.assign(y)}else{const d=be(ae(u,this.decay),ae(rs(i),1-this.decay)),p=be(ae(c,this.momentum),Fe(ae(i,this.learningRate),Js(be(d,this.epsilon))));u.assign(d),c.assign(p);const f=Ae(a,p);a.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&ht(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&ht(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&ht(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedMoments=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qU=[WU,UU,GU,HU,jU,KU,tN];function XU(){for(const t of qU)zU(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YU="model",QU=".json",ZU=".weights.bin";function Lb(t){return new Promise(e=>setTimeout(e)).then(t)}class Yo{constructor(e){if(!U().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(Yo.URL_SCHEME)&&(e=e.slice(Yo.URL_SCHEME.length)),(e==null||e.length===0)&&(e=YU),this.modelJsonFileName=e+QU,this.weightDataFileName=e+ZU}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=ds.join(e.weightData),r=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const s=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],a=Y$(e,s),o=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),i=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(i.download=this.modelJsonFileName,i.href=o,await Lb(()=>i.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const u=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;u.download=this.weightDataFileName,u.href=r,await Lb(()=>u.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Oc(e)}}}}Yo.URL_SCHEME="downloads://";class JU{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,n)=>{const r=new FileReader;r.onload=s=>{const a=JSON.parse(s.target.result),o=a.modelTopology;if(o==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(a.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:o});return}const u=Fv(a,c=>this.loadWeights(c));e(u)},r.onerror=s=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(e){const n=[],r=[];for(const o of e)n.push(...o.weights),r.push(...o.paths);const s=this.checkManifestAndWeightFiles(e),a=r.map(o=>this.loadWeightsFile(o,s[o]));return Promise.all(a).then(o=>[n,o])}loadWeightsFile(e,n){return new Promise((r,s)=>{const a=new FileReader;a.onload=o=>{const i=o.target.result;r(i)},a.onerror=o=>s(`Failed to weights data from file of path '${e}'.`),a.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(e){const n=[],r=this.weightsFiles.map(a=>Db(a.name)),s={};for(const a of e)a.paths.forEach(o=>{const i=Db(o);if(n.indexOf(i)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${i}'`);if(n.push(i),r.indexOf(i)===-1)throw new Error(`Weight file with basename '${i}' is not provided.`);s[o]=this.weightsFiles[r.indexOf(i)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return s}}const eG=t=>U().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Yo.URL_SCHEME)?tG(t.slice(Yo.URL_SCHEME.length)):null;ft.registerSaveRouter(eG);function tG(t="model"){return new Yo(t)}function nG(t){return new JU(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mb(t,e,n,r){o(t),n=n??0,r=r??1,i(n,r);let s=0;const a=u=>(u.then(c=>{const l=n+ ++s/t.length*(r-n);return e(l),c}),u);function o(u){E(u!=null&&Array.isArray(u)&&u.length>0,()=>"promises must be a none empty array")}function i(u,c){E(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${u}`),E(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),E(c>=u,()=>`startFraction must be no more than endFraction, but got startFraction ${u} and endFraction ${c}`)}return Promise.all(t.map(a))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function nN(t,e){e==null&&(e={});const n=e.fetchFunc==null?U().platform.fetch:e.fetchFunc,r=t.map(d=>n(d,e.requestInit,{isBinary:!0})),i=(e.onProgress==null?await Promise.all(r):await Mb(r,e.onProgress,0,.5)).map(d=>d.arrayBuffer());return e.onProgress==null?await Promise.all(i):await Mb(i,e.onProgress,.5,1)}function rG(t,e){var n;const r=e.fetchFunc==null?U().platform.fetch:e.fetchFunc;let s=0,a;return(n=e.onProgress)===null||n===void 0||n.call(e,0),new ReadableStream({pull:async o=>{for(var i;s<t.length;){a||(a=(await r(t[s],e.requestInit,{isBinary:!0})).body.getReader());const{done:u,value:c}=await a.read();if(u){s++,a=void 0,(i=e.onProgress)===null||i===void 0||i.call(e,s/t.length);continue}o.enqueue(c);return}o.close()}})}async function sG(t,e="",n,r){return rN(o=>nN(o,{requestInit:r}))(t,e,n)}function rN(t){return async(e,n="",r)=>{const s=e.map(()=>!1),a={},o=r!=null?r.map(()=>!1):[],i=[];if(e.forEach((f,h)=>{let y=0;f.weights.forEach(x=>{const g="quantization"in x?x.quantization.dtype:x.dtype,v=Go[g]*K(x.shape),w=()=>{s[h]=!0,a[h]==null&&(a[h]=[]),a[h].push({manifestEntry:x,groupOffset:y,sizeBytes:v})};r!=null?r.forEach((S,$)=>{S===x.name&&(w(),o[$]=!0)}):w(),i.push(x.name),y+=v})}),!o.every(f=>f)){const f=r.filter((h,y)=>!o[y]);throw new Error(`Could not find weights in manifest with names: ${f.join(", ")}. 
Manifest JSON has weights with names: ${i.join(", ")}.`)}const u=s.reduce((f,h,y)=>(h&&f.push(y),f),[]),c=[];u.forEach(f=>{e[f].paths.forEach(h=>{const y=n+(n.endsWith("/")?"":"/")+h;c.push(y)})});const l=await t(c),d={};let p=0;return u.forEach(f=>{const h=e[f].paths.length,y=new ds(l.slice(p,p+h));a[f].forEach(g=>{const v=y.slice(g.groupOffset,g.groupOffset+g.sizeBytes),w=K$(v,[g.manifestEntry]);for(const S in w)d[S]=w[S]}),p+=h}),d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aG="application/octet-stream",oG="application/json";class Yv{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(E(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=U().platform.fetch,E(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&E(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],s=Y$(e,r);if(n.body.append("model.json",new Blob([JSON.stringify(s)],{type:oG}),"model.json"),e.weightData!=null){const o=ds.join(e.weightData);n.body.append("model.weights.bin",new Blob([o],{type:aG}),"model.weights.bin")}const a=await this.fetch(this.path,n);if(a.ok)return{modelArtifactsInfo:Oc(e),responses:[a]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${a.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let o=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?o+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":o+=" Please make sure the server is serving valid JSON for this request.",new Error(o)}const r=n.modelTopology,s=n.weightsManifest;if(r==null&&s==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return Fv(e,n=>this.loadWeights(n))}async loadStream(){const e=await this.loadModelJSON(),n=await this.getWeightUrls(e.weightsManifest),r=oy(e.weightsManifest),s=()=>rG(n,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:r,getWeightStream:s})}async getWeightUrls(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[r,s]=iG(n),a=this.weightPathPrefix||r,o=[],i=[];for(const u of e)for(const c of u.paths)this.weightUrlConverter!=null?i.push(this.weightUrlConverter(c)):o.push(a+c+s);return this.weightUrlConverter&&o.push(...await Promise.all(i)),o}async loadWeights(e){const n=await this.getWeightUrls(e),r=oy(e),s=await nN(n,this.loadOptions);return[r,s]}}Yv.URL_SCHEME_REGEX=/^https?:\/\//;function iG(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),s=n>e?t.substring(n):"";return[r+"/",s]}function my(t){return t.match(Yv.URL_SCHEME_REGEX)!=null}const sN=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(r=>my(r)):n=my(t),n)return Qv(t,e)}return null};ft.registerSaveRouter(sN);ft.registerLoadRouter(sN);function Qv(t,e){return new Yv(t,e)}function uG(t,e){return Qv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Am{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class aN{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class lG{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=n=>Promise.resolve(e.save(n)))}}function cG(t,e,n,r){const s=arguments;return new lG(oN(...s))}function oN(t,e,n,r){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new Am(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Am({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Am({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))}function dG(t){return new aN(t)}function pG(t){return new aN(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var iN=Object.freeze({__proto__:null,CompositeArrayBuffer:ds,browserFiles:nG,browserHTTPRequest:uG,concatenateArrayBuffers:f3,copyModel:P3,decodeWeights:K$,decodeWeightsStream:X$,encodeWeights:i3,fromMemory:cG,fromMemorySync:oN,getLoadHandlers:b3,getModelArtifactsForJSON:Fv,getModelArtifactsForJSONSync:Q$,getModelArtifactsInfoForJSON:Oc,getSaveHandlers:w3,getWeightSpecs:oy,http:Qv,isHTTPScheme:my,listModels:O3,loadWeights:sG,moveModel:F3,registerLoadRouter:v3,registerSaveRouter:x3,removeModel:D3,weightsLoaderFactory:rN,withSaveHandler:dG,withSaveHandlerSync:pG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let go;function fG(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,s=!1,a=!1,o=!1,i=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)s=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)a=!0;else if(t.getContext!=null)o=!0;else if(typeof ImageBitmap<"u"&&t instanceof ImageBitmap)i=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);if(Jg(Zg,M.backendName)!=null){const h={pixels:t},y={numChannels:e};return M.runKernel(Zg,h,y)}const[c,l]=s?[t.videoWidth,t.videoHeight]:[t.width,t.height];let d;if(o)d=t.getContext("2d").getImageData(0,0,c,l).data;else if(r||n)d=t.data;else if(a||s||i){if(go==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")go=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else go=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});go.canvas.width=c,go.canvas.height=l,go.drawImage(t,0,0,c,l),d=go.getImageData(0,0,c,l).data}let p;if(e===4)p=new Int32Array(d);else{const h=c*l;p=new Int32Array(h*e);for(let y=0;y<h;y++)for(let x=0;x<e;++x)p[y*e+x]=d[y*4+x]}return H_(p,[l,c,e],"int32")}function hG(t){if(t.rank!==2&&t.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${t.rank}.`);const e=t.rank===2?1:t.shape[2];if(e>4||e===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${e}`);if(t.dtype!=="float32"&&t.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${t.dtype}. Please use float32 or int32 tensors.`)}async function mG(t,e){let n=N(t,"img","toPixels");if(!(t instanceof Rt)){const c=n;n=gt(c,"int32"),c.dispose()}hG(n);const[r,s]=n.shape.slice(0,2),a=n.rank===2?1:n.shape[2],o=await n.data(),i=n.dtype==="float32"?255:1,u=new Uint8ClampedArray(s*r*4);for(let c=0;c<r*s;++c){const l=[0,0,0,255];for(let p=0;p<a;p++){const f=o[c*a+p];if(n.dtype==="float32"){if(f<0||f>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${f}.`)}else if(n.dtype==="int32"&&(f<0||f>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${f}.`);a===1?(l[0]=f*i,l[1]=f*i,l[2]=f*i):l[p]=f*i}const d=c*4;u[d+0]=Math.round(l[0]),u[d+1]=Math.round(l[1]),u[d+2]=Math.round(l[2]),u[d+3]=Math.round(l[3])}return n!==t&&n.dispose(),u}const gG=F({fromPixels_:fG});function Zv(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(K(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const s=e.shape,a=s[s.length-1];let o=1;for(let d=0;d<s.length-1;++d)o*=s[d];const i=t.shape,u=s.slice();u.pop();let c=1;for(let d=a;d<n;++d)c*=i[d],u.push(i[d]);const l=[...Ye(t.shape).map(d=>d/c),1].slice(0,a);return[u,o,c,l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gy=-2,yG=-1;function uN(t,e,n){const r=t.shape.length;E(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),E(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let s=0;s<r;++s)E(e[s]+n[s]<=t.shape[s],()=>`Error in slice${r}D: begin[${s}] + size[${s}] (${e[s]+n[s]}) would overflow input.shape[${s}] (${t.shape[s]})`)}function xG(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function Jv(t,e,n){const r=[];for(let s=0;s<t.length;s++)r[s]=Math.ceil((e[s]-t[s])/n[s]);return r}function lN(t,e,n,r){const s=[...t];for(let a=s.length;a<r.length;a++)s.push(1);for(let a=0;a<n;a++)a===0?s[e]=1:(s.splice(e,0,1),s.pop());return s}function cN(t,e,n){return n<=t?n:n-(e-1)}function dN(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function vG(t,e,n,r,s,a,o,i,u){const c=t.length;let l=new Array(c),d=new Array(c),p=new Array(c);if(e.length&&n>0){const f=e[0],h=n+1;l=pN(o,f,h,r,t),d=fN(i,f,h,s,t),p=lN(a,f,h,t)}else for(let f=0;f<c;f++)l[f]=mN(o,r,a,t,f,u),d[f]=gN(i,s,a,t,f,u),p[f]=hN(a,f,u);return{begin:l,end:d,strides:p}}function pN(t,e,n,r,s){const a=[...s],o=dN(n,e);for(let i=0;i<a.length;i++)if(o.indexOf(i)>-1)a[i]=0;else{const u=cN(e,n,i);let c=r[u];t&1<<u&&(c=0),a[i]=c}return a}function fN(t,e,n,r,s){const a=[...s],o=dN(n,e);for(let i=0;i<a.length;i++)if(o.indexOf(i)>-1)a[i]=Number.MAX_SAFE_INTEGER;else{const u=cN(e,n,i);let c=r[u];t&1<<u&&(c=Number.MAX_SAFE_INTEGER),a[i]=c}for(let i=0;i<a.length;i++){const u=s[i];a[i]<0&&(a[i]+=u),a[i]=Ap(0,a[i],s[i])}return a}function hN(t,e,n){let r=t[e];return(n&1<<e||r==null)&&(r=1),r}function mN(t,e,n,r,s,a){let o=e[s];const i=n[s]||1;(t&1<<s||a&1<<s||o==null)&&(i>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const u=r[s];return o<0&&(o+=u),o=Ap(0,o,u-1),o}function gN(t,e,n,r,s,a){let o=e[s];const i=n[s]||1;(t&1<<s||a&1<<s||o==null)&&(i>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const u=r[s];return o<0&&(o+=u),i>0?o=Ap(0,o,u):o=Ap(-1,o,u-1),o}function Mh(t,e,n){let r=n.length;for(let s=0;s<n.length;s++)if(n[s]>1){r=s;break}for(let s=r+1;s<n.length;s++)if(e[s]>0||n[s]!==t[s])return!1;return!0}function Bh(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function ew(t,e,n){let r;const s=t.shape.length;typeof e=="number"?r=[e,...new Array(s-1).fill(0)]:e.length<s?r=e.concat(new Array(s-e.length).fill(0)):r=e.slice(),r.forEach(o=>{E(o!==-1,()=>"slice() does not support negative begin indexing.")});let a;return n==null?a=new Array(s).fill(-1):typeof n=="number"?a=[n,...new Array(s-1).fill(-1)]:n.length<s?a=n.concat(new Array(s-n.length).fill(-1)):a=n,a=a.map((o,i)=>o>=0?o:(E(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${i}.`),t.shape[i]-r[i])),[r,a]}function tw(t,e,n,r,s,a,o,i,u){let c;if(r==null?(c=new Array(e.length),c.fill(1)):c=r,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let l=!1;const d={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:c.slice(),beginMask:s,endMask:a,ellipsisMask:o,newAxisMask:i,shrinkAxisMask:u};for(let w=0;w<d.dims;w++)l&&1<<w&i&&d.numAddAxisAfterEllipsis++,1<<w&o&&(l=!0);l||(d.ellipsisMask|=1<<d.dims,d.dims++);const p={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};wG(d,p);let f=!0,h=!0,y=!0;const x=[],g=[];for(let w=0;w<t.length;++w){if(p.strides[w]===0)throw Error(`strides[${w}] must be non-zero`);const S=!!(p.shrinkAxisMask&1<<w),$=t[w];if($===-1){x.push(S?1:-1);continue}const k=[p.beginMask&1<<w,p.endMask&1<<w],T=[p.strides[w]>0?0:-1,p.strides[w]>0?$:$-1];if(S&&p.strides[w]<=0)throw Error("only stride 1 allowed on non-range indexing.");y=y&&p.strides[w]===1;const A=!!(p.beginMask&1<<w&&p.endMask&1<<w);if(p.beginValid&&p.endValid){if(S){const Y=p.begin[w]<0?$+p.begin[w]:p.begin[w];if(p.begin[w]=Y,p.end[w]=p.begin[w]+1,Y<0||Y>=$)throw Error(`slice index ${p.begin[w]} of dimension ${w} out of bounds.`)}else p.begin[w]=Bb(p.begin[w],0,p.strides[w],$,k,T),p.end[w]=Bb(p.end[w],1,p.strides[w],$,k,T);const z=p.strides[w]===1&&p.begin[w]===0&&p.end[w]===$;f=f&&z,h=h&&(w===0&&p.strides[w]===1||z)}else f=f&&p.strides[w]===1&&A,h=h&&(w===0&&p.strides[w]===1||A);let B,L=!1;if(p.beginValid&&p.endValid?(B=p.end[w]-p.begin[w],L=!0):S?(B=1,L=!0):A&&$>=0&&(p.strides[w]<0?B=-$:B=$,L=!0),L){let z;B===0||B<0!=p.strides[w]<0?z=0:z=Math.trunc(B/p.strides[w])+(B%p.strides[w]!==0?1:0),x.push(z)}else x.push(-1)}for(let w=0;w<p.finalShapeGatherIndices.length;++w){const S=p.finalShapeGatherIndices[w];S>=0?g.push(x[S]):S===gy&&g.push(1)}return{finalShapeSparse:g.filter((w,S)=>p.finalShapeGatherIndices[S]!==gy),finalShape:g,isIdentity:f,sliceDim0:h,isSimpleSlice:y,begin:p.begin,end:p.end,strides:p.strides}}function wG(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const s=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<s;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(gy),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[r]),t.end!=null&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(yG),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}function Bb(t,e,n,r,s,a){if(s[e])return n>0?a[e]:a[e+1&1];{const o=t<0?r+t:t;return o<a[0]?a[0]:o>a[1]?a[1]:o}}var bG=Object.freeze({__proto__:null,assertParamsValid:uN,computeFlatOffset:Bh,computeOutShape:Jv,getNormalizedAxes:vG,isSliceContinous:Mh,maskToAxes:xG,parseSliceParams:ew,sliceInfo:tw,startForAxis:mN,startIndicesWithElidedDims:pN,stopForAxis:gN,stopIndicesWithElidedDims:fN,stridesForAxis:hN,stridesWithElidedDims:lN});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SG=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function CG(){return new Promise(t=>SG(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nw(t,e){const n=t[0].length;t.forEach((s,a)=>{E(s.length===n,()=>`Error in concat${n}D: rank of tensors[${a}] must be the same as the rank of the rest (${n})`)}),E(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((s,a)=>{for(let o=0;o<n;o++)E(o===e||s[o]===r[o],()=>`Error in concat${n}D: Shape of tensors[${a}] (${s}) does not match the shape of the rest (${r}) along the non-concatenated axis ${a}.`)})}function ks(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Zr;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(Zr||(Zr={}));function yN(t,e,n){let r=new Array;if(n==null&&e==null)return r;if(e==null)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(n==null)return r;if(t+n.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${r.length}`);for(let s=1;s<n.length;++s){const a=n[s],o=r[r.length-n.length+s],i=r[o];if(a>=0)if(i>=0){if(i!==a)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${s+t}] = ${a} but shape[${s+t}] = ${i}`)}else r[o]=a}return r}function xN(t){const e={FIRST_DIM_SIZE:Zr.FIRST_DIM_SIZE,VALUE_ROWIDS:Zr.VALUE_ROWIDS,ROW_LENGTHS:Zr.ROW_LENGTHS,ROW_SPLITS:Zr.ROW_SPLITS,ROW_LIMITS:Zr.ROW_LIMITS,ROW_STARTS:Zr.ROW_STARTS},n=[];for(const r of t)if(r in e)n.push(e[r]);else break;return n}function vN(t){return t.length===0?0:t[0]===Zr.FIRST_DIM_SIZE?t.length-1:t.length}function wN(t,e){if(t==null||e==null)return;const n=t.length,r=e.length;if(n>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let s=0;s<Math.min(n,r-1);++s){const a=t[s],o=e[s+1];if(a>=0&&o>=0&&a!==1&&a!==o)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${s-t.length}] = ${a} but ragged tensor input.flatValues.shape[${s-t.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rw=30;function Vh(t){return t<=rw?t:Xg(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sw(t,e,n){const r=n*(typeof t=="number"?t:t[0]),s=e*(typeof t=="number"?t:t[1]);return[r,s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mc(t,e,n,r=!0){let s=[];if(r)s=s.concat(e.slice(0)),s.push(t[0]/n),s=s.concat(t.slice(1));else{s=s.concat(t[0]);const a=e.length;for(let o=0;o<a;++o)s=s.concat([t[o+1]/e[o],e[o]]);s=s.concat(t.slice(a+1))}return s}function Bc(t,e,n=!0){const r=[];if(n){r.push(e);for(let s=e+1;s<t;++s)s<=2*e?(r.push(s),r.push(s-(e+1))):r.push(s)}else{const s=[],a=[];for(let o=1;o<t;++o)o>=e*2+1||o%2===1?a.push(o):s.push(o);r.push(...s),r.push(0),r.push(...a)}return r}function Vc(t,e,n,r=!0){const s=[];r?s.push(t[0]/n):s.push(t[0]*n);for(let a=1;a<t.length;++a)a<=e.length?r?s.push(e[a-1]*t[a]):s.push(t[a]/e[a-1]):s.push(t[a]);return s}function aw(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function ow(t,e,n){const r=t.slice(0,1);for(let s=0;s<n;++s)r.push(t[s+1]-e[s][0]-e[s][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bN=1.7580993408473768,SN=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CN=.3275911,IN=.254829592,$N=-.284496736,_N=1.421413741,NN=-1.453152027,kN=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yy(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function IG(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function $G(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=0;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function _G(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=2;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function NG(t,e){const n=t[e*2],r=t[e*2+1];return{real:n,imag:r}}function kG(t,e,n,r){t[r*2]=e,t[r*2+1]=n}function EG(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let s=0;s<Math.ceil(t/2);s++){const a=(e?2:-2)*Math.PI*(s/t);n[s]=Math.cos(a),r[s]=Math.sin(a)}return{real:n,imag:r}}function TG(t,e,n){const r=(n?2:-2)*Math.PI*(t/e),s=Math.cos(r),a=Math.sin(r);return{real:s,imag:a}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Om="->",RG=/->/g,Vb=",",zb="...";function EN(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(RG,"").length)/Om.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${Om}").`);const[r,s]=t.split(Om);E(r.indexOf(zb)===-1,()=>`The ellipsis notation ("${zb}") is not supported yet.`);const a=r.split(Vb),o=a.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const i=[];for(let p=0;p<s.length;++p){const f=s[p];if(!a.some(h=>h.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);i.indexOf(f)===-1&&i.push(f)}for(let p=0;p<r.length;++p){const f=r[p];i.indexOf(f)===-1&&f!==Vb&&i.push(f)}const u=new Array(a.length);for(let p=0;p<o;++p){if(new Set(a[p].split("")).size!==a[p].length)throw new Error(`Found duplicate axes in input component ${a[p]}. Support for duplicate axes in input is not implemented yet.`);u[p]=[];for(let f=0;f<a[p].length;++f)u[p].push(i.indexOf(a[p][f]))}const c=i.length,l=s.length,d=[];for(let p=l;p<c;++p)d.push(p);return{allDims:i,summedDims:d,idDims:u}}function TN(t,e){let n=new Array(t);n.fill(-1);for(let s=0;s<e.length;++s)n[e[s]]=s;const r=[];for(let s=0;s<t;++s)n[s]===-1&&r.push(s);return n=n.filter(s=>s!==-1),{permutationIndices:n,expandDims:r}}function RN(t,e,n){const r=new Array(t);for(let s=0;s<n.length;++s){const a=n[s].shape;for(let o=0;o<e[s].length;++o)r[e[s][o]]===void 0?r[e[s][o]]=a[o]:E(r[e[s][o]]===a[o],()=>`Expected dimension ${r[e[s][o]]} at axis ${o} of input shaped ${JSON.stringify(a)}, but got dimension ${a[o]}`)}}function AN(t,e){const n=t,r=[];let s=0;t.length===0&&n.push(-1),s=t.length+1;for(let o=0;o<s;++o)r.push([]);const a=[];for(let o=0;o<n.length;++o){const i=n[o],u=AG(e,i);for(const c of u)a.indexOf(c)===-1&&(r[o].push(c),a.push(c))}return{path:n,steps:r}}function ON(t){return t.every((e,n)=>e===n)}function AG(t,e){const n=[];for(let r=0;r<t.length;++r)(t[r].length===0||t[r].indexOf(e)!==-1||e===-1)&&n.push(r);return n}function iw(t,e,n=0){let r=[];if(typeof e=="number")E(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{const s=e.reduce((o,i)=>(i===-1&&(o+=1),o),0);E(s<=1,()=>"There should be only one negative value in split array.");const a=e.indexOf(-1);if(a!==-1){const o=e.reduce((i,u)=>u>0?i+u:i);e[a]=t.shape[n]-o}E(t.shape[n]===e.reduce((o,i)=>o+i),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uw(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function lw(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function cw(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dw(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function pw(t,e){return`size ${t} must be non-negative, not ${e}`}function fw(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function hw(t,e){const n=K(t),r=K(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${e}`}function mw(t,e){const n=K(t),r=K(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yc(){return"segment ids must be >= 0"}function gw(){return"segment ids are not increasing"}function yw(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function xw(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DN(t,e){let n=!1,r;for(t<=rw?(r=t,n=!0):r=Xg(t,Math.floor(Math.sqrt(t)));!n;)r>e||r===t?n=!0:r=Xg(t,r+1);return r}function PN(t,e,n){const r=[],s=t.length;for(let a=0;a<s;a++)a!==e?r.push(t[a]):r.push(n);return r}function vw(t,e,n,r){const s=e.shape.length,a=t.shape.length;if(r!==0&&(r<-s||r>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${r}`);if(r<0&&(r+=s),r>a)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${a}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let d=0;d<r;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const o=t.shape[n],i=[];let u=1,c=1,l=1;for(let d=0;d<r;++d)i.push(t.shape[d]),u*=t.shape[d];for(let d=r;d<n;d++)i.push(t.shape[d]),c*=t.shape[d];for(let d=r;d<s;d++)i.push(e.shape[d]);for(let d=n+1;d<a;d++)i.push(t.shape[d]),l*=t.shape[d];return{batchSize:u,sliceSize:l,outerSize:c,dimSize:o,outputShape:i}}var OG=Object.freeze({__proto__:null,collectGatherOpShapeInfo:vw,computeOutShape:PN,segOpComputeOptimalWindowSize:DN});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iu(t){try{return t.map(e=>bu(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function ww(t){return t.map(e=>Oo(e))}var DG=Object.freeze({__proto__:null,ERF_A1:IN,ERF_A2:$N,ERF_A3:_N,ERF_A4:NN,ERF_A5:kN,ERF_P:CN,PARALLELIZE_THRESHOLD:rw,get RowPartitionType(){return Zr},SELU_SCALE:SN,SELU_SCALEALPHA:bN,applyActivation:Ph,assertAndGetBroadcastShape:Le,assertAxesAreInnerMostDims:Dt,assertParamsConsistent:nw,assignToTypedArray:kG,axesAreInnerMostDims:Bv,calculateShapes:ii,checkEinsumDimSizes:RN,checkPadOnDimRoundingMode:Br,combineLocations:m_,combineRaggedTensorToTensorShapes:yN,complexWithEvenIndex:$G,complexWithOddIndex:_G,computeConv2DInfo:qt,computeConv3DInfo:eo,computeDefaultPad:Lv,computeDilation2DInfo:Dc,computeOptimalWindowSize:Vh,computeOutAndReduceShapes:an,computeOutShape:ks,computePool2DInfo:Mr,computePool3DInfo:aa,convertConv2DDataFormat:to,decodeEinsumEquation:EN,eitherStridesOrDilationsAreOne:Rn,expandShapeToKeepDim:Ot,exponent:TG,exponents:EG,fromStringArrayToUint8:ww,fromUint8ToStringArray:Iu,getAxesPermutation:An,getBroadcastDims:Lp,getComplexWithIndex:NG,getEinsumComputePath:AN,getEinsumPermutation:TN,getFusedBiasGradient:Dh,getFusedDyActivation:Oh,getImageCenter:sw,getInnerMostAxes:Xt,getPermuted:Bc,getRaggedRank:vN,getReductionAxes:p_,getReshaped:Mc,getReshapedPermuted:Vc,getRowPartitionTypesHelper:xN,getSliceBeginCoords:aw,getSliceSize:ow,getSparseFillEmptyRowsIndicesDenseShapeMismatch:uw,getSparseFillEmptyRowsNegativeIndexErrorMessage:lw,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:cw,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:fw,getSparseReshapeInputOutputMismatchErrorMessage:mw,getSparseReshapeInputOutputMultipleErrorMessage:hw,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:dw,getSparseReshapeNegativeOutputDimErrorMessage:pw,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:xw,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:yc,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:gw,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:yw,getUndoAxesPermutation:Fc,isIdentityPermutation:ON,log:kF,mergeRealAndImagArrays:yy,prepareAndValidate:Zv,prepareSplitSize:iw,segment_util:OG,shouldFuse:Fh,slice_util:bG,splitRealAndImagArrays:IG,stridesOrDilationsArePositive:Ko,tupleValuesAreOne:dc,upcastType:Ts,validateDefaultValueShape:wN,validateInput:Kv,validateUpdateShape:j_,warn:Jr});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */XU();/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PG=U();PG.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Mn;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(Mn||(Mn={}));var Wb;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(Wb||(Wb={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FG={};function FN(t){return FG[t]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C(t,e,n,r,s){const a=e.inputParams[t];if(a&&a.inputIndexStart!==void 0){const i=a.inputIndexStart,u=a.inputIndexEnd===0?void 0:a.inputIndexEnd===void 0?i+1:a.inputIndexEnd,c=i<0?e.inputNames.length+i:i;if(a.type==="tensor")return Gt(e.inputNames[c],n,r,s);if(a.type==="tensors"){const p=e.inputs.slice(i,u);return e.inputNames.slice(i,u).filter((h,y)=>{var x;return((x=p[y])===null||x===void 0?void 0:x.op)!=="NoOp"}).map(h=>Gt(h,n,r,s))}const l=Gt(e.inputNames[c],n,r,s),d=l.dataSync();return a.type==="number"?d[0]:Yg(l.shape,d)}const o=e.attrParams[t];return o&&o.value}function Gt(t,e,n,r){const[s,a]=Vn(t,n);if(r!=null){const i=r.getHashTableHandleByName(s);if(i!=null)return i}const o=n.currentContextIds.find(i=>!!e[Wp(s,i)]);return o!==void 0?e[Wp(s,o)][a]:void 0}function Ub(t,e,n){return e[Wp(t,n.currentContextId)]}function Vs(t,e){const[n,r,s]=Vn(t,e);return[Wp(n,e&&e.currentContextId),r,s]}function Wp(t,e){return e?`${t}-${e}`:t}function Vn(t,e){if(t==="")return["",0,void 0];const n=e!=null&&e.parseNodeNameCache!=null;if(n){const a=e.parseNodeNameCache.get(t);if(a!=null)return a}const r=t.split(":");let s;if(r.length===1)s=[t,0,void 0];else{const a=r[0],o=r.length===3?r[1]:void 0,i=Number(r[r.length-1]);s=[a,i,o]}return n&&e.parseNodeNameCache.set(t,s),s}function tp(t,e,n){let r=C("pad",t,e,n);if(r==="explicit"){r=C("explicitPaddings",t,e,n);const s=[[0,0],[0,0],[0,0],[0,0]];for(let a=0;a<4;a++)s[a][0]=r[a*2],s[a][1]=r[a*2+1];return s}return r}function zs(t){return t.kept?t:Fa(t)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LG=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}];var MG=Object.freeze({__proto__:null,json:LG});/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BG=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}];var VG=Object.freeze({__proto__:null,json:BG});/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zG=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}];var WG=Object.freeze({__proto__:null,json:zG});/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UG=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}];var GG=Object.freeze({__proto__:null,json:UG});/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HG=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}];var jG=Object.freeze({__proto__:null,json:HG});/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KG=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}];var qG=Object.freeze({__proto__:null,json:KG});/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XG=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}];var YG=Object.freeze({__proto__:null,json:XG});/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QG=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}];var ZG=Object.freeze({__proto__:null,json:QG});/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JG=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}];var eH=Object.freeze({__proto__:null,json:JG});/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tH=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}];var nH=Object.freeze({__proto__:null,json:tH});/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rH=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}];var sH=Object.freeze({__proto__:null,json:rH});/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aH=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}];var oH=Object.freeze({__proto__:null,json:aH});/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iH=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}];var uH=Object.freeze({__proto__:null,json:iH});/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lH=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}];var cH=Object.freeze({__proto__:null,json:lH});/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dH=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}];var pH=Object.freeze({__proto__:null,json:dH});/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fH=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}];var hH=Object.freeze({__proto__:null,json:fH});/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mH=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}];var gH=Object.freeze({__proto__:null,json:mH});/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yH=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}];var xH=Object.freeze({__proto__:null,json:yH});/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vH=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}];var wH=Object.freeze({__proto__:null,json:vH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gb{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[MG,VG,WG,GG,jG,qG,YG,ZG,eH,nH,sH,oH,uH,cH,pH,hH,gH,xH,wH],n=[].concat(...e.map(r=>r.json));this.opMappers=n.reduce((r,s)=>(r[s.tfOpName]=s,r),{})}transformGraph(e,n={}){const r=e.node,s=[],a=[],o=[],i=r.reduce((y,x)=>(y[x.name]=this.mapNode(x),x.op.startsWith("Placeholder")?s.push(y[x.name]):x.op==="Const"?a.push(y[x.name]):(x.input==null||x.input.length===0)&&o.push(y[x.name]),y),{});let u=[];const c=[];let l={},d={};n!=null&&(l=this.mapSignatureEntries(n.inputs),d=this.mapSignatureEntries(n.outputs));const p=Object.keys(i);p.forEach(y=>{const x=i[y];x.inputNames.forEach((g,v)=>{const[w,,S]=Vs(g),$=i[w];if($.outputs!=null){const k=$.outputs.indexOf(S);if(k!==-1){const T=`${w}:${k}`;x.inputNames[v]=T}}x.inputs.push($),$.children.push(x)})}),Object.keys(d).length===0?p.forEach(y=>{const x=i[y];x.children.length===0&&c.push(x)}):Object.keys(d).forEach(y=>{const[x]=Vs(y),g=i[x];g!=null&&(g.signatureKey=d[y],c.push(g))}),Object.keys(l).length>0?Object.keys(l).forEach(y=>{const[x]=Vs(y),g=i[x];g&&(g.signatureKey=l[y],u.push(g))}):u=s;let f={};e.library!=null&&e.library.function!=null&&(f=e.library.function.reduce((y,x)=>(y[x.signature.name]=this.mapFunction(x),y),{}));const h={nodes:i,inputs:u,outputs:c,weights:a,placeholders:s,signature:n,functions:f};return o.length>0&&(h.initNodes=o),h}mapSignatureEntries(e){return Object.keys(e||{}).reduce((n,r)=>(n[e[r].name]=r,n),{})}mapNode(e){const n=FN(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const r={name:e.name,op:e.op,category:n.category,inputNames:(e.input||[]).map(s=>s.startsWith("^")?s.slice(1):s),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:n.outputs};return n.inputs!=null&&(r.inputParams=n.inputs.reduce((s,a)=>(s[a.name]={type:a.type,inputIndexStart:a.start,inputIndexEnd:a.end},s),{})),n.attrs!=null&&(r.attrParams=n.attrs.reduce((s,a)=>{const o=a.type;let i;switch(a.type){case"string":i=xy(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=xy(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"string[]":i=$y(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=$y(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"number":i=wy(e.attr,a.tfName,a.defaultValue||0),i===void 0&&a.tfDeprecatedName&&(i=wy(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"number[]":i=Iy(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=Iy(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool":i=vy(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=vy(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool[]":i=Ny(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=Ny(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape":i=Cy(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=Cy(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape[]":i=_y(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=_y(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype":i=by(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=by(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype[]":i=Sy(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=Sy(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"func":i=Hb(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=Hb(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${a.type} for op: ${e.op}`)}return s[a.name]={value:i,type:o},s},{})),r}mapFunction(e){const n=e.nodeDef,r=[],s=[];let a={};n!=null&&(a=n.reduce((d,p)=>(d[p.name]=this.mapNode(p),p.op==="Const"&&s.push(d[p.name]),d),{}));const o=[],i=[];e.signature.inputArg.forEach(d=>{const[p]=Vs(d.name),f={name:p,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:bw(d.type),type:"dtype"}},children:[]};f.signatureKey=d.name,o.push(f),a[p]=f}),Object.keys(a).forEach(d=>{const p=a[d];p.inputNames.forEach((f,h)=>{const[y,,x]=Vs(f),g=a[y];if(g.outputs!=null){const v=g.outputs.indexOf(x);if(v!==-1){const w=`${y}:${v}`;p.inputNames[h]=w}}p.inputs.push(g),g.children.push(p)})});const c=e.ret;e.signature.outputArg.forEach(d=>{const[p,f]=Vs(c[d.name]),h=a[p];h!=null&&(h.defaultOutput=f,i.push(h))});const l=this.mapArgsToSignature(e);return{nodes:a,inputs:o,outputs:i,weights:s,placeholders:r,signature:l}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r),n),{}),outputs:e.signature.outputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r,e.ret),n),{})}}mapArgToTensorInfo(e,n){let r=e.name;return n!=null&&(r=n[r]),{name:r,dtype:e.type}}}function bH(t){const e=U().global;if(typeof e.atob<"u")return e.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function LN(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):bH(t);return e?n:n.toLowerCase()}function xy(t,e,n,r=!1){const s=t[e];return s!=null?LN(s.s,r):n}function vy(t,e,n){const r=t[e];return r?r.b:n}function wy(t,e,n){const r=t[e]||{},s=r.i!=null?r.i:r.f!=null?r.f:n;return typeof s=="number"?s:parseInt(s,10)}function bw(t){switch(typeof t=="string"&&(t=Mn[t]),t){case Mn.DT_FLOAT:case Mn.DT_HALF:return"float32";case Mn.DT_INT32:case Mn.DT_INT64:case Mn.DT_INT8:case Mn.DT_UINT8:return"int32";case Mn.DT_BOOL:return"bool";case Mn.DT_DOUBLE:return"float32";case Mn.DT_STRING:return"string";case Mn.DT_COMPLEX64:case Mn.DT_COMPLEX128:return"complex64";default:return null}}function Hb(t,e,n){const r=t[e];return r&&r.func?r.func.name:n}function by(t,e,n){const r=t[e];return r&&r.type?bw(r.type):n}function Sy(t,e,n){const r=t[e];return r&&r.list&&r.list.type?r.list.type.map(s=>bw(s)):n}function MN(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function Cy(t,e,n){const r=t[e];return r&&r.shape?MN(r.shape):n}function Iy(t,e,n){const r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(s=>typeof s=="number"?s:parseInt(s,10)):n}function $y(t,e,n,r=!1){const s=t[e];return s&&s.list&&s.list.s?s.list.s.map(a=>LN(a,r)):n}function _y(t,e,n){const r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map(s=>MN(s)):n}function Ny(t,e,n){const r=t[e];return r&&r.list&&r.list.b?r.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SH{constructor(e,n,r){this.node=e,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(s=>this.getInput(s)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((s,a)=>(s[a]=this.getAttr(a),s),{}))}getInput(e){return Gt(e,this.tensorMap,this.context)}getAttr(e,n){const r=this.node.rawAttrs[e];if(r.tensor!=null)return Gt(e,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return wy(this.node.rawAttrs,e,n);if(r.s!=null)return xy(this.node.rawAttrs,e,n);if(r.b!=null)return vy(this.node.rawAttrs,e,n);if(r.shape!=null)return Cy(this.node.rawAttrs,e,n);if(r.type!=null)return by(this.node.rawAttrs,e,n);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return Iy(this.node.rawAttrs,e,n);if(r.list.s!=null)return $y(this.node.rawAttrs,e,n);if(r.list.shape!=null)return _y(this.node.rawAttrs,e,n);if(r.list.b!=null)return Ny(this.node.rawAttrs,e,n);if(r.list.type!=null)return Sy(this.node.rawAttrs,e,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Yt=Object.freeze({__proto__:null,OP_SCOPE_SUFFIX:j$,abs:nr,acos:X3,acosh:Q3,add:be,addN:J3,all:tL,any:rL,argMax:aL,argMin:iL,asin:lL,asinh:dL,atan:fL,atan2:mL,atanh:yL,avgPool:i_,avgPool3d:$L,basicLSTMCell:AL,batchNorm:Nh,batchNorm2d:LL,batchNorm3d:BL,batchNorm4d:zL,batchToSpaceND:u_,bincount:l_,bitwiseAnd:GL,booleanMaskAsync:Nz,broadcastArgs:jL,broadcastTo:Ll,buffer:xt,cast:gt,ceil:XL,clipByValue:c_,clone:Fa,complex:Ha,concat:Kt,concat1d:ZL,concat2d:eM,concat3d:nM,concat4d:sM,conv1d:iM,conv2d:kh,conv2dTranspose:cM,conv3d:pM,conv3dTranspose:gM,cos:xM,cosh:wM,cosineWindow:qv,cumprod:SM,cumsum:IM,denseBincount:_M,depthToSpace:kM,depthwiseConv2d:Mv,diag:RM,dilation2d:OM,div:Fe,divNoNan:MM,dot:VM,dropout:Vz,einsum:Li,elu:h_,enclosingPowerOfTwo:X_,ensureShape:GM,equal:f_,erf:jM,euclideanNorm:tB,exp:ea,expandDims:ws,expm1:aB,eye:y_,fft:Hv,fill:Pc,floor:x_,floorDiv:o_,fused:tW,gather:v_,gatherND:Lz,greater:Th,greaterEqual:w_,ifft:zp,imag:Rh,image:Lh,inTopKAsync:Wz,irfft:W_,isFinite:hB,isInf:gB,isNaN:xB,leakyRelu:b_,less:fy,lessEqual:Vv,linalg:DU,linspace:SB,localResponseNormalization:IB,log:fc,log1p:S_,logSigmoid:RB,logSoftmax:DB,logSumExp:I_,logicalAnd:Mp,logicalNot:$_,logicalOr:__,logicalXor:VB,losses:PU,lowerBound:WB,matMul:et,max:uu,maxPool:N_,maxPool3d:HB,maxPoolWithArgmax:KB,maximum:k_,mean:Bp,meshgrid:YB,min:py,minimum:Vp,mirrorPad:JB,mod:t4,moments:r4,movingAverage:Tz,mul:ae,multiRNNCell:a4,multinomial:i4,neg:Ns,norm:Eh,notEqual:E_,oneHot:c4,ones:To,onesLike:p4,op:F,outerProduct:h4,pad:Lc,pad1d:y4,pad2d:v4,pad3d:b4,pad4d:C4,pool:k4,pow:pc,prelu:R_,print:a_,prod:R4,raggedGather:O4,raggedRange:P4,raggedTensorToTensor:L4,rand:B4,randomGamma:sV,randomNormal:B_,randomStandardNormal:iV,randomUniform:Gv,randomUniformInt:cV,range:hc,real:mc,reciprocal:fV,relu:Ah,relu6:V_,reshape:X,reverse:Xo,reverse1d:xV,reverse2d:wV,reverse3d:SV,reverse4d:IV,rfft:jv,round:z_,rsqrt:NV,scalar:Ve,scatterND:Az,searchSorted:zv,selu:EV,separableConv2d:RV,setdiff1dAsync:OV,sigmoid:Do,sign:PV,signal:OU,sin:LV,sinh:BV,slice:Re,slice1d:zV,slice2d:UV,slice3d:HV,slice4d:KV,softmax:XV,softplus:C_,spaceToBatchND:T_,sparse:FU,sparseToDense:Pz,spectral:AU,split:gc,sqrt:Js,square:rs,squaredDifference:U_,squeeze:Wt,stack:na,step:G_,stridedSlice:oz,string:LU,sub:Ae,sum:ot,tan:uz,tanh:dy,tensor:ns,tensor1d:nn,tensor2d:Po,tensor3d:H_,tensor4d:lz,tensor5d:cz,tensor6d:dz,tensorScatterUpdate:fz,tile:Ml,topk:mz,transpose:hy,truncatedNormal:yz,unique:vz,unsortedSegmentSum:bz,unstack:ui,upperBound:Cz,variable:Iz,where:La,whereAsync:q_,zeros:qo,zerosLike:cr});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CH=(t,e,n,r=Yt)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(C("a",t,e,n),C("b",t,e,n))];case"AddN":return[r.addN(C("tensors",t,e,n))];case"FloorMod":case"Mod":return[r.mod(C("a",t,e,n),C("b",t,e,n))];case"Mul":return[r.mul(C("a",t,e,n),C("b",t,e,n))];case"RealDiv":case"Div":return[r.div(C("a",t,e,n),C("b",t,e,n))];case"DivNoNan":return[r.divNoNan(C("a",t,e,n),C("b",t,e,n))];case"FloorDiv":return[r.floorDiv(C("a",t,e,n),C("b",t,e,n))];case"Sub":return[r.sub(C("a",t,e,n),C("b",t,e,n))];case"Minimum":return[r.minimum(C("a",t,e,n),C("b",t,e,n))];case"Maximum":return[r.maximum(C("a",t,e,n),C("b",t,e,n))];case"Pow":return[r.pow(C("a",t,e,n),C("b",t,e,n))];case"SquaredDifference":return[r.squaredDifference(C("a",t,e,n),C("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IH=(t,e,n,r=Yt)=>{switch(t.op){case"Abs":case"ComplexAbs":return[r.abs(C("x",t,e,n))];case"Acos":return[r.acos(C("x",t,e,n))];case"Acosh":return[r.acosh(C("x",t,e,n))];case"Asin":return[r.asin(C("x",t,e,n))];case"Asinh":return[r.asinh(C("x",t,e,n))];case"Atan":return[r.atan(C("x",t,e,n))];case"Atan2":return[r.atan2(C("x",t,e,n),C("y",t,e,n))];case"Atanh":return[r.atanh(C("x",t,e,n))];case"Ceil":return[r.ceil(C("x",t,e,n))];case"Complex":return[r.complex(C("real",t,e,n),C("imag",t,e,n))];case"Cos":return[r.cos(C("x",t,e,n))];case"Cosh":return[r.cosh(C("x",t,e,n))];case"Elu":return[r.elu(C("x",t,e,n))];case"Erf":return[r.erf(C("x",t,e,n))];case"Exp":return[r.exp(C("x",t,e,n))];case"Expm1":return[r.expm1(C("x",t,e,n))];case"Floor":return[r.floor(C("x",t,e,n))];case"Log":return[r.log(C("x",t,e,n))];case"Log1p":return[r.log1p(C("x",t,e,n))];case"Imag":return[r.imag(C("x",t,e,n))];case"Neg":return[r.neg(C("x",t,e,n))];case"Reciprocal":return[r.reciprocal(C("x",t,e,n))];case"Real":return[r.real(C("x",t,e,n))];case"Relu":return[r.relu(C("x",t,e,n))];case"Round":return[r.round(C("x",t,e,n))];case"Selu":return[r.selu(C("x",t,e,n))];case"Sigmoid":return[r.sigmoid(C("x",t,e,n))];case"Sin":return[r.sin(C("x",t,e,n))];case"Sign":return[r.sign(C("x",t,e,n))];case"Sinh":return[r.sinh(C("x",t,e,n))];case"Softplus":return[r.softplus(C("x",t,e,n))];case"Sqrt":return[r.sqrt(C("x",t,e,n))];case"Square":return[r.square(C("x",t,e,n))];case"Tanh":return[r.tanh(C("x",t,e,n))];case"Tan":return[r.tan(C("x",t,e,n))];case"ClipByValue":return[r.clipByValue(C("x",t,e,n),C("clipValueMin",t,e,n),C("clipValueMax",t,e,n))];case"Relu6":return[r.relu6(C("x",t,e,n))];case"Rsqrt":return[r.rsqrt(Gt(t.inputNames[0],e,n))];case"LeakyRelu":return[r.leakyRelu(C("x",t,e,n),C("alpha",t,e,n))];case"Prelu":return[r.prelu(C("x",t,e,n),C("alpha",t,e,n))];case"IsNan":return[r.isNaN(Gt(t.inputNames[0],e,n))];case"IsInf":return[r.isInf(Gt(t.inputNames[0],e,n))];case"IsFinite":return[r.isFinite(Gt(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $r(t,e,n=""){if(!(typeof t=="number"||typeof e=="number")){E(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let r=0;r<t.length;r++){const s=t[r],a=e[r];E(s<0||a<0||s===a,()=>n+` Shapes ${t} and ${e} must match`)}}}function jb(t){return!(typeof t=="number"||t.some(e=>e<0))}function hl(t,e,n){let r=ky(t,n);const s=!jb(r);if(s&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(s&&e.forEach(a=>{r=ky(a.shape,r)}),!jb(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function ky(t,e){if(typeof t=="number")return e;if(typeof e=="number")return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let r=0;r<t.length;++r){const s=t[r],a=e[r];if(s>=0&&a>=0&&s!==a)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[r]=s>=0?s:a}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $H{constructor(e,n,r,s,a,o,i){this.name=e,this.dtype=n,this.maxSize=r,this.elementShape=s,this.identicalElementShapes=a,this.dynamicSize=o,this.clearAfterRead=i,this.tensors=[],this.closed_=!1,this.idTensor=Ve(0),Cs(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const n=this.tensors[e];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(e){return e.map(n=>this.read(n))}write(e,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[e]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),$r(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);r.tensor=n,Cs(n),r.written=!0,this.tensors[e]=r}writeMany(e,n){if(e.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${n.length}.`);e.forEach((r,s)=>this.write(r,n[s]))}gather(e,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(e)e=e.slice(0,this.size());else{e=[];for(let s=0;s<this.size();s++)e.push(s)}if(e.length===0)return ns([],[0].concat(this.elementShape));const r=this.readMany(e);return $r(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),na(r,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return ns([],[0].concat(this.elementShape));const n=[];for(let s=0;s<this.size();s++)n.push(s);const r=this.readMany(n);return $r(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),Kt(r,0)}scatter(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const r=Math.max(...e);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(e,ui(n,0))}split(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let r=0;const s=e.map(u=>(r+=u,r));if(r!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const a=r===0?0:n.size/r,o=[];De(()=>{n=X(n,[1,r,a]);for(let u=0;u<e.length;++u){const l=[0,u===0?0:s[u-1],0],d=[1,e[u],a];o[u]=X(Re(n,l,d),this.elementShape)}return o});const i=[];for(let u=0;u<e.length;u++)i[u]=u;this.writeMany(i,o)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qo{get id(){return this.idTensor.id}constructor(e,n,r,s=-1){this.tensors=e,this.elementShape=n,this.elementDtype=r,e!=null&&e.forEach(a=>{if(r!==a.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${a.dtype}`);$r(n,a.shape,"TensorList shape mismatch: "),Cs(a)}),this.idTensor=Ve(0),this.maxNumElements=s,Cs(this.idTensor)}copy(){return new Qo([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,n,r=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(r!==-1&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);$r(e,this.elementShape,"TensorList shape mismatch: ");const s=hl(this.elementShape,this.tensors,e);return De(()=>{const a=this.tensors.map(o=>X(o,s));return na(a,0)})}popBack(e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const r=hl(this.elementShape,this.tensors,e),s=this.tensors.pop();return s.kept=!1,$r(s.shape,e,"TensorList shape mismatch: "),X(s,r)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if($r(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Cs(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const n=new Qo([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(let r=0;r<Math.min(this.tensors.length,e);++r)n.tensors[r]=this.tensors[r];return n}getItem(e,n,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);$r(this.tensors[e].shape,n,"TensorList shape mismatch: ");const s=hl(this.elementShape,this.tensors,n);return X(this.tensors[e],s)}setItem(e,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);$r(this.elementShape,n.shape,"TensorList shape mismatch: "),Cs(n),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=n}gather(e,n,r){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);$r(this.elementShape,r,"TensorList shape mismatch: "),e=e.slice(0,this.size());const s=hl(this.elementShape,this.tensors,r);return e.length===0?ns([],[0].concat(s)):De(()=>{const a=e.map(o=>X(this.tensors[o],s));return na(a,0)})}concat(e,n){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);$r(this.elementShape,n,"TensorList shape mismatch: ");const r=hl(this.elementShape,this.tensors,n);return this.size()===0?ns([],[0].concat(r)):De(()=>{const s=this.tensors.map(a=>X(a,r));return Kt(s,0)})}}function _H(t,e,n){const r=t.dtype;if(t.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${t.shape}`);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const s=t.shape.slice(1);$r(s,e,"TensorList shape mismatch: ");const a=ui(t);return new Qo(a,e,r)}function NH(t,e,n,r){return new Qo([],t,e,r)}function kH(t,e,n,r){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const s=Math.max(...e);if(r!=null&&r!==-1&&s>=r)throw new Error(`Max index must be < array size (${s}  vs. ${r})`);const a=new Qo([],n,t.dtype,r),o=ui(t,0);return e.forEach((i,u)=>{a.setItem(i,o[u])}),a}function EH(t,e,n){let r=0;const s=e.map(l=>(r+=l,r));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${t.shape}`);const a=t.shape.slice(1),o=ky(a,n),i=r===0?0:t.size/r,u=De(()=>{const l=[];t=X(t,[1,r,i]);for(let d=0;d<e.length;++d){const f=[0,d===0?0:s[d-1],0],h=[1,e[d],i];l[d]=X(Re(t,f,h),o)}return t.dispose(),l}),c=new Qo([],n,t.dtype,e.length);for(let l=0;l<u.length;l++)c.setItem(l,u[l]);return c}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TH=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const r=C("thenBranch",t,e,n),s=C("elseBranch",t,e,n),a=C("cond",t,e,n),o=C("args",t,e,n);return(await a.data())[0]?n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap):n.functionMap[s].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=C("body",t,e,n),s=C("cond",t,e,n),a=C("args",t,e,n),o=await n.functionMap[s].executeFunctionAsync(a,n.tensorArrayMap,n.tensorListMap),i=a.map(l=>l.id);let u=await o[0].data();o.forEach(l=>{!l.kept&&i.indexOf(l.id)===-1&&l.dispose()});let c=a;for(;u[0];){const l=c;c=await n.functionMap[r].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);const d=c.map(f=>f.id);l.forEach(f=>{!f.kept&&i.indexOf(f.id)===-1&&d.indexOf(f.id)===-1&&f.dispose()});const p=await n.functionMap[s].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);u=await p[0].data(),p.forEach(f=>{!f.kept&&i.indexOf(f.id)===-1&&d.indexOf(f.id)===-1&&f.dispose()})}return c}case"LoopCond":{const r=C("pred",t,e,n);return[zs(r)]}case"Switch":{const r=C("pred",t,e,n);let s=C("data",t,e,n);return s.kept||(s=zs(s)),(await r.data())[0]?[void 0,s]:[s,void 0]}case"Merge":{const r=t.inputNames.find(s=>Gt(s,e,n)!==void 0);if(r){const s=Gt(r,e,n);return[zs(s)]}return}case"Enter":{const r=C("frameName",t,e,n),s=C("tensor",t,e,n);return n.enterFrame(r),[zs(s)]}case"Exit":{const r=C("tensor",t,e,n);return n.exitFrame(),[zs(r)]}case"NextIteration":{const r=C("tensor",t,e,n);return n.nextIteration(),[zs(r)]}case"TensorArrayV3":{const r=C("size",t,e,n),s=C("dtype",t,e,n),a=C("elementShape",t,e,n),o=C("dynamicSize",t,e,n),i=C("clearAfterRead",t,e,n),u=C("identicalElementShapes",t,e,n),c=C("name",t,e,n),l=new $H(c,s,r,a,u,o,i);return n.addTensorArray(l),[l.idTensor,Ve(1)]}case"TensorArrayWriteV3":{const r=C("tensorArrayId",t,e,n),s=C("index",t,e,n),a=C("tensor",t,e,n),o=n.getTensorArray(r.id);return o.write(s,a),[o.idTensor]}case"TensorArrayReadV3":{const r=C("tensorArrayId",t,e,n),s=C("index",t,e,n);return[n.getTensorArray(r.id).read(s)]}case"TensorArrayGatherV3":{const r=C("tensorArrayId",t,e,n),s=C("indices",t,e,n),a=C("dtype",t,e,n);return[n.getTensorArray(r.id).gather(s,a)]}case"TensorArrayScatterV3":{const r=C("tensorArrayId",t,e,n),s=C("indices",t,e,n),a=C("tensor",t,e,n),o=n.getTensorArray(r.id);return o.scatter(s,a),[o.idTensor]}case"TensorArrayConcatV3":{const r=C("tensorArrayId",t,e,n),s=n.getTensorArray(r.id),a=C("dtype",t,e,n);return[s.concat(a)]}case"TensorArraySplitV3":{const r=C("tensorArrayId",t,e,n),s=C("tensor",t,e,n),a=C("lengths",t,e,n),o=n.getTensorArray(r.id);return o.split(a,s),[o.idTensor]}case"TensorArraySizeV3":{const r=C("tensorArrayId",t,e,n),s=n.getTensorArray(r.id);return[Ve(s.size(),"int32")]}case"TensorArrayCloseV3":{const r=C("tensorArrayId",t,e,n),s=n.getTensorArray(r.id);return s.clearAndClose(),[s.idTensor]}case"TensorListSetItem":{const r=C("tensorListId",t,e,n),s=C("index",t,e,n),a=C("tensor",t,e,n),o=n.getTensorList(r.id);return o.setItem(s,a),[o.idTensor]}case"TensorListGetItem":{const r=C("tensorListId",t,e,n),s=C("index",t,e,n),a=C("elementShape",t,e,n),o=C("elementDType",t,e,n);return[n.getTensorList(r.id).getItem(s,a,o)]}case"TensorListScatterV2":case"TensorListScatter":{const r=C("indices",t,e,n),s=C("tensor",t,e,n),a=C("elementShape",t,e,n),o=C("numElements",t,e,n),i=kH(s,r,a,o);return n.addTensorList(i),[i.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=C("elementShape",t,e,n),s=C("elementDType",t,e,n);let a;t.op==="TensorListReserve"?a="numElements":a="maxNumElements";const o=C(a,t,e,n),i=t.op==="TensorListReserve"?-1:o,u=NH(r,s,o,i);return n.addTensorList(u),[u.idTensor]}case"TensorListGather":{const r=C("tensorListId",t,e,n),s=C("indices",t,e,n),a=C("elementShape",t,e,n),o=C("elementDType",t,e,n);return[n.getTensorList(r.id).gather(s,o,a)]}case"TensorListStack":{const r=C("tensorListId",t,e,n),s=C("elementShape",t,e,n),a=C("elementDType",t,e,n),o=C("numElements",t,e,n);return[n.getTensorList(r.id).stack(s,a,o)]}case"TensorListFromTensor":{const r=C("tensor",t,e,n),s=C("elementShape",t,e,n),a=C("elementDType",t,e,n),o=_H(r,s,a);return n.addTensorList(o),[o.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=C("tensorListId",t,e,n),s=n.getTensorList(r.id),a=C("dtype",t,e,n),o=C("elementShape",t,e,n);return[s.concat(a,o)]}case"TensorListPushBack":{const r=C("tensorListId",t,e,n),s=C("tensor",t,e,n),a=n.getTensorList(r.id);return a.pushBack(s),[a.idTensor]}case"TensorListPopBack":{const r=C("tensorListId",t,e,n),s=C("elementShape",t,e,n),a=C("elementDType",t,e,n);return[n.getTensorList(r.id).popBack(s,a)]}case"TensorListSplit":{const r=C("tensor",t,e,n),s=C("elementShape",t,e,n),a=C("lengths",t,e,n),o=EH(r,a,s);return n.addTensorList(o),[o.idTensor]}case"TensorListLength":{const r=C("tensorListId",t,e,n),s=n.getTensorList(r.id);return[Ve(s.size(),"int32")]}case"TensorListResize":{const r=C("tensorListId",t,e,n),s=C("size",t,e,n),o=n.getTensorList(r.id).resize(s);return n.addTensorList(o),[o.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kb(t,e,n){const[r,s]=C("fusedOps",t,e,n),a=r==="biasadd",o=!a,i=s==="prelu",u=r==="fusedbatchnorm",c=C("numArgs",t,e,n);if(a){if(i&&c!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!i&&a&&c!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(u)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const l=C("strides",t,e,n),d=tp(t,e,n),p=C("dataFormat",t,e,n).toUpperCase(),f=C("dilations",t,e,n);let[h,y]=C("args",t,e,n);o&&(y=h,h=void 0);const x=C("leakyreluAlpha",t,e,n);return{stride:l,pad:d,dataFormat:p,dilations:f,biasArg:h,preluArg:y,activationFunc:s,leakyreluAlpha:x}}const RH=(t,e,n,r=Yt)=>{switch(t.op){case"Conv1D":{const s=C("stride",t,e,n),a=C("pad",t,e,n),o=C("dataFormat",t,e,n).toUpperCase(),i=C("dilation",t,e,n);return[r.conv1d(C("x",t,e,n),C("filter",t,e,n),s,a,o,i)]}case"Conv2D":{const s=C("strides",t,e,n),a=tp(t,e,n),o=C("dataFormat",t,e,n).toUpperCase(),i=C("dilations",t,e,n);return[r.conv2d(C("x",t,e,n),C("filter",t,e,n),[s[1],s[2]],a,o,[i[1],i[2]])]}case"_FusedConv2D":{const{stride:s,pad:a,dataFormat:o,dilations:i,biasArg:u,preluArg:c,activationFunc:l,leakyreluAlpha:d}=Kb(t,e,n);return[r.fused.conv2d({x:C("x",t,e,n),filter:C("filter",t,e,n),strides:[s[1],s[2]],pad:a,dataFormat:o,dilations:[i[1],i[2]],bias:u,activation:l,preluActivationWeights:c,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:s,pad:a,dataFormat:o,dilations:i,biasArg:u,preluArg:c,activationFunc:l,leakyreluAlpha:d}=Kb(t,e,n);return[r.fused.depthwiseConv2d({x:C("x",t,e,n),filter:C("filter",t,e,n),strides:[s[1],s[2]],pad:a,dataFormat:o,dilations:[i[1],i[2]],bias:u,activation:l,preluActivationWeights:c,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const s=C("outputShape",t,e,n),a=C("strides",t,e,n),o=tp(t,e,n);return[r.conv2dTranspose(C("x",t,e,n),C("filter",t,e,n),s,[a[1],a[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const s=C("strides",t,e,n),a=tp(t,e,n),o=C("dilations",t,e,n),i=C("dataFormat",t,e,n).toUpperCase();return[r.depthwiseConv2d(C("input",t,e,n),C("filter",t,e,n),[s[1],s[2]],a,i,[o[1],o[2]])]}case"Conv3D":{const s=C("strides",t,e,n),a=C("pad",t,e,n),o=C("dataFormat",t,e,n).toUpperCase(),i=C("dilations",t,e,n);return[r.conv3d(C("x",t,e,n),C("filter",t,e,n),[s[1],s[2],s[3]],a,o,[i[1],i[2],i[3]])]}case"AvgPool":{const s=C("strides",t,e,n),a=C("pad",t,e,n),o=C("kernelSize",t,e,n);return[r.avgPool(C("x",t,e,n),[o[1],o[2]],[s[1],s[2]],a)]}case"MaxPool":{const s=C("strides",t,e,n),a=C("pad",t,e,n),o=C("kernelSize",t,e,n);return[r.maxPool(C("x",t,e,n),[o[1],o[2]],[s[1],s[2]],a)]}case"MaxPoolWithArgmax":{const s=C("strides",t,e,n),a=C("pad",t,e,n),o=C("kernelSize",t,e,n),i=C("includeBatchInIndex",t,e,n),{result:u,indexes:c}=r.maxPoolWithArgmax(C("x",t,e,n),[o[1],o[2]],[s[1],s[2]],a,i);return[u,c]}case"AvgPool3D":{const s=C("strides",t,e,n),a=C("pad",t,e,n),o=C("kernelSize",t,e,n);return[r.avgPool3d(C("x",t,e,n),[o[1],o[2],o[3]],[s[1],s[2],s[3]],a)]}case"MaxPool3D":{const s=C("strides",t,e,n),a=C("pad",t,e,n),o=C("kernelSize",t,e,n);return[r.maxPool3d(C("x",t,e,n),[o[1],o[2],o[3]],[s[1],s[2],s[3]],a)]}case"Dilation2D":{const s=C("strides",t,e,n),a=C("pad",t,e,n),o=C("dilations",t,e,n),i=s[1],u=s[2],c=o[1],l=o[2];return[r.dilation2d(C("x",t,e,n),C("filter",t,e,n),[i,u],a,[c,l],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AH=(t,e,n,r=Yt)=>{switch(t.op){case"Fill":{const s=C("shape",t,e,n),a=C("dtype",t,e,n),o=C("value",t,e,n);return[r.fill(s,o,a)]}case"LinSpace":{const s=C("start",t,e,n),a=C("stop",t,e,n),o=C("num",t,e,n);return[r.linspace(s,a,o)]}case"Multinomial":{const s=C("logits",t,e,n),a=C("numSamples",t,e,n),o=C("seed",t,e,n);return[r.multinomial(s,a,o)]}case"OneHot":{const s=C("indices",t,e,n),a=C("depth",t,e,n),o=C("onValue",t,e,n),i=C("offValue",t,e,n),u=C("dtype",t,e,n);return[r.oneHot(s,a,o,i,u)]}case"Ones":return[r.ones(C("shape",t,e,n),C("dtype",t,e,n))];case"OnesLike":return[r.onesLike(C("x",t,e,n))];case"RandomStandardNormal":return[r.randomStandardNormal(C("shape",t,e,n),C("dtype",t,e,n),C("seed",t,e,n))];case"RandomUniform":return[r.randomUniform(C("shape",t,e,n),C("minval",t,e,n),C("maxval",t,e,n),C("dtype",t,e,n))];case"RandomUniformInt":return[r.randomUniformInt(C("shape",t,e,n),C("minval",t,e,n),C("maxval",t,e,n),C("seed",t,e,n))];case"Range":{const s=C("start",t,e,n),a=C("stop",t,e,n),o=C("step",t,e,n);return[r.range(s,a,o,C("dtype",t,e,n))]}case"TruncatedNormal":{const s=C("shape",t,e,n),a=C("mean",t,e,n),o=C("stdDev",t,e,n),i=C("seed",t,e,n);return[r.truncatedNormal(s,a,o,C("dtype",t,e,n),i)]}case"Zeros":return[r.zeros(C("shape",t,e,n),C("dtype",t,e,n))];case"ZerosLike":return[r.zerosLike(C("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dm(t,e,n){const r=C("boxes",t,e,n),s=C("scores",t,e,n),a=C("maxOutputSize",t,e,n),o=C("iouThreshold",t,e,n),i=C("scoreThreshold",t,e,n),u=C("softNmsSigma",t,e,n);return{boxes:r,scores:s,maxOutputSize:a,iouThreshold:o,scoreThreshold:i,softNmsSigma:u}}const OH=async(t,e,n,r,s=Yt)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:a,scores:o,maxOutputSize:i,iouThreshold:u,scoreThreshold:c,softNmsSigma:l}=Dm(t,e,n),d=await s.image.nonMaxSuppressionWithScoreAsync(a,o,i,u,c,l);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:a,scores:o,maxOutputSize:i,iouThreshold:u,scoreThreshold:c}=Dm(t,e,n),l=C("padToMaxOutputSize",t,e,n),d=await s.image.nonMaxSuppressionPaddedAsync(a,o,i,u,c,l);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:a,scores:o,maxOutputSize:i,iouThreshold:u,scoreThreshold:c}=Dm(t,e,n);return[await s.image.nonMaxSuppressionAsync(a,o,i,u,c)]}case"Where":{const a=s.cast(C("condition",t,e,n),"bool"),o=[await s.whereAsync(a)];return a.dispose(),o}case"ListDiff":return s.setdiff1dAsync(C("x",t,e,n),C("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DH=(t,e,n,r=Yt)=>{switch(t.op){case"LowerBound":{const s=C("sortedSequence",t,e,n),a=C("values",t,e,n);return[r.lowerBound(s,a)]}case"TopKV2":{const s=C("x",t,e,n),a=C("k",t,e,n),o=C("sorted",t,e,n),i=r.topk(s,a,o);return[i.values,i.indices]}case"UpperBound":{const s=C("sortedSequence",t,e,n),a=C("values",t,e,n);return[r.upperBound(s,a)]}case"Unique":{const s=C("x",t,e,n),a=r.unique(s);return[a.values,a.indices]}case"UniqueV2":{const s=C("x",t,e,n),a=C("axis",t,e,n),o=r.unique(s,a);return[o.values,o.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PH=(t,e,n,r=Yt)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const s=C("default",t,e,n);return[Gt(t.name,e,n)||s];case"Placeholder":return[Gt(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const l=C("x",t,e,n);return[zs(l)]}case"IdentityN":return C("x",t,e,n).map(l=>zs(l));case"Snapshot":const a=C("x",t,e,n);return[zs(a)];case"Shape":return[r.tensor1d(C("x",t,e,n).shape,"int32")];case"ShapeN":return C("x",t,e,n).map(l=>r.tensor1d(l.shape));case"Size":return[r.scalar(C("x",t,e,n).size,"int32")];case"Rank":return[r.scalar(C("x",t,e,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const o=C("x",t,e,n),i=C("data",t,e,n),u=C("message",t,e,n),c=C("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(u);for(let l=0;l<i.length;l++)console.log(Array.prototype.slice.call(i[l].dataSync()).slice(0,c));return[o];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FH{get id(){return this.handle.id}constructor(e,n){this.keyDType=e,this.valueDType=n,this.handle=Ve(0),this.tensorMap=new Map,Cs(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Ve(this.size(),"int32")}async import(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return this.tensorMap.forEach(s=>s.dispose()),this.tensorMap.clear(),De(()=>{const s=ui(n),a=r.length,o=s.length;E(a===o,()=>`The number of elements doesn't match, keys has ${a} elements, the values has ${o} elements.`);for(let i=0;i<a;i++){const u=r[i],c=s[i];Cs(c),this.tensorMap.set(u,c)}return this.handle})}async find(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return De(()=>{const s=[];for(let a=0;a<r.length;a++){const o=r[a],i=this.findWithDefault(o,n);s.push(i)}return na(s)})}findWithDefault(e,n){const r=this.tensorMap.get(e);return r??n}checkKeyAndValueTensor(e,n){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LH=async(t,e,n,r)=>{switch(t.op){case"HashTable":case"HashTableV2":{const s=r.getHashTableHandleByName(t.name);if(s!=null)return[s];{const a=C("keyDType",t,e,n),o=C("valueDType",t,e,n),i=new FH(a,o);return r.addHashTable(t.name,i),[i.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const s=C("tableHandle",t,e,n,r),a=C("keys",t,e,n),o=C("values",t,e,n);return[await r.getHashTableById(s.id).import(a,o)]}case"LookupTableFind":case"LookupTableFindV2":{const s=C("tableHandle",t,e,n,r),a=C("keys",t,e,n),o=C("defaultValue",t,e,n);return[await r.getHashTableById(s.id).find(a,o)]}case"LookupTableSize":case"LookupTableSizeV2":{const s=C("tableHandle",t,e,n,r);return[r.getHashTableById(s.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MH=(t,e,n,r=Yt)=>{switch(t.op){case"ResizeBilinear":{const s=C("images",t,e,n),a=C("size",t,e,n),o=C("alignCorners",t,e,n),i=C("halfPixelCenters",t,e,n);return[r.image.resizeBilinear(s,[a[0],a[1]],o,i)]}case"ResizeNearestNeighbor":{const s=C("images",t,e,n),a=C("size",t,e,n),o=C("alignCorners",t,e,n),i=C("halfPixelCenters",t,e,n);return[r.image.resizeNearestNeighbor(s,[a[0],a[1]],o,i)]}case"CropAndResize":{const s=C("image",t,e,n),a=C("boxes",t,e,n),o=C("boxInd",t,e,n),i=C("cropSize",t,e,n),u=C("method",t,e,n),c=C("extrapolationValue",t,e,n);return[r.image.cropAndResize(s,a,o,i,u,c)]}case"ImageProjectiveTransformV3":{const s=C("images",t,e,n),a=C("transforms",t,e,n),o=C("outputShape",t,e,n),i=C("fillValue",t,e,n),u=C("interpolation",t,e,n),c=C("fillMode",t,e,n);return[r.image.transform(s,a,u.toLowerCase(),c.toLowerCase(),i,o)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BH=(t,e,n,r=Yt)=>{switch(t.op){case"Equal":return[r.equal(C("a",t,e,n),C("b",t,e,n))];case"NotEqual":return[r.notEqual(C("a",t,e,n),C("b",t,e,n))];case"Greater":return[r.greater(C("a",t,e,n),C("b",t,e,n))];case"GreaterEqual":return[r.greaterEqual(C("a",t,e,n),C("b",t,e,n))];case"Less":return[r.less(C("a",t,e,n),C("b",t,e,n))];case"LessEqual":return[r.lessEqual(C("a",t,e,n),C("b",t,e,n))];case"LogicalAnd":return[r.logicalAnd(C("a",t,e,n),C("b",t,e,n))];case"LogicalNot":return[r.logicalNot(C("a",t,e,n))];case"LogicalOr":return[r.logicalOr(C("a",t,e,n),C("b",t,e,n))];case"Select":case"SelectV2":return[r.where(C("condition",t,e,n),C("a",t,e,n),C("b",t,e,n))];case"BitwiseAnd":return[r.bitwiseAnd(C("a",t,e,n),C("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VH=(t,e,n,r=Yt)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(C("a",t,e,n),C("b",t,e,n),C("transposeA",t,e,n),C("transposeB",t,e,n))];case"Einsum":return[r.einsum(C("equation",t,e,n),...C("tensors",t,e,n))];case"Transpose":return[r.transpose(C("x",t,e,n),C("perm",t,e,n))];case"_FusedMatMul":const[s,a]=C("fusedOps",t,e,n),o=s==="biasadd",i=a==="prelu",u=C("numArgs",t,e,n),c=C("leakyreluAlpha",t,e,n);if(o){if(i&&u!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!i&&u!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[l,d]=C("args",t,e,n);return[r.fused.matMul({a:C("a",t,e,n),b:C("b",t,e,n),transposeA:C("transposeA",t,e,n),transposeB:C("transposeB",t,e,n),bias:l,activation:a,preluActivationWeights:d,leakyreluAlpha:c})];case"MatrixBandPart":return[r.linalg.bandPart(C("a",t,e,n),C("numLower",t,e,n),C("numUpper",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zH=(t,e,n,r=Yt)=>{switch(t.op){case"EuclideanNorm":return[r.euclideanNorm(C("x",t,e,n),C("axis",t,e,n),C("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm(C("x",t,e,n),C("mean",t,e,n),C("variance",t,e,n),C("offset",t,e,n),C("scale",t,e,n),C("epsilon",t,e,n))];case"FusedBatchNormV3":return[r.batchNorm(C("x",t,e,n),C("mean",t,e,n),C("variance",t,e,n),C("offset",t,e,n),C("scale",t,e,n),C("epsilon",t,e,n))];case"LRN":return[r.localResponseNormalization(C("x",t,e,n),C("radius",t,e,n),C("bias",t,e,n),C("alpha",t,e,n),C("beta",t,e,n))];case"Softmax":return[r.softmax(C("x",t,e,n))];case"LogSoftmax":return[r.logSoftmax(C("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WH=(t,e,n,r=Yt)=>{switch(t.op){case"RaggedGather":{const{outputNestedSplits:s,outputDenseValues:a}=r.raggedGather(C("paramsNestedSplits",t,e,n),C("paramsDenseValues",t,e,n),C("indices",t,e,n),C("outputRaggedRank",t,e,n));return s.concat(a)}case"RaggedRange":{const{rtNestedSplits:s,rtDenseValues:a}=r.raggedRange(C("starts",t,e,n),C("limits",t,e,n),C("splits",t,e,n));return[s,a]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor(C("shape",t,e,n),C("values",t,e,n),C("defaultValue",t,e,n),C("rowPartitionTensors",t,e,n),C("rowPartitionTypes",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UH=(t,e,n,r=Yt)=>{switch(t.op){case"Max":{const i=C("axis",t,e,n),u=C("keepDims",t,e,n);return[r.max(C("x",t,e,n),i,u)]}case"Mean":{const i=C("axis",t,e,n),u=C("keepDims",t,e,n);return[r.mean(C("x",t,e,n),i,u)]}case"Min":{const i=C("axis",t,e,n),u=C("keepDims",t,e,n);return[r.min(C("x",t,e,n),i,u)]}case"Sum":{const i=C("axis",t,e,n),u=C("keepDims",t,e,n);return[r.sum(C("x",t,e,n),i,u)]}case"All":{const i=C("axis",t,e,n),u=C("keepDims",t,e,n);return[r.all(C("x",t,e,n),i,u)]}case"Any":{const i=C("axis",t,e,n),u=C("keepDims",t,e,n);return[r.any(C("x",t,e,n),i,u)]}case"ArgMax":{const i=C("axis",t,e,n);return[r.argMax(C("x",t,e,n),i)]}case"ArgMin":{const i=C("axis",t,e,n);return[r.argMin(C("x",t,e,n),i)]}case"Prod":{const i=C("axis",t,e,n),u=C("keepDims",t,e,n);return[r.prod(C("x",t,e,n),i,u)]}case"Cumprod":{const i=C("axis",t,e,n),u=C("exclusive",t,e,n),c=C("reverse",t,e,n);return[r.cumprod(C("x",t,e,n),i,u,c)]}case"Cumsum":{const i=C("axis",t,e,n),u=C("exclusive",t,e,n),c=C("reverse",t,e,n);return[r.cumsum(C("x",t,e,n),i,u,c)]}case"Bincount":const s=C("x",t,e,n),a=C("weights",t,e,n),o=C("size",t,e,n);return[r.bincount(s,a,o)];case"DenseBincount":{const i=C("x",t,e,n),u=C("weights",t,e,n),c=C("size",t,e,n),l=C("binaryOutput",t,e,n);return[r.denseBincount(i,u,c,l)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GH=(t,e,n,r=Yt)=>{switch(t.op){case"ConcatV2":case"Concat":{const s=C("n",t,e,n),a=C("axis",t,e,n);let o=C("tensors",t,e,n);return o=o.slice(0,s),[r.concat(o,a)]}case"Gather":{const s=C("x",t,e,n),a=C("indices",t,e,n);return[r.gather(s,r.cast(a,"int32"),0)]}case"GatherV2":{const s=C("axis",t,e,n),a=C("batchDims",t,e,n),o=C("x",t,e,n),i=C("indices",t,e,n);return[r.gather(o,r.cast(i,"int32"),s,a)]}case"Reverse":{const s=C("dims",t,e,n),a=[];for(let i=0;i<s.length;i++)s[i]&&a.push(i);const o=C("x",t,e,n);return[r.reverse(o,a)]}case"ReverseV2":{const s=C("axis",t,e,n),a=C("x",t,e,n);return[r.reverse(a,s)]}case"Slice":{const s=C("begin",t,e,n),a=C("size",t,e,n);return[r.slice(C("x",t,e,n),s,a)]}case"StridedSlice":{const s=C("begin",t,e,n),a=C("end",t,e,n),o=C("strides",t,e,n),i=C("beginMask",t,e,n),u=C("endMask",t,e,n),c=C("ellipsisMask",t,e,n),l=C("newAxisMask",t,e,n),d=C("shrinkAxisMask",t,e,n),p=C("x",t,e,n);return[r.stridedSlice(p,s,a,o,i,u,c,l,d)]}case"Pack":return De(()=>{const s=C("axis",t,e,n),a=C("tensors",t,e,n),o=a[0].shape,i=r.squeeze(a[0]).shape,u=a.map(c=>{const l=yt(c.shape,o);if(!l&&!yt(r.squeeze(c).shape,i))throw new Error("the input tensors shape does not match");return l?c:r.reshape(c,o)});return[r.stack(u,s)]});case"Unpack":{const s=C("axis",t,e,n),a=C("tensor",t,e,n);return r.unstack(a,s)}case"Tile":{const s=C("reps",t,e,n);return[r.tile(C("x",t,e,n),s)]}case"Split":case"SplitV":{const s=C("axis",t,e,n),a=C("numOrSizeSplits",t,e,n),o=C("x",t,e,n);return r.split(o,a,s)}case"ScatterNd":{const s=C("indices",t,e,n),a=C("values",t,e,n),o=C("shape",t,e,n);return[r.scatterND(s,a,o)]}case"GatherNd":{const s=C("x",t,e,n),a=C("indices",t,e,n);return[r.gatherND(s,a)]}case"SparseToDense":{const s=C("sparseIndices",t,e,n),a=C("outputShape",t,e,n),o=C("sparseValues",t,e,n),i=C("defaultValue",t,e,n);return[r.sparseToDense(s,o,a,o.dtype===i.dtype?i:r.cast(i,o.dtype))]}case"TensorScatterUpdate":{const s=C("indices",t,e,n),a=C("values",t,e,n),o=C("tensor",t,e,n);return[r.tensorScatterUpdate(o,s,a)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HH=(t,e,n,r=Yt)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:s,outputValues:a,emptyRowIndicator:o,reverseIndexMap:i}=r.sparse.sparseFillEmptyRows(C("indices",t,e,n),C("values",t,e,n),C("denseShape",t,e,n),C("defaultValue",t,e,n));return[s,a,o,i]}case"SparseReshape":{const{outputIndices:s,outputShape:a}=r.sparse.sparseReshape(C("inputIndices",t,e,n),C("inputShape",t,e,n),C("newShape",t,e,n));return[s,a]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(C("data",t,e,n),C("indices",t,e,n),C("segmentIds",t,e,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(C("data",t,e,n),C("indices",t,e,n),C("segmentIds",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jH=(t,e,n,r=Yt)=>{switch(t.op){case"FFT":return[r.fft(C("x",t,e,n))];case"IFFT":return[r.ifft(C("x",t,e,n))];case"RFFT":return[r.rfft(C("x",t,e,n))];case"IRFFT":return[r.irfft(C("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KH=(t,e,n,r=Yt)=>{switch(t.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(C("input",t,e,n),C("pattern",t,e,n),C("rewrite",t,e,n),C("replaceGlobal",t,e,n))];case"StringNGrams":{const{nGrams:s,nGramsSplits:a}=r.string.stringNGrams(C("data",t,e,n),C("dataSplits",t,e,n),C("separator",t,e,n),C("nGramWidths",t,e,n),C("leftPad",t,e,n),C("rightPad",t,e,n),C("padWidth",t,e,n),C("preserveShortSequences",t,e,n));return[s,a]}case"StringSplit":{const{indices:s,values:a,shape:o}=r.string.stringSplit(C("input",t,e,n),C("delimiter",t,e,n),C("skipEmpty",t,e,n));return[s,a,o]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(C("input",t,e,n),C("numBuckets",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qH=(t,e,n,r=Yt)=>{switch(t.op){case"Cast":return[r.cast(C("x",t,e,n),C("dtype",t,e,n))];case"ExpandDims":{const s=C("axis",t,e,n);return[r.expandDims(C("x",t,e,n),s)]}case"Squeeze":{const s=C("axis",t,e,n);return[r.squeeze(C("x",t,e,n),s)]}case"Reshape":return[r.reshape(C("x",t,e,n),C("shape",t,e,n))];case"EnsureShape":return[r.ensureShape(C("x",t,e,n),C("shape",t,e,n))];case"MirrorPad":return[r.mirrorPad(C("x",t,e,n),C("padding",t,e,n),C("mode",t,e,n))];case"PadV2":case"Pad":return[r.pad(C("x",t,e,n),C("padding",t,e,n),C("constantValue",t,e,n))];case"SpaceToBatchND":{const s=C("blockShape",t,e,n),a=C("paddings",t,e,n);return[r.spaceToBatchND(C("x",t,e,n),s,a)]}case"BatchToSpaceND":{const s=C("blockShape",t,e,n),a=C("crops",t,e,n);return[r.batchToSpaceND(C("x",t,e,n),s,a)]}case"DepthToSpace":{const s=C("blockSize",t,e,n),a=C("dataFormat",t,e,n).toUpperCase();return[r.depthToSpace(C("x",t,e,n),s,a)]}case"BroadcastTo":return[r.broadcastTo(C("x",t,e,n),C("shape",t,e,n))];case"BroadcastArgs":return[r.broadcastArgs(C("s0",t,e,n),C("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qb(t,e,n,r,s=De){const a=((o,i,u)=>{switch(o.category){case"arithmetic":return s(()=>CH(o,i,u));case"basic_math":return s(()=>IH(o,i,u));case"control":return TH(o,i,u);case"convolution":return s(()=>RH(o,i,u));case"creation":return s(()=>AH(o,i,u));case"dynamic":return OH(o,i,u);case"evaluation":return s(()=>DH(o,i,u));case"image":return s(()=>MH(o,i,u));case"graph":return s(()=>PH(o,i,u));case"logical":return s(()=>BH(o,i,u));case"matrices":return s(()=>VH(o,i,u));case"normalization":return s(()=>zH(o,i,u));case"ragged":return s(()=>WH(o,i,u));case"reduction":return s(()=>UH(o,i,u));case"slice_join":return s(()=>GH(o,i,u));case"sparse":return s(()=>HH(o,i,u));case"spectral":return s(()=>jH(o,i,u));case"string":return s(()=>KH(o,i,u));case"transformation":return s(()=>qH(o,i,u));case"hash_table":return LH(o,i,u,r);case"custom":const c=FN(o.op);if(c&&c.customExecutor)return c.customExecutor(new SH(o,i,u));throw TypeError(`Custom op ${o.op} is not registered.`);default:throw TypeError(`Unknown op '${o.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return Wo(a)?a.then(o=>[].concat(o)):[].concat(a)}class Xb{constructor(e={},n={},r={},s={},a){this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=s,this.parseNodeNameCache=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,n){return{id:e,frameName:n,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let n=0;n<this.contexts.length-1;n++){const r=this.contexts.slice(0,this.contexts.length-n);e.push(this.contextIdforContexts(r))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(e);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yb(t,e,n,r){const s=new Set,a=[];let o=null,i=null;const u=new Set,c=new Set(Object.keys(t).map(p=>Vn(p)[0]));r=r||[];const l=new Set(r.map(p=>Vn(p.name)[0])),d=[...e];for(;d.length>0;){const p=d.pop();if((Co(p)||nj(p)||rj(p))&&o==null&&(o=p,i=o.children.map(f=>f.name).filter(f=>s.has(f))),s.add(p.name),n[p.name]==null&&!c.has(p.name)&&!l.has(p.name)){if(p.inputs.length===0){a.push(p.name);continue}p.inputs.forEach(f=>{u.has(f.name)||(u.add(f.name),d.push(f))})}}return{inputs:t,outputs:e,usedNodes:s,missingInputs:a,dynamicNode:o,syncInputs:i}}function XH(t,e){const{usedNodes:n,inputs:r}=e,s=Object.keys(r).map(x=>Vn(x)[0]).map(x=>t.nodes[x]),a=t.initNodes||[],o=x=>n.has(typeof x=="string"?x:x.name);function i(x){return[...new Map(x.map(g=>[g.name,g])).values()]}const u=i([...s,...t.weights,...a]).filter(o),c=i([...u,...Object.values(t.nodes)]).filter(o),l=new Map(c.map(x=>[x.name,x])),d={};for(const x of c){d[x.name]=d[x.name]||0;for(const g of x.children)o(g)||(d[g.name]=Number.POSITIVE_INFINITY),d[g.name]=(d[g.name]||0)+1}const p=Object.entries(d).filter(([,x])=>x===0).map(([x])=>x),f=[...p];for(;p.length>0;){const x=p.pop(),g=l.get(x);for(const v of g.children.filter(o))--d[v.name]===0&&(f.push(v.name),p.push(v.name))}const h=f.map(x=>l.get(x)),y=YH(h,u);return QH(y,u),y}function YH(t,e){const n=new Map(t.map(o=>[o.name,o])),r=e.map(o=>o.name),s=new Set(r);for(;r.length>0;){const o=r.pop(),i=n.get(o);for(const u of i.children)!n.has(u.name)||s.has(u.name)||(s.add(u.name),r.push(u.name))}return t.filter(o=>s.has(o.name))}class Ed extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function QH(t,e){const n=new Map(t.map((i,u)=>[i.name,u])),r=new Set(e.map(i=>i.name)),s=i=>r.has(typeof i=="string"?i:i.name),a=new Set(t.map(i=>i.name)),o=i=>a.has(typeof i=="string"?i:i.name);for(const i of t){for(const u of i.children.filter(o)){if(!n.has(u.name))throw new Ed(`Child ${u.name} of node ${i.name} is unreachable.`);if(n.get(i.name)>n.get(u.name))throw new Ed(`Node ${i.name} is scheduled to run after its child ${u.name}.`)}if(!s(i))for(const u of i.inputs){if(!n.has(u.name))throw new Ed(`Input ${u.name} of node ${i.name} is unreachable.`);if(n.get(u.name)>n.get(i.name))throw new Ed(`Node ${i.name} is scheduled to run before its input ${u.name}.`)}}}function ZH(t){const e=new Map(t.map((i,u)=>[i.name,u])),n=Number.MAX_SAFE_INTEGER,r=t.map((i,u)=>Co(i)?n:u),s=i=>{const u=r[e.get(i.name)];return u??-1},a=t.map((i,u)=>i.children.map(s).reduce((c,l)=>Math.max(c,l),r[u])),o=new Map;for(let i=0;i<t.length;++i){const u=a[i];if(u===n)continue;const c=t[i],l=t[u];o.has(l.name)||o.set(l.name,[]),o.get(l.name).push(c)}return o}const JH=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),ej=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),tj=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function Co(t){return JH.has(t.op)}function nj(t){return ej.has(t.op)}function rj(t){return tj.has(t.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Up{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const n=Object.keys(e).map(r=>e[r].map(s=>s.id));this._weightIds=[].concat(...n),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const n=e.signatureKey||e.name;return e.defaultOutput?`${n}:${e.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((e,n)=>(e[n]=this._functions[n].signature,e),{})}constructor(e,n){this.graph=e,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(r=>{this._functionExecutorMap[r]=new Up(e.functions[r],this)})}getCompilationKey(e,n){const r=e.map(a=>a.name).sort(),s=n.map(a=>a.name).sort();return r.join(this.SEPARATOR)+"--"+s.join(this.SEPARATOR)}compile(e,n){const r=Yb(e,n,this.weightMap,this._initNodes),{missingInputs:s,dynamicNode:a,syncInputs:o}=r;if(a!=null)throw new Error(`This execution contains the node '${a.name}', which has the dynamic op '${a.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(s.length>0){const c=n.map(d=>d.name),l=Object.keys(e);throw new Error(`Cannot compute the outputs [${c}] from the provided inputs [${l}]. Missing the following inputs: [${s}]`)}const i=XH(this.graph,r),u=ZH(i);return{orderedNodes:i,nodeLiveUntilMap:u}}cloneAndKeepTensor(e){if(e==null)return null;const n=e.clone();return Cs(n),n}cloneTensorList(e){return e?e.map(r=>this.cloneAndKeepTensor(r)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([n,r])=>[n,this.cloneTensorList(r)]))}execute(e,n){this.disposeIntermediateTensors(),e=this.mapInputs(e);const r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n);const s=r.map(p=>this.graph.nodes[Vn(p)[0]]),a=n.map(p=>Vn(p)[0]),o=new Set(a);let i=a.map(p=>this.graph.nodes[p]);i.length===0&&(i=this._outputs);const u=this.getCompilationKey(s,i);let c=this.compiledMap.get(u);c==null&&(c=this.compile(e,i),this.compiledMap.set(u,c));try{this.keepIntermediateTensors=U().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(p){this.keepIntermediateTensors=!1,console.warn(p.message)}const l={},d={};return De(()=>{const p=new Xb(this.weightMap,l,d,this.functionExecutorMap,this.parseNodeNameCache),f=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(g=>{const[v,w]=Vn(g,p),S=[];S[w]=e[g],f[v]=S,this.keepIntermediateTensors&&(this.clonedTensorsMap[v]=this.cloneTensorList(S))});const h=this.getFrozenTensorIds(f),{orderedNodes:y,nodeLiveUntilMap:x}=c;for(const g of y){if(f[g.name])continue;const v=qb(g,f,p,this._resourceManager);if(Wo(v))throw new Error(`The execution of the op '${g.op}' returned a promise. Please use model.executeAsync() instead.`);f[g.name]=v,this.keepIntermediateTensors&&(this.clonedTensorsMap[g.name]=this.cloneTensorList(v)),this.checkTensorForDisposalWithNodeLiveUntilInfo(g,f,p,h,o,x.get(g.name))}return this.parent==null&&p.dispose(h),n.map(g=>Gt(g,f,p))})}getFrozenTensorIds(e){const n=[].concat.apply([],Object.keys(e).map(r=>e[r]).map(r=>r.map(s=>s.id)));return new Set(n)}checkTensorForDisposal(e,n,r,s,a,o,i){if(!(Co(n)||o.has(e))){for(const u of r[e])u!=null&&(i[u.id]=(i[u.id]||0)+n.children.length);for(const u of n.inputs){if(Co(u))continue;const c=Ub(u.name,r,s);if(c!=null)for(const l of c){if(!l||l.kept||a.has(l.id))continue;const d=i[l.id];d===1?(l.dispose(),delete i[l.id]):d!=null&&i[l.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,n,r,s,a,o){function i(u){return Co(u)||a.has(u.name)}if(!(Co(e)||o==null))for(const u of o){if(i(u))continue;const c=Ub(u.name,n,r);for(const l of c)!l||l.kept||s.has(l.id)||l.dispose()}}async executeAsync(e,n){return this._executeAsync(e,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const n of e)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,n,r=!1,s={},a={}){this.disposeIntermediateTensors(),r||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=U().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(p){this.keepIntermediateTensors=!1,console.warn(p.message)}const o=new Xb(this.weightMap,s,a,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const i=await this.executeWithControlFlow(e,o,n,r),u=n.map(p=>Gt(p,i,o)),c=u.map(p=>p.id),l=Object.keys(e).map(p=>e[p].id),d=new Set([...c,...l,...this.weightIds]);return Object.values(i).forEach(p=>{p.forEach(f=>{f&&!f.isDisposed&&!d.has(f.id)&&f.dispose()})}),this.parent==null&&o.dispose(d),u}async executeFunctionAsync(e,n,r){const s=e.reduce((a,o,i)=>(a[this.inputs[i].name]=o,a),{});return this._executeAsync(s,this.outputNodes,!0,n,r)}async executeWithControlFlow(e,n,r,s){const a=Object.keys(e),o=a.map(S=>this.graph.nodes[Vn(S)[0]]),i=r.map(S=>Vn(S)[0]),u=new Set(i);let c=i.map(S=>this.graph.nodes[S]);c.length===0&&(c=this._outputs);const{usedNodes:l,missingInputs:d,dynamicNode:p,syncInputs:f}=Yb(e,c,this.weightMap,this._initNodes),h=[...o,...this.graph.weights,...this._initNodes||[]].map(S=>({node:S,contexts:n.currentContext})),y=Object.assign({},this.weightMap);Object.keys(e).forEach(S=>{const[$,k]=Vn(S),T=[];T[k]=e[S],y[$]=T});const x={},g=this.getFrozenTensorIds(y),v={};for(;h.length>0;){const S=this.processStack(o,h,n,y,v,g,u,x,l);await Promise.all(S)}p==null&&!s&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const w=c.filter(S=>!Co(S)&&!Gt(S.name,y,n)).map(S=>S.name);if(w.length>0){let S="";throw p!=null&&(S=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${f}]`),new Error(`Cannot compute the outputs [${w}] from the provided inputs [${a}]. Consider providing the following inputs: [${d}]. ${S}`)}return y}processStack(e,n,r,s,a,o,i,u,c){const l=[];for(;n.length>0;){const d=n.pop();r.currentContext=d.contexts;let p="";if(d.node.op==="Enter"&&C("isConstant",d.node,s,r)&&([p]=Vs(d.node.name,r)),s[d.node.name]==null){const f=qb(d.node,s,r,this._resourceManager);p||([p]=Vs(d.node.name,r));const h=r.currentContext;Wo(f)?l.push(f.then(y=>(s[p]=y,this.keepIntermediateTensors&&(this.clonedTensorsMap[p]=this.cloneTensorList(y)),r.currentContext=h,this.checkTensorForDisposal(p,d.node,s,r,o,i,u),this.processChildNodes(d.node,n,r,s,a,c),y))):(s[p]=f,this.keepIntermediateTensors&&(this.clonedTensorsMap[p]=this.cloneTensorList(f)),this.checkTensorForDisposal(p,d.node,s,r,o,i,u),this.processChildNodes(d.node,n,r,s,a,c))}else this.processChildNodes(d.node,n,r,s,a,c)}return l}processChildNodes(e,n,r,s,a,o){e.children.forEach(i=>{const[u]=Vs(i.name,r);a[u]||!o.has(i.name)||(i.op==="Merge"?i.inputNames.some(c=>!!Gt(c,s,r))&&(a[u]=!0,n.push({contexts:r.currentContext,node:i})):i.inputNames.every(c=>!!Gt(c,s,r))&&(a[u]=!0,n.push({contexts:r.currentContext,node:i})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(n=>n.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(n=>{const r=e[n],[s]=Vn(n),a=this.graph.nodes[s];if(a.attrParams.shape&&a.attrParams.shape.value){const o=a.attrParams.shape.value,i=o.length===r.shape.length&&r.shape.every((u,c)=>o[c]===-1||o[c]===u);E(i,()=>`The shape of dict['${a.name}'] provided in model.execute(dict) must be [${o}], but was [${r.shape}]`)}a.attrParams.dtype&&a.attrParams.dtype.value&&E(r.dtype===a.attrParams.dtype.value,()=>`The dtype of dict['${a.name}'] provided in model.execute(dict) must be ${a.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(e){var n,r;const s={};for(const a in e){const o=(r=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||r===void 0?void 0:r[a];o!=null?s[o.name]=e[a]:s[a]=e[a]}return s}checkInputs(e){const n=Object.keys(e).filter(r=>{const[s]=Vn(r);return this.graph.nodes[s]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(e){return e.map(n=>{var r,s;const a=(s=(r=this._signature)===null||r===void 0?void 0:r.outputs)===null||s===void 0?void 0:s[n];return a!=null?a.name:n},{})}checkOutputs(e){e.forEach(n=>{const[r]=Vn(n);if(!this.graph.nodes[r])throw new Error(`The output '${n}' is not found in the graph`)})}}class sj{constructor(e={},n={}){this.hashTableNameToHandle=e,this.hashTableMap=n}addHashTable(e,n){this.hashTableNameToHandle[e]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aj="?tfjs-format=file",oj="model.json";class ij{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,n={},r=iN){this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=r,n==null&&(this.loadOptions={}),this.resourceManager=new sj}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const n=this.io.getLoadHandlers(e,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[e]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return Wo(e)?e.then(n=>n.getWeightStream==null?this.loadSync(n):this.loadStreaming(n)):this.loadSync(e)}loadSync(e){const n=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,n)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const n=await X$(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,n)}loadWithWeightMap(e,n){this.artifacts=e;const r=this.artifacts.modelTopology;let s=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const a=this.artifacts.userDefinedMetadata;a.signature!=null&&(s=a.signature),a.structuredOutputKeys!=null&&(this.structuredOutputKeys=a.structuredOutputKeys)}if(this.signature=s,this.version=`${r.versions.producer}.${r.versions.minConsumer}`,this.executor=new Up(Gb.Instance.transformGraph(r,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const a=Gb.Instance.transformGraph(e.modelInitializer);this.initializer=new Up(a),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,n){if(typeof e=="string"){const r=this.io.getSaveHandlers(e);if(r.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(r.length>1)throw new Error(`Found more than one (${r.length}) save handlers for URL '${e}'`);e=r[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const n=e instanceof Rt?[e]:e,r={};return n.forEach((s,a)=>r[this.structuredOutputKeys[a]]=s),r}return e}predict(e,n){const r=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(r)}async predictAsync(e,n){const r=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(r)}normalizeInputs(e){var n;if(!(e instanceof Rt)&&!Array.isArray(e)){const a=(n=this.signature)===null||n===void 0?void 0:n.inputs;if(a!=null)for(const o in a){const i=a[o];i.resourceId!=null&&(e[o]=this.resourceIdToCapturedInput[i.resourceId])}return e}e=Array.isArray(e)?e:[e];const r=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+r!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-r} non-resource placeholders, while there are ${e.length} input tensors provided.`);let s=0;return this.inputNodes.reduce((a,o)=>{var i,u,c;const l=(c=(u=(i=this.signature)===null||i===void 0?void 0:i.inputs)===null||u===void 0?void 0:u[o])===null||c===void 0?void 0:c.resourceId;return l!=null?a[o]=this.resourceIdToCapturedInput[l]:a[o]=e[s++],a},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=this.initializerSignature.outputs,r=Object.keys(n);for(let s=0;s<r.length;s++){const a=r[s],o=n[a];this.resourceIdToCapturedInput[o.resourceId]=e[s]}}}execute(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=this.executor.execute(e,n);return r.length>1?r:r[0]}async executeAsync(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=await this.executor.executeAsync(e,n);return r.length>1?r:r[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((n,r)=>(n[r]=[e[r]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&ht(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function Qb(t,e={},n=iN){if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof t=="string"&&(t=uj(t));const r=new ij(t,e,n);return await r.load(),r}function uj(t){return t.endsWith("/")||(t=t+"/"),`${t}${oj}${aj}`}/**
    * @license
    * Copyright 2023 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */var mn=function(){return mn=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t},mn.apply(this,arguments)};function ss(t,e,n,r){return new(n||(n=Promise))(function(s,a){function o(c){try{u(r.next(c))}catch(l){a(l)}}function i(c){try{u(r.throw(c))}catch(l){a(l)}}function u(c){var l;c.done?s(c.value):(l=c.value,l instanceof n?l:new n(function(d){d(l)})).then(o,i)}u((r=r.apply(t,[])).next())})}function as(t,e){var n,r,s,a,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function i(u){return function(c){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(o=0)),o;)try{if(n=1,r&&(s=2&l[0]?r.return:l[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,l[1])).done)return s;switch(r=0,s&&(l=[2&l[0],s.value]),l[0]){case 0:case 1:s=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,r=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(s=o.trys,!((s=s.length>0&&s[s.length-1])||l[0]!==6&&l[0]!==2)){o=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){o.label=l[1];break}if(l[0]===6&&o.label<s[1]){o.label=s[1],s=l;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(l);break}s[2]&&o.ops.pop(),o.trys.pop();continue}l=e.call(t,o)}catch(d){l=[6,d],r=0}finally{n=s=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([u,c])}}}var Gp=["wrist","thumb_cmc","thumb_mcp","thumb_ip","thumb_tip","index_finger_mcp","index_finger_pip","index_finger_dip","index_finger_tip","middle_finger_mcp","middle_finger_pip","middle_finger_dip","middle_finger_tip","ring_finger_mcp","ring_finger_pip","ring_finger_dip","ring_finger_tip","pinky_finger_mcp","pinky_finger_pip","pinky_finger_dip","pinky_finger_tip"],Pm={runtime:"mediapipe",maxHands:2,modelType:"full"},lj=function(){function t(e){var n,r=this;this.width=0,this.height=0,this.selfieMode=!1,this.handsSolution=new cF({locateFile:function(s,a){return e.solutionPath?e.solutionPath.replace(/\/+$/,"")+"/"+s:a+"/"+s}}),e.modelType==="lite"?n=0:n=1,this.handsSolution.setOptions({modelComplexity:n,selfieMode:this.selfieMode,maxNumHands:e.maxHands}),this.handsSolution.onResults(function(s){if(r.height=s.image.height,r.width=s.image.width,r.hands=[],s.multiHandLandmarks!==null)for(var a=s.multiHandedness,o=s.multiHandLandmarks,i=s.multiHandWorldLandmarks,u=0;u<a.length;u++)r.hands.push(mn(mn({},r.translateOutput(o[u],i[u])),{score:a[u].score,handedness:a[u].label}))})}return t.prototype.translateOutput=function(e,n){var r=this;return{keypoints:e.map(function(s,a){return{x:s.x*r.width,y:s.y*r.height,score:s.visibility,name:Gp[a]}}),keypoints3D:n.map(function(s,a){return{x:s.x,y:s.y,z:s.z,score:s.visibility,name:Gp[a]}})}},t.prototype.estimateHands=function(e,n){return ss(this,void 0,void 0,function(){var r,s;return as(this,function(a){switch(a.label){case 0:return n&&n.flipHorizontal&&n.flipHorizontal!==this.selfieMode&&(this.selfieMode=n.flipHorizontal,this.handsSolution.setOptions({selfieMode:this.selfieMode})),e instanceof Rt?(s=ImageData.bind,[4,mG(e)]):[3,2];case 1:return r=new(s.apply(ImageData,[void 0,a.sent(),e.shape[1],e.shape[0]])),[3,3];case 2:r=e,a.label=3;case 3:return e=r,[4,this.handsSolution.send({image:e})];case 4:return a.sent(),[2,this.hands]}})})},t.prototype.dispose=function(){this.handsSolution.close()},t.prototype.reset=function(){this.handsSolution.reset(),this.width=0,this.height=0,this.hands=null,this.selfieMode=!1},t.prototype.initialize=function(){return this.handsSolution.initialize()},t}();function cj(t){return ss(this,void 0,void 0,function(){var e,n;return as(this,function(r){switch(r.label){case 0:return e=function(s){if(s==null)return mn({},Pm);var a=mn({},s);return a.runtime="mediapipe",a.maxHands==null&&(a.maxHands=Pm.maxHands),a.modelType==null&&(a.modelType=Pm.modelType),a}(t),[4,(n=new lj(e)).initialize()];case 1:return r.sent(),[2,n]}})})}function Fm(t){return t.width*t.height}function Zb(t){var e=t.xCenter-t.width/2,n=e+t.width,r=t.yCenter-t.height/2;return{xMin:e,xMax:n,yMin:r,yMax:r+t.height,width:t.width,height:t.height}}function dj(t,e){var n=Zb(t),r=Zb(e);if(!function(o,i){return!(o.xMax<i.xMin||i.xMax<o.xMin||o.yMax<i.yMin||i.yMax<o.yMin)}(n,r))return 0;var s=Fm(function(o,i){var u=Math.max(o.xMin,i.xMin),c=Math.min(o.xMax,i.xMax),l=Math.max(o.yMin,i.yMin),d=Math.min(o.yMax,i.yMax);return{xMin:u,xMax:c,yMin:l,yMax:d,width:Math.max(c-u,0),height:Math.max(d-l,0)}}(n,r)),a=Fm(n)+Fm(r)-s;return a>0?s/a:0}function pj(t,e,n,r){var s=t.width,a=t.height,o=1,i=Math.cos(t.rotation),u=Math.sin(t.rotation),c=t.xCenter,l=t.yCenter,d=1/e,p=1/n,f=new Array(16);return f[0]=s*i*o*d,f[1]=-a*u*d,f[2]=0,f[3]=(-.5*s*i*o+.5*a*u+c)*d,f[4]=s*u*o*p,f[5]=a*i*p,f[6]=0,f[7]=(-.5*a*i-.5*s*u*o+l)*p,f[8]=0,f[9]=0,f[10]=s*d,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,function(h){if(h.length!==16)throw new Error("Array length must be 16 but got "+h.length);return[[h[0],h[1],h[2],h[3]],[h[4],h[5],h[6],h[7]],[h[8],h[9],h[10],h[11]],[h[12],h[13],h[14],h[15]]]}(f)}function BN(t){return t instanceof Rt?{height:t.shape[0],width:t.shape[1]}:{height:t.height,width:t.width}}function Hp(t){return t-2*Math.PI*Math.floor((t+Math.PI)/(2*Math.PI))}function VN(t){return t instanceof Rt?t:gG(t)}function Lm(t,e){E(t.width!==0,function(){return e+" width cannot be 0."}),E(t.height!==0,function(){return e+" height cannot be 0."})}function fj(t,e){var n=function(r,s,a,o){var i=s-r,u=o-a,c=u/i;return{scale:c,offset:a-r*c}}(0,255,e[0],e[1]);return De(function(){return be(ae(t,n.scale),n.offset)})}function Jb(t,e,n){var r=e.outputTensorSize,s=e.keepAspectRatio,a=e.borderMode,o=e.outputTensorFloatRange,i=BN(t),u=function(p,f){return f?{xCenter:f.xCenter*p.width,yCenter:f.yCenter*p.height,width:f.width*p.width,height:f.height*p.height,rotation:f.rotation}:{xCenter:.5*p.width,yCenter:.5*p.height,width:p.width,height:p.height,rotation:0}}(i,n),c=function(p,f,h){if(h===void 0&&(h=!1),!h)return{top:0,left:0,right:0,bottom:0};var y=f.height,x=f.width;Lm(f,"targetSize"),Lm(p,"roi");var g,v,w=y/x,S=p.height/p.width,$=0,k=0;return w>S?(g=p.width,v=p.width*w,k=(1-S/w)/2):(g=p.height/w,v=p.height,$=(1-w/S)/2),p.width=g,p.height=v,{top:k,left:$,right:$,bottom:k}}(u,r,s),l=pj(u,i.width,i.height),d=De(function(){var p=VN(t),f=Po(function(x,g,v){return Lm(v,"inputResolution"),[1/v.width*x[0][0]*g.width,1/v.height*x[0][1]*g.width,x[0][3]*g.width,1/v.width*x[1][0]*g.height,1/v.height*x[1][1]*g.height,x[1][3]*g.height,0,0]}(l,i,r),[1,8]),h=a==="zero"?"constant":"nearest",y=Lh.transform(ws(gt(p,"float32")),f,"bilinear",h,0,[r.height,r.width]);return o!=null?fj(y,o):y});return{imageTensor:d,padding:c,transformationMatrix:l}}function eS(t,e,n,r){return r===1?.5*(t+e):t+(e-t)*n/(r-1)}function tS(t){return{xCenter:t.xMin+t.width/2,yCenter:t.yMin+t.height/2,width:t.width,height:t.height}}function hj(t){var e=t.relativeKeypoints;if(e.length<=1)throw new Error("2 or more keypoints required to calculate a rect.");var n=Number.MAX_VALUE,r=Number.MAX_VALUE,s=Number.MIN_VALUE,a=Number.MIN_VALUE;return e.forEach(function(o){n=Math.min(n,o.x),s=Math.max(s,o.x),r=Math.min(r,o.y),a=Math.max(a,o.y)}),{xCenter:(n+s)/2,yCenter:(r+a)/2,width:s-n,height:a-r}}function mj(t,e,n,r,s){var a=n==="rect"?function(o,i,u){var c,l=o.locationData;return c=tS(l.boundingBox),c}(t):function(o,i){var u=o.locationData;return i==="boundingbox"?tS(u.relativeBoundingBox):hj(u)}(t,e);return s&&(a.rotation=function(o,i,u){var c,l=o.locationData,d=u.rotationVectorStartKeypointIndex,p=u.rotationVectorEndKeypointIndex;c=u.rotationVectorTargetAngle?u.rotationVectorTargetAngle:Math.PI*u.rotationVectorTargetAngleDegree/180;var f=l.relativeKeypoints[d].x*i.width,h=l.relativeKeypoints[d].y*i.height,y=l.relativeKeypoints[p].x*i.width,x=l.relativeKeypoints[p].y*i.height;return Hp(c-Math.atan2(-(x-h),y-f))}(t,r,s)),a}function gj(t){return De(function(){var e=function(s){return De(function(){return[Re(s,[0,0,0],[1,-1,1]),Re(s,[0,0,1],[1,-1,-1])]})}(t),n=e[0],r=e[1];return{boxes:Wt(r),logits:Wt(n)}})}function yj(t,e,n,r){return ss(this,void 0,void 0,function(){var s,a,o,i,u;return as(this,function(c){switch(c.label){case 0:return t.sort(function(l,d){return Math.max.apply(Math,d.score)-Math.max.apply(Math,l.score)}),s=Po(t.map(function(l){return[l.locationData.relativeBoundingBox.yMin,l.locationData.relativeBoundingBox.xMin,l.locationData.relativeBoundingBox.yMax,l.locationData.relativeBoundingBox.xMax]})),a=nn(t.map(function(l){return l.score[0]})),[4,Lh.nonMaxSuppressionAsync(s,a,e,n)];case 1:return[4,(o=c.sent()).array()];case 2:return i=c.sent(),u=t.filter(function(l,d){return i.indexOf(d)>-1}),ht([s,a,o]),[2,u]}})})}function xj(t,e){return t.map(function(n){var r=mn(mn({},n),{x:n.x*e.width,y:n.y*e.height});return n.z!=null&&(r.z=n.z*e.width),r})}function vj(t,e,n){return ss(this,void 0,void 0,function(){var r,s,a,o,i;return as(this,function(u){switch(u.label){case 0:return r=t[0],s=t[1],a=function(c,l,d){return De(function(){var p,f,h,y;d.reverseOutputOrder?(f=Wt(Re(c,[0,d.boxCoordOffset+0],[-1,1])),p=Wt(Re(c,[0,d.boxCoordOffset+1],[-1,1])),y=Wt(Re(c,[0,d.boxCoordOffset+2],[-1,1])),h=Wt(Re(c,[0,d.boxCoordOffset+3],[-1,1]))):(p=Wt(Re(c,[0,d.boxCoordOffset+0],[-1,1])),f=Wt(Re(c,[0,d.boxCoordOffset+1],[-1,1])),h=Wt(Re(c,[0,d.boxCoordOffset+2],[-1,1])),y=Wt(Re(c,[0,d.boxCoordOffset+3],[-1,1]))),f=be(ae(Fe(f,d.xScale),l.w),l.x),p=be(ae(Fe(p,d.yScale),l.h),l.y),d.applyExponentialOnBoxSize?(h=ae(ea(Fe(h,d.hScale)),l.h),y=ae(ea(Fe(y,d.wScale)),l.w)):(h=ae(Fe(h,d.hScale),l.h),y=ae(Fe(y,d.wScale),l.h));var x=Ae(p,Fe(h,2)),g=Ae(f,Fe(y,2)),v=be(p,Fe(h,2)),w=be(f,Fe(y,2)),S=Kt([X(x,[d.numBoxes,1]),X(g,[d.numBoxes,1]),X(v,[d.numBoxes,1]),X(w,[d.numBoxes,1])],1);if(d.numKeypoints)for(var $=0;$<d.numKeypoints;++$){var k=d.keypointCoordOffset+$*d.numValuesPerKeypoint,T=void 0,A=void 0;d.reverseOutputOrder?(T=Wt(Re(c,[0,k],[-1,1])),A=Wt(Re(c,[0,k+1],[-1,1]))):(A=Wt(Re(c,[0,k],[-1,1])),T=Wt(Re(c,[0,k+1],[-1,1])));var B=be(ae(Fe(T,d.xScale),l.w),l.x),L=be(ae(Fe(A,d.yScale),l.h),l.y);S=Kt([S,X(B,[d.numBoxes,1]),X(L,[d.numBoxes,1])],1)}return S})}(s,e,n),o=De(function(){var c=r;return n.sigmoidScore?(n.scoreClippingThresh!=null&&(c=c_(r,-n.scoreClippingThresh,n.scoreClippingThresh)),c=Do(c)):c}),[4,wj(a,o,n)];case 1:return i=u.sent(),ht([a,o]),[2,i]}})})}function wj(t,e,n){return ss(this,void 0,void 0,function(){var r,s,a,o,i,u,c,l,d,p,f,h;return as(this,function(y){switch(y.label){case 0:return r=[],[4,t.data()];case 1:return s=y.sent(),[4,e.data()];case 2:for(a=y.sent(),o=0;o<n.numBoxes;++o)if(!(n.minScoreThresh!=null&&a[o]<n.minScoreThresh||(i=o*n.numCoords,u=bj(s[i+0],s[i+1],s[i+2],s[i+3],a[o],n.flipVertically,o),(c=u.locationData.relativeBoundingBox).width<0||c.height<0))){if(n.numKeypoints>0)for((l=u.locationData).relativeKeypoints=[],d=n.numKeypoints*n.numValuesPerKeypoint,p=0;p<d;p+=n.numValuesPerKeypoint)f=i+n.keypointCoordOffset+p,h={x:s[f+0],y:n.flipVertically?1-s[f+1]:s[f+1]},l.relativeKeypoints.push(h);r.push(u)}return[2,r]}})})}function bj(t,e,n,r,s,a,o){return{score:[s],ind:o,locationData:{relativeBoundingBox:{xMin:e,yMin:a?1-n:t,xMax:r,yMax:a?1-t:n,width:r-e,height:n-t}}}}function Sj(t,e){return t==="none"?e:function(n){return 1/(1+Math.exp(-n))}(e)}function nS(t,e,n,r){return ss(this,void 0,void 0,function(){var s,a,o,i,u,c,l,d;return as(this,function(p){switch(p.label){case 0:return n=n||e.flipHorizontally||!1,r=r||e.flipVertically||!1,s=t.size,a=s/e.numLandmarks,[4,t.data()];case 1:for(o=p.sent(),i=[],u=0;u<e.numLandmarks;++u)c=u*a,(d={x:0,y:0}).x=n?e.inputImageWidth-o[c]:o[c],a>1&&(d.y=r?e.inputImageHeight-o[c+1]:o[c+1]),a>2&&(d.z=o[c+2]),a>3&&(d.score=Sj(e.visibilityActivation,o[c+3])),i.push(d);for(l=0;l<i.length;++l)(d=i[l]).x=d.x/e.inputImageWidth,d.y=d.y/e.inputImageHeight,d.z=d.z/e.inputImageWidth/(e.normalizeZ||1);return[2,i]}})})}function rS(t,e,n){var r=t.width,s=t.height,a=t.rotation;if(n.rotation==null&&n.rotationDegree==null||(a=function(l,d){return d.rotation!=null?l+=d.rotation:d.rotationDegree!=null&&(l+=Math.PI*d.rotationDegree/180),Hp(l)}(a,n)),a===0)t.xCenter=t.xCenter+r*n.shiftX,t.yCenter=t.yCenter+s*n.shiftY;else{var o=(e.width*r*n.shiftX*Math.cos(a)-e.height*s*n.shiftY*Math.sin(a))/e.width,i=(e.width*r*n.shiftX*Math.sin(a)+e.height*s*n.shiftY*Math.cos(a))/e.height;t.xCenter=t.xCenter+o,t.yCenter=t.yCenter+i}if(n.squareLong){var u=Math.max(r*e.width,s*e.height);r=u/e.width,s=u/e.height}else if(n.squareShort){var c=Math.min(r*e.width,s*e.height);r=c/e.width,s=c/e.height}return t.width=r*n.scaleX,t.height=s*n.scaleY,t}function Cj(t,e){for(var n=function(z,Y){var Q=z[0].x*Y.width,re=z[0].y*Y.height,Z=(z[4].x+z[8].x)/2,de=(z[4].y+z[8].y)/2;return Z=(Z+z[6].x)/2*Y.width,de=(de+z[6].y)/2*Y.height,Hp(Math.PI/2-Math.atan2(-(de-re),Z-Q))}(t,e),r=Hp(-n),s=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,u=0,c=t;u<c.length;u++){var l=(x=c[u]).x,d=x.y;s=Math.min(s,l),a=Math.max(a,l),o=Math.min(o,d),i=Math.max(i,d)}var p=(a+s)/2,f=(i+o)/2;s=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;for(var h=0,y=t;h<y.length;h++){var x,g=((x=y[h]).x-p)*e.width,v=(x.y-f)*e.height,w=g*Math.cos(r)-v*Math.sin(r),S=g*Math.sin(r)+v*Math.cos(r);s=Math.min(s,w),a=Math.max(a,w),o=Math.min(o,S),i=Math.max(i,S)}var $=(a+s)/2,k=(i+o)/2,T=$*Math.cos(n)-k*Math.sin(n)+e.width*p,A=$*Math.sin(n)+k*Math.cos(n)+e.height*f,B=(a-s)/e.width,L=(i-o)/e.height;return{xCenter:T/e.width,yCenter:A/e.height,width:B,height:L,rotation:n}}var Ij={reduceBoxesInLowestLayer:!1,interpolatedScaleAspectRatio:1,featureMapHeight:[],featureMapWidth:[],numLayers:4,minScale:.1484375,maxScale:.75,inputSizeHeight:192,inputSizeWidth:192,anchorOffsetX:.5,anchorOffsetY:.5,strides:[8,16,16,16],aspectRatios:[1],fixedAnchorSize:!0},Mm={runtime:"tfjs",modelType:"full",maxHands:2,detectorModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/handpose_3d/detector/full/1",landmarkModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/handpose_3d/landmark/full/1"},Bm={flipHorizontal:!1,staticImageMode:!1},$j={applyExponentialOnBoxSize:!1,flipVertically:!1,ignoreClasses:[],numClasses:1,numBoxes:2016,numCoords:18,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:7,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:192,yScale:192,hScale:192,wScale:192,minScoreThresh:.5},_j=.3,Nj={shiftX:0,shiftY:-.5,scaleX:2.6,scaleY:2.6,squareLong:!0},kj={shiftX:0,shiftY:-.1,scaleX:2,scaleY:2,squareLong:!0},Ej={outputTensorSize:{width:192,height:192},keepAspectRatio:!0,outputTensorFloatRange:[0,1],borderMode:"zero"},Tj={outputTensorSize:{width:224,height:224},keepAspectRatio:!0,outputTensorFloatRange:[0,1],borderMode:"zero"},Rj={numLandmarks:21,inputImageWidth:224,inputImageHeight:224,normalizeZ:.4,visibilityActivation:"none",flipHorizontally:!1,flipVertically:!1},Aj={numLandmarks:21,inputImageWidth:1,inputImageHeight:1,visibilityActivation:"none",flipHorizontally:!1,flipVertically:!1},jp,Oj=function(){function t(e,n,r){this.detectorModel=e,this.landmarkModel=n,this.maxHands=r,this.prevHandRectsFromLandmarks=null,this.anchors=function(u){u.reduceBoxesInLowestLayer==null&&(u.reduceBoxesInLowestLayer=!1),u.interpolatedScaleAspectRatio==null&&(u.interpolatedScaleAspectRatio=1),u.fixedAnchorSize==null&&(u.fixedAnchorSize=!1);for(var c=[],l=0;l<u.numLayers;){for(var d=[],p=[],f=[],h=[],y=l;y<u.strides.length&&u.strides[y]===u.strides[l];){var x=eS(u.minScale,u.maxScale,y,u.strides.length);if(y===0&&u.reduceBoxesInLowestLayer)f.push(1),f.push(2),f.push(.5),h.push(.1),h.push(x),h.push(x);else{for(var g=0;g<u.aspectRatios.length;++g)f.push(u.aspectRatios[g]),h.push(x);if(u.interpolatedScaleAspectRatio>0){var v=y===u.strides.length-1?1:eS(u.minScale,u.maxScale,y+1,u.strides.length);h.push(Math.sqrt(x*v)),f.push(u.interpolatedScaleAspectRatio)}}y++}for(var w=0;w<f.length;++w){var S=Math.sqrt(f[w]);d.push(h[w]/S),p.push(h[w]*S)}var $=0,k=0;if(u.featureMapHeight.length>0)$=u.featureMapHeight[l],k=u.featureMapWidth[l];else{var T=u.strides[l];$=Math.ceil(u.inputSizeHeight/T),k=Math.ceil(u.inputSizeWidth/T)}for(var A=0;A<$;++A)for(var B=0;B<k;++B)for(var L=0;L<d.length;++L){var z={xCenter:(B+u.anchorOffsetX)/k,yCenter:(A+u.anchorOffsetY)/$,width:0,height:0};u.fixedAnchorSize?(z.width=1,z.height=1):(z.width=p[L],z.height=d[L]),c.push(z)}l=y}return c}(Ij);var s=nn(this.anchors.map(function(u){return u.width})),a=nn(this.anchors.map(function(u){return u.height})),o=nn(this.anchors.map(function(u){return u.xCenter})),i=nn(this.anchors.map(function(u){return u.yCenter}));this.anchorTensor={x:o,y:i,w:s,h:a}}return t.prototype.estimateHands=function(e,n){return ss(this,void 0,void 0,function(){var r,s,a,o,i,u,c,l,d,p,f,h,y,x,g,v,w,S,$=this;return as(this,function(k){switch(k.label){case 0:return r=function(B){if(B==null)return mn({},Bm);var L=mn({},B);return L.flipHorizontal==null&&(L.flipHorizontal=Bm.flipHorizontal),L.staticImageMode==null&&(L.staticImageMode=Bm.staticImageMode),L}(n),e==null?(this.reset(),[2,[]]):(s=BN(e),a=De(function(){var B=gt(VN(e),"float32");return r.flipHorizontal&&(B=Wt(Lh.flipLeftRight(ws(B,0)),[0])),B}),o=this.prevHandRectsFromLandmarks,r.staticImageMode||o==null||o.length<this.maxHands?[4,this.detectPalm(a)]:[3,2]);case 1:return(u=k.sent()).length===0?(this.reset(),a.dispose(),[2,[]]):(c=u.map(function(B){return $.palmDetectionToRoi(B,s)}),i=c,[3,3]);case 2:i=o,k.label=3;case 3:return T=.5,A=[],[i].forEach(function(B){return B.forEach(function(L){(A=A.filter(function(z){return dj(L,z)<=T})).push(L)})}),i=A,[4,Promise.all(i.map(function(B){return $.handLandmarks(B,a)}))];case 4:for(l=k.sent(),d=[],this.prevHandRectsFromLandmarks=[],p=0,f=l;p<f.length;p++)(h=f[p])!=null&&(y=h.landmarks,x=h.worldLandmarks,g=h.handScore,v=h.handedness,this.prevHandRectsFromLandmarks.push(this.handLandmarksToRoi(y,s)),(w=xj(y,s))!=null&&w.forEach(function(B,L){delete B.z,B.name=Gp[L]}),(S=x)!=null&&S.forEach(function(B,L){B.name=Gp[L]}),d.push({keypoints:w,keypoints3D:S,handedness:v,score:g}));return a.dispose(),[2,d]}var T,A})})},t.prototype.dispose=function(){this.detectorModel.dispose(),this.landmarkModel.dispose(),ht([this.anchorTensor.x,this.anchorTensor.y,this.anchorTensor.w,this.anchorTensor.h])},t.prototype.reset=function(){this.prevHandRectsFromLandmarks=null},t.prototype.detectPalm=function(e){return ss(this,void 0,void 0,function(){var n,r,s,a,o,i,u,c,l,d;return as(this,function(p){switch(p.label){case 0:return n=Jb(e,Ej),r=n.imageTensor,s=n.padding,a=this.detectorModel.predict(r),o=gj(a),i=o.boxes,[4,vj([u=o.logits,i],this.anchorTensor,$j)];case 1:return(c=p.sent()).length===0?(ht([r,a,u,i]),[2,c]):[4,yj(c,this.maxHands,_j)];case 2:return l=p.sent(),d=function(f,h){f===void 0&&(f=[]);for(var y=h.left,x=h.top,g=h.left+h.right,v=h.top+h.bottom,w=0;w<f.length;w++){var S=f[w],$=S.locationData.relativeBoundingBox,k=($.xMin-y)/(1-g),T=($.yMin-x)/(1-v),A=$.width/(1-g),B=$.height/(1-v);$.xMin=k,$.yMin=T,$.width=A,$.height=B,$.xMax=k+A,$.yMax=T+B;var L=S.locationData.relativeKeypoints;L&&L.forEach(function(z){var Y=(z.x-y)/(1-g),Q=(z.y-x)/(1-v);z.x=Y,z.y=Q})}return f}(l,s),ht([r,a,u,i]),[2,d]}})})},t.prototype.palmDetectionToRoi=function(e,n){return rS(mj(e,"boundingbox","normRect",n,{rotationVectorStartKeypointIndex:0,rotationVectorEndKeypointIndex:2,rotationVectorTargetAngleDegree:90}),n,Nj)},t.prototype.handLandmarks=function(e,n){return ss(this,void 0,void 0,function(){var r,s,a,o,i,u,c,l,d,p,f,h,y,x,g,v;return as(this,function(w){switch(w.label){case 0:return r=Jb(n,Tj,e),s=r.imageTensor,a=r.padding,o=this.landmarkModel.execute(s,["Identity_2:0","Identity_1:0","Identity:0","Identity_3:0"]),i=o[0],u=o[1],c=o[2],l=o[3],[4,u.data()];case 1:return(d=w.sent()[0])<.5?(ht(o),ht(s),[2,null]):[4,c.data()];case 2:return p=w.sent()[0],f=p>=.5?"Left":"Right",[4,nS(i,Rj)];case 3:return h=w.sent(),[4,nS(l,Aj)];case 4:return y=w.sent(),x=function(S,$){var k=$.left,T=$.top,A=$.left+$.right,B=$.top+$.bottom;return S.map(function(L){return mn(mn({},L),{x:(L.x-k)/(1-A),y:(L.y-T)/(1-B),z:L.z/(1-A)})})}(h,a),g=function(S,$,k){k===void 0&&(k={ignoreRotation:!1});for(var T=[],A=0,B=S;A<B.length;A++){var L=B[A],z=L.x-.5,Y=L.y-.5,Q=k.ignoreRotation?0:$.rotation,re=Math.cos(Q)*z-Math.sin(Q)*Y,Z=Math.sin(Q)*z+Math.cos(Q)*Y;re=re*$.width+$.xCenter,Z=Z*$.height+$.yCenter;var de=L.z*$.width,ce=mn({},L);ce.x=re,ce.y=Z,ce.z=de,T.push(ce)}return T}(x,e),v=function(S,$){for(var k=[],T=0,A=S;T<A.length;T++){var B=A[T],L=B.x,z=B.y,Y=$.rotation,Q=Math.cos(Y)*L-Math.sin(Y)*z,re=Math.sin(Y)*L+Math.cos(Y)*z,Z=mn({},B);Z.x=Q,Z.y=re,k.push(Z)}return k}(y,e),ht(o),ht(s),[2,{landmarks:g,worldLandmarks:v,handScore:d,handedness:f}]}})})},t.prototype.handLandmarksToRoi=function(e,n){return rS(Cj([].concat(e.slice(0,4),e.slice(5,7),e.slice(9,11),e.slice(13,15),e.slice(17,19)),n),n,kj)},t}();function Dj(t){return ss(this,void 0,void 0,function(){var e,n,r,s,a,o;return as(this,function(i){switch(i.label){case 0:return e=function(u){if(u==null)return mn({},Mm);var c=mn({},u);if(c.runtime="tfjs",c.maxHands==null&&(c.maxHands=Mm.maxHands),c.modelType==null&&(c.modelType=Mm.modelType),c.modelType!=="lite"&&c.modelType!=="full")throw new Error("Model type must be one of lite or full, but got "+c.modelType);return c.detectorModelUrl==null&&(c.modelType==="lite"?c.detectorModelUrl="https://tfhub.dev/mediapipe/tfjs-model/handpose_3d/detector/lite/1":c.detectorModelUrl="https://tfhub.dev/mediapipe/tfjs-model/handpose_3d/detector/full/1"),c.landmarkModelUrl==null&&(c.modelType==="lite"?c.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/handpose_3d/landmark/lite/1":c.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/handpose_3d/landmark/full/1"),c}(t),n=e.detectorModelUrl.indexOf("https://tfhub.dev")>-1,r=e.landmarkModelUrl.indexOf("https://tfhub.dev")>-1,[4,Promise.all([Qb(e.detectorModelUrl,{fromTFHub:n}),Qb(e.landmarkModelUrl,{fromTFHub:r})])];case 1:return s=i.sent(),a=s[0],o=s[1],[2,new Oj(a,o,e.maxHands)]}})})}function Pj(t,e){return ss(this,void 0,void 0,function(){var n,r;return as(this,function(s){if(t===jp.MediaPipeHands){if(r=void 0,(n=e)!=null){if(n.runtime==="tfjs")return[2,Dj(n)];if(n.runtime==="mediapipe")return[2,cj(n)];r=n.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' or 'mediapipe', but got "+r)}throw new Error(t+" is not a supported model name.")})})}(function(t){t.MediaPipeHands="MediaPipeHands"})(jp||(jp={}));async function Fj(){const t=jp.MediaPipeHands;return await Pj(t,{runtime:"mediapipe",solutionPath:"https://cdn.jsdelivr.net/npm/@mediapipe/hands",modelType:"full"})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ue;(function(t){t[t.float32=0]="float32",t[t.int32=1]="int32",t[t.bool=2]="bool",t[t.string=3]="string",t[t.complex64=4]="complex64"})(Ue||(Ue={}));var xc;(function(t){t[t.linear=0]="linear",t[t.relu=1]="relu",t[t.relu6=2]="relu6",t[t.prelu=3]="prelu",t[t.leakyrelu=4]="leakyrelu",t[t.sigmoid=5]="sigmoid",t[t.elu=6]="elu"})(xc||(xc={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let zN;function Lj(t){zN=t.wasm.cwrap(oc,null,["number","array","number","number","array","number","number","number","number","number","number","number","number"])}function Mj(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:a,bias:o,preluActivationWeights:i}=e;if(s.dtype!=="float32"||a.dtype!=="float32")throw new Error("_FusedMatMul for non non-float32 tensors not yet supported.");const{transposeA:u,transposeB:c,activation:l,leakyreluAlpha:d}=r,p=n.dataIdMap.get(s.dataId).id,f=n.dataIdMap.get(a.dataId).id;let h=0;if(o!=null){const A=n.dataIdMap.get(o.dataId);if(A.shape.length!==1)throw new Error(`_FusedMatMul only supports rank-1 bias but got rank ${A.shape.length}.`);h=A.id}const y=i==null?0:n.dataIdMap.get(i.dataId).id,x=xc[l];if(x==null)throw new Error(`${l} activation not yet supported for FusedConv2D in the wasm backend.`);const g=u?s.shape[2]:s.shape[1],v=c?a.shape[1]:a.shape[2],w=Le(s.shape.slice(0,-2),a.shape.slice(0,-2)),S=n.makeOutput([...w,g,v],s.dtype),$=n.dataIdMap.get(S.dataId).id,k=new Uint8Array(new Int32Array(s.shape).buffer),T=new Uint8Array(new Int32Array(a.shape).buffer);return zN(p,k,s.shape.length,f,T,a.shape.length,u,c,x,h,y,d||0,$),S}const Bj={kernelName:oc,backendName:"wasm",setupFunc:Lj,kernelFunc:Mj};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ze(t,e){let n;function r(a){n=a.wasm.cwrap(t,null,["number","number","number"])}function s(a){const{backend:o,inputs:{x:i}}=a,u=o.dataIdMap.get(i.dataId).id,c=o.makeOutput(i.shape,e||i.dtype),l=o.dataIdMap.get(c.dataId).id;return K(c.shape)===0||n(u,Ue[i.dtype],l),c}return{kernelName:t,backendName:"wasm",setupFunc:r,kernelFunc:s}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vj=ze(Y0);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zj=ze(Q0);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wj=ze(Z0);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tt(t,e,n){let r;function s(o){r=o.wasm.cwrap(t,null,["number","array","number","number","array","number","number","number"])}function a(o){const{backend:i,inputs:u}=o,{a:c,b:l}=u,d=i.dataIdMap.get(c.dataId).id,p=i.dataIdMap.get(l.dataId).id,f=n??c.dtype,h=Le(c.shape,l.shape),y=i.makeOutput(h,f);if(K(h)===0)return y;const x=new Uint8Array(new Int32Array(c.shape).buffer),g=new Uint8Array(new Int32Array(l.shape).buffer),v=i.dataIdMap.get(y.dataId).id;return r(d,x,c.shape.length,p,g,l.shape.length,Ue[c.dtype],v),y}return{kernelName:t,backendName:"wasm",setupFunc:s,kernelFunc:a}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uj=Tt($f);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let WN;function Gj(t){WN=t.wasm.cwrap(_f,null,["array","number","number","number"])}function Hj(t){const{inputs:e,backend:n}=t,r=n.makeOutput(e[0].shape,e[0].dtype);if(K(r.shape)===0)return r;const s=e.map(i=>n.dataIdMap.get(i.dataId).id),a=new Uint8Array(new Int32Array(s).buffer),o=n.dataIdMap.get(r.dataId).id;return WN(a,s.length,Ue[r.dtype],o),r}const jj={kernelName:_f,backendName:"wasm",setupFunc:Gj,kernelFunc:Hj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zh(t){const{inputs:{x:e},backend:n}=t;if(e.dtype==="string")return ns(n.readSync(e.dataId),e.shape,e.dtype);const r=n.makeOutput(e.shape,e.dtype),s=n.typedArrayFromHeap(e);return n.typedArrayFromHeap(r).set(s),r}const Kj={kernelName:Kf,backendName:"wasm",kernelFunc:zh};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let UN;function qj(t){UN=t.wasm.cwrap(au,null,["number","array","number","number","number","array","number"])}function Ka(t){const{inputs:e,backend:n,attrs:r}=t,[s,a]=Yj(e.x.shape,r.perm);let o=!0;for(let h=0;h<a.length;h++)a[h]!==h&&(o=!1);const i=Xj(e.x.shape,r.perm),u={dataId:e.x.dataId,shape:s,dtype:e.x.dtype};if(o){const h=zh({inputs:e,backend:n});return h.shape=i,h}const c=n.makeOutput(i,u.dtype),l=n.dataIdMap.get(u.dataId).id,d=n.dataIdMap.get(c.dataId).id,p=new Uint8Array(new Int32Array(a).buffer),f=new Uint8Array(new Int32Array(u.shape).buffer);return UN(l,f,u.shape.length,Ue[u.dtype],d,p,a.length),c}function Xj(t,e){const n=new Array(t.length);for(let r=0;r<n.length;r++)n[r]=t[e[r]];return n}function Yj(t,e){const n=[],r=[];for(let s=0;s<t.length;++s)t[s]!==1&&n.push(t[s]),t[e[s]]!==1&&r.push(e[s]);for(let s=0;s<r.length;++s){let a=-1;for(let o=0;o<r.length;++o)r[o]>=s&&(a===-1||r[a]>r[o])&&(a=o);r[a]=s}return[n,r]}const Qj={kernelName:au,backendName:"wasm",kernelFunc:Ka,setupFunc:qj};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function no(t,e,n){const r=t.shape,s=t.shape.length,a=vt(e,r);let o=a;const i=An(o,s);let u=null,c=!1;if(i!=null){const l=new Array(s);for(let f=0;f<l.length;f++)l[f]=r[i[f]];o=Xt(o.length,s),u=Ka({inputs:{x:t},attrs:{perm:i},backend:n});const d=n.dataIdMap.get(t.dataId).id;n.dataIdMap.get(u.dataId).id!==d&&(c=!0)}return{transposed:u,originalAxes:a,axes:o,inputWasTransposed:c}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let GN;function Zj(t){GN=t.wasm.cwrap(Nf,null,["number, number, number"])}function Jj(t){const{backend:e,inputs:n,attrs:r}=t,{axis:s,keepDims:a}=r,{x:o}=n;let u=e.dataIdMap.get(o.dataId).id,c=o;const{transposed:l,axes:d,originalAxes:p,inputWasTransposed:f}=no(o,s,e);if(f){const w=e.dataIdMap.get(l.dataId).id;c=l,u=w}const h=c.shape.length;Dt("all",d,h);const[y,x]=an(c.shape,d),g=K(x),v=e.makeOutput(y,o.dtype);if(K(c.shape)!==0){const w=e.dataIdMap.get(v.dataId).id;GN(u,g,w)}if(f&&e.disposeData(l.dataId),a){const w=Ot(v.shape,p);v.shape=w}return v}const e6={kernelName:Nf,backendName:"wasm",setupFunc:Zj,kernelFunc:Jj};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let HN;function t6(t){HN=t.wasm.cwrap(kf,null,["number, number, number"])}function n6(t){const{backend:e,inputs:n,attrs:r}=t,{axis:s,keepDims:a}=r,{x:o}=n;let u=e.dataIdMap.get(o.dataId).id,c=o;const{transposed:l,axes:d,originalAxes:p,inputWasTransposed:f}=no(o,s,e);if(f){const w=e.dataIdMap.get(l.dataId).id;c=l,u=w}const h=c.shape.length;Dt("any",d,h);const[y,x]=an(c.shape,d),g=K(x),v=e.makeOutput(y,o.dtype);if(K(c.shape)!==0){const w=e.dataIdMap.get(v.dataId).id;HN(u,g,w)}if(f&&e.disposeData(l.dataId),a){const w=Ot(v.shape,p);v.shape=w}return v}const r6={kernelName:kf,backendName:"wasm",setupFunc:t6,kernelFunc:n6};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jN(t){let e;function n(s){e=s.wasm.cwrap(t,null,["number","number","number","number","number"])}function r(s){const{backend:a,inputs:o,attrs:i}=s,{axis:u}=i,{x:c}=o,l=a.dataIdMap.get(c.dataId).id;let d=l,p=c;const{transposed:f,axes:h,inputWasTransposed:y}=no(c,u,a);if(y){const $=a.dataIdMap.get(f.dataId).id;$!==l&&(p=f,d=$)}const x=p.shape.slice(0,-1),g=a.makeOutput(x,"int32"),v=a.dataIdMap.get(g.dataId).id,w=K(g.shape),S=p.shape[h[0]];return e(d,Ue[p.dtype],w,S,v),y&&a.disposeData(f.dataId),g}return{kernelName:t,backendName:"wasm",setupFunc:n,kernelFunc:r}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s6=jN(J0);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a6=jN(ex);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o6=ze(tx);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i6=ze(nx);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u6=ze(rx);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l6=Tt(ax);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c6=ze(sx);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let KN;function d6(t){KN=t.wasm.cwrap(Ef,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function p6(t){const{inputs:e,attrs:n,backend:r}=t,s=e.x,a=r.dataIdMap.get(s.dataId).id,{filterSize:o,strides:i,pad:u,dimRoundingMode:c}=n,l=Mr(s.shape,o,i,1,u,c),d=l.filterHeight,p=l.filterWidth,f=l.padInfo.top,h=l.padInfo.right,y=l.padInfo.bottom,x=l.padInfo.left,g=l.strideHeight,v=l.strideWidth,w=l.inChannels;if(l.dataFormat!=="channelsLast")throw new Error(`wasm backend does not support dataFormat:'${l.dataFormat}'. Please use 'channelsLast'.`);if(l.dilationWidth!==1||l.dilationHeight!==1)throw new Error(`was backend only supports average pooling with dilation = [1, 1], got [${l.dilationHeight}, ${l.dilationWidth}].`);const S=r.makeOutput(l.outShape,"float32"),$=r.dataIdMap.get(S.dataId).id;return KN(a,s.shape[0],s.shape[1],s.shape[2],d,p,f,h,y,x,g,v,w,$),S}const f6={kernelName:Ef,backendName:"wasm",setupFunc:d6,kernelFunc:p6};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let qN;function h6(t){qN=t.wasm.cwrap("AvgPool3D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function m6(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:a,strides:o,pad:i,dimRoundingMode:u,dataFormat:c}=r,l=aa(s.shape,a,o,1,i,u,c),d=n.makeOutput(l.outShape,s.dtype);return qN(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(d.dataId).id,l.batchSize,l.inChannels,l.inDepth,l.inHeight,l.inWidth,l.outDepth,l.outHeight,l.outWidth,l.strideDepth,l.strideHeight,l.strideWidth,l.dilationDepth,l.dilationHeight,l.dilationWidth,l.effectiveFilterDepth,l.effectiveFilterHeight,l.effectiveFilterWidth,l.padInfo.front,l.padInfo.top,l.padInfo.left),d}const g6={kernelName:ox,backendName:"wasm",setupFunc:h6,kernelFunc:m6};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let XN;function y6(t){XN=t.wasm.cwrap("AvgPool3DGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function x6(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:a}=e,{filterSize:o,strides:i,pad:u,dimRoundingMode:c}=r,l=aa(a.shape,o,i,1,u,c),d=n.makeOutput(a.shape,a.dtype);return XN(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(d.dataId).id,l.batchSize,l.inChannels,l.inDepth,l.inHeight,l.inWidth,l.outDepth,l.outHeight,l.outWidth,l.strideDepth,l.strideHeight,l.strideWidth,l.dilationDepth,l.dilationHeight,l.dilationWidth,l.effectiveFilterDepth,l.effectiveFilterHeight,l.effectiveFilterWidth,l.padInfo.front,l.padInfo.top,l.padInfo.left,l.filterDepth,l.filterHeight,l.filterWidth),d}const v6={kernelName:s$,backendName:"wasm",setupFunc:y6,kernelFunc:x6};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let YN;function w6(t){YN=t.wasm.cwrap("AvgPoolGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function b6(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:a}=e,{filterSize:o,strides:i,pad:u}=r,c=Mr(a.shape,o,i,1,u),l=n.makeOutput(a.shape,a.dtype);return YN(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(l.dataId).id,c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.top,c.padInfo.left,c.filterHeight,c.filterWidth),l}const S6={kernelName:r$,backendName:"wasm",setupFunc:w6,kernelFunc:b6};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nn(t){const{inputs:e,attrs:n}=t,{x:r}=e,{shape:s}=n,a=K(r.shape),o=Z2(s,a);return E(a===K(o),()=>`new shape: ${o}, old shape: ${r.shape}. New shape and old shape must have the same number of elements.`),t.backend.incRef(r.dataId),{dataId:r.dataId,shape:o,dtype:r.dtype}}const C6={kernelName:nv,backendName:"wasm",kernelFunc:Nn};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let QN;function I6(t){QN=t.wasm.cwrap(Tf,null,["number","array","number","number","array","number","number","number","number"])}function $6(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:a}=e,{transposeA:o,transposeB:i}=r;if(s.dtype!=="float32"||a.dtype!=="float32")throw new Error("BatchMatMul for non non-float32 tensors not yet supported.");const u=s.shape.length,c=a.shape.length,l=o?s.shape[u-2]:s.shape[u-1],d=i?a.shape[c-1]:a.shape[c-2],p=o?s.shape[u-1]:s.shape[u-2],f=i?a.shape[c-2]:a.shape[c-1],h=s.shape.slice(0,-2),y=a.shape.slice(0,-2),x=K(h),g=K(y),w=Le(s.shape.slice(0,-2),a.shape.slice(0,-2)).concat([p,f]);E(l===d,()=>`Error in matMul: inner shapes (${l}) and (${d}) of Tensors with shapes ${s.shape} and ${a.shape} and transposeA=${o} and transposeB=${i} must match.`);const S=o?[x,l,p]:[x,p,l],$=i?[g,f,d]:[g,d,f],k=Nn({inputs:{x:s},backend:n,attrs:{shape:S}}),T=Nn({inputs:{x:a},backend:n,attrs:{shape:$}}),A=n.dataIdMap.get(k.dataId).id,B=n.dataIdMap.get(T.dataId).id,L=o?k.shape[2]:k.shape[1],z=i?T.shape[1]:T.shape[2],Y=Math.max(x,g),Q=n.makeOutput([Y,L,z],k.dtype),re=n.dataIdMap.get(Q.dataId).id,Z=new Uint8Array(new Int32Array(k.shape).buffer),de=new Uint8Array(new Int32Array(T.shape).buffer);return QN(A,Z,k.shape.length,B,de,T.shape.length,o,i,re),n.disposeData(k.dataId),n.disposeData(T.dataId),Q.shape=w,Q}const _6={kernelName:Tf,backendName:"wasm",setupFunc:I6,kernelFunc:$6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N6(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function On(t){return(e,n,r,s,a)=>{const o=Le(e,n),i=o.length,u=Ye(o),c=K(o),l=Ua(a,c),d=e.length,p=n.length,f=Ye(e),h=Ye(n),y=Lp(e,o),x=Lp(n,o);if(y.length+x.length===0)for(let g=0;g<l.length;++g)l[g]=t(r[g%r.length],s[g%s.length]);else for(let g=0;g<l.length;++g){const v=q0(g,i,u),w=v.slice(-d);y.forEach(T=>w[T]=0);const S=Qg(w,d,f),$=v.slice(-p);x.forEach(T=>$[T]=0);const k=Qg($,p,h);l[g]=t(r[S],s[k])}return[l,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k6(t,e,n,r){if(r==="int32"){const s=Int32Array.from(t);return[e,"int32",s]}if(r==="bool"){const s=_h([0],n),[a,o]=On((i,u)=>i!==u?1:0)(e,[],t,s,"bool");return[o,"bool",a]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E6=On((t,e)=>t+e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T6(t,e,n,r,s){const a=K(r),o=Ga(s,n);for(let i=0;i<t.length;i++){const u=t[i];if(u<0)throw new Error("Input x must be non-negative!");u>=s||(a>0?o[u]+=e[i]:o[u]+=1)}return o}function R6(t,e,n,r=!1){const s=t.shape[0],a=t.shape[1],o=xt([s,n],e.dtype);for(let i=0;i<s;i++)for(let u=0;u<a;u++){const c=t.get(i,u);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(r?o.set(1,i,c):e.size>0?o.set(o.get(i,c)+e.get(i,u),i,c):o.set(o.get(i,c)+1,i,c))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A6=On((t,e)=>t&e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ia(t){return(e,n,r)=>{const s=Vt(n,e.length);for(let a=0;a<e.length;++a)s[a]=t(e[a],r);return s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O6=ia(t=>Math.ceil(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZN(t,e,n,r){const s=Vt(n,K(e));if(r&&n!=="string"){let a=0;t.forEach(o=>{const i=K(o.shape);s.set(o.vals,a),a+=i})}else{let a=0;t.forEach(o=>{const i=n==="string"?Iu(o.vals):o.vals;let u=0;for(let c=0;c<o.shape[0];++c){const l=c*e[1]+a;for(let d=0;d<o.shape[1];++d)s[l+d]=i[u++]}a+=o.shape[1]})}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D6=On((t,e)=>t===e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P6=ia(t=>Math.exp(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F6=ia(t=>Math.expm1(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L6=ia(t=>Math.floor(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M6=On((t,e)=>Math.floor(t/e));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B6(t,e,n,r,s,a,o,i,u){const c=xt([r,a],n);for(let l=0;l<r;l++){const d=[];let p=0;for(let f=0;f<s;f++){const h=t[l*s+f];p+=h*o[f],d.push(h)}if(p<0||p>=u/a)throw new Error(`Invalid indices: ${d} does not index into ${i}`);for(let f=0;f<a;f++)c.values[l*a+f]=e.get(...e.indexToLoc(p*a+f))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V6(t,e,n){const r=xt(n,t.dtype);for(let s=0;s<r.size;++s){const o=r.indexToLoc(s).slice(),i=o[0],u=o[2],c=e.locToIndex([i,u]);o[2]=e.values[c];const l=t.locToIndex(o);0<=l&&l<t.values.length&&(r.values[s]=t.values[l])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z6=On((t,e)=>t>e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W6=On((t,e)=>t>=e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U6=On((t,e)=>t<e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G6=On((t,e)=>t<=e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H6(t,e,n){const r=(e-t)/(n-1),s=Ga(n,"float32");s[0]=t;for(let a=1;a<s.length;a++)s[a]=s[a-1]+r;return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j6=ia(t=>Math.log(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K6(t,e,n,r){const s=Ua(r,K(n));for(let a=0;a<s.length;++a){const o=a*e;let i=t[o];for(let u=0;u<e;++u){const c=t[o+u];(Number.isNaN(c)||c>i)&&(i=c)}s[a]=i}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q6=On((t,e)=>Math.max(t,e));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X6=On((t,e)=>Math.min(t,e));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JN=On((t,e)=>t*e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y6(t,e,n){const r=Du(-1,n);return JN([],e,r,t,n)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q6=On((t,e)=>t!==e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z6(t,e,n,r,s){const a=e.length,o=K(e),i=Ye(e),u=Ye(s),c=Ua(n,K(s));for(let l=0;l<o;++l){const d=q0(l,a,i),p=new Array(d.length);for(let h=0;h<p.length;h++)p[h]=d[r[h]];const f=Qg(p,a,u);c[f]=t[l]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J6(t,e,n,r){const[s,a]=an(t,r),o=Ts(e,"int32"),i=Ga(K(s),o),u=K(a);for(let c=0;c<i.length;++c){const l=c*u;let d=1;for(let p=0;p<u;++p)d*=n[l+p];i[c]=d}return{outVals:i,outShape:s,outDtype:o}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e8(t,e,n){t.forEach((r,s)=>{if(r<0||r>=n){const a=q0(s,e.length,Ye(e)).join(",");throw new Error(`indices[${a}] = ${r} is not in [0, ${n})`)}})}function t8(t,e){for(let n=0;n<t.length;++n){const r=t[n],s=n===t.length-1?e:t[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>s)throw new Error("Ragged splits must not point past values");for(let a=1;a<r.length;++a)if(r[a-1]>r[a])throw new Error("Ragged splits must be sorted in ascending order")}}function n8(t,e,n,r){const s=[];let a=0;const o=e.length-1+n.length,i=new Array(o).fill(null).map(()=>[0]);t8(n,r);let u=1;for(let c=0;c<e.length-1;++c){u*=e[c];const l=e[c+1];for(let d=1;d<u+1;++d)i[c].push(d*l)}for(let c=0;c<t.length;++c){let l=t[c],d=t[c]+1;for(let p=0;p<n.length;++p){const f=n[p],h=p+e.length-1;if(h>=0){const y=i[h],x=y[y.length-1]-f[l];for(let g=l;g<d;++g)i[h].push(f[g+1]+x)}l=f[l],d=f[d]}d!==l&&(s.push([l,d]),a+=d-l)}return{outSplits:i,valueSlices:s,numValues:a}}function r8(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n].length,s=Vt("int32",r);e.push(s),t[n].forEach((a,o)=>s[o]=a)}return e}function sS(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function s8(t,e,n,r,s,a){const o=sS(e,2)[1],i=sS(a,2)[1];let u=0;for(const c of n)for(let l=c[0];l<c[1];++l){for(let d=0;d<r;++d)s[u*i+d]=t[l*o+d];++u}}function a8(t,e,n,r,s){const a=e.slice();a[0]=s;const o=Vt(n,K(a)),i=t.length,u=i===0?0:i/e[0];return s8(t,e,r,u,o,a),[o,a]}function o8(t,e,n,r,s,a,o,i){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const u=e[0][0]-1;if(e8(a,o,u),r.length===0)throw new Error("params.rank must be nonzero");const c=r[0],{outSplits:l,valueSlices:d,numValues:p}=n8(a,o,t,c),f=r8(l),h=a8(n,r,s,d,p);return[f,h[0],h[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aS=2147483647;function i8(t,e,n,r,s,a,o){if(e.length>1)throw new Error("starts must be a scalar or vector");if(s.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const i=e.length===0,u=s.length===0,c=o.length===0,l=[];i||l.push(e[0]),u||l.push(s[0]),c||l.push(o[0]);for(let x=1;x<l.length;++x)if(l[x]!==l[x-1])throw new Error("starts, limits, and deltas must have the same shape");const d=l.length===0?1:l[0],p=Vt("int32",d+1);p[0]=0;for(let x=0;x<d;++x){const g=i?t[0]:t[x],v=u?r[0]:r[x],w=c?a[0]:a[x];if(w===0)throw new Error("Requires delta != 0");let S;if(w>0&&v<g||w<0&&v>g)S=0;else if(S=Math.ceil(Math.abs((v-g)/w)),S>aS)throw new Error(`Requires ((limit - start) / delta) <= ${aS}`);p[x+1]=p[x]+S}const f=p[d],h=Vt(n,f);let y=0;for(let x=0;x<d;++x){const g=p[x+1]-p[x];let v=i?t[0]:t[x];const w=c?a[0]:a[x];for(let S=0;S<g;++S)h[y++]=v,v+=w}return[p,h]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ir=Zr;class Kp{constructor(e,n,r,s,a,o,i,u,c,l){this.shape=e,this.shapeShape=n,this.values=r,this.valuesShape=s,this.valuesDType=a,this.defaultValue=o,this.defaultValueShape=i,this.rowPartitionValues=u,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=xN(l),this.raggedRank=vN(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Ir.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Ir.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Ir.VALUE_ROWIDS:return Kp.getMaxWidthValueRowID(n);case Ir.ROW_SPLITS:return Kp.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${Ir[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let r=0;for(let s=0;s<n-1;++s){const a=e[s+1]-e[s];a>r&&(r=a)}return r}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let r=0,s=e[0],a=0;for(let o=1;o<n;++o){const i=e[o];i!==s&&(s=i,a=Math.max(o-r,a),r=o)}return Math.max(n-r,a)}tensorShapeFromTensor(e,n,r=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return iS(e,r)}calculateOutputSize(e){const n=this.valuesShape,r=this.defaultValueShape;wN(r,n);const s=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=yN(this.raggedRank,s,n);o[0]<0&&(o[0]=e);for(let i=1;i<=this.raggedRank;++i)o[i]<0&&(o[i]=this.getMaxWidth(i));return o}calculateFirstParentOutputIndex(e,n,r){const s=Math.min(e,r),a=[];let o=0;for(let i=0;i<s;++i,o+=n)a.push(o);for(let i=s;i<e;++i)a.push(-1);return E(a.length===e,()=>"Final length of result must be equal to firstDimension."),a}calculateOutputIndexRowSplit(e,n,r,s){const a=e.length,o=[];for(let i=0;i<a-1;++i){const u=e[i+1]-e[i];let c=Math.min(s,u),l=n[i];l===-1&&(c=0);for(let d=0;d<c;++d)o.push(l),l+=r;for(let d=0;d<u-c;++d)o.push(-1)}if(a>0&&o.length!==e[a-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,n,r,s){const a=e.length,o=[];if(a===0)return[];let i=0,u=e[0];if(u>=n.length)throw new Error(`Got currentValueRowId=${u}, which is not less than ${n.length}`);let c=n[u];o.push(c);for(let l=1;l<a;++l){const d=e[l];if(d===u)c>=0&&(++i,i<s?c+=r:c=-1);else{if(i=0,u=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);c=n[d]}o.push(c)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,n,r,s){const a=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case Ir.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,n,r,s);case Ir.ROW_SPLITS:if(a.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${a.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(a,n,r,s);default:throw new Error(`Unsupported partition type: ${Ir[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case Ir.FIRST_DIM_SIZE:return e[0];case Ir.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Ir.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Ir[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),s=new Array(this.raggedRank+1);s[s.length-1]=1;for(let u=s.length-2;u>=0;--u)s[u]=s[u+1]*r[u+1];const a=iS(r,!1),o=Vt(this.valuesDType,K(a));if(s[0]*r[0]>0){let u=this.calculateFirstParentOutputIndex(n,s[0],r[0]);for(let c=1;c<=this.raggedRank;++c)u=this.calculateOutputIndex(c-1,u,s[c],r[c]);this.setOutput(this.raggedRank,u,o,a)}return[a,o]}setOutput(e,n,r,s){if(r.length===0)return;const a=this.values,o=r;let i=s.slice();i=i.slice(e+1);const u=K(i),c=n.length;let l=this.defaultValue;if(l.length!==u&&l.length!==1){const h=this.defaultValueShape;De(()=>{const y=X(l,h);l=Ll(y,i).dataSync()})}let d=0,p=0,f=0;for(let h=0;h<=c;++h){let y=h<c?n[h]:-1;if(y===f){++f;continue}if(p<f){const x=a.subarray(d*u),g=o.subarray(p*u),v=(f-p)*u;oS(g,x,v)}if(h>=c){const x=r.length;y=Math.floor(x/u)}if(y>f)if(this.defaultValue.length===1)o.subarray(f*u,y*u).fill(this.defaultValue[0]),f=y;else for(;y>f;){const x=o.slice(f*u);oS(x,l,u),++f}y<0?(d=h+1,p=f):(d=h,p=f,f=p+1)}}}function oS(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function iS(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function u8(t,e,n,r,s,a,o,i,u,c){return new Kp(t,e,n,r,s,a,o,i,u,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ek(t,e,n,r){const s=t===e,a=t<e&&n<0,o=e<t&&n>1;if(s||a||o)return Ga(0,r);const i=Math.abs(Math.ceil((e-t)/n)),u=Ga(i,r);e<t&&n===1&&(n=-1),u[0]=t;for(let c=1;c<u.length;c++)u[c]=u[c-1]+n;return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l8=ia(t=>1/Math.sqrt(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c8(t,e,n,r,s,a,o,i,u,c){const l=[r/s,s],d=t.values,p=e.values;if(r===0)return xt(n,e.dtype);const f=u instanceof Su?u:xt(l,e.dtype);typeof u=="string"||typeof u=="number"?f.values.fill(u):typeof u=="boolean"&&f.values.fill(+u);for(let h=0;h<a;h++){const y=[];let x=0;for(let g=0;g<o;g++){const v=d[h*o+g];y.push(v),x+=v*i[g]}if(x<0||x>=r/s)throw new Error(`Invalid indices: ${y} does not index into ${n}`);for(let g=0;g<s;g++)c?f.values[x*s+g]+=p[h*s+g]:f.values[x*s+g]=e.rank===0?p[0]:p[h*s+g]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d8=ia(t=>1/(1+Math.exp(-t)));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ey(t,e,n,r,s){const a=Mh(r,e,n),o=K(n),i=Ye(r);if(a){const d=Bh(e,i);return s==="string"?t.slice(d,d+o):t.subarray(d,d+o)}const u=s==="string"?Iu(t):t,c=xt(r,s,u),l=xt(n,s);for(let d=0;d<l.size;++d){const p=l.indexToLoc(d),f=p.map((h,y)=>h+e[y]);l.set(c.get(...f),...p)}return s==="string"?ww(l.values):l.values}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p8(t,e,n,r,s,a,o){const i=e[0],u=a[0],c=new Array(u),l=new Array(i),d=e[1];if(u===0){if(i!==0)throw new Error(uw(i));const x=Vt(n,0),g=Vt(s,0);return[x,[0,d],g,c,l]}let p=!0,f=0;const h=new Array(u).fill(0);for(let x=0;x<i;++x){const g=t[x*d];if(g<0)throw new Error(lw(x,g));if(g>=u)throw new Error(cw(x,g,u));++h[g],p=p&&g>=f,f=g}let y=!0;for(let x=0;x<u;++x){const g=h[x]===0;c[x]=g,y=y&&!g,h[x]=Math.max(h[x],1),x>0&&(h[x]+=h[x-1])}if(y&&p){const x=t,g=r;for(let v=0;v<i;++v)l[v]=v;return[x,[i,d],g,c,l]}else{const x=h[u-1],g=Vt(n,x*d),v=Vt(s,x),w=new Array(u).fill(0);for(let S=0;S<i;++S){const $=t[S*d],k=w[$],T=($===0?0:h[$-1])+k;w[$]++;for(let A=0;A<d;++A)g[T*d+A]=t[S*d+A];v[T]=r[S],l[S]=T}for(let S=0;S<u;++S)if(w[S]===0){const k=S===0?0:h[S-1];g[k*d+0]=S;for(let T=1;T<d;++T)g[k*d+T]=0;v[k]=o}return[g,[x,d],v,c,l]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f8(t,e,n,r,s){const a=K(r),o=e[0],i=s.length,u=[];let c=1,l=-1;for(let x=0;x<i;++x){const g=s[x];if(g===-1){if(l!==-1)throw new Error(dw(l,x));l=x,u.push(1)}else{if(g<0)throw new Error(pw(x,g));c*=g,u.push(g)}}if(l!==-1){if(c<=0)throw new Error(fw());const x=Math.trunc(a/c);if(c*x!==a)throw new Error(hw(r,u));u[l]=x}if(K(u)!==a)throw new Error(mw(r,u));const p=r.length,f=[];if(p>0){f[p-1]=1;for(let x=p-2;x>=0;--x)f[x]=f[x+1]*r[x+1]}const h=[];if(i>0){h[i-1]=1;for(let x=i-2;x>=0;--x)h[x]=h[x+1]*u[x+1]}const y=Vt(n,o*i);for(let x=0;x<o;++x){let g=0;for(let v=0;v<p;++v)g+=t[x*p+v]*f[v];for(let v=0;v<i;++v)y[x*i+v]=Math.trunc(g/h[v]),g%=h[v]}return[y,[o,i],u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h8(t,e,n,r,s,a=!1,o=0){const i=r.length,u=[e[0],t.length/e[0]],c=u[1],d=i>0?s[i-1]+1:0;if(d<0)throw new Error(yc());const p=e.slice();p[0]=d;const f=p.reduce((w,S)=>w*S,1),h=Vt(n,f);if(i===0)return d>0&&h.fill(o),[h,p];if(d<=0)throw new Error(yc());let y=0,x=1,g=0,v=s[y];for(;;){let w=0;if(x<i){if(w=s[x],v===w){++x;continue}if(v>=w)throw new Error(gw())}if(v<0||v>=d)throw new Error(yw(v,d));v>g&&h.fill(o,g*c,v*c);for(let S=y;S<x;++S){const $=r[S];if($<0||$>=u[0])throw new Error(xw(S,r[S],u[0]));for(let k=0;k<c;k++)h[v*c+k]+=t[$*c+k]}if(a)for(let S=0;S<c;S++)h[v*c+S]/=x-y;if(y=x,++x,g=v+1,v=w,x>i)break}return g<d&&h.fill(o,g*c,d*c),[h,p]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m8=ia(t=>Math.sqrt(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g8=On((t,e)=>{const n=t-e;return n*n});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y8=ia((t,e)=>{const{pattern:n,replaceGlobal:r,rewrite:s}=e;return t.replace(new RegExp(n,r?"g":""),s)});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x8(t,e,n,r){const s=xt(t,e.dtype);for(let a=0;a<s.size;a++){const o=s.indexToLoc(a),i=new Array(o.length);for(let u=0;u<i.length;u++)i[u]=o[u]*n[u]+r[u];s.set(e.get(...i),...o)}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class v8{constructor(e,n,r,s,a,o){this.separator=Oo(e),this.nGramWidths=n,this.leftPad=Oo(r),this.rightPad=Oo(s),this.padWidth=a,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const r=this.getPadWidth(n);return Math.max(0,e+2*r-n+1)}createNGrams(e,n,r,s,a,o){for(let i=0;i<a;++i){const u=this.getPadWidth(o),c=Math.max(0,u-i),l=Math.max(0,u-(a-(i+1))),d=o-(c+l),p=n+(c>0?0:i-u);let f=0;f+=c*this.leftPad.length;for(let v=0;v<d;++v)f+=e[p+v].length;f+=l*this.rightPad.length;const h=c+l+d-1;f+=h*this.separator.length,r[s+i]=new Uint8Array(f);const y=r[s+i];let x=0;const g=v=>v.forEach(w=>y[x++]=w);for(let v=0;v<c;++v)g(this.leftPad),g(this.separator);for(let v=0;v<d-1;++v)g(e[p+v]),g(this.separator);if(d>0){g(e[p+d-1]);for(let v=0;v<l;++v)g(this.separator),g(this.rightPad)}else{for(let v=0;v<l-1;++v)g(this.rightPad),g(this.separator);g(this.rightPad)}}}compute(e,n){const r=e.length,s=n.length;if(s>0){let u=n[0];if(u!==0)throw new Error(`First split value must be 0, got ${u}`);for(let c=1;c<s;++c){let l=n[c]>=u;if(l=l&&n[c]<=r,!l)throw new Error(`Invalid split value ${n[c]}, must be in [${u}, ${r}]`);u=n[c]}if(u!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${u}`)}const a=s-1,o=Vt("int32",s);if(r===0||s===0){const u=new Array(r);for(let c=0;c<=a;++c)o[c]=0;return[u,o]}o[0]=0;for(let u=1;u<=a;++u){const c=n[u]-n[u-1];let l=0;this.nGramWidths.forEach(d=>{l+=this.getNumNGrams(c,d)}),this.preserveShort&&c>0&&l===0&&(l=1),o[u]=o[u-1]+l}const i=new Array(o[a]);for(let u=0;u<a;++u){const c=n[u];let l=o[u];if(this.nGramWidths.forEach(d=>{const p=n[u+1]-n[u],f=this.getNumNGrams(p,d);this.createNGrams(e,c,i,l,f,d),l+=f}),this.preserveShort&&l===o[u]){const d=n[u+1]-n[u];if(d===0)continue;const p=d+2*this.padWidth;this.createNGrams(e,c,i,l,1,p)}}return[i,o]}}function tk(t,e,n,r,s,a,o,i){return new v8(n,r,s,a,o,i).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w8(t,e,n,r){if(!t.length)return;if(e.length===0){for(let a=0;a<t.length;++a)r.push(t.subarray(a,a+1));return}if(e.length===1){const a=e[0];let o=t.indexOf(a);for(;o!==-1;){const i=t.subarray(0,o);(!n||i.length!==0)&&r.push(i),t=t.subarray(o+1),o=t.indexOf(a)}(!n||t.length!==0)&&r.push(t);return}let s=0;for(let a=0;a<t.length+1;a++)if(a===t.length||e.indexOf(t[a])!==-1){const o=t.subarray(s,a);(!n||o.length!==0)&&r.push(o),s=a+1}}function nk(t,e,n){const r=t.length,s=[];let a=0,o=0;const i=new Array(r);for(let p=0;p<r;++p){const f=s.length;w8(t[p],e,n,s);const h=s.length-f;i[p]=h,a+=h,o=Math.max(o,h)}const u=Vt("int32",a*2),c=new Array(a),l=[r,o];let d=0;for(let p=0;p<r;++p)for(let f=0;f<i[p];++f)u[d*2]=p,u[d*2+1]=f,c[d]=s[d],++d;return[u,c,l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rk(t,e){const n=Vt("int32",t.length);for(let r=0;r<t.length;++r)n[r]=FF(t[r]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b8=On((t,e)=>t-e);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S8(t,e){const n=new Array(t.rank);for(let s=0;s<n.length;s++)n[s]=t.shape[s]*e[s];const r=xt(n,t.dtype);for(let s=0;s<r.values.length;++s){const a=r.indexToLoc(s),o=new Array(t.rank);for(let u=0;u<o.length;u++)o[u]=a[u]%t.shape[u];const i=t.locToIndex(o);r.values[s]=t.values[i]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Il=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function sk(t,e,n=0,r=t.length-1){for(;r>n;){if(r-n>600){const i=r-n+1,u=e-n+1,c=Math.log(i),l=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*l*(i-l)/i)*Math.sign(u-i/2),p=Math.max(n,Math.floor(e-u*l/i+d)),f=Math.min(r,Math.floor(e+(i-u)*l/i+d));sk(t,e,p,f)}const s=t[e];let a=n,o=r;for(pl(t,n,e),Il(t[r],s)>0&&pl(t,n,r);a<o;){for(pl(t,a,o),a++,o--;Il(t[a],s)<0;)a=a+1;for(;Il(t[o],s)>0;)o=o-1}Il(t[n],s)===0?pl(t,n,o):(o=o+1,pl(t,o,r)),o<=e&&(n=o+1),e<=o&&(r=o-1)}}function C8(t,e,n,r,s){const a=e[e.length-1],[o,i]=[t.length/a,a],u=Ua(n,o*r),c=Ua("int32",o*r);for(let d=0;d<o;d++){const p=d*i,f=t.subarray(p,p+i);let h=new Array(f.length);f.forEach((v,w)=>h[w]={value:v,index:w}),r<h.length&&(sk(h,r),h=h.slice(0,r)),s&&h.sort(Il);const y=d*r,x=u.subarray(y,y+r),g=c.subarray(y,y+r);for(let v=0;v<r;v++)x[v]=h[v].value,g[v]=h[v].index}const l=e.slice();return l[l.length-1]=r,[xt(l,n,u),xt(l,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ak(t,e,n,r){const s=vt(e,n)[0],a=[1,n[0],1];for(let h=0;h<s;h++)a[0]*=n[h];a[1]=n[s];for(let h=s+1;h<n.length;h++)a[2]*=n[h];const o=new Map,i=new Int32Array(n[s]),u=new Su(a,r,t),c=[],l=a[0]===1&&a[2]===1;for(let h=0;h<n[s];h++){let y;if(l)y=t[h].toString();else{const g=[];for(let v=0;v<a[0];v++)for(let w=0;w<a[2];w++)g.push(u.get(v,h,w));y=g.join(",")}const x=o.get(y);if(x!=null)i[h]=x;else{const g=o.size;o.set(y,g),i[h]=g,c.push(h)}}const d=a.slice();d[1]=o.size;const p=new Su(d,r);c.forEach((h,y)=>{for(let x=0;x<a[0];x++)for(let g=0;g<a[2];g++)p.set(u.get(x,h,g),x,y,g)});const f=n.slice();return f[s]=d[1],{outputValues:p.values,outputShape:f,indices:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var I8=Object.freeze({__proto__:null,addImpl:E6,bincountImpl:T6,bincountReduceImpl:R6,bitwiseAndImpl:A6,castImpl:k6,ceilImpl:O6,concatImpl:ZN,equalImpl:D6,expImpl:P6,expm1Impl:F6,floorDivImpl:M6,floorImpl:L6,gatherNdImpl:B6,gatherV2Impl:V6,greaterEqualImpl:W6,greaterImpl:z6,lessEqualImpl:G6,lessImpl:U6,linSpaceImpl:H6,logImpl:j6,maxImpl:K6,maximumImpl:q6,minimumImpl:X6,multiplyImpl:JN,negImpl:Y6,notEqualImpl:Q6,prodImpl:J6,raggedGatherImpl:o8,raggedRangeImpl:i8,raggedTensorToTensorImpl:u8,rangeImpl:ek,rsqrtImpl:l8,scatterImpl:c8,sigmoidImpl:d8,simpleAbsImpl:N6,sliceImpl:Ey,sparseFillEmptyRowsImpl:p8,sparseReshapeImpl:f8,sparseSegmentReductionImpl:h8,sqrtImpl:m8,squaredDifferenceImpl:g8,staticRegexReplaceImpl:y8,stridedSliceImpl:x8,stringNGramsImpl:tk,stringSplitImpl:nk,stringToHashBucketFastImpl:rk,subImpl:b8,tileImpl:S8,topKImpl:C8,transposeImpl:Z6,uniqueImpl:ak});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zo(t){const{inputs:{x:e},attrs:{begin:n,size:r},backend:s}=t,[a,o]=ew(e,n,r),i=Mh(e.shape,a,o),u=s.readSync(e.dataId),c=s.makeOutput(o,e.dtype),l=Ye(e.shape),d=s.dataIdMap.get(c.dataId);if(i){const h=Bh(a,l);return e.dtype==="string"?d.stringBytes=u.slice(h,h+K(o)):s.typedArrayFromHeap(c).set(u.subarray(h,h+K(o))),c}if(e.dtype==="string"){const h=Ey(u,a,o,e.shape,e.dtype);return d.stringBytes=h,c}const p=s.typedArrayFromHeap(c),f=e.shape.length;if(f===2)$8(u,l[0],p,a,o);else if(f===3)_8(u,l[0],l[1],p,a,o);else if(f===4)N8(u,l[0],l[1],l[2],p,a,o);else{const h=Ey(u,a,o,e.shape,e.dtype);p.set(h)}return c}function $8(t,e,n,r,s){let a=0;const o=r[0],i=r[1],u=o+s[0];for(let c=o;c<u;c++){const l=c*e+i;n.set(t.subarray(l,l+s[1]),a),a+=s[1]}}function _8(t,e,n,r,s,a){let o=0;const i=s[0],u=s[1],c=s[2],l=i+a[0],d=u+a[1];for(let p=i;p<l;p++)for(let f=u;f<d;f++){const h=p*e+f*n+c;r.set(t.subarray(h,h+a[2]),o),o+=a[2]}}function N8(t,e,n,r,s,a,o){let i=0;const u=a[0],c=a[1],l=a[2],d=u+o[0],p=c+o[1],f=l+o[2],h=a[3];for(let y=u;y<d;y++)for(let x=c;x<p;x++)for(let g=l;g<f;g++){const v=y*e+x*n+g*r+h;s.set(t.subarray(v,v+o[3]),i),i+=o[3]}}const k8={kernelName:cv,backendName:"wasm",kernelFunc:Zo};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E8(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:a,crops:o}=r,i=a.reduce((g,v)=>g*v),u=Mc(s.shape,a,i),c=Bc(u.length,a.length),l=Vc(s.shape,a,i),d=aw(o,a.length),p=ow(l,o,a.length),f=Nn({inputs:{x:s},backend:n,attrs:{shape:u}}),h=Ka({inputs:{x:f},backend:n,attrs:{perm:c}}),y=Nn({inputs:{x:h},backend:n,attrs:{shape:l}}),x=Zo({inputs:{x:y},backend:n,attrs:{begin:d,size:p}});return n.disposeData(f.dataId),n.disposeData(h.dataId),n.disposeData(y.dataId),x}const T8={kernelName:ix,backendName:"wasm",kernelFunc:E8};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ok;function R8(t){ok=t.wasm.cwrap(Rf,null,["number","number","boolean","number","number","number"])}function A8(t){const{backend:e,inputs:n,attrs:r}=t,{x:s,weights:a}=n,{size:o}=r,i=a.shape.reduce((d,p)=>d*p,1)!==0,u=s.shape.length===1?[o]:[s.shape[0],o],c=e.makeOutput(u,a.dtype);function l(d){return e.dataIdMap.get(d.dataId).id}return ok(l(s),o,i,l(a),Ue[a.dtype],l(c)),c}const O8={kernelName:Rf,backendName:"wasm",setupFunc:R8,kernelFunc:A8};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D8=Tt(ux);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P8(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e,a=n.typedArrayFromHeap(r),o=n.typedArrayFromHeap(s),i=Le(Array.from(a),Array.from(o));return n.makeOutput([i.length],"int32",void 0,new Int32Array(i))}const F8={kernelName:lx,backendName:"wasm",kernelFunc:P8};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ro(t){const{inputs:{x:e},attrs:{dtype:n},backend:r}=t,s=r.makeOutput(e.shape,n),a=r.typedArrayFromHeap(e);return r.typedArrayFromHeap(s).set(a),s}const L8={kernelName:Af,backendName:"wasm",kernelFunc:ro};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M8=ze(cx);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ik;function B8(t){ik=t.wasm.cwrap(Of,null,["number","number","number","number"])}function V8(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{clipValueMin:a,clipValueMax:o}=r,i=n.dataIdMap.get(s.dataId).id,u=n.makeOutput(s.shape,s.dtype),c=n.dataIdMap.get(u.dataId).id;return ik(i,a,o,c),u}const z8={kernelName:Of,backendName:"wasm",setupFunc:B8,kernelFunc:V8};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uk(t){const{inputs:e,backend:n}=t,r=vt(t.attrs.axis,e[0].shape)[0],s=e.map(f=>f.shape);nw(s,r);let a=ks(e.map(f=>f.shape),r);const o=e.filter(f=>K(f.shape)>0);if(o.length===1)return zh({inputs:{x:o[0]},backend:n});const i=n.makeOutput(a,e[0].dtype);if(K(a)===0)return i;if(o[0].dtype==="string"){const f=o.map(w=>{const $=[-1,K(w.shape.slice(r))];return Nn({inputs:{x:w},backend:n,attrs:{shape:$}})}),h=f.map(w=>({vals:n.readSync(w.dataId),shape:w.shape}));a=ks(f.map(w=>w.shape),1);const y=f[0].shape[0]===1,x=ZN(h,a,e[0].dtype,y),g=ks(o.map(w=>w.shape),r);i.shape=g;const v=n.dataIdMap.get(i.dataId);return v.stringBytes=ww(x),f.forEach(w=>n.disposeData(w.dataId)),i}const u=K(o[0].shape.slice(0,r));let c=0;const l=o.map(f=>{const h=K(f.shape.slice(r));return c+=h,h}),d=o.map(f=>n.typedArrayFromHeap(f)),p=n.typedArrayFromHeap(i);for(let f=0;f<u;f++){let h=f*c;for(let y=0;y<d.length;y++){const x=l[y],g=f*x,v=d[y].subarray(g,g+x);p.set(v,h),h+=x}}return i}const W8={kernelName:dx,backendName:"wasm",kernelFunc:uk};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let lk;function U8(t){lk=t.wasm.cwrap(Df,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function G8(t){const{inputs:e,attrs:n,backend:r}=t,{x:s,filter:a}=e,o=r.dataIdMap.get(s.dataId).id,i=r.dataIdMap.get(a.dataId).id,{strides:u,dilations:c,pad:l,dimRoundingMode:d,dataFormat:p}=n,f=to(p),h=qt(s.shape,a.shape,u,c,l,d,!1,f),y=h.filterHeight,x=h.filterWidth,g=h.padInfo.top,v=h.padInfo.right,w=h.padInfo.bottom,S=h.padInfo.left,$=h.dilationHeight,k=h.dilationWidth,T=h.strideHeight,A=h.strideWidth,B=h.inChannels,L=h.outChannels,z=h.padInfo.type==="SAME"?1:0;if(h.dataFormat!=="channelsLast")throw new Error(`wasm backend Conv2D does not support dataFormat:'${h.dataFormat}'. Please use 'channelsLast'.`);const Y=r.makeOutput(h.outShape,"float32"),Q=r.dataIdMap.get(Y.dataId).id;return lk(o,s.shape[0],s.shape[1],s.shape[2],i,y,x,g,v,w,S,z,$,k,T,A,B,L,Q),Y}const H8={kernelName:Df,backendName:"wasm",setupFunc:U8,kernelFunc:G8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ck;function j8(t){ck=t.wasm.cwrap(Pf,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function K8(t){const{backend:e,inputs:n,attrs:r}=t,{dy:s,filter:a}=n,{strides:o,pad:i,dataFormat:u,dimRoundingMode:c,inputShape:l}=r,d=1,p=to(u),f=qt(l,a.shape,o,d,i,c,!1,p),{batchSize:h,filterHeight:y,filterWidth:x,inChannels:g,inHeight:v,inWidth:w,outChannels:S,outHeight:$,outWidth:k,strideHeight:T,strideWidth:A}=f,B=y-1-f.padInfo.top,L=x-1-f.padInfo.left,z=f.dataFormat==="channelsLast",Y=Ye(f.inShape),Q=Ye(s.shape),[re,Z,de]=Ye(a.shape),ce=Y[0],j=z?Y[1]:Y[2],ee=z?Y[2]:1,me=z?1:Y[1],Ie=Q[0],Pe=z?Q[1]:Q[2],Ge=z?Q[2]:1,_t=z?1:Q[1],Pt=e.makeOutput(f.inShape,"float32"),Nt=e.dataIdMap.get(Pt.dataId).id,wn=e.dataIdMap.get(s.dataId).id,rt=e.dataIdMap.get(a.dataId).id;return ck(wn,rt,h,y,x,v,w,g,$,k,S,T,A,B,L,re,Z,de,ce,j,ee,me,Ie,Pe,Ge,_t,Nt),Pt}const q8={kernelName:Pf,backendName:"wasm",setupFunc:j8,kernelFunc:K8};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let dk;function X8(t){dk=t.wasm.cwrap(Ff,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Y8(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:a}=e,{strides:o,pad:i,dilations:u}=r;if(s.dtype!=="float32")throw new Error(`Tensor x must have dtype float32, got ${s.dtype}`);if(a.dtype!=="float32")throw new Error(`Tensor filter must have dtype float32, got ${a.dtype}`);const c=eo(s.shape,a.shape,o,u,i),l=n.makeOutput(c.outShape,s.dtype);return dk(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(l.dataId).id,c.batchSize,c.inDepth,c.inHeight,c.inWidth,c.inChannels,c.outDepth,c.outHeight,c.outWidth,c.outChannels,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.filterDepth,c.filterHeight,c.filterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),l}const Q8={kernelName:Ff,backendName:"wasm",setupFunc:X8,kernelFunc:Y8};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let pk;function Z8(t){pk=t.wasm.cwrap(px,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function J8(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:a}=e,{strides:o,pad:i,filterShape:u}=r;if(s.dtype!=="float32")throw new Error(`Tensor dy must have dtype float32, got ${s.dtype}`);if(a.dtype!=="float32")throw new Error(`Tensor filter must have dtype float32, got ${a.dtype}`);const c=eo(s.shape,u,o,1,i),l=n.makeOutput(c.filterShape,a.dtype);return pk(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(l.dataId).id,c.batchSize,c.inDepth,c.inHeight,c.inWidth,c.inChannels,c.outDepth,c.outHeight,c.outWidth,c.outChannels,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.filterDepth,c.filterHeight,c.filterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),l}const e5={kernelName:px,backendName:"wasm",setupFunc:Z8,kernelFunc:J8};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let fk;function t5(t){fk=t.wasm.cwrap(Lf,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function n5(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:a}=e,{pad:o,strides:i,inputShape:u}=r;if(s.dtype!=="float32")throw new Error(`Tensor dy must have dtype float32, got ${s.dtype}`);if(a.dtype!=="float32")throw new Error(`Tensor filter must have dtype float32, got ${a.dtype}`);const c=eo(u,a.shape,i,1,o),l=n.makeOutput(c.inShape,s.dtype);return fk(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(l.dataId).id,c.batchSize,c.inDepth,c.inHeight,c.inWidth,c.inChannels,c.outDepth,c.outHeight,c.outWidth,c.outChannels,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.filterDepth,c.filterHeight,c.filterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),l}const r5={kernelName:Lf,backendName:"wasm",setupFunc:t5,kernelFunc:n5};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s5=ze(fx);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a5=ze(hx);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ty;(function(t){t[t.bilinear=0]="bilinear",t[t.nearest=1]="nearest"})(Ty||(Ty={}));let hk;function o5(t){hk=t.wasm.cwrap(Vf,null,["number","number","number","number","array","number","number","number","number","number"])}function i5(t){const{backend:e,inputs:n,attrs:r}=t,{method:s,extrapolationValue:a,cropSize:o}=r,{image:i,boxes:u,boxInd:c}=n,l=u.shape[0],[d,p]=o,f=[l,d,p,i.shape[3]];let h=e.dataIdMap.get(i.dataId),y;i.dtype!=="float32"&&(y=ro({backend:e,inputs:{x:i},attrs:{dtype:"float32"}}),h=e.dataIdMap.get(y.dataId));const x=h.id,g=e.dataIdMap.get(u.dataId).id,v=e.dataIdMap.get(c.dataId).id,w=e.makeOutput(f,"float32"),S=e.dataIdMap.get(w.dataId).id,$=new Uint8Array(new Int32Array(i.shape).buffer);return hk(x,g,v,l,$,d,p,Ty[s],a,S),y!=null&&e.disposeData(y.dataId),w}const u5={kernelName:Vf,backendName:"wasm",setupFunc:o5,kernelFunc:i5};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let mk;function l5(t){mk=t.wasm.cwrap(Mf,null,["number","number","number","number","number","number"])}function c5(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:a,exclusive:o,reverse:i}=r,u=s.shape.length;E(s.dtype==="float32"||s.dtype==="int32",()=>`cumprod does not support ${s.dtype} tensors in the WASM backend`);const c=An([a],u);let l=s;c!==null&&(l=Ka({inputs:{x:s},attrs:{perm:c},backend:n}));const d=Xt(1,u)[0];Dt("cumprod",[d],u);const p=n.makeOutput(l.shape,l.dtype),f=l.shape[d],h=n.dataIdMap.get(l.dataId).id,y=n.dataIdMap.get(p.dataId).id;mk(h,o?1:0,i?1:0,f,y,Ue[s.dtype]);let x=p;if(c!==null){const g=Fc(c);x=Ka({inputs:{x:p},attrs:{perm:g},backend:n}),n.disposeData(l.dataId),n.disposeData(p.dataId)}return x}const d5={kernelName:Mf,backendName:"wasm",setupFunc:l5,kernelFunc:c5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let gk;function p5(t){gk=t.wasm.cwrap(Bf,null,["number","number","number","number","number","number"])}function f5(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:a,exclusive:o,reverse:i}=r,u=s.shape.length;E(s.dtype==="float32"||s.dtype==="int32",()=>`cumsum does not support ${s.dtype} tensors in the WASM backend`);const c=An([a],u);let l=s;c!==null&&(l=Ka({inputs:{x:s},attrs:{perm:c},backend:n}));const d=Xt(1,u)[0];Dt("cumsum",[d],u);const p=n.makeOutput(l.shape,l.dtype),f=l.shape[d],h=n.dataIdMap.get(l.dataId).id,y=n.dataIdMap.get(p.dataId).id;gk(h,o?1:0,i?1:0,f,y,Ue[s.dtype]);let x=p;if(c!==null){const g=Fc(c);x=Ka({inputs:{x:p},attrs:{perm:g},backend:n}),n.disposeData(l.dataId),n.disposeData(p.dataId)}return x}const h5={kernelName:Bf,backendName:"wasm",setupFunc:p5,kernelFunc:f5};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let yk;function m5(t){yk=t.wasm.cwrap("DenseBincount",null,["number","array","number","number","boolean","number","number","boolean","number"])}function g5(t){const{backend:e,inputs:n,attrs:r}=t,{x:s,weights:a}=n,{size:o,binaryOutput:i}=r,u=a.shape.reduce((p,f)=>p*f,1)!==0,c=s.shape.length===1?[o]:[s.shape[0],o],l=e.makeOutput(c,a.dtype);function d(p){return e.dataIdMap.get(p.dataId).id}return yk(d(s),new Uint8Array(new Int32Array(s.shape).buffer),s.shape.length,o,u,d(a),Ue[a.dtype],i,d(l)),l}const y5={kernelName:mx,backendName:"wasm",setupFunc:m5,kernelFunc:g5};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let xk;function x5(t){xk=t.wasm.cwrap(zf,null,["number","number","number","array","number","array","array","number","number"])}function v5(t){const{backend:e,inputs:n,attrs:r}=t,{x:s}=n,{blockSize:a,dataFormat:o}=r,i=s.shape[0],u=o==="NHWC"?s.shape[1]:s.shape[2],c=o==="NHWC"?s.shape[2]:s.shape[3],l=o==="NHWC"?s.shape[3]:s.shape[1],d=u*a,p=c*a,f=l/(a*a),h=o==="NHWC"?[i,d,p,f]:[i,f,d,p],y=e.makeOutput(h,"float32"),g=e.dataIdMap.get(s.dataId).id,v=new Uint8Array(new Int32Array(Ye(s.shape)).buffer),w=new Uint8Array(new Int32Array(h).buffer),S=new Uint8Array(new Int32Array(Ye(h)).buffer),$=e.dataIdMap.get(y.dataId).id;return xk(g,a,o==="NHWC"?1:0,v,s.shape.length-1,w,S,h.length,$),y}const w5={kernelName:zf,backendName:"wasm",setupFunc:x5,kernelFunc:v5};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let vk;function b5(t){vk=t.wasm.cwrap(Wf,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function S5(t){const{inputs:e,attrs:n,backend:r}=t,{x:s,filter:a}=e,o=r.dataIdMap.get(s.dataId).id,i=r.dataIdMap.get(a.dataId).id,{strides:u,dilations:c,pad:l,dimRoundingMode:d}=n,p=c??[1,1],f=qt(s.shape,a.shape,u,p,l,d,!0),h=f.filterHeight,y=f.filterWidth,x=f.padInfo.top,g=f.padInfo.right,v=f.padInfo.bottom,w=f.padInfo.left,S=f.dilationHeight,$=f.dilationWidth,k=f.strideHeight,T=f.strideWidth,A=f.inChannels,B=f.outChannels,L=f.padInfo.type==="SAME"?1:0;if(f.dataFormat!=="channelsLast")throw new Error(`wasm backend DepthwiseConv2dNative does not support dataFormat:'${f.dataFormat}'. Please use 'channelsLast'.`);const z=r.makeOutput(f.outShape,"float32"),Y=r.dataIdMap.get(z.dataId).id;return vk(o,s.shape[0],s.shape[1],s.shape[2],i,h,y,x,g,v,w,L,S,$,k,T,A,B,Y),z}const C5={kernelName:Wf,backendName:"wasm",setupFunc:b5,kernelFunc:S5};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let wk;function I5(t){wk=t.wasm.cwrap("Diag",null,["number","number","number","number"])}function $5(t){const{inputs:e,backend:n}=t,{x:r}=e,s=K(r.shape),a=n.makeOutput([...r.shape,...r.shape],r.dtype);return wk(n.dataIdMap.get(r.dataId).id,Ue[r.dtype],s,n.dataIdMap.get(a.dataId).id),a}const _5={kernelName:gx,backendName:"wasm",setupFunc:I5,kernelFunc:$5};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let bk;function N5(t){bk=t.wasm.cwrap(Uf,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function k5(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:a}=e,{strides:o,pad:i,dilations:u}=r;if(s.dtype!==a.dtype)throw new Error(`Dilation2D error: x must have the same dtype as filter. Got ${s.dtype} and ${a.dtype}`);const c=Dc(s.shape,a.shape,o,i,"NHWC",u),l=n.makeOutput(c.outShape,s.dtype);return bk(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(l.dataId).id,Ue[s.dtype],c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.filterHeight,c.filterWidth,c.padInfo.top,c.padInfo.left),l}const E5={kernelName:Uf,backendName:"wasm",setupFunc:N5,kernelFunc:k5};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Sk;function T5(t){Sk=t.wasm.cwrap(d$,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function R5(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:a,dy:o}=e,{strides:i,pad:u,dilations:c}=r;if(s.dtype!==a.dtype||s.dtype!==o.dtype)throw new Error(`Dilation2DBackpropFilter error: x must have the same dtype as filter and dy. Got ${s.dtype}, ${a.dtype}, and ${o.dtype}`);const l=Dc(s.shape,a.shape,i,u,"NHWC",c),d=n.makeOutput(a.shape,a.dtype);return Sk(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(o.dataId).id,n.dataIdMap.get(d.dataId).id,Ue[s.dtype],l.batchSize,l.inChannels,l.inHeight,l.inWidth,l.outHeight,l.outWidth,l.strideHeight,l.strideWidth,l.dilationHeight,l.dilationWidth,l.filterHeight,l.filterWidth,l.padInfo.top,l.padInfo.left),d}const A5={kernelName:d$,backendName:"wasm",setupFunc:T5,kernelFunc:R5};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Ck;function O5(t){Ck=t.wasm.cwrap(c$,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function D5(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:a,dy:o}=e,{strides:i,pad:u,dilations:c}=r;if(s.dtype!==a.dtype||s.dtype!==o.dtype)throw new Error(`Dilation2DBackpropInput error: x must have the same dtype as filter and dy. Got ${s.dtype}, ${a.dtype}, and ${o.dtype}`);const l=Dc(s.shape,a.shape,i,u,"NHWC",c),d=n.makeOutput(s.shape,s.dtype);return Ck(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(o.dataId).id,n.dataIdMap.get(d.dataId).id,Ue[s.dtype],l.batchSize,l.inChannels,l.inHeight,l.inWidth,l.outHeight,l.outWidth,l.strideHeight,l.strideWidth,l.dilationHeight,l.dilationWidth,l.filterHeight,l.filterWidth,l.padInfo.top,l.padInfo.left),d}const P5={kernelName:c$,backendName:"wasm",setupFunc:O5,kernelFunc:D5};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F5=ze(xx);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Ik;function L5(t){Ik=t.wasm.cwrap(vx,null,["number","number","number"])}function M5(t){const{inputs:e,backend:n}=t,{dy:r,y:s}=e,a=n.makeOutput(s.shape,"float32"),o=i=>n.dataIdMap.get(i.dataId).id;return Ik(o(s),o(r),o(a)),a}const B5={kernelName:vx,backendName:"wasm",setupFunc:L5,kernelFunc:M5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V5=!1,z5=Tt(bx,V5,"bool");/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W5=ze(wx);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U5=ze(Sx,"float32");/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ry(t){const{inputs:e,attrs:n,backend:r}=t,{input:s}=e,{dim:a}=n,o=s.shape.length,i=s.shape.slice();let u=a;return a<0&&(E(-(o+1)<=a,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),u=o+a+1),i.splice(u,0,1),Nn({inputs:{x:s},backend:r,attrs:{shape:i}})}const G5={kernelName:Cx,backendName:"wasm",kernelFunc:Ry};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H5=ze(Ix,"float32");/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $k(t){const{attrs:{shape:e,value:n},backend:r}=t;let{attrs:{dtype:s}}=t;s=s||Ou(n);const a=r.makeOutput(e,s);return r.typedArrayFromHeap(a).fill(n),a}const j5={kernelName:$x,backendName:"wasm",kernelFunc:$k};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let _k;function K5(t){_k=t.wasm.cwrap(Gf,null,["number","number","number","number","number","number"])}function q5(t){const{inputs:e,backend:n}=t,{image:r}=e,s=n.makeOutput(r.shape,r.dtype),a=n.dataIdMap.get(r.dataId).id,o=n.dataIdMap.get(s.dataId).id,[i,u,c,l]=r.shape;return _k(a,i,u,c,l,o),s}const X5={kernelName:Gf,backendName:"wasm",kernelFunc:q5,setupFunc:K5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y5=ze(_x);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q5=Tt(Nx);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Nk;function Z5(t){Nk=t.wasm.cwrap(Hf,null,["number","number","number","number","number","number","number"])}function J5(t){const{backend:e,inputs:n,attrs:r}=t,{varianceEpsilon:s}=r,{x:a,mean:o,variance:i,offset:u,scale:c}=n,l=e.dataIdMap.get(a.dataId).id,d=e.dataIdMap.get(o.dataId).id,p=e.dataIdMap.get(i.dataId).id,f=u!=null?e.dataIdMap.get(u.dataId).id:0,h=c!=null?e.dataIdMap.get(c.dataId).id:0,y=e.makeOutput(a.shape,a.dtype);if(K(a.shape)===0)return y;const x=e.dataIdMap.get(y.dataId).id;return Nk(l,d,p,f,h,s,x),y}const eK={kernelName:Hf,backendName:"wasm",setupFunc:Z5,kernelFunc:J5};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let kk;function tK(t){kk=t.wasm.cwrap(ic,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function nK(t){const{inputs:e,attrs:n,backend:r}=t,{x:s,filter:a,bias:o,preluActivationWeights:i}=e,{strides:u,pad:c,dilations:l,dataFormat:d,dimRoundingMode:p,activation:f,leakyreluAlpha:h}=n,y=qt(s.shape,a.shape,u,l,c,p),x=xc[f];if(x==null)throw new Error(`${f} activation not yet supported for FusedConv2D in the wasm backend.`);const g=r.dataIdMap.get(s.dataId).id,v=r.dataIdMap.get(a.dataId).id,w=y.outChannels;let S=0;if(o!=null){const Ge=r.dataIdMap.get(o.dataId);if(Ge.shape.length!==1)throw new Error(`FusedConv2D only supports rank-1 bias but got rank ${Ge.shape.length}.`);if(Ge.shape[0]!==w)throw new Error(`FusedConv2D bias shape (${Ge.shape}) does not match the number of output channels (${w})`);S=Ge.id}const $=y.filterHeight,k=y.filterWidth,T=y.padInfo.top,A=y.padInfo.right,B=y.padInfo.bottom,L=y.padInfo.left,z=y.dilationHeight,Y=y.dilationWidth,Q=y.strideHeight,re=y.strideWidth,Z=y.inChannels,de=y.padInfo.type==="SAME"?1:0,ce=y.batchSize,j=y.inHeight,ee=y.inWidth;if(d!=="NHWC")throw new Error(`wasm backend FusedConv2D does not support dataFormat:'${d}'. Please use 'NHWC'.`);const me=r.makeOutput(y.outShape,"float32"),Ie=r.dataIdMap.get(me.dataId).id,Pe=i==null?0:r.dataIdMap.get(i.dataId).id;return kk(g,ce,j,ee,v,$,k,S,T,A,B,L,de,z,Y,Q,re,Z,w,x,Pe,h||0,Ie),me}const rK={kernelName:ic,backendName:"wasm",setupFunc:tK,kernelFunc:nK};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Ek;function sK(t){Ek=t.wasm.cwrap(uc,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function aK(t){const{inputs:e,attrs:n,backend:r}=t,{x:s,filter:a,bias:o,preluActivationWeights:i}=e,{strides:u,pad:c,dilations:l,dataFormat:d,dimRoundingMode:p,activation:f,leakyreluAlpha:h}=n,y=qt(s.shape,a.shape,u,l,c,p,!0),x=xc[f];if(x==null)throw new Error(`${f} activation not yet supported for FusedDepthwiseConv2D in the wasm backend.`);const g=r.dataIdMap.get(s.dataId).id,v=r.dataIdMap.get(a.dataId).id,w=y.outChannels;let S=0;if(o!=null){const Ge=r.dataIdMap.get(o.dataId);if(Ge.shape.length!==1)throw new Error(`FusedDepthwiseConv2D only supports rank-1 bias but got rank ${Ge.shape.length}.`);if(Ge.shape[0]!==w)throw new Error(`FusedDepthwiseConv2D bias shape (${Ge.shape}) does not match the number of output channels (${w})`);S=Ge.id}const $=y.filterHeight,k=y.filterWidth,T=y.padInfo.top,A=y.padInfo.right,B=y.padInfo.bottom,L=y.padInfo.left,z=y.dilationHeight,Y=y.dilationWidth,Q=y.strideHeight,re=y.strideWidth,Z=y.inChannels,de=y.padInfo.type==="SAME"?1:0,ce=y.batchSize,j=y.inHeight,ee=y.inWidth;if(d!=="NHWC")throw new Error(`wasm backend FusedDepthwiseConv2D does not support dataFormat:'${d}'. Please use 'NHWC'.`);const me=r.makeOutput(y.outShape,"float32"),Ie=r.dataIdMap.get(me.dataId).id,Pe=i==null?0:r.dataIdMap.get(i.dataId).id;return Ek(g,ce,j,ee,v,$,k,S,T,A,B,L,de,z,Y,Q,re,Z,w,x,Pe,h||0,Ie),me}const oK={kernelName:uc,backendName:"wasm",setupFunc:sK,kernelFunc:aK};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Tk;function iK(t){Tk=t.wasm.cwrap(jf,null,["number","number","number","number","number","number","array","number"])}function uK(t){const{backend:e,inputs:n}=t,{params:r,indices:s}=n,[a,o,i,u]=Zv(r,s),c=e.makeOutput(a,r.dtype);if(o===0)return c;const l=s.shape,d=l[l.length-1],f=e.dataIdMap.get(r.dataId).id,y=e.dataIdMap.get(s.dataId).id,x=new Uint8Array(new Int32Array(u).buffer),g=e.dataIdMap.get(c.dataId).id;return Tk(f,Ue[r.dtype],y,o,d,i,x,g),c}const lK={kernelName:jf,backendName:"wasm",setupFunc:iK,kernelFunc:uK};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Rk;function cK(t){Rk=t.wasm.cwrap("Gather",null,["number","number","array","number","number","number","array","number"])}function dK(t){const{backend:e,inputs:n,attrs:r}=t,{x:s,indices:a}=n,{axis:o,batchDims:i}=r,u=vt(o,s.shape)[0],c=e.readSync(a.dataId),l=s.shape[u];for(let B=0;B<c.length;++B){const L=c[B];E(L<=l-1&&L>=0,()=>`GatherV2: the index value ${L} is not in [0, ${l-1}]`)}const d=vw(s,a,u,i),p=Nn({inputs:{x:s},attrs:{shape:[d.batchSize,d.outerSize,d.dimSize,d.sliceSize]},backend:e}),f=K(a.shape),h=Nn({inputs:{x:a},attrs:{shape:[d.batchSize,f/d.batchSize]},backend:e}),y=[d.batchSize,d.outerSize,f/d.batchSize,d.sliceSize],x=e.makeOutput(y,s.dtype);if(K(s.shape)===0)return x;const g=p.shape.length-1,w=e.dataIdMap.get(p.dataId).id,$=e.dataIdMap.get(h.dataId).id,k=e.dataIdMap.get(x.dataId).id,T=new Uint8Array(new Int32Array(Ye(p.shape)).buffer),A=new Uint8Array(new Int32Array(Ye(y)).buffer);return Rk(w,Ue[s.dtype],T,g,$,d.batchSize,A,k),e.disposeData(p.dataId),e.disposeData(h.dataId),x.shape=d.outputShape,x}const pK={kernelName:kx,backendName:"wasm",setupFunc:cK,kernelFunc:dK};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fK=!1,hK=Tt(Ex,fK,"bool");/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mK=!1,gK=Tt(Tx,mK,"bool");/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yK=ze(Rx,"bool");/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xK=ze(Ax,"bool");/**
 * @license
 * Copyright 2022 The TensorFlow Authors. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vK=ze(Ox,"bool");/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Ak;function wK(t){Ak=t.wasm.cwrap(qf,null,["number","number","number","number"])}function bK(t){const{inputs:{x:e},attrs:{alpha:n},backend:r}=t,s=r.dataIdMap.get(e.dataId).id,a=r.makeOutput(e.shape,"float32");if(K(e.shape)!==0){const o=r.dataIdMap.get(a.dataId).id;Ak(s,Ue[e.dtype],n,o)}return a}const SK={kernelName:qf,backendName:"wasm",setupFunc:wK,kernelFunc:bK};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CK=!1,IK=Tt(Dx,CK,"bool");/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $K=!1,_K=Tt(Px,$K,"bool");/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Ok;function NK(t){Ok=t.wasm.cwrap(Xf,null,["number","number","number","number"])}function kK(t){const{attrs:e,backend:n}=t,{start:r,stop:s,num:a}=e,o=Math.floor(a),i=n.makeOutput([o],"float32");return Ok(n.dataIdMap.get(i.dataId).id,r,s,o),i}const EK={kernelName:Xf,backendName:"wasm",setupFunc:NK,kernelFunc:kK};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TK=ze(Fx);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RK=ze(Lx);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AK=!1,OK=Tt(Mx,AK,"bool");/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DK=ze(Bx);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PK=!1,FK=Tt(Vx,PK,"bool");/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LK=!1,MK=Tt(NF,LK,"bool");/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Dk;function BK(t){Dk=t.wasm.cwrap(Yf,null,["number","number","number","number","number","number","number"])}function VK(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:a,bias:o,alpha:i,beta:u}=r;if(s.dtype!=="float32")throw new Error("LRN error: x must have dtype float32");const c=n.makeOutput(s.shape,s.dtype);return Dk(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(c.dataId).id,s.shape[3],a,o,i,u),c}const zK={kernelName:Yf,backendName:"wasm",setupFunc:BK,kernelFunc:VK};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Pk;function WK(t){Pk=t.wasm.cwrap(zx,null,["number","number","number","number","number","number","number","number","number"])}function UK(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,y:a,dy:o}=e,{depthRadius:i,bias:u,alpha:c,beta:l}=r;if(s.dtype!=="float32"||a.dtype!=="float32"||o.dtype!=="float32")throw new Error("LRNGrad error: x, y, and dy must have dtype float32");const d=n.makeOutput(s.shape,s.dtype);return Pk(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(o.dataId).id,n.dataIdMap.get(d.dataId).id,o.shape[3],i,u,c,l),d}const GK={kernelName:zx,backendName:"wasm",setupFunc:WK,kernelFunc:UK};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Fk;function HK(t){Fk=t.wasm.cwrap(Qf,null,["number","number","number","number"])}function jK(t){const{backend:e,inputs:n,attrs:r}=t,{reductionIndices:s,keepDims:a}=r,{x:o}=n;let u=e.dataIdMap.get(o.dataId).id,c=o;const{transposed:l,axes:d,originalAxes:p,inputWasTransposed:f}=no(o,s,e);if(f){const w=e.dataIdMap.get(l.dataId).id;c=l,u=w}const h=c.shape.length;Dt("max",d,h);const[y,x]=an(c.shape,d),g=K(x),v=e.makeOutput(y,o.dtype);if(K(c.shape)!==0){const w=e.dataIdMap.get(v.dataId).id;Fk(u,Ue[o.dtype],g,w)}if(f&&e.disposeData(l.dataId),a){const w=Ot(v.shape,p);v.shape=w}return v}const KK={kernelName:Qf,backendName:"wasm",setupFunc:HK,kernelFunc:jK};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qK=Tt(Wx);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Lk;function XK(t){Lk=t.wasm.cwrap(Zf,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function YK(t){const{inputs:e,attrs:n,backend:r}=t,s=e.x,a=r.dataIdMap.get(s.dataId).id;E(s.dtype==="float32",()=>`Error in MaxPool: only float32 input is supported. Got ${s.dtype}.`);const{filterSize:o,strides:i,pad:u,dimRoundingMode:c}=n,l=Mr(s.shape,o,i,1,u,c),d=l.filterHeight,p=l.filterWidth,f=l.padInfo.top,h=l.padInfo.right,y=l.padInfo.bottom,x=l.padInfo.left,g=l.dilationHeight,v=l.dilationWidth,w=l.strideHeight,S=l.strideWidth,$=l.inChannels,k=l.outChannels;if(l.dataFormat!=="channelsLast")throw new Error(`wasm backend does not support dataFormat:'${l.dataFormat}'. Please use 'channelsLast'.`);const T=r.makeOutput(l.outShape,"float32"),A=r.dataIdMap.get(T.dataId).id;return Lk(a,s.shape[0],s.shape[1],s.shape[2],d,p,f,h,y,x,g,v,w,S,$,k,A),T}const QK={kernelName:Zf,backendName:"wasm",setupFunc:XK,kernelFunc:YK};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Mk;function ZK(t){Mk=t.wasm.cwrap("MaxPool3D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function JK(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:a,strides:o,pad:i,dimRoundingMode:u,dataFormat:c}=r,l=aa(s.shape,a,o,1,i,u,c),d=n.makeOutput(l.outShape,s.dtype);return Mk(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(d.dataId).id,l.batchSize,l.inChannels,l.inDepth,l.inHeight,l.inWidth,l.outDepth,l.outHeight,l.outWidth,l.strideDepth,l.strideHeight,l.strideWidth,l.dilationDepth,l.dilationHeight,l.dilationWidth,l.effectiveFilterDepth,l.effectiveFilterHeight,l.effectiveFilterWidth,l.padInfo.front,l.padInfo.top,l.padInfo.left),d}const eq={kernelName:Ux,backendName:"wasm",setupFunc:ZK,kernelFunc:JK};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Bk;function tq(t){Bk=t.wasm.cwrap("MaxPool3DGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function nq(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:a}=e,{filterSize:o,strides:i,pad:u,dimRoundingMode:c}=r,l=aa(a.shape,o,i,1,u,c),d=n.makeOutput(a.shape,a.dtype);return Bk(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(d.dataId).id,l.batchSize,l.inChannels,l.inDepth,l.inHeight,l.inWidth,l.outDepth,l.outHeight,l.outWidth,l.strideDepth,l.strideHeight,l.strideWidth,l.dilationDepth,l.dilationHeight,l.dilationWidth,l.effectiveFilterDepth,l.effectiveFilterHeight,l.effectiveFilterWidth,l.padInfo.front,l.padInfo.top,l.padInfo.left),d}const rq={kernelName:y$,backendName:"wasm",setupFunc:tq,kernelFunc:nq};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Vk;function sq(t){Vk=t.wasm.cwrap("MaxPoolGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function aq(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:a}=e,{filterSize:o,strides:i,pad:u,dimRoundingMode:c}=r,l=Mr(a.shape,o,i,1,u,c),d=n.makeOutput(a.shape,a.dtype);return Vk(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(d.dataId).id,l.batchSize,l.inChannels,l.inHeight,l.inWidth,l.outHeight,l.outWidth,l.strideHeight,l.strideWidth,l.dilationHeight,l.dilationWidth,l.effectiveFilterHeight,l.effectiveFilterWidth,l.padInfo.top,l.padInfo.left),d}const oq={kernelName:g$,backendName:"wasm",setupFunc:sq,kernelFunc:aq};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let zk;function iq(t){zk=t.wasm.cwrap("MaxPoolWithArgmax",null,["number","number","number","number","boolean","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function uq(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:a,strides:o,pad:i,includeBatchInIndex:u}=r;E(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const c=[1,1];E(Rn(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const l=Mr(s.shape,a,o,[1,1],i),d=n.makeOutput(l.outShape,s.dtype),p=n.makeOutput(l.outShape,"int32");return zk(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(d.dataId).id,n.dataIdMap.get(p.dataId).id,Ue[s.dtype],u,l.batchSize,l.inChannels,l.inHeight,l.inWidth,l.outHeight,l.outWidth,l.strideHeight,l.strideWidth,l.dilationHeight,l.dilationWidth,l.effectiveFilterHeight,l.effectiveFilterWidth,l.padInfo.top,l.padInfo.left),[d,p]}const lq={kernelName:Gx,backendName:"wasm",setupFunc:iq,kernelFunc:uq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Wk;function cq(t){Wk=t.wasm.cwrap(Jf,null,["number, number, number"])}function dq(t){const{backend:e,inputs:n,attrs:r}=t,{axis:s,keepDims:a}=r,{x:o}=n,i=e.dataIdMap.get(o.dataId).id;let u=i,c=o;const{transposed:l,axes:d,originalAxes:p,inputWasTransposed:f}=no(o,s,e);let h=d;if(f){const S=e.dataIdMap.get(l.dataId).id;S!==i&&(c=l,u=S,h=Xt(h.length,c.shape.length))}Dt("mean",h,c.shape.length);const[y,x]=an(c.shape,h),g=K(x);let v=c;c.dtype!=="float32"&&(v=ro({backend:e,inputs:{x:c},attrs:{dtype:"float32"}}),u=e.dataIdMap.get(v.dataId).id);const w=e.makeOutput(y,"float32");if(K(c.shape)!==0){const S=e.dataIdMap.get(w.dataId).id;Wk(u,g,S)}if(f&&e.disposeData(l.dataId),a){const S=Ot(w.shape,p);w.shape=S}return c.dtype!=="float32"&&e.disposeData(v.dataId),w}const pq={kernelName:Jf,backendName:"wasm",setupFunc:cq,kernelFunc:dq};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Uk;function fq(t){Uk=t.wasm.cwrap(eh,null,["number","number","number","number"])}function hq(t){const{backend:e,inputs:n,attrs:r}=t,{axis:s,keepDims:a}=r,{x:o}=n,i=e.dataIdMap.get(o.dataId).id;let u=i,c=o;const{transposed:l,axes:d,originalAxes:p,inputWasTransposed:f}=no(o,s,e);if(f){const w=e.dataIdMap.get(l.dataId).id;w!==i&&(c=l,u=w)}const h=c.shape.length;Dt("min",d,h);const[y,x]=an(c.shape,d),g=K(x),v=e.makeOutput(y,c.dtype);if(K(c.shape)!==0){const w=e.dataIdMap.get(v.dataId).id;Uk(u,Ue[o.dtype],g,w)}if(f&&e.disposeData(l.dataId),a){const w=Ot(v.shape,p);v.shape=w}return v}const mq={kernelName:eh,backendName:"wasm",setupFunc:fq,kernelFunc:hq};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gq=Tt(Hx);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ay;(function(t){t[t.reflect=0]="reflect",t[t.symmetric=1]="symmetric"})(Ay||(Ay={}));let Gk;function yq(t){Gk=t.wasm.cwrap(th,null,["number","array","number","number","array","array","number","number"])}function xq(t){const{inputs:{x:e},backend:n,attrs:{paddings:r,mode:s}}=t,a=r.map((h,y)=>h[0]+e.shape[y]+h[1]),o=n.dataIdMap.get(e.dataId).id,i=n.makeOutput(a,e.dtype),u=n.dataIdMap.get(i.dataId).id,c=new Uint8Array(new Int32Array(e.shape).buffer),l=r.map(h=>h[0]),d=r.map(h=>h[1]),p=new Uint8Array(new Int32Array(l).buffer),f=new Uint8Array(new Int32Array(d).buffer);return Gk(o,c,e.shape.length,Ue[e.dtype],p,f,Ay[s],u),i}const vq={kernelName:th,backendName:"wasm",kernelFunc:xq,setupFunc:yq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Hk;function wq(t){Hk=t.wasm.cwrap(yh,null,["number","number","number","number"])}function jk(t){const{backend:e,inputs:{logits:n},attrs:{dim:r}}=t,s=e.dataIdMap.get(n.dataId).id,a=e.makeOutput(n.shape,n.dtype),o=e.dataIdMap.get(a.dataId).id,i=n.shape[r],u=K(n.shape)/i;return K(a.shape)===0||Hk(s,o,i,u),a}const bq={kernelName:yh,backendName:"wasm",setupFunc:wq,kernelFunc:jk};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Kk;function Sq(t){Kk=t.wasm.cwrap(nh,null,["number","number","number","number","number","number"])}function Cq(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:a,seed:o,normalized:i}=r;if(s.dtype!=="float32")throw new Error(`Tensor logits must have dtype float32, got ${s.dtype}`);const u=i?s:jk({inputs:{logits:s},backend:n,attrs:{dim:s.shape.length-1}}),[c,l]=u.shape,d=n.makeOutput([c,a],"int32");return Kk(n.dataIdMap.get(u.dataId).id,c,l,a,o,n.dataIdMap.get(d.dataId).id),i||n.disposeData(u.dataId),d}const Iq={kernelName:nh,backendName:"wasm",setupFunc:Sq,kernelFunc:Cq};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $q=Tt(jx);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _q=Tt(Kx);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nq=ze(qx);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sw(t,e){const n=new Int32Array(t.wasm.HEAPU8.buffer,e,4),r=n[0],s=n[1],a=n[2],o=n[3];return t.wasm._free(e),{pSelectedIndices:r,selectedSize:s,pSelectedScores:a,pValidOutputs:o}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let qk;function kq(t){qk=t.wasm.cwrap(rh,"number",["number","number","number","number","number"])}function Eq(t){const{backend:e,inputs:n,attrs:r}=t,{iouThreshold:s,maxOutputSize:a,scoreThreshold:o}=r,{boxes:i,scores:u}=n,c=e.dataIdMap.get(i.dataId).id,l=e.dataIdMap.get(u.dataId).id,d=qk(c,l,a,s,o),{pSelectedIndices:p,selectedSize:f,pSelectedScores:h,pValidOutputs:y}=Sw(e,d);return e.wasm._free(h),e.wasm._free(y),e.makeOutput([f],"int32",p)}const Tq={kernelName:rh,backendName:"wasm",setupFunc:kq,kernelFunc:Eq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Xk;function Rq(t){Xk=t.wasm.cwrap(sh,"number",["number","number","number","number","number","bool"])}function Aq(t){const{backend:e,inputs:n,attrs:r}=t,{iouThreshold:s,maxOutputSize:a,scoreThreshold:o,padToMaxOutputSize:i}=r,{boxes:u,scores:c}=n,l=e.dataIdMap.get(u.dataId).id,d=e.dataIdMap.get(c.dataId).id,p=Xk(l,d,a,s,o,i),{pSelectedIndices:f,selectedSize:h,pSelectedScores:y,pValidOutputs:x}=Sw(e,p);e.wasm._free(y);const g=e.makeOutput([h],"int32",f),v=e.makeOutput([],"int32",x);return[g,v]}const Oq={kernelName:sh,backendName:"wasm",setupFunc:Rq,kernelFunc:Aq};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Yk;function Dq(t){Yk=t.wasm.cwrap(ah,"number",["number","number","number","number","number","number"])}function Pq(t){const{backend:e,inputs:n,attrs:r}=t,{iouThreshold:s,maxOutputSize:a,scoreThreshold:o,softNmsSigma:i}=r,{boxes:u,scores:c}=n,l=e.dataIdMap.get(u.dataId).id,d=e.dataIdMap.get(c.dataId).id,p=Yk(l,d,a,s,o,i),{pSelectedIndices:f,selectedSize:h,pSelectedScores:y,pValidOutputs:x}=Sw(e,p);e.wasm._free(x);const g=e.makeOutput([h],"int32",f),v=e.makeOutput([h],"float32",y);return[g,v]}const Fq={kernelName:ah,backendName:"wasm",setupFunc:Dq,kernelFunc:Pq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lq=!1,Mq=Tt(Xx,Lq,"bool");/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Qk;function Bq(t){Qk=t.wasm.cwrap(oh,null,["number","number","number","number","number"])}function Vq(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:a,depth:o,onValue:i,offValue:u}=r,c=n.makeOutput([...s.shape,o],a),l=n.dataIdMap.get(c.dataId).id,p=n.dataIdMap.get(s.dataId).id;return Qk(p,o,i,u,l),c}const zq={kernelName:oh,backendName:"wasm",setupFunc:Bq,kernelFunc:Vq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wq(t){const{inputs:{x:e},backend:n}=t,r=n.makeOutput(e.shape,e.dtype);return n.typedArrayFromHeap(r).fill(1),r}const Uq={kernelName:Yx,backendName:"wasm",kernelFunc:Wq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gq(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return Ry({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const a=e[0].shape,o=e[0].dtype;e.forEach(l=>{Yn(a,l.shape,"All tensors passed to stack must have matching shapes"),E(o===l.dtype,()=>"All tensors passed to stack must have matching dtypes")});const i=[],u=e.map(l=>{const d=Ry({inputs:{input:l},backend:n,attrs:{dim:s}});return i.push(d),d}),c=uk({inputs:u,backend:n,attrs:{axis:s}});return i.forEach(l=>n.disposeData(l.dataId)),c}const Hq={kernelName:Qx,backendName:"wasm",kernelFunc:Gq};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Zk;function jq(t){Zk=t.wasm.cwrap(ih,null,["number","array","number","number","array","array","number","number"])}function Kq(t){const{inputs:{x:e},backend:n,attrs:{paddings:r,constantValue:s}}=t,a=r.map((y,x)=>y[0]+e.shape[x]+y[1]);if(K(e.shape)===0)return $k({backend:n,attrs:{shape:a,value:s,dtype:e.dtype}});const o=n.dataIdMap.get(e.dataId).id,i=n.makeOutput(a,e.dtype),c=n.dataIdMap.get(i.dataId).id,l=new Uint8Array(new Int32Array(e.shape).buffer),d=r.map(y=>y[0]),p=r.map(y=>y[1]),f=new Uint8Array(new Int32Array(d).buffer),h=new Uint8Array(new Int32Array(p).buffer);return Zk(o,l,e.shape.length,Ue[e.dtype],f,h,s,c),i}const Jk={kernelName:ih,backendName:"wasm",kernelFunc:Kq,setupFunc:jq};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qq=Tt(Zx);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let eE;function Xq(t){eE=t.wasm.cwrap(uh,null,["number","number","number"])}function Yq(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e,a=n.dataIdMap.get(r.dataId).id,o=n.dataIdMap.get(s.dataId).id;let i=a;const u=r;let c=u;u.dtype!=="float32"&&(c=ro({backend:n,inputs:{x:r},attrs:{dtype:"float32"}}),i=n.dataIdMap.get(c.dataId).id);const l=n.makeOutput(r.shape,"float32"),d=n.dataIdMap.get(l.dataId).id;return eE(i,o,d),u.dtype!=="float32"&&n.disposeData(c.dataId),l}const Qq={kernelName:uh,backendName:"wasm",setupFunc:Xq,kernelFunc:Yq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let tE;function Zq(t){tE=t.wasm.cwrap(lh,null,["number","number","number","number"])}function Jq(t){const{backend:e,inputs:n,attrs:r}=t,{axis:s,keepDims:a}=r,{x:o}=n,i=e.dataIdMap.get(o.dataId).id;let u=i,c=o;const{transposed:l,axes:d,originalAxes:p,inputWasTransposed:f}=no(o,s,e);let h=d;if(f){const w=e.dataIdMap.get(l.dataId).id;w!==i&&(c=l,u=w,h=Xt(h.length,c.shape.length))}Dt("prod",h,c.shape.length);const[y,x]=an(c.shape,h),g=K(x),v=e.makeOutput(y,c.dtype);if(K(c.shape)!==0){const w=e.dataIdMap.get(v.dataId).id;tE(u,g,Ue[v.dtype],w)}if(f&&e.disposeData(l.dataId),a){const w=Ot(v.shape,p);v.shape=w}return v}const eX={kernelName:lh,backendName:"wasm",setupFunc:Zq,kernelFunc:Jq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tX=t=>{const{backend:e,attrs:n}=t,{start:r,stop:s,step:a,dtype:o}=n,i=ek(r,s,a,o),u=e.makeOutput([i.length],o);return e.typedArrayFromHeap(u).set(i),u},nX={kernelName:Jx,backendName:"wasm",kernelFunc:tX};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rX=Tt(yx);/**
 * @license
 * Copyright 2022 The TensorFlow Authors. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sX=ze(ev);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aX=ze(tv);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oX=ze(av);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let nE;function iX(t){nE=t.wasm.cwrap(dh,null,["number","number","number","number","number","number","number","number","number","number"])}function uX(t){const{backend:e,inputs:n,attrs:r}=t,{images:s}=n,{alignCorners:a,halfPixelCenters:o,size:i}=r,[u,c]=i,[l,d,p,f]=s.shape,h=[l,u,c,f];let y=e.dataIdMap.get(s.dataId),x;y.dtype!=="float32"&&(x=ro({backend:e,inputs:{x:s},attrs:{dtype:"float32"}}),y=e.dataIdMap.get(x.dataId));const g=y.id,v=e.makeOutput(h,"float32");if(K(s.shape)===0)return v;const w=e.dataIdMap.get(v.dataId).id;return nE(g,l,d,p,f,u,c,a?1:0,o?1:0,w),x!=null&&e.disposeData(x.dataId),v}const lX={kernelName:dh,backendName:"wasm",setupFunc:iX,kernelFunc:uX};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let rE;function cX(t){rE=t.wasm.cwrap(sv,null,["number","number","number","array","array","boolean"])}function dX(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:a}=e,{alignCorners:o}=r,i=n.makeOutput(s.shape,"float32");let u=n.dataIdMap.get(s.dataId),c;return u.dtype!=="float32"&&(c=ro({backend:n,inputs:{x:s},attrs:{dtype:"float32"}}),u=n.dataIdMap.get(c.dataId)),rE(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,new Uint8Array(new Int32Array(s.shape).buffer),new Uint8Array(new Int32Array(a.shape).buffer),o),c!=null&&n.disposeData(c.dataId),i}const pX={kernelName:sv,backendName:"wasm",setupFunc:cX,kernelFunc:dX};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let sE;function fX(t){sE=t.wasm.cwrap(ch,null,["number","number","number","number","number","number","number","number","number","number"])}function hX(t){const{backend:e,inputs:n,attrs:r}=t,{images:s}=n,{alignCorners:a,halfPixelCenters:o,size:i}=r,[u,c]=i,[l,d,p,f]=s.shape,h=[l,u,c,f],y=e.makeOutput(h,"float32");if(K(s.shape)===0)return y;let x=e.dataIdMap.get(s.dataId),g;x.dtype!=="float32"&&(g=ro({backend:e,inputs:{x:s},attrs:{dtype:"float32"}}),x=e.dataIdMap.get(g.dataId));const v=x.id,w=e.dataIdMap.get(y.dataId).id;return sE(v,l,d,p,f,u,c,a?1:0,o?1:0,w),g!=null&&e.disposeData(g.dataId),y}const mX={kernelName:ch,backendName:"wasm",setupFunc:fX,kernelFunc:hX};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let aE;function gX(t){aE=t.wasm.cwrap(rv,null,["number","number","number","array","array","boolean"])}function yX(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:a}=e,{alignCorners:o}=r,i=n.makeOutput(s.shape,"float32");let u=n.dataIdMap.get(s.dataId),c;return u.dtype!=="float32"&&(c=ro({backend:n,inputs:{x:s},attrs:{dtype:"float32"}}),u=n.dataIdMap.get(c.dataId)),aE(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,new Uint8Array(new Int32Array(s.shape).buffer),new Uint8Array(new Int32Array(a.shape).buffer),o),c!=null&&n.disposeData(c.dataId),i}const xX={kernelName:rv,backendName:"wasm",setupFunc:gX,kernelFunc:yX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let oE;function vX(t){oE=t.wasm.cwrap(ph,null,["number","array","number","array","number","number"])}function wX(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:a}=r,o=vt(a,s.shape);if(s.shape.length===0)return zh({inputs:{x:s},backend:n});const i=n.makeOutput(s.shape,s.dtype),u=n.dataIdMap.get(s.dataId).id,c=n.dataIdMap.get(i.dataId).id,l=new Uint8Array(new Int32Array(o).buffer),d=new Uint8Array(new Int32Array(s.shape).buffer);oE(u,l,o.length,d,s.shape.length,c);const p=Nn({inputs:{x:i},attrs:{shape:s.shape},backend:n});return n.disposeData(i.dataId),p}const bX={kernelName:ph,backendName:"wasm",kernelFunc:wX,setupFunc:vX};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let iE;function SX(t){iE=t.wasm.cwrap(Ih,null,["number","number","number","number","number","number","number","number","array","number","number"])}function CX(t){const{inputs:e,backend:n,attrs:r}=t,{image:s}=e,{radians:a,fillValue:o,center:i}=r,u=n.makeOutput(s.shape,s.dtype),c=n.dataIdMap.get(s.dataId).id,l=n.dataIdMap.get(u.dataId).id,[d,p,f,h]=s.shape,[y,x]=sw(i,p,f),g=o===0,v=255,w=typeof o=="number"?[o,o,o,g?0:v]:[...o,v],S=new Uint8Array(new Int32Array(w).buffer);return iE(c,d,p,f,h,a,y,x,S,w.length,l),u}const IX={kernelName:Ih,backendName:"wasm",kernelFunc:CX,setupFunc:SX};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $X=ze(ov);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _X=ze(iv);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let uE;function NX(t){uE=t.wasm.cwrap(fh,null,["number","number","number","number","number","number","array","number","number"])}function kX(t){const{backend:e,inputs:n,attrs:r}=t,{indices:s,updates:a}=n,{shape:o}=r,i=e.makeOutput(o,a.dtype);if(K(o)===0)return i;const{sliceRank:u,numUpdates:c,sliceSize:l,strides:d,outputSize:p}=ii(a,s,o),h=e.dataIdMap.get(s.dataId).id,x=e.dataIdMap.get(a.dataId).id,g=new Uint8Array(new Int32Array(d).buffer),v=e.dataIdMap.get(i.dataId).id;return uE(h,x,Ue[a.dtype],u,c,l,g,p,v),i}const EX={kernelName:fh,backendName:"wasm",setupFunc:NX,kernelFunc:kX};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let lE;function TX(t){lE=t.wasm.cwrap(mh,null,["number","number","number","number","number","number","bool","number"])}function RX(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:a}=e,{side:o}=r;if(s.dtype!==a.dtype)throw new Error(`SearchSorted error: sorted_sequence must have the same dtype as values. Got ${s.dtype} and ${a.dtype}`);const i=n.makeOutput(a.shape,"int32");function u(c){return n.dataIdMap.get(c.dataId).id}return lE(u(s),u(a),s.shape[0],s.shape[1],a.shape[1],Ue[s.dtype],o==="left",u(i)),i}const AX={kernelName:mh,backendName:"wasm",setupFunc:TX,kernelFunc:RX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let cE;function OX(t){cE=t.wasm.cwrap("SelectV2",null,["number","number","number","number","number"])}function DX(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:a}=e,o=n.dataIdMap.get(r.dataId).id,i=n.dataIdMap.get(s.dataId).id,u=n.dataIdMap.get(a.dataId).id,c=n.makeOutput(s.shape,s.dtype),l=n.dataIdMap.get(c.dataId).id,d=r.shape.length,p=s.shape.length,f=d===0||d>1||p===1?1:K(s.shape.slice(1));return cE(o,i,u,f,l),c}const PX={kernelName:uv,backendName:"wasm",kernelFunc:DX,setupFunc:OX};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FX=ze(lv);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let dE;function LX(t){dE=t.wasm.cwrap(hv,null,["number","number"])}function MX(t){const{backend:e,inputs:{x:n}}=t,r=e.dataIdMap.get(n.dataId).id,s=e.makeOutput(n.shape,n.dtype),a=e.dataIdMap.get(s.dataId).id;return K(s.shape)===0||dE(r,a),s}const BX={kernelName:"Sigmoid",backendName:"wasm",setupFunc:LX,kernelFunc:MX};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VX=ze(fv);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zX=ze(dv);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WX=ze(pv);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UX=ze(mv);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GX(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:a,paddings:o}=r,i=K(a),u=[[0,0]];u.push(...o);for(let k=1+a.length;k<s.shape.length;++k)u.push([0,0]);const c=Jk.kernelFunc({inputs:{x:s},backend:n,attrs:{paddings:u,constantValue:0}}),l=Mc(c.shape,a,i,!1),d=Bc(l.length,a.length,!1),p=Vc(c.shape,a,i,!1),y=Nn({inputs:{x:c},backend:n,attrs:{shape:l}}),v=Ka({inputs:{x:y},backend:n,attrs:{perm:d}}),$=Nn({inputs:{x:v},backend:n,attrs:{shape:p}});return n.disposeData(c.dataId),n.disposeData(y.dataId),n.disposeData(v.dataId),$}const HX={kernelName:yv,backendName:"wasm",kernelFunc:GX};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let pE;function jX(t){pE=t.wasm.cwrap("SparseFillEmptyRows","number",["number","number","number","number","number","number","number","number","number","number","number","number"])}function KX(t){const{backend:e,inputs:n}=t,{indices:r,values:s,denseShape:a,defaultValue:o}=n,i=r.shape[0],u=r.shape[1],c=e.readSync(a.dataId)[0],l=[i+c,u],d=e.dataIdMap.get(r.dataId).id,p=e.dataIdMap.get(s.dataId).id,f=e.dataIdMap.get(o.dataId).id,h=e.makeOutput(l,r.dtype),y=e.dataIdMap.get(h.dataId).id,x=e.makeOutput(l.slice(0,1),s.dtype),g=e.dataIdMap.get(x.dataId).id,v=e.makeOutput([c],"bool"),w=e.dataIdMap.get(v.dataId).id,S=e.makeOutput([i],r.dtype),$=e.dataIdMap.get(S.dataId).id,k=e.makeOutput([4],"int32"),T=e.dataIdMap.get(k.dataId).id,A=pE(d,p,Ue[s.dtype],i,c,u,f,y,g,w,$,T),B=e.readSync(k.dataId);let L;switch(B[0]){case 1:{L=uw(B[1]);break}case 2:{L=lw(B[1],B[2]);break}case 3:L=cw(B[1],B[2],B[3]);break;default:L=""}if(e.disposeData(k.dataId),L)throw e.disposeData(h.dataId),e.disposeData(x.dataId),e.disposeData(v.dataId),e.disposeData(S.dataId),new Error(L);let z=h,Y=x;return A!==l[0]&&(z=Zo({inputs:{x:h},attrs:{begin:0,size:[A,u]},backend:e}),Y=Zo({inputs:{x},attrs:{begin:0,size:A},backend:e}),e.disposeData(h.dataId),e.disposeData(x.dataId)),[z,Y,v,S]}const qX={kernelName:vv,backendName:"wasm",setupFunc:jX,kernelFunc:KX};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let fE;function XX(t){fE=t.wasm.cwrap(xh,null,["number","number","number","number","number","number","number"])}function YX(t){const{backend:e,inputs:n}=t,{inputIndices:r,inputShape:s,newShape:a}=n;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${s.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const o=e.dataIdMap.get(r.dataId).id,i=e.dataIdMap.get(s.dataId).id,u=e.dataIdMap.get(a.dataId).id,c=r.shape[0],l=K(a.shape),d=e.makeOutput([c,l],r.dtype),p=e.dataIdMap.get(d.dataId).id,f=e.makeOutput([l],a.dtype),h=e.dataIdMap.get(f.dataId).id,y=e.makeOutput([3],"int32"),x=e.dataIdMap.get(y.dataId).id;fE(o,i,u,c,p,h,x);const g=e.readSync(y.dataId);let v;switch(g[0]){case 0:{v=dw(g[1],g[2]);break}case 1:{v=pw(g[1],g[2]);break}case 2:v=fw();break;case 3:{const w=Array.from(e.readSync(s.dataId)),S=Array.from(e.readSync(f.dataId));v=hw(w,S);break}case 4:{const w=Array.from(e.readSync(s.dataId)),S=Array.from(e.readSync(f.dataId));v=mw(w,S);break}default:v=""}if(e.disposeData(y.dataId),v)throw e.disposeData(d.dataId),e.disposeData(f.dataId),new Error(v);return[d,f]}const QX={kernelName:xh,backendName:"wasm",setupFunc:XX,kernelFunc:YX};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let hE;function mE(t){hE=t.wasm.cwrap("SparseSegmentReduction",null,["number","number","number","number","number","number","number","number","number"])}function gE(t,e){const{backend:n,inputs:r}=t,{data:s,indices:a,segmentIds:o}=r,i=a.shape[0],u=n.readSync(o.dataId,i-1,i)[0],l=i>0?u+1:0;if(l<0)throw new Error(yc());const d=s.shape.slice();d[0]=l;const p=n.dataIdMap.get(s.dataId).id,f=n.dataIdMap.get(a.dataId).id,h=n.dataIdMap.get(o.dataId).id,y=n.makeOutput(d,s.dtype),x=n.dataIdMap.get(y.dataId).id,g=n.makeOutput([4],"int32"),v=n.dataIdMap.get(g.dataId).id;hE(p,Ue[s.dtype],s.shape[0],f,h,x,v,e,0);const w=n.readSync(g.dataId);let S;switch(w[0]){case 0:{S=yc();break}case 1:{S=gw();break}case 2:S=yw(w[1],w[2]);break;case 3:S=xw(w[1],w[2],w[3]);break;default:S=""}if(n.disposeData(g.dataId),S)throw n.disposeData(y.dataId),new Error(S);return y}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZX(t){return gE(t,!0)}const JX={kernelName:wv,backendName:"wasm",setupFunc:mE,kernelFunc:ZX};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e7(t){return gE(t,!1)}const t7={kernelName:bv,backendName:"wasm",setupFunc:mE,kernelFunc:e7};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let yE;function n7(t){yE=t.wasm.cwrap(vh,null,["number","number","number","number","number","number","number","number","array","number","number"])}function r7(t){const{backend:e,inputs:n,attrs:r}=t,{sparseIndices:s,sparseValues:a,defaultValue:o}=n,{outputShape:i}=r,u=e.makeOutput(i,o.dtype);if(K(i)===0)return u;const{sliceRank:c,numUpdates:l,sliceSize:d,strides:p,outputSize:f}=ii(a,s,i),h=e.dataIdMap.get(s.dataId).id,y=e.dataIdMap.get(a.dataId).id,x=e.dataIdMap.get(o.dataId).id,g=new Uint8Array(new Int32Array(p).buffer),v=e.dataIdMap.get(u.dataId).id;return yE(h,y,a.shape.length,x,Ue[o.dtype],c,l,d,g,f,v),u}const s7={kernelName:vh,backendName:"wasm",setupFunc:n7,kernelFunc:r7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a7(t){const{inputs:e,attrs:n,backend:r}=t,{x:s}=e,{numOrSizeSplits:a,axis:o}=n,i=vt(o,s.shape)[0],u=iw(s,a,i),c=new Array(s.shape.length).fill(0),l=s.shape.slice();return u.map(d=>{const p=[...l];p[i]=d;const f=Zo({inputs:{x:s},attrs:{begin:c,size:p},backend:r});return c[i]+=d,f})}const o7={kernelName:xv,backendName:"wasm",kernelFunc:a7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i7=ze(gv);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u7=ze(S$);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l7=Tt(Sv);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let xE;function c7(t){xE=t.wasm.cwrap(Ch,null,["number","number","number","number"])}function d7(t){const{backend:e,inputs:n,attrs:r}=t,{alpha:s}=r,{x:a}=n,o=e.dataIdMap.get(a.dataId).id,i=e.makeOutput(a.shape,a.dtype),u=e.dataIdMap.get(i.dataId).id;return xE(o,s,Ue[a.dtype],u),i}const p7={kernelName:Ch,backendName:"wasm",setupFunc:c7,kernelFunc:d7};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let vE;function f7(t){vE=t.wasm.cwrap(wh,null,["number","array","number","array","array","array","array","array","number","number"])}function h7(t){const{backend:e,inputs:n,attrs:r}=t,{x:s}=n,{begin:a,end:o,strides:i,beginMask:u,endMask:c,ellipsisMask:l,newAxisMask:d,shrinkAxisMask:p}=r,{finalShapeSparse:f,finalShape:h,isIdentity:y,sliceDim0:x,isSimpleSlice:g,begin:v,end:w,strides:S}=tw(s.shape,a,o,i,u,c,l,d,p);let $;if(y)$=Nn({inputs:{x:s},backend:e,attrs:{shape:h}});else if(x||g){E(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const k=Jv(v,w,S),T=Zo({inputs:{x:s},backend:e,attrs:{begin:v,size:k}});$=Nn({inputs:{x:T},backend:e,attrs:{shape:h}}),e.disposeData(T.dataId)}else{const k=e.makeOutput(f,"float32"),T=e.dataIdMap.get(s.dataId).id,A=new Uint8Array(new Int32Array(Ye(s.shape)).buffer),B=new Uint8Array(new Int32Array(v).buffer),L=new Uint8Array(new Int32Array(w).buffer),z=new Uint8Array(new Int32Array(S).buffer),Y=new Uint8Array(new Int32Array(f).buffer),Q=new Uint8Array(new Int32Array(Ye(f)).buffer),re=e.dataIdMap.get(k.dataId).id;vE(T,A,s.shape.length,B,L,z,Y,Q,f.length,re),$=Nn({inputs:{x:k},backend:e,attrs:{shape:h}}),e.disposeData(k.dataId)}return $}const m7={kernelName:wh,backendName:"wasm",setupFunc:f7,kernelFunc:h7};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g7(t){const{backend:e,inputs:n,attrs:r}=t,{data:s,dataSplits:a}=n,{separator:o,nGramWidths:i,leftPad:u,rightPad:c,padWidth:l,preserveShortSequences:d}=r,p=e.readSync(s.dataId),f=e.readSync(a.dataId),[h,y]=tk(p,f,o,i,u,c,l,d),x=e.makeOutput([h.length],"string"),g=e.dataIdMap.get(x.dataId);g.stringBytes=h;const v=e.makeOutput(a.shape,"int32");return e.typedArrayFromHeap(v).set(y),[x,v]}const y7={kernelName:Cv,backendName:"wasm",kernelFunc:g7};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x7(t){const{backend:e,inputs:n,attrs:r}=t,{input:s,delimiter:a}=n,{skipEmpty:o}=r,i=e.readSync(s.dataId),u=e.readSync(a.dataId),[c,l,d]=nk(i,u[0],o),p=l.length,f=e.makeOutput([p,2],"int32");e.typedArrayFromHeap(f).set(c);const y=e.makeOutput([p],"string"),x=e.dataIdMap.get(y.dataId);x.stringBytes=l;const g=e.makeOutput([2],"int32");return e.typedArrayFromHeap(g).set(d),[f,y,g]}const v7={kernelName:Iv,backendName:"wasm",kernelFunc:x7};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w7(t){const{backend:e,inputs:n,attrs:r}=t,{input:s}=n,{numBuckets:a}=r,o=e.readSync(s.dataId),i=rk(o,a),u=e.makeOutput(s.shape,"int32");return e.typedArrayFromHeap(u).set(i),u}const b7={kernelName:$v,backendName:"wasm",kernelFunc:w7};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S7=Tt(_v);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let wE;function C7(t){wE=t.wasm.cwrap(gh,null,["number","number","number","number"])}function I7(t){const{backend:e,inputs:n,attrs:r}=t,{axis:s,keepDims:a}=r,{x:o}=n,i=e.dataIdMap.get(o.dataId).id;let u=i,c=o;const{transposed:l,axes:d,originalAxes:p,inputWasTransposed:f}=no(o,s,e);let h=d;if(f){const w=e.dataIdMap.get(l.dataId).id;w!==i&&(c=l,u=w,h=Xt(h.length,c.shape.length))}Dt("sum",h,c.shape.length);const[y,x]=an(c.shape,h),g=K(x),v=e.makeOutput(y,c.dtype);if(K(c.shape)!==0){const w=e.dataIdMap.get(v.dataId).id;wE(u,g,Ue[v.dtype],w)}if(f&&e.disposeData(l.dataId),a){const w=Ot(v.shape,p);v.shape=w}return v}const $7={kernelName:gh,backendName:"wasm",setupFunc:C7,kernelFunc:I7};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _7=ze(Nv);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N7=ze(kv);/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let bE;function k7(t){bE=t.wasm.cwrap(hh,null,["number","number","number","number","number","number","array","number","number","number"])}function E7(t){const{backend:e,inputs:n,attrs:r}=t,{tensor:s,indices:a,updates:o}=n,i=e.makeOutput(s.shape,s.dtype);if(K(s.shape)===0)return i;const{sliceRank:u,numUpdates:c,sliceSize:l,strides:d,outputSize:p}=ii(o,a,s.shape),h=e.dataIdMap.get(a.dataId).id,x=e.dataIdMap.get(o.dataId).id,v=e.dataIdMap.get(s.dataId).id,w=new Uint8Array(new Int32Array(d).buffer),S=e.dataIdMap.get(i.dataId).id;return bE(h,x,Ue[o.dtype],u,c,l,w,p,S,v),i}const T7={kernelName:hh,backendName:"wasm",setupFunc:k7,kernelFunc:E7};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let SE;function R7(t){SE=t.wasm.cwrap(Ac,null,["number","array","number","array","number","number"])}function A7(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,a=n.dataIdMap.get(s.dataId).id,{reps:o}=r,i=new Array(s.shape.length);for(let p=0;p<i.length;p++)i[p]=s.shape[p]*o[p];const u=new Uint8Array(new Int32Array(s.shape).buffer),c=new Uint8Array(new Int32Array(i).buffer),l=n.makeOutput(i,s.dtype),d=n.dataIdMap.get(l.dataId).id;return SE(a,u,s.shape.length,c,i.length,Ue[l.dtype],d),l}const O7={kernelName:Ac,backendName:"wasm",setupFunc:R7,kernelFunc:A7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let CE;function D7(t){CE=t.wasm.cwrap(bh,null,["number","array","number","number","number","bool","number","number"])}const P7=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{k:s,sorted:a}=n,o=e.dataIdMap.get(r.dataId).id,i=new Uint8Array(new Int32Array(r.shape).buffer),u=r.shape.slice();u[u.length-1]=s;const c=e.makeOutput(u,r.dtype),l=e.dataIdMap.get(c.dataId).id,d=e.makeOutput(u,"int32"),p=e.dataIdMap.get(d.dataId).id;return CE(o,i,r.shape.length,Ue[r.dtype],s,a,l,p),[c,d]},F7={kernelName:bh,backendName:"wasm",setupFunc:D7,kernelFunc:P7};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let IE;function L7(t){IE=t.wasm.cwrap(Sh,null,["number","number","bool","number","number","number","number","number","number","array","number","array","number","number","number","number","number"])}function M7(t){const{backend:e,inputs:n,attrs:r}=t,{image:s,transforms:a}=n,{interpolation:o,fillMode:i,fillValue:u,outputShape:c}=r,[l,d,p,f]=s.shape,[h,y]=c??[d,p],x=[l,h,y,f],g=new Uint8Array(new Int32Array(Ye(s.shape)).buffer),v=new Uint8Array(new Int32Array(Ye(x)).buffer),w=e.makeOutput(x,s.dtype),S=e.dataIdMap.get(w.dataId).id,k=e.dataIdMap.get(s.dataId).id,A=e.dataIdMap.get(a.dataId).id,B=o==="nearest"?1:2;let L;switch(i){case"constant":L=1;break;case"reflect":L=2;break;case"wrap":L=3;break;case"nearest":L=4;break;default:L=1;break}return IE(k,A,a.shape[0]>1,l,h,y,f,p,d,g,s.shape.length-1,v,x.length-1,B,L,u,S),w}const B7={kernelName:Sh,backendName:"wasm",setupFunc:L7,kernelFunc:M7};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V7(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:a}=e,{outputValues:o,outputShape:i,indices:u}=ak(r.readSync(a.dataId),s,a.shape,a.dtype);return[r.makeOutput(i,a.dtype,void 0,o),r.makeOutput([u.length],"int32",void 0,u)]}const z7={kernelName:Ev,backendName:"wasm",kernelFunc:V7};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W7(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:a}=r;a<0&&(a+=s.shape.length);const o=s.shape[a],i=s.shape.length,u=new Array(i-1);let c=0;for(let f=0;f<i;f++)f!==a&&(u[c++]=s.shape[f]);const l=new Array(o),d=new Array(i).fill(0),p=s.shape.slice();p[a]=1;for(let f=0;f<l.length;f++)d[a]=f,l[f]=Zo({inputs:{x:s},attrs:{begin:d,size:p},backend:n});return l.map(({dataId:f,dtype:h})=>({dataId:f,dtype:h,shape:u}))}const U7={kernelName:Tv,backendName:"wasm",kernelFunc:W7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G7(t){const{inputs:{x:e},backend:n}=t,r=n.makeOutput(e.shape,e.dtype);return n.typedArrayFromHeap(r).fill(0),r}const H7={kernelName:Rv,backendName:"wasm",kernelFunc:G7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j7=[Bj,Vj,zj,Wj,Uj,jj,e6,r6,s6,a6,o6,i6,u6,l6,c6,f6,S6,g6,v6,_6,T8,O8,D8,F8,L8,M8,z8,W8,H8,q8,Q8,e5,r5,s5,a5,u5,d5,h5,y5,w5,C5,_5,E5,A5,P5,F5,B5,z5,W5,U5,G5,H5,j5,X5,Y5,Q5,eK,rK,oK,lK,pK,hK,gK,Kj,yK,xK,vK,SK,IK,_K,EK,RK,TK,OK,DK,FK,MK,zK,GK,KK,qK,QK,eq,rq,oq,lq,pq,mq,gq,vq,Iq,$q,_q,Nq,Tq,Oq,Fq,Mq,zq,Uq,Hq,Jk,qq,Qq,eX,nX,rX,sX,aX,oX,C6,lX,pX,mX,xX,bX,IX,$X,_X,EX,AX,PX,FX,BX,VX,zX,WX,k8,bq,UX,HX,qX,QX,JX,t7,s7,o7,i7,u7,l7,p7,m7,y7,v7,b7,S7,$7,_7,N7,T7,O7,F7,B7,Qj,z7,U7,H7];for(const t of j7)$$(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oy=U();Oy.registerFlag("WASM_HAS_SIMD_SUPPORT",async()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]))}catch{return!1}});Oy.registerFlag("WASM_HAS_MULTITHREAD_SUPPORT",async()=>{if(Oy.get("IS_NODE"))return!1;try{return new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}});var $E={exports:{}};(function(t,e){var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),function(s){s=s||{};function a(){return j.buffer!=rt&&Qe(j.buffer),Dn}function o(){return j.buffer!=rt&&Qe(j.buffer),zr}function i(){return j.buffer!=rt&&Qe(j.buffer),Zn}function u(){return j.buffer!=rt&&Qe(j.buffer),mr}function c(){return j.buffer!=rt&&Qe(j.buffer),Xe}var l=typeof s<"u"?s:{},d,p;l.ready=new Promise(function(D,W){d=D,p=W});var f;typeof process<"u"&&process.listeners&&(f={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var h=Object.assign({},l),y=(D,W)=>{throw W},x=typeof window=="object",g=typeof importScripts=="function",v=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",w=l.ENVIRONMENT_IS_PTHREAD||!1,S="";function $(D){return l.locateFile?l.locateFile(D,S):S+D}var k,T,A;function B(D){if(D instanceof bn)return;Z("exiting due to exception: "+D)}if(v){var L=Sa,z=Sa;g?S=z.dirname(S)+"/":S=__dirname+"/",k=(W,se)=>(W=hs(W)?new URL(W):z.normalize(W),L.readFileSync(W,se?void 0:"utf8")),A=W=>{var se=k(W,!0);return se.buffer||(se=new Uint8Array(se)),se},T=(W,se,Ce)=>{W=hs(W)?new URL(W):z.normalize(W),L.readFile(W,function($e,ke){$e?Ce($e):se(ke.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(W){if(!(W instanceof bn))throw W}),process.on("unhandledRejection",function(W){throw W}),y=(W,se)=>{if(As())throw process.exitCode=W,se;B(se),process.exit(W)},l.inspect=function(){return"[Emscripten Module object]"};let D;try{D=Sa}catch(W){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),W}qn.Worker=D.Worker}else(x||g)&&(g?S=self.location.href:typeof document<"u"&&document.currentScript&&(S=document.currentScript.src),typeof r<"u"&&r&&(S=r),S.indexOf("blob:")!==0?S=S.substr(0,S.replace(/[?#].*/,"").lastIndexOf("/")+1):S="",v||(k=D=>{var W=new XMLHttpRequest;return W.open("GET",D,!1),W.send(null),W.responseText},g&&(A=D=>{var W=new XMLHttpRequest;return W.open("GET",D,!1),W.responseType="arraybuffer",W.send(null),new Uint8Array(W.response)}),T=(D,W,se)=>{var Ce=new XMLHttpRequest;Ce.open("GET",D,!0),Ce.responseType="arraybuffer",Ce.onload=()=>{if(Ce.status==200||Ce.status==0&&Ce.response){W(Ce.response);return}se()},Ce.onerror=se,Ce.send(null)}));v&&typeof performance>"u"&&(qn.performance=Sa.performance);var Y=console.log.bind(console),Q=console.warn.bind(console);v&&(Y=D=>L.writeSync(1,D+`
`),Q=D=>L.writeSync(2,D+`
`));var re=l.print||Y,Z=l.printErr||Q;Object.assign(l,h),h=null,l.arguments&&l.arguments,l.thisProgram&&l.thisProgram,l.quit&&(y=l.quit);var de;l.wasmBinary&&(de=l.wasmBinary);var ce=l.noExitRuntime||!0;typeof WebAssembly!="object"&&fs("no native wasm support detected");var j,ee,me=!1,Ie;function Pe(D,W){D||fs(W)}var Ge=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function _t(D,W,se){W>>>=0;for(var Ce=W+se,$e=W;D[$e]&&!($e>=Ce);)++$e;if($e-W>16&&D.buffer&&Ge)return Ge.decode(D.buffer instanceof SharedArrayBuffer?D.slice(W,$e):D.subarray(W,$e));for(var ke="";W<$e;){var pe=D[W++];if(!(pe&128)){ke+=String.fromCharCode(pe);continue}var ye=D[W++]&63;if((pe&224)==192){ke+=String.fromCharCode((pe&31)<<6|ye);continue}var Be=D[W++]&63;if((pe&240)==224?pe=(pe&15)<<12|ye<<6|Be:pe=(pe&7)<<18|ye<<12|Be<<6|D[W++]&63,pe<65536)ke+=String.fromCharCode(pe);else{var Cn=pe-65536;ke+=String.fromCharCode(55296|Cn>>10,56320|Cn&1023)}}return ke}function Pt(D,W){return D>>>=0,D?_t(o(),D,W):""}function Nt(D,W,se,Ce){if(se>>>=0,!(Ce>0))return 0;for(var $e=se,ke=se+Ce-1,pe=0;pe<D.length;++pe){var ye=D.charCodeAt(pe);if(ye>=55296&&ye<=57343){var Be=D.charCodeAt(++pe);ye=65536+((ye&1023)<<10)|Be&1023}if(ye<=127){if(se>=ke)break;W[se++>>>0]=ye}else if(ye<=2047){if(se+1>=ke)break;W[se++>>>0]=192|ye>>6,W[se++>>>0]=128|ye&63}else if(ye<=65535){if(se+2>=ke)break;W[se++>>>0]=224|ye>>12,W[se++>>>0]=128|ye>>6&63,W[se++>>>0]=128|ye&63}else{if(se+3>=ke)break;W[se++>>>0]=240|ye>>18,W[se++>>>0]=128|ye>>12&63,W[se++>>>0]=128|ye>>6&63,W[se++>>>0]=128|ye&63}}return W[se>>>0]=0,se-$e}function wn(D,W,se){return Nt(D,o(),W,se)}var rt,Dn,zr,Zn,mr,Xe;w&&(rt=l.buffer);function Qe(D){rt=D,l.HEAP8=Dn=new Int8Array(D),l.HEAP16=new Int16Array(D),l.HEAP32=Zn=new Int32Array(D),l.HEAPU8=zr=new Uint8Array(D),l.HEAPU16=new Uint16Array(D),l.HEAPU32=mr=new Uint32Array(D),l.HEAPF32=new Float32Array(D),l.HEAPF64=Xe=new Float64Array(D)}var gr=l.INITIAL_MEMORY||16777216;if(w)j=l.wasmMemory,rt=l.buffer;else if(l.wasmMemory)j=l.wasmMemory;else if(j=new WebAssembly.Memory({initial:gr/65536,maximum:65536,shared:!0}),!(j.buffer instanceof SharedArrayBuffer))throw Z("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),v&&Z("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");j&&(rt=j.buffer),gr=rt.byteLength,Qe(rt);var kt,ps=[],Rs=[],yr=[];function As(){return ce}function la(){if(l.preRun)for(typeof l.preRun=="function"&&(l.preRun=[l.preRun]);l.preRun.length;)Wr(l.preRun.shift());Ze(ps)}function ca(){w||Ze(Rs)}function ao(){if(!w){if(l.postRun)for(typeof l.postRun=="function"&&(l.postRun=[l.postRun]);l.postRun.length;)da(l.postRun.shift());Ze(yr)}}function Wr(D){ps.unshift(D)}function hi(D){Rs.unshift(D)}function da(D){yr.unshift(D)}var Jn=0,Os=null;function mi(D){Jn++,l.monitorRunDependencies&&l.monitorRunDependencies(Jn)}function Gu(D){if(Jn--,l.monitorRunDependencies&&l.monitorRunDependencies(Jn),Jn==0&&Os){var W=Os;Os=null,W()}}function fs(D){l.onAbort&&l.onAbort(D),D="Aborted("+D+")",Z(D),me=!0,Ie=1,D+=". Build with -sASSERTIONS for more info.";var W=new WebAssembly.RuntimeError(D);throw p(W),W}var gi="data:application/octet-stream;base64,";function Ur(D){return D.startsWith(gi)}function hs(D){return D.startsWith("file://")}var Ft;Ft="tfjs-backend-wasm-threaded-simd.wasm",Ur(Ft)||(Ft=$(Ft));function yi(D){try{if(D==Ft&&de)return new Uint8Array(de);if(A)return A(D);throw"both async and sync fetching of the wasm failed"}catch(W){fs(W)}}function oo(){if(!de&&(x||g)){if(typeof fetch=="function"&&!hs(Ft))return fetch(Ft,{credentials:"same-origin"}).then(function(D){if(!D.ok)throw"failed to load wasm binary file at '"+Ft+"'";return D.arrayBuffer()}).catch(function(){return yi(Ft)});if(T)return new Promise(function(D,W){T(Ft,function(se){D(new Uint8Array(se))},W)})}return Promise.resolve().then(function(){return yi(Ft)})}function pa(){var D={env:Qu,wasi_snapshot_preview1:Qu};function W(pe,ye){var Be=pe.exports;if(l.asm=Be,qe(l.asm._emscripten_tls_init),kt=l.asm.__indirect_function_table,hi(l.asm.__wasm_call_ctors),ee=ye,!w){var Cn=oe.unusedWorkers.length;oe.unusedWorkers.forEach(function(jr){oe.loadWasmModuleToWorker(jr,function(){--Cn||Gu()})})}}w||mi();function se(pe){W(pe.instance,pe.module)}function Ce(pe){return oo().then(function(ye){return WebAssembly.instantiate(ye,D)}).then(function(ye){return ye}).then(pe,function(ye){Z("failed to asynchronously prepare wasm: "+ye),fs(ye)})}function $e(){return!de&&typeof WebAssembly.instantiateStreaming=="function"&&!Ur(Ft)&&!hs(Ft)&&!v&&typeof fetch=="function"?fetch(Ft,{credentials:"same-origin"}).then(function(pe){var ye=WebAssembly.instantiateStreaming(pe,D);return ye.then(se,function(Be){return Z("wasm streaming compile failed: "+Be),Z("falling back to ArrayBuffer instantiation"),Ce(se)})}):Ce(se)}if(l.instantiateWasm)try{var ke=l.instantiateWasm(D,W);return ke}catch(pe){Z("Module.instantiateWasm callback failed with error: "+pe),p(pe)}return $e().catch(p),{}}var xr={};function bn(D){this.name="ExitStatus",this.message="Program terminated with exit("+D+")",this.status=D}function Ds(D){var W=oe.pthreads[D];delete oe.pthreads[D],W.terminate(),$i(D),oe.runningWorkers.splice(oe.runningWorkers.indexOf(W),1),W.pthread_ptr=0}function io(D){var W=oe.pthreads[D];W.postMessage({cmd:"cancel"})}function Gr(D){var W=oe.pthreads[D];Pe(W),oe.returnWorkerToPool(W)}function ms(D){var W=oe.getNewWorker();if(!W)return 6;oe.runningWorkers.push(W),oe.pthreads[D.pthread_ptr]=W,W.pthread_ptr=D.pthread_ptr;var se={cmd:"run",start_routine:D.startRoutine,arg:D.arg,pthread_ptr:D.pthread_ptr};return W.runPthread=()=>{v&&W.ref(),W.postMessage(se,D.transferList),delete W.runPthread},W.loaded&&W.runPthread(),0}function vr(D){if(w)return Hr(1,1,D);Ie=D,As()||(oe.terminateAllThreads(),l.onExit&&l.onExit(D),me=!0),y(D,new bn(D))}function q(D,W){if(Ie=D,!W&&w)throw Te(D),"unwind";vr(D)}var te=q;function ve(D){if(D instanceof bn||D=="unwind")return Ie;y(1,D)}var oe={unusedWorkers:[],runningWorkers:[],tlsInitFunctions:[],pthreads:{},init:function(){w?oe.initWorker():oe.initMainThread()},initMainThread:function(){for(var D=8;D--;)oe.allocateUnusedWorker()},initWorker:function(){ce=!1},setExitStatus:function(D){Ie=D},terminateAllThreads:function(){for(var D of Object.values(oe.pthreads))oe.returnWorkerToPool(D);for(var D of oe.unusedWorkers)D.terminate();oe.unusedWorkers=[]},returnWorkerToPool:function(D){var W=D.pthread_ptr;delete oe.pthreads[W],oe.unusedWorkers.push(D),oe.runningWorkers.splice(oe.runningWorkers.indexOf(D),1),D.pthread_ptr=0,v&&D.unref(),$i(W)},receiveObjectTransfer:function(D){},threadInitTLS:function(){oe.tlsInitFunctions.forEach(D=>D())},loadWasmModuleToWorker:function(D,W){D.onmessage=ke=>{var pe=ke.data,ye=pe.cmd;if(D.pthread_ptr&&(oe.currentProxiedOperationCallerThread=D.pthread_ptr),pe.targetThread&&pe.targetThread!=co()){var Be=oe.pthreads[pe.targetThread];Be?Be.postMessage(pe,pe.transferList):Z('Internal error! Worker sent a message "'+ye+'" to target pthread '+pe.targetThread+", but that thread no longer exists!"),oe.currentProxiedOperationCallerThread=void 0;return}ye==="processProxyingQueue"?vi(pe.queue):ye==="spawnThread"?ms(pe):ye==="cleanupThread"?Gr(pe.thread):ye==="killThread"?Ds(pe.thread):ye==="cancelThread"?io(pe.thread):ye==="loaded"?(D.loaded=!0,v&&D.unref(),W&&W(D),D.runPthread&&D.runPthread()):ye==="print"?re("Thread "+pe.threadId+": "+pe.text):ye==="printErr"?Z("Thread "+pe.threadId+": "+pe.text):ye==="alert"?alert("Thread "+pe.threadId+": "+pe.text):pe.target==="setimmediate"?D.postMessage(pe):ye==="callHandler"?l[pe.handler](...pe.args):ye&&Z("worker sent an unknown command "+ye),oe.currentProxiedOperationCallerThread=void 0},D.onerror=ke=>{var pe="worker sent an error!";throw Z(pe+" "+ke.filename+":"+ke.lineno+": "+ke.message),ke},v&&(D.on("message",function(ke){D.onmessage({data:ke})}),D.on("error",function(ke){D.onerror(ke)}),D.on("detachedExit",function(){}));var se=[],Ce=["onExit","onAbort","print","printErr"];for(var $e of Ce)l.hasOwnProperty($e)&&se.push($e);D.postMessage({cmd:"load",handlers:se,urlOrBlob:l.mainScriptUrlOrBlob||r,wasmMemory:j,wasmModule:ee})},allocateUnusedWorker:function(){var D,W=$("tfjs-backend-wasm-threaded-simd.worker.js");D=new Worker(W),oe.unusedWorkers.push(D)},getNewWorker:function(){return oe.unusedWorkers.length==0&&(oe.allocateUnusedWorker(),oe.loadWasmModuleToWorker(oe.unusedWorkers[0])),oe.unusedWorkers.pop()}};l.PThread=oe;function Ze(D){for(;D.length>0;)D.shift()(l)}function je(){var D=co(),W=i()[D+52>>>2],se=i()[D+56>>>2],Ce=W-se;Ju(W,Ce),gs(W)}l.establishStackSpace=je;function Te(D){if(w)return Hr(2,0,D);try{te(D)}catch(W){ve(W)}}var Se=[];function Je(D){var W=Se[D];return W||(D>=Se.length&&(Se.length=D+1),Se[D]=W=kt.get(D)),W}function un(D,W){var se=Je(D)(W);As()?oe.setExitStatus(se):po(se)}l.invokeEntryPoint=un;function qe(D){oe.tlsInitFunctions.push(D)}function Sn(D){td(D,!g,1,!x),oe.threadInitTLS()}function Ps(D){w?postMessage({cmd:"cleanupThread",thread:D}):Gr(D)}function xi(D,W,se,Ce){return w?Hr(3,1,D,W,se,Ce):It(D,W,se,Ce)}function It(D,W,se,Ce){if(typeof SharedArrayBuffer>"u")return Z("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var $e=[],ke=0;if(w&&($e.length===0||ke))return xi(D,W,se,Ce);var pe={startRoutine:se,pthread_ptr:D,arg:Ce,transferList:$e};return w?(pe.cmd="spawnThread",postMessage(pe,$e),0):ms(pe)}function wr(){return 65536}var Fs=!0;function uo(){return Fs}function vi(D){Atomics.store(i(),D>>2,1),co()&&Zu(D),Atomics.compareExchange(i(),D>>2,1,0)}l.executeNotifiedProxyingQueue=vi;function Hu(D,W,se,Ce){if(D==W)setTimeout(()=>vi(Ce));else if(w)postMessage({targetThread:D,cmd:"processProxyingQueue",queue:Ce});else{var $e=oe.pthreads[D];if(!$e)return;$e.postMessage({cmd:"processProxyingQueue",queue:Ce})}return 1}function ju(D,W,se){return-1}function jc(){fs("")}function Zt(D){Zt.shown||(Zt.shown={}),Zt.shown[D]||(Zt.shown[D]=1,v&&(D="warning: "+D),Z(D))}function br(){v||g||Zt("Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread")}function lo(){return Date.now()}function wi(){return 4294901760}function Ku(){return wi()}var bi;v?bi=()=>{var D=process.hrtime();return D[0]*1e3+D[1]/1e6}:bi=()=>performance.timeOrigin+performance.now();function Si(D,W,se){o().copyWithin(D>>>0,W>>>0,W+se>>>0)}function Sr(){return v?Sa.cpus().length:navigator.hardwareConcurrency}function Kc(D){var W=_i(),se=D();return gs(W),se}function Hr(D,W){var se=arguments.length-2,Ce=arguments;return Kc(()=>{for(var $e=se,ke=Ni($e*8),pe=ke>>3,ye=0;ye<se;ye++){var Be=Ce[2+ye];c()[pe+ye>>>0]=Be}return nd(D,$e,ke,W)})}var Pn=[];function Ci(D,W,se){Pn.length=W;for(var Ce=se>>3,$e=0;$e<W;$e++)Pn[$e]=c()[Ce+$e>>>0];var ke=D<0,pe=ke?xr[-D-1]:Ii[D];return pe.apply(null,Pn)}function Xh(D){try{return j.grow(D-rt.byteLength+65535>>>16),Qe(j.buffer),1}catch{}}function qc(D){var W=o().length;if(D=D>>>0,D<=W)return!1;var se=wi();if(D>se)return!1;let Ce=(Be,Cn)=>Be+(Cn-Be%Cn)%Cn;for(var $e=1;$e<=4;$e*=2){var ke=W*(1+.2/$e);ke=Math.min(ke,D+100663296);var pe=Math.min(se,Ce(Math.max(D,ke),65536)),ye=Xh(pe);if(ye)return!0}return!1}function qu(){throw"unwind"}function Xc(D){return w?Hr(4,1,D):52}function Yc(D,W,se,Ce,$e){return w?Hr(5,1,D,W,se,Ce,$e):70}var Qc=[null,[],[]];function Zc(D,W){var se=Qc[D];W===0||W===10?((D===1?re:Z)(_t(se,0)),se.length=0):se.push(W)}function Xu(D,W,se,Ce){if(w)return Hr(6,1,D,W,se,Ce);for(var $e=0,ke=0;ke<se;ke++){var pe=u()[W>>>2],ye=u()[W+4>>>2];W+=8;for(var Be=0;Be<ye;Be++)Zc(D,o()[pe+Be>>>0]);$e+=ye}return u()[Ce>>>2]=$e,0}function Yu(D){var W=l["_"+D];return W}function ln(D,W){a().set(D,W>>>0)}function Jc(D,W,se,Ce,$e){var ke={string:zt=>{var er=0;if(zt!=null&&zt!==0){var nl=(zt.length<<2)+1;er=Ni(nl),wn(zt,er,nl)}return er},array:zt=>{var er=Ni(zt.length);return ln(zt,er),er}};function pe(zt){return W==="string"?Pt(zt):W==="boolean"?!!zt:zt}var ye=Yu(D),Be=[],Cn=0;if(Ce)for(var jr=0;jr<Ce.length;jr++){var el=ke[se[jr]];el?(Cn===0&&(Cn=_i()),Be[jr]=el(Ce[jr])):Be[jr]=Ce[jr]}var Ti=ye.apply(null,Be);function tl(zt){return Cn!==0&&gs(Cn),pe(zt)}return Ti=tl(Ti),Ti}function ed(D,W,se,Ce){se=se||[];var $e=se.every(pe=>pe==="number"||pe==="boolean"),ke=W!=="string";return ke&&$e&&!Ce?Yu(D):function(){return Jc(D,W,se,arguments)}}oe.init();var Ii=[null,vr,Te,xi,Xc,Yc,Xu],Qu={__emscripten_init_main_thread_js:Sn,__emscripten_thread_cleanup:Ps,__pthread_create_js:It,_emscripten_default_pthread_stack_size:wr,_emscripten_get_now_is_monotonic:uo,_emscripten_notify_task_queue:Hu,_emscripten_set_offscreencanvas_size:ju,abort:jc,emscripten_check_blocking_allowed:br,emscripten_date_now:lo,emscripten_get_heap_max:Ku,emscripten_get_now:bi,emscripten_memcpy_big:Si,emscripten_num_logical_cores:Sr,emscripten_receive_on_main_thread_js:Ci,emscripten_resize_heap:qc,emscripten_unwind_to_js_event_loop:qu,exit:te,fd_close:Xc,fd_seek:Yc,fd_write:Xu,memory:j||l.wasmMemory};pa(),l.___wasm_call_ctors=function(){return(l.___wasm_call_ctors=l.asm.__wasm_call_ctors).apply(null,arguments)},l._init=function(){return(l._init=l.asm.init).apply(null,arguments)},l._init_with_threads_count=function(){return(l._init_with_threads_count=l.asm.init_with_threads_count).apply(null,arguments)},l._get_threads_count=function(){return(l._get_threads_count=l.asm.get_threads_count).apply(null,arguments)},l._register_tensor=function(){return(l._register_tensor=l.asm.register_tensor).apply(null,arguments)},l._dispose_data=function(){return(l._dispose_data=l.asm.dispose_data).apply(null,arguments)},l._dispose=function(){return(l._dispose=l.asm.dispose).apply(null,arguments)},l._Abs=function(){return(l._Abs=l.asm.Abs).apply(null,arguments)},l._Acos=function(){return(l._Acos=l.asm.Acos).apply(null,arguments)},l._Acosh=function(){return(l._Acosh=l.asm.Acosh).apply(null,arguments)},l._Add=function(){return(l._Add=l.asm.Add).apply(null,arguments)},l._AddN=function(){return(l._AddN=l.asm.AddN).apply(null,arguments)},l._All=function(){return(l._All=l.asm.All).apply(null,arguments)},l._Any=function(){return(l._Any=l.asm.Any).apply(null,arguments)},l._ArgMax=function(){return(l._ArgMax=l.asm.ArgMax).apply(null,arguments)},l._ArgMin=function(){return(l._ArgMin=l.asm.ArgMin).apply(null,arguments)},l._Asin=function(){return(l._Asin=l.asm.Asin).apply(null,arguments)},l._Asinh=function(){return(l._Asinh=l.asm.Asinh).apply(null,arguments)},l._Atan=function(){return(l._Atan=l.asm.Atan).apply(null,arguments)},l._Atan2=function(){return(l._Atan2=l.asm.Atan2).apply(null,arguments)},l._Atanh=function(){return(l._Atanh=l.asm.Atanh).apply(null,arguments)},l._AvgPool=function(){return(l._AvgPool=l.asm.AvgPool).apply(null,arguments)},l._AvgPool3D=function(){return(l._AvgPool3D=l.asm.AvgPool3D).apply(null,arguments)},l._AvgPool3DGrad=function(){return(l._AvgPool3DGrad=l.asm.AvgPool3DGrad).apply(null,arguments)},l._AvgPoolGrad=function(){return(l._AvgPoolGrad=l.asm.AvgPoolGrad).apply(null,arguments)},l._BatchMatMul=function(){return(l._BatchMatMul=l.asm.BatchMatMul).apply(null,arguments)},l._Bincount=function(){return(l._Bincount=l.asm.Bincount).apply(null,arguments)},l._BitwiseAnd=function(){return(l._BitwiseAnd=l.asm.BitwiseAnd).apply(null,arguments)},l._Ceil=function(){return(l._Ceil=l.asm.Ceil).apply(null,arguments)},l._ClipByValue=function(){return(l._ClipByValue=l.asm.ClipByValue).apply(null,arguments)},l._Conv2D=function(){return(l._Conv2D=l.asm.Conv2D).apply(null,arguments)},l._Conv2DBackpropInput=function(){return(l._Conv2DBackpropInput=l.asm.Conv2DBackpropInput).apply(null,arguments)},l._Conv3D=function(){return(l._Conv3D=l.asm.Conv3D).apply(null,arguments)},l._Conv3DBackpropFilterV2=function(){return(l._Conv3DBackpropFilterV2=l.asm.Conv3DBackpropFilterV2).apply(null,arguments)},l._Conv3DBackpropInputV2=function(){return(l._Conv3DBackpropInputV2=l.asm.Conv3DBackpropInputV2).apply(null,arguments)},l._Cos=function(){return(l._Cos=l.asm.Cos).apply(null,arguments)},l._Cosh=function(){return(l._Cosh=l.asm.Cosh).apply(null,arguments)},l._CropAndResize=function(){return(l._CropAndResize=l.asm.CropAndResize).apply(null,arguments)},l._Cumprod=function(){return(l._Cumprod=l.asm.Cumprod).apply(null,arguments)},l._Cumsum=function(){return(l._Cumsum=l.asm.Cumsum).apply(null,arguments)},l._DenseBincount=function(){return(l._DenseBincount=l.asm.DenseBincount).apply(null,arguments)},l._DepthToSpace=function(){return(l._DepthToSpace=l.asm.DepthToSpace).apply(null,arguments)},l._DepthwiseConv2dNative=function(){return(l._DepthwiseConv2dNative=l.asm.DepthwiseConv2dNative).apply(null,arguments)},l._Diag=function(){return(l._Diag=l.asm.Diag).apply(null,arguments)},l._Dilation2D=function(){return(l._Dilation2D=l.asm.Dilation2D).apply(null,arguments)},l._Dilation2DBackpropFilter=function(){return(l._Dilation2DBackpropFilter=l.asm.Dilation2DBackpropFilter).apply(null,arguments)},l._Dilation2DBackpropInput=function(){return(l._Dilation2DBackpropInput=l.asm.Dilation2DBackpropInput).apply(null,arguments)},l._Elu=function(){return(l._Elu=l.asm.Elu).apply(null,arguments)},l._EluGrad=function(){return(l._EluGrad=l.asm.EluGrad).apply(null,arguments)},l._Equal=function(){return(l._Equal=l.asm.Equal).apply(null,arguments)},l._Erf=function(){return(l._Erf=l.asm.Erf).apply(null,arguments)},l._Exp=function(){return(l._Exp=l.asm.Exp).apply(null,arguments)},l._Expm1=function(){return(l._Expm1=l.asm.Expm1).apply(null,arguments)},l._FlipLeftRight=function(){return(l._FlipLeftRight=l.asm.FlipLeftRight).apply(null,arguments)},l._Floor=function(){return(l._Floor=l.asm.Floor).apply(null,arguments)},l._FloorDiv=function(){return(l._FloorDiv=l.asm.FloorDiv).apply(null,arguments)},l._FusedBatchNorm=function(){return(l._FusedBatchNorm=l.asm.FusedBatchNorm).apply(null,arguments)},l._FusedConv2D=function(){return(l._FusedConv2D=l.asm.FusedConv2D).apply(null,arguments)},l._FusedDepthwiseConv2D=function(){return(l._FusedDepthwiseConv2D=l.asm.FusedDepthwiseConv2D).apply(null,arguments)},l._Gather=function(){return(l._Gather=l.asm.Gather).apply(null,arguments)},l._GatherNd=function(){return(l._GatherNd=l.asm.GatherNd).apply(null,arguments)},l._Greater=function(){return(l._Greater=l.asm.Greater).apply(null,arguments)},l._GreaterEqual=function(){return(l._GreaterEqual=l.asm.GreaterEqual).apply(null,arguments)},l._IsFinite=function(){return(l._IsFinite=l.asm.IsFinite).apply(null,arguments)},l._IsInf=function(){return(l._IsInf=l.asm.IsInf).apply(null,arguments)},l._IsNan=function(){return(l._IsNan=l.asm.IsNan).apply(null,arguments)},l._LRN=function(){return(l._LRN=l.asm.LRN).apply(null,arguments)},l._LRNGrad=function(){return(l._LRNGrad=l.asm.LRNGrad).apply(null,arguments)},l._LeakyRelu=function(){return(l._LeakyRelu=l.asm.LeakyRelu).apply(null,arguments)},l._Less=function(){return(l._Less=l.asm.Less).apply(null,arguments)},l._LessEqual=function(){return(l._LessEqual=l.asm.LessEqual).apply(null,arguments)},l._LinSpace=function(){return(l._LinSpace=l.asm.LinSpace).apply(null,arguments)},l._Log=function(){return(l._Log=l.asm.Log).apply(null,arguments)},l._Log1p=function(){return(l._Log1p=l.asm.Log1p).apply(null,arguments)},l._LogicalAnd=function(){return(l._LogicalAnd=l.asm.LogicalAnd).apply(null,arguments)},l._LogicalNot=function(){return(l._LogicalNot=l.asm.LogicalNot).apply(null,arguments)},l._LogicalOr=function(){return(l._LogicalOr=l.asm.LogicalOr).apply(null,arguments)},l._LogicalXor=function(){return(l._LogicalXor=l.asm.LogicalXor).apply(null,arguments)},l._Max=function(){return(l._Max=l.asm.Max).apply(null,arguments)},l._MaxPool=function(){return(l._MaxPool=l.asm.MaxPool).apply(null,arguments)},l._MaxPool3D=function(){return(l._MaxPool3D=l.asm.MaxPool3D).apply(null,arguments)},l._MaxPool3DGrad=function(){return(l._MaxPool3DGrad=l.asm.MaxPool3DGrad).apply(null,arguments)},l._MaxPoolGrad=function(){return(l._MaxPoolGrad=l.asm.MaxPoolGrad).apply(null,arguments)},l._MaxPoolWithArgmax=function(){return(l._MaxPoolWithArgmax=l.asm.MaxPoolWithArgmax).apply(null,arguments)},l._Maximum=function(){return(l._Maximum=l.asm.Maximum).apply(null,arguments)},l._Mean=function(){return(l._Mean=l.asm.Mean).apply(null,arguments)},l._Min=function(){return(l._Min=l.asm.Min).apply(null,arguments)},l._Minimum=function(){return(l._Minimum=l.asm.Minimum).apply(null,arguments)},l._MirrorPad=function(){return(l._MirrorPad=l.asm.MirrorPad).apply(null,arguments)},l._Mod=function(){return(l._Mod=l.asm.Mod).apply(null,arguments)},l._Multinomial=function(){return(l._Multinomial=l.asm.Multinomial).apply(null,arguments)},l._Multiply=function(){return(l._Multiply=l.asm.Multiply).apply(null,arguments)},l._Neg=function(){return(l._Neg=l.asm.Neg).apply(null,arguments)},l._NonMaxSuppressionV3=function(){return(l._NonMaxSuppressionV3=l.asm.NonMaxSuppressionV3).apply(null,arguments)},l._NonMaxSuppressionV4=function(){return(l._NonMaxSuppressionV4=l.asm.NonMaxSuppressionV4).apply(null,arguments)},l._NonMaxSuppressionV5=function(){return(l._NonMaxSuppressionV5=l.asm.NonMaxSuppressionV5).apply(null,arguments)},l._NotEqual=function(){return(l._NotEqual=l.asm.NotEqual).apply(null,arguments)},l._OneHot=function(){return(l._OneHot=l.asm.OneHot).apply(null,arguments)},l._PadV2=function(){return(l._PadV2=l.asm.PadV2).apply(null,arguments)},l._Pow=function(){return(l._Pow=l.asm.Pow).apply(null,arguments)},l._Prelu=function(){return(l._Prelu=l.asm.Prelu).apply(null,arguments)},l._Prod=function(){return(l._Prod=l.asm.Prod).apply(null,arguments)},l._RealDiv=function(){return(l._RealDiv=l.asm.RealDiv).apply(null,arguments)},l._Reciprocal=function(){return(l._Reciprocal=l.asm.Reciprocal).apply(null,arguments)},l._Relu=function(){return(l._Relu=l.asm.Relu).apply(null,arguments)},l._Relu6=function(){return(l._Relu6=l.asm.Relu6).apply(null,arguments)},l._ResizeBilinear=function(){return(l._ResizeBilinear=l.asm.ResizeBilinear).apply(null,arguments)},l._ResizeBilinearGrad=function(){return(l._ResizeBilinearGrad=l.asm.ResizeBilinearGrad).apply(null,arguments)},l._ResizeNearestNeighbor=function(){return(l._ResizeNearestNeighbor=l.asm.ResizeNearestNeighbor).apply(null,arguments)},l._ResizeNearestNeighborGrad=function(){return(l._ResizeNearestNeighborGrad=l.asm.ResizeNearestNeighborGrad).apply(null,arguments)},l._Reverse=function(){return(l._Reverse=l.asm.Reverse).apply(null,arguments)},l._RotateWithOffset=function(){return(l._RotateWithOffset=l.asm.RotateWithOffset).apply(null,arguments)},l._Round=function(){return(l._Round=l.asm.Round).apply(null,arguments)},l._Rsqrt=function(){return(l._Rsqrt=l.asm.Rsqrt).apply(null,arguments)},l._ScatterNd=function(){return(l._ScatterNd=l.asm.ScatterNd).apply(null,arguments)},l._SearchSorted=function(){return(l._SearchSorted=l.asm.SearchSorted).apply(null,arguments)},l._SelectV2=function(){return(l._SelectV2=l.asm.SelectV2).apply(null,arguments)},l._Selu=function(){return(l._Selu=l.asm.Selu).apply(null,arguments)},l._Sigmoid=function(){return(l._Sigmoid=l.asm.Sigmoid).apply(null,arguments)},l._Sign=function(){return(l._Sign=l.asm.Sign).apply(null,arguments)},l._Sin=function(){return(l._Sin=l.asm.Sin).apply(null,arguments)},l._Sinh=function(){return(l._Sinh=l.asm.Sinh).apply(null,arguments)},l._Softmax=function(){return(l._Softmax=l.asm.Softmax).apply(null,arguments)},l._Softplus=function(){return(l._Softplus=l.asm.Softplus).apply(null,arguments)},l._SparseFillEmptyRows=function(){return(l._SparseFillEmptyRows=l.asm.SparseFillEmptyRows).apply(null,arguments)},l._SparseReshape=function(){return(l._SparseReshape=l.asm.SparseReshape).apply(null,arguments)},l._SparseSegmentReduction=function(){return(l._SparseSegmentReduction=l.asm.SparseSegmentReduction).apply(null,arguments)},l._SparseToDense=function(){return(l._SparseToDense=l.asm.SparseToDense).apply(null,arguments)},l._Sqrt=function(){return(l._Sqrt=l.asm.Sqrt).apply(null,arguments)},l._Square=function(){return(l._Square=l.asm.Square).apply(null,arguments)},l._SquaredDifference=function(){return(l._SquaredDifference=l.asm.SquaredDifference).apply(null,arguments)},l._Step=function(){return(l._Step=l.asm.Step).apply(null,arguments)},l._StridedSlice=function(){return(l._StridedSlice=l.asm.StridedSlice).apply(null,arguments)},l._Sub=function(){return(l._Sub=l.asm.Sub).apply(null,arguments)},l._Sum=function(){return(l._Sum=l.asm.Sum).apply(null,arguments)},l._Tan=function(){return(l._Tan=l.asm.Tan).apply(null,arguments)},l._Tanh=function(){return(l._Tanh=l.asm.Tanh).apply(null,arguments)},l._TensorScatterUpdate=function(){return(l._TensorScatterUpdate=l.asm.TensorScatterUpdate).apply(null,arguments)},l._Tile=function(){return(l._Tile=l.asm.Tile).apply(null,arguments)},l._TopK=function(){return(l._TopK=l.asm.TopK).apply(null,arguments)},l._Transform=function(){return(l._Transform=l.asm.Transform).apply(null,arguments)},l._Transpose=function(){return(l._Transpose=l.asm.Transpose).apply(null,arguments)},l.__FusedMatMul=function(){return(l.__FusedMatMul=l.asm._FusedMatMul).apply(null,arguments)},l._malloc=function(){return(l._malloc=l.asm.malloc).apply(null,arguments)},l._free=function(){return(l._free=l.asm.free).apply(null,arguments)},l.__emscripten_tls_init=function(){return(l.__emscripten_tls_init=l.asm._emscripten_tls_init).apply(null,arguments)};var co=l._pthread_self=function(){return(co=l._pthread_self=l.asm.pthread_self).apply(null,arguments)};l.___errno_location=function(){return(l.___errno_location=l.asm.__errno_location).apply(null,arguments)};var td=l.__emscripten_thread_init=function(){return(td=l.__emscripten_thread_init=l.asm._emscripten_thread_init).apply(null,arguments)};l.__emscripten_thread_crashed=function(){return(l.__emscripten_thread_crashed=l.asm._emscripten_thread_crashed).apply(null,arguments)},l._emscripten_main_thread_process_queued_calls=function(){return(l._emscripten_main_thread_process_queued_calls=l.asm.emscripten_main_thread_process_queued_calls).apply(null,arguments)},l._emscripten_main_browser_thread_id=function(){return(l._emscripten_main_browser_thread_id=l.asm.emscripten_main_browser_thread_id).apply(null,arguments)};var nd=l._emscripten_run_in_main_runtime_thread_js=function(){return(nd=l._emscripten_run_in_main_runtime_thread_js=l.asm.emscripten_run_in_main_runtime_thread_js).apply(null,arguments)};l._emscripten_dispatch_to_thread_=function(){return(l._emscripten_dispatch_to_thread_=l.asm.emscripten_dispatch_to_thread_).apply(null,arguments)};var Zu=l.__emscripten_proxy_execute_task_queue=function(){return(Zu=l.__emscripten_proxy_execute_task_queue=l.asm._emscripten_proxy_execute_task_queue).apply(null,arguments)},$i=l.__emscripten_thread_free_data=function(){return($i=l.__emscripten_thread_free_data=l.asm._emscripten_thread_free_data).apply(null,arguments)},po=l.__emscripten_thread_exit=function(){return(po=l.__emscripten_thread_exit=l.asm._emscripten_thread_exit).apply(null,arguments)},Ju=l._emscripten_stack_set_limits=function(){return(Ju=l._emscripten_stack_set_limits=l.asm.emscripten_stack_set_limits).apply(null,arguments)},_i=l.stackSave=function(){return(_i=l.stackSave=l.asm.stackSave).apply(null,arguments)},gs=l.stackRestore=function(){return(gs=l.stackRestore=l.asm.stackRestore).apply(null,arguments)},Ni=l.stackAlloc=function(){return(Ni=l.stackAlloc=l.asm.stackAlloc).apply(null,arguments)};l.dynCall_iijjiiii=function(){return(l.dynCall_iijjiiii=l.asm.dynCall_iijjiiii).apply(null,arguments)},l.dynCall_jiji=function(){return(l.dynCall_jiji=l.asm.dynCall_jiji).apply(null,arguments)},l.keepRuntimeAlive=As,l.wasmMemory=j,l.cwrap=ed,l.ExitStatus=bn,l.PThread=oe;var ki;Os=function D(){ki||rd(),ki||(Os=D)};function rd(D){if(Jn>0)return;if(w){d(l),ca(),startWorker(l);return}if(la(),Jn>0)return;function W(){ki||(ki=!0,l.calledRun=!0,!me&&(ca(),d(l),l.onRuntimeInitialized&&l.onRuntimeInitialized(),ao()))}l.setStatus?(l.setStatus("Running..."),setTimeout(function(){setTimeout(function(){l.setStatus("")},1),W()},1)):W()}if(l.preInit)for(typeof l.preInit=="function"&&(l.preInit=[l.preInit]);l.preInit.length>0;)l.preInit.pop()();rd();var Ei;f&&(Ei={uncaughtException:process.listeners("uncaughtException").filter(function(D){return!f.uncaughtException.indexOf(D)>-1}),unhandledRejection:process.listeners("unhandledRejection").filter(function(D){return!f.unhandledRejection.indexOf(D)>-1})});var fa;if(typeof WasmBackendModule<"u")fa=WasmBackendModule;else if(typeof s<"u")fa=s;else throw new Error("Could not find wasm module in post.js");if(Ei){var fo=fa._dispose;fa._dispose=function(){fo(),Ei.uncaughtException.forEach(function(D){process.removeListener("uncaughtException",D)}),Ei.unhandledRejection.forEach(function(D){process.removeListener("unhandledRejection",D)})}}return s.ready}})();t.exports=n})($E);var _E=$E.exports,NE=Rc(_E),K7=H0({__proto__:null,default:NE},[_E]),q7=`"use strict";var Module={};var ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads");var parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",data=>onmessage({data:data}));var fs=require("fs");Object.assign(global,{self:global,require:require,Module:Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:function(f){(0,eval)(fs.readFileSync(f,"utf8")+"//# sourceURL="+f)},postMessage:function(msg){parentPort.postMessage(msg)},performance:global.performance||{now:function(){return Date.now()}}})}var initializedJS=false;var pendingNotifiedProxyingQueues=[];function threadPrintErr(){var text=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,text+"
");return}console.error(text)}function threadAlert(){var text=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:text,threadId:Module["_pthread_self"]()})}var err=threadPrintErr;self.alert=threadAlert;Module["instantiateWasm"]=(info,receiveInstance)=>{var instance=new WebAssembly.Instance(Module["wasmModule"],info);receiveInstance(instance);Module["wasmModule"]=null;return instance.exports};self.onunhandledrejection=e=>{throw e.reason??e};self.startWorker=instance=>{Module=instance;postMessage({"cmd":"loaded"})};self.onmessage=e=>{try{if(e.data.cmd==="load"){Module["wasmModule"]=e.data.wasmModule;for(const handler of e.data.handlers){Module[handler]=function(){postMessage({cmd:"callHandler",handler:handler,args:[...arguments]})}}Module["wasmMemory"]=e.data.wasmMemory;Module["buffer"]=Module["wasmMemory"].buffer;Module["ENVIRONMENT_IS_PTHREAD"]=true;if(typeof e.data.urlOrBlob=="string"){importScripts(e.data.urlOrBlob)}else{var objectUrl=URL.createObjectURL(e.data.urlOrBlob);importScripts(objectUrl);URL.revokeObjectURL(objectUrl)}WasmBackendModuleThreadedSimd(Module)}else if(e.data.cmd==="run"){Module["__emscripten_thread_init"](e.data.pthread_ptr,0,0,1);Module["establishStackSpace"]();Module["PThread"].receiveObjectTransfer(e.data);Module["PThread"].threadInitTLS();if(!initializedJS){pendingNotifiedProxyingQueues.forEach(queue=>{Module["executeNotifiedProxyingQueue"](queue)});pendingNotifiedProxyingQueues=[];initializedJS=true}try{Module["invokeEntryPoint"](e.data.start_routine,e.data.arg)}catch(ex){if(ex!="unwind"){if(ex instanceof Module["ExitStatus"]){if(Module["keepRuntimeAlive"]()){}else{Module["__emscripten_thread_exit"](ex.status)}}else{throw ex}}}}else if(e.data.cmd==="cancel"){if(Module["_pthread_self"]()){Module["__emscripten_thread_exit"](-1)}}else if(e.data.target==="setimmediate"){}else if(e.data.cmd==="processProxyingQueue"){if(initializedJS){Module["executeNotifiedProxyingQueue"](e.data.queue)}else{pendingNotifiedProxyingQueues.push(e.data.queue)}}else if(e.data.cmd){err("worker.js received unknown command "+e.data.cmd);err(e.data)}}catch(ex){if(Module["__emscripten_thread_crashed"]){Module["__emscripten_thread_crashed"]()}throw ex}};`,kE={exports:{}};(function(t,e){var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),function(s){s=s||{};var a=typeof s<"u"?s:{},o,i;a.ready=new Promise(function(q,te){o=q,i=te});var u;typeof process<"u"&&process.listeners&&(u={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var c=Object.assign({},a),l=typeof window=="object",d=typeof importScripts=="function",p=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",f="";function h(q){return a.locateFile?a.locateFile(q,f):f+q}var y,x,g;if(p){var v=Sa,w=Sa;d?f=w.dirname(f)+"/":f=__dirname+"/",y=(q,te)=>(q=gr(q)?new URL(q):w.normalize(q),v.readFileSync(q,te?void 0:"utf8")),g=q=>{var te=y(q,!0);return te.buffer||(te=new Uint8Array(te)),te},x=(q,te,ve)=>{q=gr(q)?new URL(q):w.normalize(q),v.readFile(q,function(oe,Ze){oe?ve(oe):te(Ze.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(q){if(!(q instanceof As))throw q}),process.on("unhandledRejection",function(q){throw q}),a.inspect=function(){return"[Emscripten Module object]"}}else(l||d)&&(d?f=self.location.href:typeof document<"u"&&document.currentScript&&(f=document.currentScript.src),r&&(f=r),f.indexOf("blob:")!==0?f=f.substr(0,f.replace(/[?#].*/,"").lastIndexOf("/")+1):f="",y=q=>{var te=new XMLHttpRequest;return te.open("GET",q,!1),te.send(null),te.responseText},d&&(g=q=>{var te=new XMLHttpRequest;return te.open("GET",q,!1),te.responseType="arraybuffer",te.send(null),new Uint8Array(te.response)}),x=(q,te,ve)=>{var oe=new XMLHttpRequest;oe.open("GET",q,!0),oe.responseType="arraybuffer",oe.onload=()=>{if(oe.status==200||oe.status==0&&oe.response){te(oe.response);return}ve()},oe.onerror=ve,oe.send(null)});var S=a.print||console.log.bind(console),$=a.printErr||console.warn.bind(console);Object.assign(a,c),c=null,a.arguments&&a.arguments,a.thisProgram&&a.thisProgram,a.quit&&a.quit;var k;a.wasmBinary&&(k=a.wasmBinary),a.noExitRuntime,typeof WebAssembly!="object"&&mr("no native wasm support detected");var T,A=!1,B=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function L(q,te,ve){te>>>=0;for(var oe=te+ve,Ze=te;q[Ze]&&!(Ze>=oe);)++Ze;if(Ze-te>16&&q.buffer&&B)return B.decode(q.subarray(te,Ze));for(var je="";te<Ze;){var Te=q[te++];if(!(Te&128)){je+=String.fromCharCode(Te);continue}var Se=q[te++]&63;if((Te&224)==192){je+=String.fromCharCode((Te&31)<<6|Se);continue}var Je=q[te++]&63;if((Te&240)==224?Te=(Te&15)<<12|Se<<6|Je:Te=(Te&7)<<18|Se<<12|Je<<6|q[te++]&63,Te<65536)je+=String.fromCharCode(Te);else{var un=Te-65536;je+=String.fromCharCode(55296|un>>10,56320|un&1023)}}return je}function z(q,te){return q>>>=0,q?L(de,q,te):""}function Y(q,te,ve,oe){if(ve>>>=0,!(oe>0))return 0;for(var Ze=ve,je=ve+oe-1,Te=0;Te<q.length;++Te){var Se=q.charCodeAt(Te);if(Se>=55296&&Se<=57343){var Je=q.charCodeAt(++Te);Se=65536+((Se&1023)<<10)|Je&1023}if(Se<=127){if(ve>=je)break;te[ve++>>>0]=Se}else if(Se<=2047){if(ve+1>=je)break;te[ve++>>>0]=192|Se>>6,te[ve++>>>0]=128|Se&63}else if(Se<=65535){if(ve+2>=je)break;te[ve++>>>0]=224|Se>>12,te[ve++>>>0]=128|Se>>6&63,te[ve++>>>0]=128|Se&63}else{if(ve+3>=je)break;te[ve++>>>0]=240|Se>>18,te[ve++>>>0]=128|Se>>12&63,te[ve++>>>0]=128|Se>>6&63,te[ve++>>>0]=128|Se&63}}return te[ve>>>0]=0,ve-Ze}function Q(q,te,ve){return Y(q,de,te,ve)}var re,Z,de,ce;function j(q){re=q,a.HEAP8=Z=new Int8Array(q),a.HEAP16=new Int16Array(q),a.HEAP32=new Int32Array(q),a.HEAPU8=de=new Uint8Array(q),a.HEAPU16=new Uint16Array(q),a.HEAPU32=ce=new Uint32Array(q),a.HEAPF32=new Float32Array(q),a.HEAPF64=new Float64Array(q)}a.INITIAL_MEMORY;var ee=[],me=[],Ie=[];function Pe(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)Pt(a.preRun.shift());la(ee)}function Ge(){la(me)}function _t(){if(a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)wn(a.postRun.shift());la(Ie)}function Pt(q){ee.unshift(q)}function Nt(q){me.unshift(q)}function wn(q){Ie.unshift(q)}var rt=0,Dn=null;function zr(q){rt++,a.monitorRunDependencies&&a.monitorRunDependencies(rt)}function Zn(q){if(rt--,a.monitorRunDependencies&&a.monitorRunDependencies(rt),rt==0&&Dn){var te=Dn;Dn=null,te()}}function mr(q){a.onAbort&&a.onAbort(q),q="Aborted("+q+")",$(q),A=!0,q+=". Build with -sASSERTIONS for more info.";var te=new WebAssembly.RuntimeError(q);throw i(te),te}var Xe="data:application/octet-stream;base64,";function Qe(q){return q.startsWith(Xe)}function gr(q){return q.startsWith("file://")}var kt;kt="tfjs-backend-wasm.wasm",Qe(kt)||(kt=h(kt));function ps(q){try{if(q==kt&&k)return new Uint8Array(k);if(g)return g(q);throw"both async and sync fetching of the wasm failed"}catch(te){mr(te)}}function Rs(){if(!k&&(l||d)){if(typeof fetch=="function"&&!gr(kt))return fetch(kt,{credentials:"same-origin"}).then(function(q){if(!q.ok)throw"failed to load wasm binary file at '"+kt+"'";return q.arrayBuffer()}).catch(function(){return ps(kt)});if(x)return new Promise(function(q,te){x(kt,function(ve){q(new Uint8Array(ve))},te)})}return Promise.resolve().then(function(){return ps(kt)})}function yr(){var q={env:oo,wasi_snapshot_preview1:oo};function te(Te,Se){var Je=Te.exports;a.asm=Je,T=a.asm.memory,j(T.buffer),a.asm.__indirect_function_table,Nt(a.asm.__wasm_call_ctors),Zn()}zr();function ve(Te){te(Te.instance)}function oe(Te){return Rs().then(function(Se){return WebAssembly.instantiate(Se,q)}).then(function(Se){return Se}).then(Te,function(Se){$("failed to asynchronously prepare wasm: "+Se),mr(Se)})}function Ze(){return!k&&typeof WebAssembly.instantiateStreaming=="function"&&!Qe(kt)&&!gr(kt)&&!p&&typeof fetch=="function"?fetch(kt,{credentials:"same-origin"}).then(function(Te){var Se=WebAssembly.instantiateStreaming(Te,q);return Se.then(ve,function(Je){return $("wasm streaming compile failed: "+Je),$("falling back to ArrayBuffer instantiation"),oe(ve)})}):oe(ve)}if(a.instantiateWasm)try{var je=a.instantiateWasm(q,te);return je}catch(Te){$("Module.instantiateWasm callback failed with error: "+Te),i(Te)}return Ze().catch(i),{}}function As(q){this.name="ExitStatus",this.message="Program terminated with exit("+q+")",this.status=q}function la(q){for(;q.length>0;)q.shift()(a)}function ca(){mr("")}function ao(){return 4294901760}function Wr(){return ao()}function hi(q,te,ve){de.copyWithin(q>>>0,te>>>0,te+ve>>>0)}function da(q){try{return T.grow(q-re.byteLength+65535>>>16),j(T.buffer),1}catch{}}function Jn(q){var te=de.length;q=q>>>0;var ve=ao();if(q>ve)return!1;let oe=(Je,un)=>Je+(un-Je%un)%un;for(var Ze=1;Ze<=4;Ze*=2){var je=te*(1+.2/Ze);je=Math.min(je,q+100663296);var Te=Math.min(ve,oe(Math.max(q,je),65536)),Se=da(Te);if(Se)return!0}return!1}function Os(q){return 52}function mi(q,te,ve,oe,Ze){return 70}var Gu=[null,[],[]];function fs(q,te){var ve=Gu[q];te===0||te===10?((q===1?S:$)(L(ve,0)),ve.length=0):ve.push(te)}function gi(q,te,ve,oe){for(var Ze=0,je=0;je<ve;je++){var Te=ce[te>>>2],Se=ce[te+4>>>2];te+=8;for(var Je=0;Je<Se;Je++)fs(q,de[Te+Je>>>0]);Ze+=Se}return ce[oe>>>2]=Ze,0}function Ur(q){var te=a["_"+q];return te}function hs(q,te){Z.set(q,te>>>0)}function Ft(q,te,ve,oe,Ze){var je={string:It=>{var wr=0;if(It!=null&&It!==0){var Fs=(It.length<<2)+1;wr=bn(Fs),Q(It,wr,Fs)}return wr},array:It=>{var wr=bn(It.length);return hs(It,wr),wr}};function Te(It){return te==="string"?z(It):te==="boolean"?!!It:It}var Se=Ur(q),Je=[],un=0;if(oe)for(var qe=0;qe<oe.length;qe++){var Sn=je[ve[qe]];Sn?(un===0&&(un=pa()),Je[qe]=Sn(oe[qe])):Je[qe]=oe[qe]}var Ps=Se.apply(null,Je);function xi(It){return un!==0&&xr(un),Te(It)}return Ps=xi(Ps),Ps}function yi(q,te,ve,oe){ve=ve||[];var Ze=ve.every(Te=>Te==="number"||Te==="boolean"),je=te!=="string";return je&&Ze&&!oe?Ur(q):function(){return Ft(q,te,ve,arguments)}}var oo={abort:ca,emscripten_get_heap_max:Wr,emscripten_memcpy_big:hi,emscripten_resize_heap:Jn,fd_close:Os,fd_seek:mi,fd_write:gi};yr(),a.___wasm_call_ctors=function(){return(a.___wasm_call_ctors=a.asm.__wasm_call_ctors).apply(null,arguments)},a._init=function(){return(a._init=a.asm.init).apply(null,arguments)},a._init_with_threads_count=function(){return(a._init_with_threads_count=a.asm.init_with_threads_count).apply(null,arguments)},a._get_threads_count=function(){return(a._get_threads_count=a.asm.get_threads_count).apply(null,arguments)},a._register_tensor=function(){return(a._register_tensor=a.asm.register_tensor).apply(null,arguments)},a._dispose_data=function(){return(a._dispose_data=a.asm.dispose_data).apply(null,arguments)},a._dispose=function(){return(a._dispose=a.asm.dispose).apply(null,arguments)},a._Abs=function(){return(a._Abs=a.asm.Abs).apply(null,arguments)},a._Acos=function(){return(a._Acos=a.asm.Acos).apply(null,arguments)},a._Acosh=function(){return(a._Acosh=a.asm.Acosh).apply(null,arguments)},a._Add=function(){return(a._Add=a.asm.Add).apply(null,arguments)},a._AddN=function(){return(a._AddN=a.asm.AddN).apply(null,arguments)},a._All=function(){return(a._All=a.asm.All).apply(null,arguments)},a._Any=function(){return(a._Any=a.asm.Any).apply(null,arguments)},a._ArgMax=function(){return(a._ArgMax=a.asm.ArgMax).apply(null,arguments)},a._ArgMin=function(){return(a._ArgMin=a.asm.ArgMin).apply(null,arguments)},a._Asin=function(){return(a._Asin=a.asm.Asin).apply(null,arguments)},a._Asinh=function(){return(a._Asinh=a.asm.Asinh).apply(null,arguments)},a._Atan=function(){return(a._Atan=a.asm.Atan).apply(null,arguments)},a._Atan2=function(){return(a._Atan2=a.asm.Atan2).apply(null,arguments)},a._Atanh=function(){return(a._Atanh=a.asm.Atanh).apply(null,arguments)},a._AvgPool=function(){return(a._AvgPool=a.asm.AvgPool).apply(null,arguments)},a._AvgPool3D=function(){return(a._AvgPool3D=a.asm.AvgPool3D).apply(null,arguments)},a._AvgPool3DGrad=function(){return(a._AvgPool3DGrad=a.asm.AvgPool3DGrad).apply(null,arguments)},a._AvgPoolGrad=function(){return(a._AvgPoolGrad=a.asm.AvgPoolGrad).apply(null,arguments)},a._BatchMatMul=function(){return(a._BatchMatMul=a.asm.BatchMatMul).apply(null,arguments)},a._Bincount=function(){return(a._Bincount=a.asm.Bincount).apply(null,arguments)},a._BitwiseAnd=function(){return(a._BitwiseAnd=a.asm.BitwiseAnd).apply(null,arguments)},a._Ceil=function(){return(a._Ceil=a.asm.Ceil).apply(null,arguments)},a._ClipByValue=function(){return(a._ClipByValue=a.asm.ClipByValue).apply(null,arguments)},a._Conv2D=function(){return(a._Conv2D=a.asm.Conv2D).apply(null,arguments)},a._Conv2DBackpropInput=function(){return(a._Conv2DBackpropInput=a.asm.Conv2DBackpropInput).apply(null,arguments)},a._Conv3D=function(){return(a._Conv3D=a.asm.Conv3D).apply(null,arguments)},a._Conv3DBackpropFilterV2=function(){return(a._Conv3DBackpropFilterV2=a.asm.Conv3DBackpropFilterV2).apply(null,arguments)},a._Conv3DBackpropInputV2=function(){return(a._Conv3DBackpropInputV2=a.asm.Conv3DBackpropInputV2).apply(null,arguments)},a._Cos=function(){return(a._Cos=a.asm.Cos).apply(null,arguments)},a._Cosh=function(){return(a._Cosh=a.asm.Cosh).apply(null,arguments)},a._CropAndResize=function(){return(a._CropAndResize=a.asm.CropAndResize).apply(null,arguments)},a._Cumprod=function(){return(a._Cumprod=a.asm.Cumprod).apply(null,arguments)},a._Cumsum=function(){return(a._Cumsum=a.asm.Cumsum).apply(null,arguments)},a._DenseBincount=function(){return(a._DenseBincount=a.asm.DenseBincount).apply(null,arguments)},a._DepthToSpace=function(){return(a._DepthToSpace=a.asm.DepthToSpace).apply(null,arguments)},a._DepthwiseConv2dNative=function(){return(a._DepthwiseConv2dNative=a.asm.DepthwiseConv2dNative).apply(null,arguments)},a._Diag=function(){return(a._Diag=a.asm.Diag).apply(null,arguments)},a._Dilation2D=function(){return(a._Dilation2D=a.asm.Dilation2D).apply(null,arguments)},a._Dilation2DBackpropFilter=function(){return(a._Dilation2DBackpropFilter=a.asm.Dilation2DBackpropFilter).apply(null,arguments)},a._Dilation2DBackpropInput=function(){return(a._Dilation2DBackpropInput=a.asm.Dilation2DBackpropInput).apply(null,arguments)},a._Elu=function(){return(a._Elu=a.asm.Elu).apply(null,arguments)},a._EluGrad=function(){return(a._EluGrad=a.asm.EluGrad).apply(null,arguments)},a._Equal=function(){return(a._Equal=a.asm.Equal).apply(null,arguments)},a._Erf=function(){return(a._Erf=a.asm.Erf).apply(null,arguments)},a._Exp=function(){return(a._Exp=a.asm.Exp).apply(null,arguments)},a._Expm1=function(){return(a._Expm1=a.asm.Expm1).apply(null,arguments)},a._FlipLeftRight=function(){return(a._FlipLeftRight=a.asm.FlipLeftRight).apply(null,arguments)},a._Floor=function(){return(a._Floor=a.asm.Floor).apply(null,arguments)},a._FloorDiv=function(){return(a._FloorDiv=a.asm.FloorDiv).apply(null,arguments)},a._FusedBatchNorm=function(){return(a._FusedBatchNorm=a.asm.FusedBatchNorm).apply(null,arguments)},a._FusedConv2D=function(){return(a._FusedConv2D=a.asm.FusedConv2D).apply(null,arguments)},a._FusedDepthwiseConv2D=function(){return(a._FusedDepthwiseConv2D=a.asm.FusedDepthwiseConv2D).apply(null,arguments)},a._Gather=function(){return(a._Gather=a.asm.Gather).apply(null,arguments)},a._GatherNd=function(){return(a._GatherNd=a.asm.GatherNd).apply(null,arguments)},a._Greater=function(){return(a._Greater=a.asm.Greater).apply(null,arguments)},a._GreaterEqual=function(){return(a._GreaterEqual=a.asm.GreaterEqual).apply(null,arguments)},a._IsFinite=function(){return(a._IsFinite=a.asm.IsFinite).apply(null,arguments)},a._IsInf=function(){return(a._IsInf=a.asm.IsInf).apply(null,arguments)},a._IsNan=function(){return(a._IsNan=a.asm.IsNan).apply(null,arguments)},a._LRN=function(){return(a._LRN=a.asm.LRN).apply(null,arguments)},a._LRNGrad=function(){return(a._LRNGrad=a.asm.LRNGrad).apply(null,arguments)},a._LeakyRelu=function(){return(a._LeakyRelu=a.asm.LeakyRelu).apply(null,arguments)},a._Less=function(){return(a._Less=a.asm.Less).apply(null,arguments)},a._LessEqual=function(){return(a._LessEqual=a.asm.LessEqual).apply(null,arguments)},a._LinSpace=function(){return(a._LinSpace=a.asm.LinSpace).apply(null,arguments)},a._Log=function(){return(a._Log=a.asm.Log).apply(null,arguments)},a._Log1p=function(){return(a._Log1p=a.asm.Log1p).apply(null,arguments)},a._LogicalAnd=function(){return(a._LogicalAnd=a.asm.LogicalAnd).apply(null,arguments)},a._LogicalNot=function(){return(a._LogicalNot=a.asm.LogicalNot).apply(null,arguments)},a._LogicalOr=function(){return(a._LogicalOr=a.asm.LogicalOr).apply(null,arguments)},a._LogicalXor=function(){return(a._LogicalXor=a.asm.LogicalXor).apply(null,arguments)},a._Max=function(){return(a._Max=a.asm.Max).apply(null,arguments)},a._MaxPool=function(){return(a._MaxPool=a.asm.MaxPool).apply(null,arguments)},a._MaxPool3D=function(){return(a._MaxPool3D=a.asm.MaxPool3D).apply(null,arguments)},a._MaxPool3DGrad=function(){return(a._MaxPool3DGrad=a.asm.MaxPool3DGrad).apply(null,arguments)},a._MaxPoolGrad=function(){return(a._MaxPoolGrad=a.asm.MaxPoolGrad).apply(null,arguments)},a._MaxPoolWithArgmax=function(){return(a._MaxPoolWithArgmax=a.asm.MaxPoolWithArgmax).apply(null,arguments)},a._Maximum=function(){return(a._Maximum=a.asm.Maximum).apply(null,arguments)},a._Mean=function(){return(a._Mean=a.asm.Mean).apply(null,arguments)},a._Min=function(){return(a._Min=a.asm.Min).apply(null,arguments)},a._Minimum=function(){return(a._Minimum=a.asm.Minimum).apply(null,arguments)},a._MirrorPad=function(){return(a._MirrorPad=a.asm.MirrorPad).apply(null,arguments)},a._Mod=function(){return(a._Mod=a.asm.Mod).apply(null,arguments)},a._Multinomial=function(){return(a._Multinomial=a.asm.Multinomial).apply(null,arguments)},a._Multiply=function(){return(a._Multiply=a.asm.Multiply).apply(null,arguments)},a._Neg=function(){return(a._Neg=a.asm.Neg).apply(null,arguments)},a._NonMaxSuppressionV3=function(){return(a._NonMaxSuppressionV3=a.asm.NonMaxSuppressionV3).apply(null,arguments)},a._NonMaxSuppressionV4=function(){return(a._NonMaxSuppressionV4=a.asm.NonMaxSuppressionV4).apply(null,arguments)},a._NonMaxSuppressionV5=function(){return(a._NonMaxSuppressionV5=a.asm.NonMaxSuppressionV5).apply(null,arguments)},a._NotEqual=function(){return(a._NotEqual=a.asm.NotEqual).apply(null,arguments)},a._OneHot=function(){return(a._OneHot=a.asm.OneHot).apply(null,arguments)},a._PadV2=function(){return(a._PadV2=a.asm.PadV2).apply(null,arguments)},a._Pow=function(){return(a._Pow=a.asm.Pow).apply(null,arguments)},a._Prelu=function(){return(a._Prelu=a.asm.Prelu).apply(null,arguments)},a._Prod=function(){return(a._Prod=a.asm.Prod).apply(null,arguments)},a._RealDiv=function(){return(a._RealDiv=a.asm.RealDiv).apply(null,arguments)},a._Reciprocal=function(){return(a._Reciprocal=a.asm.Reciprocal).apply(null,arguments)},a._Relu=function(){return(a._Relu=a.asm.Relu).apply(null,arguments)},a._Relu6=function(){return(a._Relu6=a.asm.Relu6).apply(null,arguments)},a._ResizeBilinear=function(){return(a._ResizeBilinear=a.asm.ResizeBilinear).apply(null,arguments)},a._ResizeBilinearGrad=function(){return(a._ResizeBilinearGrad=a.asm.ResizeBilinearGrad).apply(null,arguments)},a._ResizeNearestNeighbor=function(){return(a._ResizeNearestNeighbor=a.asm.ResizeNearestNeighbor).apply(null,arguments)},a._ResizeNearestNeighborGrad=function(){return(a._ResizeNearestNeighborGrad=a.asm.ResizeNearestNeighborGrad).apply(null,arguments)},a._Reverse=function(){return(a._Reverse=a.asm.Reverse).apply(null,arguments)},a._RotateWithOffset=function(){return(a._RotateWithOffset=a.asm.RotateWithOffset).apply(null,arguments)},a._Round=function(){return(a._Round=a.asm.Round).apply(null,arguments)},a._Rsqrt=function(){return(a._Rsqrt=a.asm.Rsqrt).apply(null,arguments)},a._ScatterNd=function(){return(a._ScatterNd=a.asm.ScatterNd).apply(null,arguments)},a._SearchSorted=function(){return(a._SearchSorted=a.asm.SearchSorted).apply(null,arguments)},a._SelectV2=function(){return(a._SelectV2=a.asm.SelectV2).apply(null,arguments)},a._Selu=function(){return(a._Selu=a.asm.Selu).apply(null,arguments)},a._Sigmoid=function(){return(a._Sigmoid=a.asm.Sigmoid).apply(null,arguments)},a._Sign=function(){return(a._Sign=a.asm.Sign).apply(null,arguments)},a._Sin=function(){return(a._Sin=a.asm.Sin).apply(null,arguments)},a._Sinh=function(){return(a._Sinh=a.asm.Sinh).apply(null,arguments)},a._Softmax=function(){return(a._Softmax=a.asm.Softmax).apply(null,arguments)},a._Softplus=function(){return(a._Softplus=a.asm.Softplus).apply(null,arguments)},a._SparseFillEmptyRows=function(){return(a._SparseFillEmptyRows=a.asm.SparseFillEmptyRows).apply(null,arguments)},a._SparseReshape=function(){return(a._SparseReshape=a.asm.SparseReshape).apply(null,arguments)},a._SparseSegmentReduction=function(){return(a._SparseSegmentReduction=a.asm.SparseSegmentReduction).apply(null,arguments)},a._SparseToDense=function(){return(a._SparseToDense=a.asm.SparseToDense).apply(null,arguments)},a._Sqrt=function(){return(a._Sqrt=a.asm.Sqrt).apply(null,arguments)},a._Square=function(){return(a._Square=a.asm.Square).apply(null,arguments)},a._SquaredDifference=function(){return(a._SquaredDifference=a.asm.SquaredDifference).apply(null,arguments)},a._Step=function(){return(a._Step=a.asm.Step).apply(null,arguments)},a._StridedSlice=function(){return(a._StridedSlice=a.asm.StridedSlice).apply(null,arguments)},a._Sub=function(){return(a._Sub=a.asm.Sub).apply(null,arguments)},a._Sum=function(){return(a._Sum=a.asm.Sum).apply(null,arguments)},a._Tan=function(){return(a._Tan=a.asm.Tan).apply(null,arguments)},a._Tanh=function(){return(a._Tanh=a.asm.Tanh).apply(null,arguments)},a._TensorScatterUpdate=function(){return(a._TensorScatterUpdate=a.asm.TensorScatterUpdate).apply(null,arguments)},a._Tile=function(){return(a._Tile=a.asm.Tile).apply(null,arguments)},a._TopK=function(){return(a._TopK=a.asm.TopK).apply(null,arguments)},a._Transform=function(){return(a._Transform=a.asm.Transform).apply(null,arguments)},a._Transpose=function(){return(a._Transpose=a.asm.Transpose).apply(null,arguments)},a.__FusedMatMul=function(){return(a.__FusedMatMul=a.asm._FusedMatMul).apply(null,arguments)},a._malloc=function(){return(a._malloc=a.asm.malloc).apply(null,arguments)},a._free=function(){return(a._free=a.asm.free).apply(null,arguments)},a.___errno_location=function(){return(a.___errno_location=a.asm.__errno_location).apply(null,arguments)};var pa=a.stackSave=function(){return(pa=a.stackSave=a.asm.stackSave).apply(null,arguments)},xr=a.stackRestore=function(){return(xr=a.stackRestore=a.asm.stackRestore).apply(null,arguments)},bn=a.stackAlloc=function(){return(bn=a.stackAlloc=a.asm.stackAlloc).apply(null,arguments)};a.dynCall_iijjiiii=function(){return(a.dynCall_iijjiiii=a.asm.dynCall_iijjiiii).apply(null,arguments)},a.dynCall_jiji=function(){return(a.dynCall_jiji=a.asm.dynCall_jiji).apply(null,arguments)},a.cwrap=yi;var Ds;Dn=function q(){Ds||io(),Ds||(Dn=q)};function io(q){if(rt>0||(Pe(),rt>0))return;function te(){Ds||(Ds=!0,a.calledRun=!0,!A&&(Ge(),o(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),_t()))}a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),te()},1)):te()}if(a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();io();var Gr;u&&(Gr={uncaughtException:process.listeners("uncaughtException").filter(function(q){return!u.uncaughtException.indexOf(q)>-1}),unhandledRejection:process.listeners("unhandledRejection").filter(function(q){return!u.unhandledRejection.indexOf(q)>-1})});var ms;if(typeof s<"u")ms=s;else if(typeof WasmBackendModuleThreadedSimd<"u")ms=WasmBackendModuleThreadedSimd;else throw new Error("Could not find wasm module in post.js");if(Gr){var vr=ms._dispose;ms._dispose=function(){vr(),Gr.uncaughtException.forEach(function(q){process.removeListener("uncaughtException",q)}),Gr.unhandledRejection.forEach(function(q){process.removeListener("unhandledRejection",q)})}}return s.ready}})();t.exports=n})(kE);var EE=kE.exports,TE=Rc(EE),X7=H0({__proto__:null,default:TE},[EE]);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uS=NE||K7,Y7=TE||X7;class Q7 extends j0{constructor(e){super(),this.wasm=e,this.dataIdNextNumber=1,this.wasm.tfjs.initWithThreadsCount(s9),this.wasm.tfjs.getThreadsCount(),this.dataIdMap=new Q2(this,vs())}write(e,n,r){const s={id:this.dataIdNextNumber++};return this.move(s,e,n,r,1),s}numDataIds(){return this.dataIdMap.numDataIds()}async time(e){const n=sr();return e(),{kernelMs:sr()-n}}move(e,n,r,s,a){const o=this.dataIdNextNumber++;if(s==="string"){const l=n;this.dataIdMap.set(e,{id:o,stringBytes:l,shape:r,dtype:s,memoryOffset:null,refCount:a});return}const i=K(r),u=i*vu(s),c=this.wasm._malloc(u)>>>0;this.dataIdMap.set(e,{id:o,memoryOffset:c,shape:r,dtype:s,refCount:a}),this.wasm.tfjs.registerTensor(o,i,c),n!=null&&this.wasm.HEAPU8.set(new Uint8Array(n.buffer,n.byteOffset,u),c)}async read(e){return this.readSync(e)}readSync(e,n,r){const{memoryOffset:s,dtype:a,shape:o,stringBytes:i}=this.dataIdMap.get(e);if(a==="string")return(n==null||n===0)&&(r==null||r>=i.length)?i:i.slice(n,r);n=n||0,r=r||K(o);const u=vu(a),c=this.wasm.HEAPU8.slice(s+n*u,s+r*u);return e9(c.buffer,a)}disposeData(e,n=!1){if(this.dataIdMap.has(e)){const r=this.dataIdMap.get(e);if(r.refCount--,!n&&r.refCount>0)return!1;this.wasm._free(r.memoryOffset),this.wasm.tfjs.disposeData(r.id),this.dataIdMap.delete(e)}return!0}refCount(e){return this.dataIdMap.has(e)?this.dataIdMap.get(e).refCount:0}incRef(e){const n=this.dataIdMap.get(e);n!=null&&n.refCount++}floatPrecision(){return 32}getMemoryOffset(e){return this.dataIdMap.get(e).memoryOffset}dispose(){this.wasm.tfjs.dispose(),"PThread"in this.wasm&&this.wasm.PThread.terminateAllThreads(),this.wasm=null}memory(){return{unreliable:!1}}makeOutput(e,n,r,s){let a;if(r==null)a=this.write(s??null,e,n);else{const o=this.dataIdNextNumber++;a={id:o},this.dataIdMap.set(a,{id:o,memoryOffset:r,shape:e,dtype:n,refCount:1});const i=K(e);this.wasm.tfjs.registerTensor(o,i,r)}return{dataId:a,shape:e,dtype:n}}typedArrayFromHeap({shape:e,dtype:n,dataId:r}){const s=this.wasm.HEAPU8.buffer,{memoryOffset:a}=this.dataIdMap.get(r),o=K(e);switch(n){case"float32":return new Float32Array(s,a,o);case"int32":return new Int32Array(s,a,o);case"bool":return new Uint8Array(s,a,o);default:throw new Error(`Unknown dtype ${n}`)}}}function Z7(t){return(e,n)=>(MF(t,{credentials:"same-origin"}).then(r=>{r.ok||e.env.a(`failed to load wasm binary file at '${t}'`),r.arrayBuffer().then(s=>{WebAssembly.instantiate(s,e).then(a=>{n(a.instance,a.module)})})}),{})}function lS(t,e,n){let r="tfjs-backend-wasm.wasm";return t&&e?r="tfjs-backend-wasm-threaded-simd.wasm":t&&(r="tfjs-backend-wasm-simd.wasm"),Bl!=null&&Bl[r]!=null?Bl[r]:n+r}async function J7(){const[t,e]=await Promise.all([U().getAsync("WASM_HAS_SIMD_SUPPORT"),U().getAsync("WASM_HAS_MULTITHREAD_SUPPORT")]);return new Promise((n,r)=>{const s={};s.locateFile=(i,u)=>{if(i.endsWith(".worker.js")){const c=q7.replace(/\n/g,"\\n"),l=new Blob([c],{type:"application/javascript"});return URL.createObjectURL(l)}return i.endsWith(".wasm")?lS(t,e,$l??u):u+i},RE&&(s.instantiateWasm=Z7(lS(t,e,$l??"")));let a=!1;s.onAbort=()=>{if(a||np)return;np=!0,r({message:"Make sure the server can serve the `.wasm` file relative to the bundled js file. For more details see https://github.com/tensorflow/tfjs/blob/master/tfjs-backend-wasm/README.md#using-bundlers"})};let o;e&&t&&n9==null?(s.mainScriptUrlOrBlob=new Blob(["var WasmBackendModuleThreadedSimd = "+uS.toString()],{type:"text/javascript"}),o=uS(s)):o=Y7(s),o.then(i=>{a=!0,np=!1;const u=null;i.tfjs={init:i.cwrap("init",null,[]),initWithThreadsCount:i.cwrap("init_with_threads_count",null,["number"]),getThreadsCount:i.cwrap("get_threads_count","number",[]),registerTensor:i.cwrap("register_tensor",null,["number","number","number"]),disposeData:i.cwrap("dispose_data",u,["number"]),dispose:i.cwrap("dispose",u,[])},n({wasm:i})}).catch(r)})}function e9(t,e){switch(e){case"float32":return new Float32Array(t);case"int32":return new Int32Array(t);case"bool":return new Uint8Array(t);default:throw new Error(`Unknown dtype ${e}`)}}const t9=["tfjs-backend-wasm.wasm","tfjs-backend-wasm-simd.wasm","tfjs-backend-wasm-threaded-simd.wasm"];let n9=null,$l=null,Bl={},np=!1,RE=!1;function r9(t,e=!1){if(np)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPaths()` before you call `tf.setBackend()` or `tf.ready()`");if(typeof t=="string")$l=t;else{Bl=t;const n=t9.filter(r=>Bl[r]==null);if(n.length>0)throw new Error(`There were no entries found for the following binaries: ${n.join(",")}. Please either call setWasmPaths with a map providing a path for each binary, or with a string indicating the directory where all the binaries can be found.`)}RE=e}let s9=-1;/** @license See the LICENSE file. */const a9="4.20.0";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o9=2;Dv("wasm",async()=>{const{wasm:t}=await J7();return new Q7(t)},o9);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Io={},Td={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function i9(t,e){Io[t]=e}function ls(t,e){if(!(t in Io)||e!=null){const r=l9(t,e);if(r!==null)Io[t]=r;else return console.log("Could not get context for WebGL version",t),null}const n=Io[t];return n==null||n.isContextLost()?(delete Io[t],ls(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Io[t])}function u9(t){if(!U().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function l9(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??u9(t);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete Io[t]},!1),U().getBool("SOFTWARE_WEBGL_ENABLED")&&(Td.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",Td)||n.getContext("experimental-webgl",Td):n.getContext("webgl2",Td)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var vc;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(vc||(vc={}));var ir;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(ir||(ir={}));var Ht;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Ht||(Ht={}));function zc(t,e){return[e,t]}function c9(t,e){return t*e}function Rd(t){const e=K(t),n=Math.ceil(e/4);return Kg(n)}function Fu(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function d9(t,e){const[n,r]=Fu(t,e);return n*r*4}function Cw(t,e){const n=t;let r,s,a,o,i,u,c,l,d,p;return U().getNumber("WEBGL_VERSION")===2?(r=n.R32F,s=n.R16F,a=n.RGBA16F,o=n.RGBA32F,i=n.RED,c=4,l=1,d=n.HALF_FLOAT,p=n.FLOAT,u=n.RGBA8):(r=t.RGBA,s=t.RGBA,a=t.RGBA,o=n.RGBA,i=t.RGBA,c=4,l=4,d=e!=null?e.HALF_FLOAT_OES:null,p=t.FLOAT,u=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:o,textureFormatFloat:i,downloadTextureFormat:u,downloadUnpackNumChannels:c,defaultNumChannels:l,textureTypeHalfFloat:d,textureTypeFloat:p}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fe(t,e){const n=e();return U().getBool("DEBUG")&&p9(t),n}function p9(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+g9(t,e))}const f9=596e-10,h9=65504;function m9(t){return!!(U().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||f9<Math.abs(t)&&Math.abs(t)<h9)}function g9(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function Ad(t,e){return ua(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function y9(t,e){const n=ua(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(fe(t,()=>t.shaderSource(n,e)),fe(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function x9(t,e){const n=ua(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(fe(t,()=>t.shaderSource(n,e)),fe(t,()=>t.compileShader(n)),U().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw AE(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const v9=/ERROR: [0-9]+:([0-9]+):/g;function AE(t,e){const n=v9.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const r=+n[1],s=t.split(`
`),a=s.length.toString().length+2,o=s.map((d,p)=>su((p+1).toString(),a)+d);let i=0;for(let d=0;d<o.length;d++)i=Math.max(o[d].length,i);const u=o.slice(0,r-1),c=o.slice(r-1,r),l=o.slice(r);console.log(u.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${su(c[0],i)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(l.join(`
`))}function w9(t){return ua(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function b9(t,e){if(fe(t,()=>t.linkProgram(e)),!U().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Vm(t,e){if(fe(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function S9(t,e){const n=ua(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return fe(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),fe(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function C9(t,e){const n=ua(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return fe(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),fe(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function I9(t){return ua(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function $9(t,e){const n=U().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const r=`[${t}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n){const r=`[${t}x${e}]`,s=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+s+".")}}function _9(t){return ua(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function cS(t,e,n,r,s,a,o){const i=t.getAttribLocation(e,n);return i===-1?!1:(fe(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),fe(t,()=>t.vertexAttribPointer(i,s,t.FLOAT,!1,a,o)),fe(t,()=>t.enableVertexAttribArray(i)),!0)}function N9(t,e,n){A9(t,n),fe(t,()=>t.activeTexture(t.TEXTURE0+n)),fe(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function k9(t,e,n){return ua(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function E9(t,e,n){return t.getUniformLocation(e,n)}function T9(t,e,n,r){fe(t,()=>N9(t,e,r)),fe(t,()=>t.uniform1i(n,r))}function zm(t,e,n){fe(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),fe(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function dS(t,e){fe(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),fe(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function Od(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+R9(t,e))}function R9(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function ua(t,e,n){const r=fe(t,()=>e());if(r==null)throw new Error(n);return r}function A9(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const s=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${s}.`)}}function $u(t,e=2){return K(t.slice(0,t.length-e))}function _u(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Dd(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[$u(t),..._u(t)]),e}function O9(t,e=!1){let n=U().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=U().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&U().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n=n*2,r=r*2,t=t.map((i,u)=>u>=t.length-2?K0(t[u]):t[u]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=Qa(t).newShape);let s=K(t),a=null;t.length<=1&&s<=n?a=[1,s]:t.length===2&&t[0]<=n&&t[1]<=n?a=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?a=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?a=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?a=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(a=[t[0],t[1]*t[2]*t[3]]);const o=a!=null&&Math.max(...a)>r&&Math.min(...a)<=(e?2:1)&&Math.min(...a)>0;if(a==null||o)if(e){const i=$u(t);let u=2,c=2;t.length&&([u,c]=_u(t)),s=i*(u/2)*(c/2),a=Kg(s).map(l=>l*2)}else a=Kg(s);return a}function Pd(t){return t%2===0}function qp(t,e){if(t=t.slice(-2),e=e.slice(-2),yt(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],r=e[e.length-1];if(n===r||Pd(n)&&Pd(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&Pd(t[0])&&Pd(e[0])}let Wm,Um;function D9(t){if(Wm==null){const e=ls(t);Wm=e.getParameter(e.MAX_TEXTURE_SIZE)}return Wm}function P9(t){if(Um==null){const e=ls(t);Um=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Um)}function F9(t){if(t===0)return 0;let e;const n=ls(t);return Or(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:Or(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function Or(t,e){return t.getExtension(e)!=null}function pS(t){try{if(ls(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function L9(t){if(t===0)return!1;const e=ls(t);if(t===1){if(!Or(e,"OES_texture_float"))return!1}else if(!Or(e,"EXT_color_buffer_float"))return!1;return Dy(e)}function M9(t){if(t===0)return!1;const e=ls(t);if(t===1){if(!Or(e,"OES_texture_float")||!Or(e,"WEBGL_color_buffer_float"))return!1}else{if(Or(e,"EXT_color_buffer_float"))return Dy(e);const r="EXT_color_buffer_half_float";if(Or(e,r)){const s=e.getExtension(r);return B9(e,s)}return!1}return Dy(e)}function Dy(t){const e=Cw(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const a=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,a),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(a),o}function B9(t,e){const n=Cw(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(o),i}function V9(t){return t!==2?!1:ls(t).fenceSync!=null}function Wc(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&E(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xe=U();xe.registerFlag("HAS_WEBGL",()=>xe.getNumber("WEBGL_VERSION")>0);xe.registerFlag("WEBGL_VERSION",()=>pS(2)?2:pS(1)?1:0);xe.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);xe.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>xe.get("WEBGL_VERSION")===2);xe.registerFlag("WEBGL_CPU_FORWARD",()=>!0);xe.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);xe.registerFlag("WEBGL_PACK",()=>xe.getBool("HAS_WEBGL"));xe.registerFlag("WEBGL_PACK_NORMALIZATION",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_CLIP",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_REDUCE",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_LAZILY_UNPACK",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_CONV_IM2COL",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>D9(xe.getNumber("WEBGL_VERSION")));xe.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>P9(xe.getNumber("WEBGL_VERSION")));xe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=xe.getNumber("WEBGL_VERSION");return t===0?0:F9(t)});xe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>xe.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!U$());xe.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>L9(xe.getNumber("WEBGL_VERSION")));xe.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>xe.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:xe.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));xe.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>M9(xe.getNumber("WEBGL_VERSION")));xe.registerFlag("WEBGL_FENCE_API_ENABLED",()=>V9(xe.getNumber("WEBGL_VERSION")));xe.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>xe.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);xe.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});xe.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>U$()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});xe.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);xe.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);xe.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);xe.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);xe.registerFlag("WEBGL_EXP_CONV",()=>!1);xe.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>xe.getBool("IS_TEST"));xe.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);xe.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);xe.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);xe.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vn(){let t,e,n,r,s,a,o,i,u,c;return U().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",s="texture",a="outputColor",o="out vec4 outputColor;",i=U().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",u="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",s="texture2D",a="gl_FragColor",o="",i=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:s,output:a,defineOutput:o,defineSpecialNaN:i,defineSpecialInf:u,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ci(t,e,n="index"){const r=Ye(e);return r.map((s,a)=>{const o=`int ${t[a]} = ${n} / ${s}`,i=a===r.length-1?`int ${t[a+1]} = ${n} - ${t[a]} * ${s}`:`index -= ${t[a]} * ${s}`;return`${o}; ${i};`}).join("")}function Wh(t,e,n="index"){const r=Ye(e);return r.map((s,a)=>{const o=`int ${t[a]} = ${n} / outShapeStrides[${a}]`,i=a===r.length-1?`int ${t[a+1]} = ${n} - ${t[a]} * outShapeStrides[${a}]`:`index -= ${t[a]} * outShapeStrides[${a}]`;return`${o}; ${i};`}).join("")}function z9(t,e){const n=t.length,r=t.map(a=>`${e}[${a}]`),s=new Array(n-1);s[n-2]=r[n-1];for(let a=n-3;a>=0;--a)s[a]=`(${s[a+1]} * ${r[a+1]})`;return s}function W9(t,e,n="index"){const r=t.map((a,o)=>o),s=z9(r,e);return s.map((a,o)=>{const i=`int ${t[o]} = ${n} / ${s[o]}`,u=o===s.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${s[o]}`:`index -= ${t[o]} * ${s[o]}`;return`${i}; ${u};`}).join("")}function Iw(t){const e=Ye(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function $w(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const OE=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:DE}=DG;function U9(t,e,n){const r=[];if(t.forEach(f=>{const h=K(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?r.push(`uniform float ${f.name}${h>1?`[${h}]`:""};`):(r.push(`uniform sampler2D ${f.name};`),r.push(`uniform int offset${f.name};`)),n.enableShapeUniforms){const{uniformShape:y}=_w(n.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(y.length){case 1:r.push(`uniform int ${f.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${f.name}Shape;`);break}r.push(`uniform ivec2 ${f.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(f=>{r.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const s=r.join(`
`),a=t.map(f=>G9(f,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=e.texShape,i=vn(),u=K9(i);let c,l,d=Y9(i);return e.isPacked?(c=H9(e.logicalShape,o,n.enableShapeUniforms),l=X9(i)):(c=j9(e.logicalShape,o,n.enableShapeUniforms),l=q9(i)),n.packedInputs&&(d+=eY),[d,u,l,s,c,a,n.userCode].join(`
`)}function Lu(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return pY(t,e);case 1:return hY(t,e);case 2:return gY(t,e);case 3:return xY(t,e);case 4:return wY(t,e);case 5:return bY(t);case 6:return SY(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function PE(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return dY(t);case 1:return fY(t,e);case 2:return mY(t,e);case 3:return yY(t,e);default:return vY(t,e)}}function G9(t,e,n=!1,r){let s="";n?s+=PE(t,r):s+=Lu(t,r);const a=t.shapeInfo.logicalShape,o=e.logicalShape;return a.length<=o.length&&(n?s+=CY(t,e):s+=IY(t,e)),s}function H9(t,e,n){switch(t.length){case 0:return FE();case 1:return tY(t,e,n);case 2:return lY(t,e,n);case 3:return rY(t,e,n);default:return aY(t,e,n)}}function j9(t,e,n){switch(t.length){case 0:return FE();case 1:return nY(t,e,n);case 2:return cY(t,e,n);case 3:return sY(t,e,n);case 4:return oY(t,e,n);case 5:return iY(t,e);case 6:return uY(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function K9(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function q9(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function X9(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function Y9(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Q9}
    ${Z9}
    ${J9}
  `}const Q9=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Z9=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,J9=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,eY=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function FE(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function tY(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function nY(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function rY(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[2]/2),a=s*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec3(b, r, c);
    }
  `}function sY(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${Wh(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const r=ci(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function aY(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[t.length-1]/2),a=s*Math.ceil(t[t.length-2]/2);let o=a,i="",u="b, r, c";for(let c=2;c<t.length-1;c++)o*=t[t.length-c-1],i=`
      int b${c} = index / ${o};
      index -= b${c} * ${o};
    `+i,u=`b${c}, `+u;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${i}

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec${t.length}(${u});
    }
  `}function oY(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${Wh(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const r=ci(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function iY(t,e){const n=ci(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function uY(t,e){const n=ci(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function lY(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(yt(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const s=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec2(r, c);
    }
  `}function cY(t,e,n){return yt(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function di(t){return`offset${t}`}function dY(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=vn();return`
    vec4 ${n}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function pY(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[s,a]=t.shapeInfo.texShape;if(s===1&&a===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=di(n);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[i,u]=t.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${i}, ${u}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function fY(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=t.shapeInfo.texShape,a=vn();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${a.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${a.texture2D}(${n}, uv);
    }
  `}function hY(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${Mu(t)}
      }
    `;const s=t.shapeInfo.texShape,a=s[0],o=s[1];if(o===1&&a===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const i=di(n);return o===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${i}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${i}) + 0.5) / ${a}.0);
        return sampleTexture(${n}, uv);
      }
    `:a===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${i}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${i}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${i});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${a}, ${o}, index + ${i});
      return sampleTexture(${n}, uv);
    }
  `}function mY(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),a=t.shapeInfo.texShape,o=a[0],i=a[1],u=vn();if(a!=null&&yt(n,a))return e?`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${u.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${i}.0, ${o}.0);

        return ${u.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${s}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${u.texture2D}(${r}, uv);
    }
  `;const c=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],l=Math.ceil(n[1]/2);return`
    vec4 ${s}(int row, int col) {
      vec2 uv = packedUVfrom2D(${l}, ${c[0]}, ${c[1]}, row, col);
      return ${u.texture2D}(${r}, uv);
    }
  `}function gY(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),a=t.shapeInfo.texShape;if(a!=null&&yt(n,a)){if(e)return`
      float ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const p=a[0],f=a[1];return`
    float ${s}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${p}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:o,keptDims:i}=Qa(n),u=o;if(u.length<n.length){const p=Bu(t,u),f=["row","col"];return`
      ${Lu(p,e)}
      float ${s}(int row, int col) {
        return ${s}(${Vu(f,i)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Mu(t)}
      }
    `;const c=a[0],l=a[1],d=di(r);return l===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${r}, uv);
    }
  `:c===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${l}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${s}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${s}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${c}, ${l}, index);
    return sampleTexture(${r}, uv);
  }
`}function yY(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),a=t.shapeInfo.texShape,o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(n[0]===1){const p=n.slice(1),f=[1,2],h=Bu(t,p),y=["b","row","col"];return`
        ${PE(h,e)}
        vec4 ${s}(int b, int row, int col) {
          return ${s}(${Vu(y,f)});
        }
      `}const i=vn();if(e)return`
    vec4 ${s}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${i.texture2D}(${r}, uv);
    }
  `;const u=o[0],c=o[1],l=Math.ceil(n[2]/2),d=l*Math.ceil(n[1]/2);return`
    vec4 ${s}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${u}, ${c}, ${d}, ${l}, b, row, col);
      return ${i.texture2D}(${r}, uv);
    }
  `}function xY(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),a=n[1]*n[2],o=n[2],{newShape:i,keptDims:u}=Qa(n),c=i;if(c.length<n.length){const y=Bu(t,c),x=["row","col","depth"];return`
        ${Lu(y,e)}
        float ${s}(int row, int col, int depth) {
          return ${s}(${Vu(x,u)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${a}, ${o}, 1)));
        ${Mu(t)}
      }
    `;const l=t.shapeInfo.texShape,d=l[0],p=l[1],f=t.shapeInfo.flatOffset;if(p===a&&f==null)return e?`
      float ${s}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${s}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${p}.0, ${d}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(p===o&&f==null)return e?`
      float ${s}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${p}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `;const h=di(r);return e?`
    float ${s}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${h};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${s}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${a} + col * ${o} + depth + ${h};
        vec2 uv = uvFromFlat(${d}, ${p}, index);
        return sampleTexture(${r}, uv);
      }
  `}function vY(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=vn();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${s.texture2D}(${n}, uv);
    }
  `;const a=t.shapeInfo.logicalShape,o=a.length,i=t.shapeInfo.texShape,u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],c=u[0],l=u[1],d=Math.ceil(a[o-1]/2);let p=d*Math.ceil(a[o-2]/2),f="int b, int row, int col",h=`b * ${p} + (row / 2) * ${d} + (col / 2)`;for(let y=2;y<o-1;y++)f=`int b${y}, `+f,p*=a[o-y-1],h=`b${y} * ${p} + `+h;return`
    vec4 ${r}(${f}) {
      int index = ${h};
      int texR = index / ${l};
      int texC = index - texR * ${l};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${l}, ${c});
      return ${s.texture2D}(${n}, uv);
    }
  `}function wY(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),a=n[3],o=n[2]*a,i=n[1]*o,{newShape:u,keptDims:c}=Qa(n);if(u.length<n.length){const v=Bu(t,u),w=["row","col","depth","depth2"];return`
      ${Lu(v,e)}
      float ${s}(int row, int col, int depth, int depth2) {
        return ${s}(${Vu(w,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${i}, ${o}, ${a}, 1)));
        ${Mu(t)}
      }
    `;const l=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],f=d[1],h=`int stride2 = ${r}Shape[3];`,y=`int stride1 = ${r}Shape[2] * stride2;`,x=`int stride0 = ${r}Shape[1] * stride1;`;if(f===i&&l==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        ${h}
        ${y}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${p}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(f===a&&l==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${p}.0);
        return sampleTexture(${r}, uv);
      }
    `;const g=di(r);return e?`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${h}
      ${y}
      ${x}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${g});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${i} + col * ${o} +
          depth * ${a} + depth2;
      vec2 uv = uvFromFlat(${p}, ${f}, index + ${g});
      return sampleTexture(${r}, uv);
    }
  `}function bY(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e[4],a=e[3]*s,o=e[2]*a,i=e[1]*o,{newShape:u,keptDims:c}=Qa(e);if(u.length<e.length){const y=Bu(t,u),x=["row","col","depth","depth2","depth3"];return`
      ${Lu(y)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${Vu(x,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${i}, ${o}, ${a}, ${s})) +
          depth3;
        ${Mu(t)}
      }
    `;const l=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],f=d[1];if(f===i&&l==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${a}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===s&&l==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;const h=di(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${i} + col * ${o} + depth * ${a} +
          depth2 * ${s} + depth3 + ${h};
      vec2 uv = uvFromFlat(${p}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function SY(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:s,keptDims:a}=Qa(e);if(s.length<e.length){const x=Bu(t,s),g=["row","col","depth","depth2","depth3","depth4"];return`
      ${Lu(x)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${Vu(g,a)});
      }
    `}const o=e[5],i=e[4]*o,u=e[3]*i,c=e[2]*u,l=e[1]*c;if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${l}, ${c}, ${u}, ${i})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${Mu(t)}
      }
    `;const d=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,f=p[0],h=p[1];if(h===l&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${u}, ${i}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(h===o&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const y=di(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${l} + col * ${c} + depth * ${u} +
          depth2 * ${i} + depth3 * ${o} + depth4 + ${y};
      vec2 uv = uvFromFlat(${f}, ${h}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Mu(t){const e=t.name,n=K(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function CY(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",a=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,i=DE(t.shapeInfo.logicalShape,e.logicalShape),u=nt(o),c=o-a;let l;const d=["x","y","z","w","u","v"];a===0?l="":o<2&&i.length>=1?l="coords = 0;":l=i.map(v=>`coords.${d[v+c]} = 0;`).join(`
`);let p="";o<2&&a>0?p="coords":p=t.shapeInfo.logicalShape.map((v,w)=>`coords.${d[w+c]}`).join(", ");let f="return outputValue;";const y=K(t.shapeInfo.logicalShape)===1,g=K(e.logicalShape)===1;if(a===1&&!y&&!g)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(y&&!g)o===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(i.length){const v=a-2,w=a-1;i.indexOf(v)>-1&&i.indexOf(w)>-1?f="return vec4(outputValue.x);":i.indexOf(v)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":i.indexOf(w)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${s}() {
      ${u} coords = getOutputCoords();
      ${l}
      vec4 outputValue = get${r}(${p});
      ${f}
    }
  `}function IY(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",a=e.texShape,o=t.shapeInfo.texShape,i=t.shapeInfo.logicalShape.length,u=e.logicalShape.length;if(!t.shapeInfo.isUniform&&i===u&&t.shapeInfo.flatOffset==null&&yt(o,a))return`
      float ${s}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const c=nt(u),l=DE(t.shapeInfo.logicalShape,e.logicalShape),d=u-i;let p;const f=["x","y","z","w","u","v"];i===0?p="":u<2&&l.length>=1?p="coords = 0;":p=l.map(y=>`coords.${f[y+d]} = 0;`).join(`
`);let h="";return u<2&&i>0?h="coords":h=t.shapeInfo.logicalShape.map((y,x)=>`coords.${f[x+d]}`).join(", "),`
    float ${s}() {
      ${c} coords = getOutputCoords();
      ${p}
      return get${r}(${h});
    }
  `}function nt(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function _w(t,e,n){const{newShape:r,keptDims:s}=Qa(e),a=e.length,o=t&&a===3&&e[0]===1,i=o?e.slice(1):r,u=!t&&a>1&&!yt(e,n)&&r.length<a||o;return{useSqueezeShape:u,uniformShape:u?i:e,keptDims:s}}function Bu(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Vu(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Y(t,e,n,r){const s=n.map((l,d)=>{const p={logicalShape:l.shape,texShape:l.isUniform?null:l.texData.texShape,isUniform:l.isUniform,isPacked:l.isUniform?!1:l.texData.isPacked,flatOffset:null};return l.texData!=null&&l.texData.slice!=null&&l.texData.slice.flatOffset>0&&(p.flatOffset=l.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:p}}),a=s.map(l=>l.shapeInfo),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},i=U9(s,o,e),u=x9(t.gl,i),c=t.createProgram(u);return U().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:u,source:i,webGLProgram:c,inShapeInfos:a,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(c),Object.assign({program:e,fragmentShader:u,source:i,webGLProgram:c,inShapeInfos:a,outShapeInfo:o},LE(t,e,c)))}function LE(t,e,n){const r=[],s=[];let a,o,i,u=null,c=null;c=t.getUniformLocation(n,"NAN",!1),U().getNumber("WEBGL_VERSION")===1&&(u=t.getUniformLocation(n,"INFINITY",!1));const l=!1;for(const d of e.variableNames){const p={name:d,uniform:t.getUniformLocation(n,d,l),offset:t.getUniformLocation(n,`offset${d}`,l)};e.enableShapeUniforms&&(p.shape=t.getUniformLocation(n,`${d}Shape`,l),p.texShape=t.getUniformLocation(n,`${d}TexShape`,l)),r.push(p)}if(e.enableShapeUniforms&&(a=t.getUniformLocation(n,"outShape",l),i=t.getUniformLocation(n,"outShapeStrides",l),o=t.getUniformLocation(n,"outTexShape",l)),e.customUniforms)for(const d of e.customUniforms)s.push(t.getUniformLocation(n,d.name,l));return{variablesLocations:r,customUniformLocations:s,infLoc:u,nanLoc:c,outShapeLocation:a,outShapeStridesLocation:i,outTexShapeLocation:o}}function fS(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,r)=>{const s=n.logicalShape,a=e[r],o=a.shape;if(!yt(s,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${s} and ${o} must match`);if(n.isUniform&&a.isUniform)return;const i=n.texShape,u=a.isUniform?null:a.texData.texShape;if(!yt(i,u))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${i} and ${u} must match`)})}function _Y(t,e,n,r,s){e.program.enableShapeUniforms||(fS(e.inShapeInfos,n),fS([e.outShapeInfo],[r]));const a=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(a.texture,o[0],o[1]):t.setOutputMatrixTexture(a.texture,o[0],o[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),U().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let u=0;u<n.length;++u){const c=n[u],{uniform:l,offset:d,shape:p,texShape:f}=e.variablesLocations[u];if(p){const{uniformShape:h}=_w(e.program.packedInputs,c.shape,c.texData.texShape);switch(h.length){case 1:t.gl.uniform1iv(p,new Int32Array(h));break;case 2:t.gl.uniform2iv(p,new Int32Array(h));break;case 3:t.gl.uniform3iv(p,new Int32Array(h));break;case 4:t.gl.uniform4iv(p,new Int32Array(h));break}}if(f&&t.gl.uniform2i(f,c.texData.texShape[0],c.texData.texShape[1]),l!=null){if(c.isUniform){if(K(c.shape)<2)t.gl.uniform1f(l,c.uniformValues[0]);else{let h=c.uniformValues;h instanceof Float32Array||(h=new Float32Array(h)),t.gl.uniform1fv(l,h)}continue}c.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,c.texData.slice.flatOffset),t.setInputMatrixTexture(c.texData.texture.texture,l,u)}}const i=e.outShapeLocation;if(i)switch(r.shape.length){case 1:t.gl.uniform1iv(i,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(i,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(i,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(i,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const u=Ye(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(u));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(u));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(u));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&s)for(let u=0;u<e.program.customUniforms.length;++u){const c=e.program.customUniforms[u],l=e.customUniformLocations[u],d=s[u];if(c.type==="float")t.gl.uniform1fv(l,d);else if(c.type==="vec2")t.gl.uniform2fv(l,d);else if(c.type==="vec3")t.gl.uniform3fv(l,d);else if(c.type==="vec4")t.gl.uniform4fv(l,d);else if(c.type==="int")t.gl.uniform1iv(l,d);else if(c.type==="ivec2")t.gl.uniform2iv(l,d);else if(c.type==="ivec3")t.gl.uniform3iv(l,d);else if(c.type==="ivec4")t.gl.uniform4iv(l,d);else throw Error(`uniform type ${c.type} is not supported yet.`)}t.executeProgram()}function NY(t,e,n){let r="";e.concat(n).forEach(o=>{const i=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!o.isUniform){const u=o.texData.texShape,{useSqueezeShape:c,uniformShape:l,keptDims:d}=_w(t.packedInputs,o.shape,u);let p="",f="",h="";if(l.length===1&&t.packedInputs){const $=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];p=`${$[0]>1}_${$[1]>1}`}else if(l.length===2&&!t.packedInputs)f=`${l[0]>1}_${l[1]>1}`;else if(l.length>2&&!t.packedInputs){const $=Ye(l);h=`${$[0]===u[1]}_${$[$.length-1]===u[1]}`}const y=o.shape.length,x=l.length===2&&yt(o.shape,u),g=K(o.shape)===1,v=Lp(o.shape,n.shape),w=!t.packedInputs&&y===n.shape.length&&yt(u,n.texData.texShape),S=t.packedInputs||l.length>2?"":`${u[0]>1}_${u[1]>1}`;r+=`${y}_${w}_${c?d:""}_${l.length}_${g}_${v}_${x}_${p}_${f}_${h}_${S}_${i}`}else{const u=o.isUniform?"uniform":o.texData.texShape;r+=`${o.shape}_${u}_${i}`}});const s=t.userCode;let a=t.constructor.name;return a+="_"+r+"_"+s+`${U().getNumber("WEBGL_VERSION")}`,a}function on(t){return U().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kY{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=vc.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=vn();this.outputShape=e,this.enableShapeUniforms=on(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Wh(["r","c","d"],e):ci(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EY{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=vc.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=vn();this.outputShape=e,this.enableShapeUniforms=on(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Wh(["r","c","d"],e):ci(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TY{constructor(e){this.variableNames=["A"],this.outTexUsage=ir.DOWNLOAD;const n=vn();this.outputShape=e,this.userCode=`
      ${OE}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RY{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=ir.DOWNLOAD;const n=vn();this.outputShape=e,this.userCode=`
      ${OE}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AY={R:0,G:1,B:2,A:3};class hS{constructor(e,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=vn();this.outputShape=e,this.enableShapeUniforms=on(this.outputShape.length);let a="result";n&&(a="floor(result * 255. + 0.5)");let o="";for(let i=0;i<r.length;i++){const u=r[i];o+=`
          if(offset == ${i}) {
            result = values[${AY[u]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?$w():Iw(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${s.texture2D}(A, uv);
          ${o}
        }
        ${s.output} = vec4(${a}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OY{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=vn();this.outputShape=e,this.enableShapeUniforms=on(this.outputShape.length);let s="",a="result";n&&(a="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let i=0;i<=1;i++){const u=o*2+i;s+=`
          localCoords = coords;
          if(localCoords[2] + ${i} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${i};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${u}] = values[0];
            } else if (offset == 1) {
              result[${u}] = values[1];
            } else if (offset == 2) {
              result[${u}] = values[2];
            } else {
              result[${u}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?$w():Iw(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${s}

          ${r.output} = ${a};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DY(t){const e=vn(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return y9(t,n)}function PY(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return S9(t,e)}function FY(t){const e=new Uint16Array([0,1,2,2,1,3]);return C9(t,e)}function Uc(t,e,n,r,s,a){$9(e,n);const o=I9(t),i=t.TEXTURE_2D;return fe(t,()=>t.bindTexture(i,o)),fe(t,()=>t.texParameteri(i,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),fe(t,()=>t.texParameteri(i,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),fe(t,()=>t.texParameteri(i,t.TEXTURE_MIN_FILTER,t.NEAREST)),fe(t,()=>t.texParameteri(i,t.TEXTURE_MAG_FILTER,t.NEAREST)),U().getNumber("WEBGL_VERSION")===1?fe(t,()=>t.texImage2D(i,0,r,e,n,0,s,a,null)):fe(t,()=>t.texStorage2D(i,1,r,e,n)),fe(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:o,texShape:[n,e]}}function ME(t){return t.internalFormatFloat}function LY(t,e,n,r){const[s,a]=zc(e,n);return Uc(t,s,a,ME(r),r.textureFormatFloat,t.FLOAT)}function BE(t){return t.internalFormatHalfFloat}function MY(t,e,n,r){const[s,a]=zc(e,n);return Uc(t,s,a,BE(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function VE(t){return t.downloadTextureFormat}function BY(t,e,n,r){const[s,a]=zc(e,n);return Uc(t,s,a,VE(r),t.RGBA,t.UNSIGNED_BYTE)}function zE(t){return t.internalFormatPackedFloat}function VY(t,e,n,r){const[s,a]=Fu(e,n);return Uc(t,s,a,zE(r),t.RGBA,t.FLOAT)}function WE(t){return t.internalFormatPackedHalfFloat}function zY(t,e,n,r){const[s,a]=Fu(e,n);return Uc(t,s,a,WE(r),t.RGBA,r.textureTypeHalfFloat)}function WY(t,e,n){return fe(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),cS(t,e,"clipSpacePos",n,3,20,0)&&cS(t,e,"uv",n,2,20,12)}function UY(t,e,n,r,s,a){fe(t,()=>t.bindTexture(t.TEXTURE_2D,e));let o,i,u;s instanceof Uint8Array?(o=new Uint8Array(n*r*4),i=t.UNSIGNED_BYTE,u=t.RGBA):(o=new Float32Array(n*r*4),i=t.FLOAT,u=a.internalFormatPackedFloat),o.set(s),U().getNumber("WEBGL_VERSION")===2?fe(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,i,o)):fe(t,()=>t.texImage2D(t.TEXTURE_2D,0,u,n,r,0,t.RGBA,i,o)),fe(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function GY(t,e,n){fe(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?U().getNumber("WEBGL_VERSION")===2?fe(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):fe(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):U().getNumber("WEBGL_VERSION")===2?fe(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):fe(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),fe(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function HY(t,e,n,r){const s=t.createBuffer();fe(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,s));const i=4*4*e*n;return fe(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,i,t.STREAM_READ)),fe(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),fe(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),s}function jY(t,e,n){const r=t,s=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,s),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),s}function KY(t,e,n,r){const[s,a]=zc(e,n),o=4,i=new Uint8Array(c9(e*n,o));return fe(t,()=>t.readPixels(0,0,s,a,r.downloadTextureFormat,t.UNSIGNED_BYTE,i)),new Float32Array(i.buffer)}function qY(t,e,n,r,s,a,o,i){const u=t,c=new Float32Array(d9(a,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function XY(t,e,n){const r=new Float32Array(e*n*4);return fe(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gm{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=U().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,i9(n,e)):this.gl=ls(n),e=this.gl,U().getNumber("WEBGL_VERSION")===2){const a=e;this.createVertexArray=()=>fe(a,()=>a.createVertexArray()),this.bindVertexArray=o=>fe(a,()=>a.bindVertexArray(o)),this.deleteVertexArray=o=>fe(a,()=>a.deleteVertexArray(o)),this.getVertexArray=()=>fe(a,()=>a.getParameter(a.VERTEX_ARRAY_BINDING))}else if(e!=null){const a=e.getExtension("OES_vertex_array_object");if(a==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>fe(e,()=>a.createVertexArrayOES()),this.bindVertexArray=o=>fe(e,()=>a.bindVertexArrayOES(o)),this.deleteVertexArray=o=>fe(e,()=>a.deleteVertexArrayOES(o)),this.getVertexArray=()=>fe(e,()=>e.getParameter(a.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const s="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),U().getNumber("WEBGL_VERSION")===1){const a="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=Ad(this.gl,a),Or(this.gl,o))this.textureHalfFloatExtension=Ad(this.gl,o);else if(U().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Or(this.gl,s))this.colorBufferHalfFloatExtension=Ad(this.gl,s);else if(U().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Or(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(Or(this.gl,s))this.colorBufferHalfFloatExtension=this.gl.getExtension(s);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=PY(this.gl),this.indexBuffer=FY(this.gl),this.framebuffer=_9(this.gl),this.textureConfig=Cw(this.gl,this.textureHalfFloatExtension)}get debug(){return U().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;fe(e,()=>e.finish()),fe(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),fe(e,()=>e.deleteFramebuffer(this.framebuffer)),fe(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),fe(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),fe(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),LY(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),MY(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),BY(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),GY(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,r,s){this.throwIfDisposed(),UY(this.gl,e,n,r,s,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),zY(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),VY(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(dS(this.gl,this.framebuffer),this.outputTexture=null),fe(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,r){return this.downloadMatrixDriver(e,()=>KY(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,r,s,a,o){return qY(this.gl,e,n,r,s,a,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return jY(this.gl,e,n)}createBufferFromTexture(e,n,r){this.bindTextureToFrameBuffer(e);const s=HY(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),s}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,r;if(U().getBool("WEBGL_FENCE_API_ENABLED")){const s=e,a=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const o=s.clientWaitSync(a,0,0);return o===s.ALREADY_SIGNALED||o===s.CONDITION_SATISFIED},n=a}else U().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,U().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(e,n,r){return this.downloadMatrixDriver(e,()=>XY(this.gl,n,r))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=DY(n));const r=w9(n);fe(n,()=>n.attachShader(r,this.vertexShader)),fe(n,()=>n.attachShader(r,e)),b9(n,r);const s=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&Vm(n,s),s}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;fe(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),WY(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(fe(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Vm(this.gl,this.program),fe(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,r=!0){return this.throwIfDisposed(),r?k9(this.gl,e,n):E9(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),fe(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),T9(this.gl,e,n,r)}setOutputMatrixTexture(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)}setOutputPackedMatrixTexture(e,n,r){this.throwIfDisposed();const[s,a]=Fu(n,r);this.setOutputMatrixTextureDriver(e,s,a)}setOutputMatrixWriteRegion(e,n,r,s){this.setOutputMatrixWriteRegionDriver(r,e,s,n)}setOutputPackedMatrixWriteRegion(e,n,r,s){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Vm(this.gl,this.program),Od(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}fe(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),fe(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Ad(this.gl,U().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(U().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),a=r.createQuery();return r.beginQuery(s.TIME_ELAPSED_EXT,a),a}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(U().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await xb(()=>this.disposed||this.isQueryAvailable(e,U().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,U().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),a=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),a&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),s=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),s&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=YY(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in U().platform&&(r=U().platform.setTimeoutCustom.bind(U().platform)),xb(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),zm(this.gl,e,this.framebuffer),this.debug&&Od(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(zm(this.gl,this.outputTexture,this.framebuffer),this.debug&&Od(this.gl)):dS(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,n,r){this.throwIfDisposed();const s=this.gl;zm(s,e,this.framebuffer),this.debug&&Od(s),this.outputTexture=e,fe(s,()=>s.viewport(0,0,n,r)),fe(s,()=>s.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(e,n,r,s){this.throwIfDisposed(),fe(this.gl,()=>this.gl.scissor(e,n,r,s))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function YY(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:QY,bincountImpl:UE,bincountReduceImpl:ZY,bitwiseAndImpl:JY,castImpl:eQ,ceilImpl:tQ,concatImpl:nQ,equalImpl:rQ,expImpl:sQ,expm1Impl:aQ,floorImpl:oQ,gatherNdImpl:iQ,gatherV2Impl:uQ,greaterImpl:lQ,greaterEqualImpl:cQ,lessImpl:dQ,lessEqualImpl:pQ,linSpaceImpl:fQ,logImpl:hQ,maxImpl:mQ,maximumImpl:gQ,minimumImpl:yQ,multiplyImpl:xQ,negImpl:vQ,notEqualImpl:wQ,prodImpl:bQ,raggedGatherImpl:SQ,raggedRangeImpl:CQ,raggedTensorToTensorImpl:IQ,rangeImpl:$Q,rsqrtImpl:_Q,scatterImpl:NQ,sigmoidImpl:kQ,simpleAbsImpl:GE,sliceImpl:EQ,sparseFillEmptyRowsImpl:TQ,sparseReshapeImpl:RQ,sparseSegmentReductionImpl:HE,sqrtImpl:AQ,staticRegexReplaceImpl:OQ,stridedSliceImpl:DQ,stringNGramsImpl:PQ,stringSplitImpl:FQ,stringToHashBucketFastImpl:LQ,subImpl:MQ,tileImpl:BQ,topKImpl:VQ,transposeImpl:Nw,uniqueImpl:zQ}=I8;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jE(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function gn(t,e){return e===1?[t]:jE(t,e)}function WQ(t,e){if(t===1)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UQ{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=on(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=gn("rc",this.rank),r=nt(this.rank),s=this.getOutOfBoundsCondition(n),a=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${s}) {
            setOutput(vec4(0));
          } else {
            ${a}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let a=`${r===0?"r":"rp1"}, ${s===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)a=`${e[e.length-1-o]},`+a;n.push(a)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],s=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${s};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KE{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=on(this.outputShape.length);let r="";for(let s=0;s<4;s++){let a="thisRC = rc;";s%2===1&&(a+="thisRC.z += 1;"),s>1&&(a+="thisRC.y += 1;"),r+=`
        ${a}
        ${s>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${s}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${s>0?"}":""}
      `}this.userCode=`
      ${GQ(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?$w():Iw(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function GQ(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?W9(["r","c","d"],"inputShape"):ci(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HQ{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,r){const s=gS(n,r),a=yS(e,s,r);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);const o=mS(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const u=this.freeTextures[a].pop();return this.usedTextures[a].push(u),u}let i;return s===Ht.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):s===Ht.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):s===Ht.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):s===Ht.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):s===Ht.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(i),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),i}releaseTexture(e,n,r,s){if(this.freeTextures==null)return;const a=gS(r,s),o=yS(n,a,s);o in this.freeTextures||(this.freeTextures[o]=[]);const i=mS(n,a,this.gpgpu.gl,this.gpgpu.textureConfig,s),u=U().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");u!==-1&&this._numBytesAllocated>u?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=i):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=i),this.numUsedTextures--;const c=this.usedTextures[o],l=c&&c.indexOf(e);if(l==null||l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[l]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function jQ(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function mS(t,e,n,r,s){const a=KQ(e,r);let o;if(s){const[u,c]=Fu(t[0],t[1]);o=u*c}else{const[u,c]=zc(t[0],t[1]);o=u*c}const i=jQ(n,a);return o*i}function KQ(t,e){switch(t){case Ht.PACKED_2X2_FLOAT32:return zE(e);case Ht.PACKED_2X2_FLOAT16:return WE(e);case Ht.UNPACKED_FLOAT32:return ME(e);case Ht.UNPACKED_FLOAT16:return BE(e);case Ht.PACKED_4X1_UNSIGNED_BYTE:return VE(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function qQ(t){return U().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Ht.PACKED_2X2_FLOAT32:Ht.UNPACKED_FLOAT32:t?Ht.PACKED_2X2_FLOAT16:Ht.UNPACKED_FLOAT16}function gS(t,e){if(t===ir.UPLOAD)return Ht.PACKED_2X2_FLOAT32;if(t===ir.RENDER||t==null)return qQ(e);if(t===ir.DOWNLOAD||t===ir.PIXELS)return Ht.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function yS(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Is{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=on(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Vr="if (isnan(x)) return x;",XQ="return x;",xS="return abs(x);",YQ="return (x >= 0.0) ? x : (exp(x) - 1.0);",QQ=Vr+`
  return (x < 0.0) ? 0.0 : x;
`,ZQ=Vr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,xa="return x;",JQ="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eZ="return x;",tZ=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,nZ=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,rZ=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,sZ="return 1.0 / (1.0 + exp(-1.0 * x));";class _a{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=on(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aZ{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=on(this.outputShape.length);const n=e.length,r=gn("rc",n),s=nt(n),a=WQ(n,r),o=r.slice(-2),i=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${s} rc = getOutputCoords();
        vec4 packedInput = getA(${a});

        setOutput(getChannel(packedInput, ${i}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oZ=K_,iZ=1e-7,uZ=1e-4,Fd={};function lZ(t){return t in Fd||(Fd[t]={}),Fd[t]}const cZ=U().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),dZ=600;function pZ(){return U().global.screen==null?1024:U().global.screen.height*U().global.screen.width*window.devicePixelRatio*dZ/1024/1024}class Uh extends j0{nextDataId(){return Uh.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!U().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof Gm)n=e;else{const r=ls(U().getNumber("WEBGL_VERSION"),e);n=new Gm(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=ls(U().getNumber("WEBGL_VERSION"));n=new Gm(r),this.binaryCache=lZ(U().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new HQ(this.gpgpu),this.numMBBeforeWarning=pZ(),this.texData=new Q2(this,vs())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,r,s,a,o){const i=this.makeTensorInfo(n,r),u=this.texData.get(i.dataId);u.isPacked=!1,u.texture={texture:e,texShape:[s,a]},u.texShape=[s,a];const c=Dd(n),l=new hS(c,!1,o),d=this.runWebGLProgram(l,[i],r,[[s,a]]);return d.shape=n,u.texture=null,this.disposeIntermediateTensorInfo(i),d.dataId}write(e,n,r){if((U().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||U().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.texData.set(s,{shape:n,dtype:r,values:e,usage:ir.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,r,s,a){if(U().getBool("DEBUG")&&this.checkNumericalProblems(n),s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:s,values:n,usage:ir.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:r,dtype:s,complexTensorInfos:a,slice:o,shape:i,isPacked:u}=n;if(o!=null){let p;u?p=new _a(i,xa):p=new Is(i,xa);const f=this.runWebGLProgram(p,[{dataId:e,shape:i,dtype:s}],s),h=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),h}if(r!=null)return this.convertAndCacheOnCPU(e);if(s==="string")return r;const c=this.activeTimers!=null;let l;c&&(l=sr());let d;if(s==="complex64"){const p=this.readSync(a.real.dataId),f=this.readSync(a.imag.dataId);d=yy(p,f)}else d=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=sr()-l),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const h=this.pendingRead.get(e);return new Promise(y=>h.push(y))}const n=this.texData.get(e),{values:r,shape:s,slice:a,dtype:o,complexTensorInfos:i,isPacked:u}=n;if(a!=null){let h;u?h=new _a(s,xa):h=new Is(s,xa);const y=this.runWebGLProgram(h,[{dataId:e,shape:s,dtype:o}],o),x=this.read(y.dataId);return this.disposeIntermediateTensorInfo(y),x}if(r!=null)return this.convertAndCacheOnCPU(e);if(U().getBool("DEBUG")&&!U().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&U().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,l;if(o!=="complex64"&&U().get("WEBGL_BUFFER_SUPPORTED")){l=this.decode(e);const h=this.texData.get(l.dataId);c=this.gpgpu.createBufferFromTexture(h.texture.texture,...Rd(s))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(o==="complex64"){const h=await Promise.all([this.read(i.real.dataId),this.read(i.imag.dataId)]),y=h[0],x=h[1];d=yy(y,x)}else if(c==null)d=this.getValuesFromTexture(e);else{const h=K(s);d=this.gpgpu.downloadFloat32MatrixFromBuffer(c,h)}if(l!=null&&this.disposeIntermediateTensorInfo(l),c!=null){const h=this.gpgpu.gl;fe(h,()=>h.deleteBuffer(c))}const p=this.convertAndCacheOnCPU(e,d),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(h=>h(p)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&vs().removeDataId(e,this),this.pendingDeletes--),p}readToGPU(e,n={}){const r=this.texData.get(e),{values:s,shape:a,slice:o,dtype:i,isPacked:u,texture:c}=r;if(i==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let f;u?f=new _a(a,xa):f=new Is(a,xa);const h=this.runWebGLProgram(f,[{dataId:e,shape:a,dtype:i}],i),y=this.readToGPU(h,n);return this.disposeIntermediateTensorInfo(h),y}if(c==null)throw s!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const l=this.decode(e,n.customTexShape),d=vs().makeTensorFromTensorInfo(l),p=this.texData.get(l.dataId);return Object.assign({tensorRef:d},p.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>bu(s));return xt(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return xt(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const r=e[n];if(!m9(r))throw U().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:r,isPacked:s}=this.texData.get(e),a=K(n);if(U().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const p=this.decode(e),f=this.texData.get(p.dataId),h=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...Rd(n)).subarray(0,a);return this.disposeIntermediateTensorInfo(p),h}const o=U().getBool("WEBGL_PACK")&&s===!0,i=o?Dd(n):n,u=o?new RY(i):new TY(i),c=this.runWebGLProgram(u,[{shape:i,dtype:r,dataId:e}],"float32"),l=this.texData.get(c.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(l.texture.texture,l.texShape[0],l.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(c),d}timerAvailable(){return U().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,r=[];let s=!1;this.programTimersStack==null?(this.programTimersStack=r,s=!0):this.activeTimers.push(r),this.activeTimers=r,e();const a=Uo(this.activeTimers.map(u=>u.query)).filter(u=>u!=null),o=Uo(this.activeTimers.map(u=>u.name)).filter(u=>u!=null);this.activeTimers=n,s&&(this.programTimersStack=null);const i={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(U().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const u=await Promise.all(a);i.kernelMs=fF(u),i.getExtraProfileInfo=()=>u.map((c,l)=>({name:o[l],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else i.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,i})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return U().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:sr(),endMs:null}}endTimer(e){return U().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=sr(),e)}async getQueryTime(e){if(U().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:r,texShape:s,usage:a,isPacked:o,slice:i}=this.texData.get(e),u=i&&i.origDataId||e,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),n!=null&&(this.numBytesInGPU-=this.computeBytes(s,r),this.textureManager.releaseTexture(n,s,a,o)));const l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=cZ){return U().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&K(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){Jr("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return oZ(e.shape,n)}packedUnaryOp(e,n,r){const s=new _a(e.shape,n),a=this.compileAndRun(s,[e],r);return vs().makeTensorFromTensorInfo(a)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const s=GE(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(U().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,xS,e.dtype);const n=new Is(e.shape,xS),r=this.compileAndRun(n,[e]);return vs().makeTensorFromTensorInfo(r)}makeTensorInfo(e,n,r){let s;if(n==="string"&&r!=null&&r.length>0&&If(r[0])){const a=r.map(o=>Oo(o));s=this.write(a,e,n)}else s=this.write(r,e,n);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:n}}makeOutput(e,n,r){return vs().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,r),this)}unpackTensor(e){const n=new aZ(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new UQ(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const r=[$u(e.shape),..._u(e.shape)],s={dtype:e.dtype,shape:r,dataId:e.dataId},a=[$u(n),..._u(n)],o=new KE(a,r),i=!0,u=[r],c=this.runWebGLProgram(o,[s],e.dtype,u,i);return{dataId:c.dataId,shape:n,dtype:c.dtype}}decode(e,n){const r=this.texData.get(e),{isPacked:s,shape:a,dtype:o}=r;if(n!=null){const p=K(a),f=n[0]*n[1]*4;E(p<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const i=Dd(a);let u;s?u=new EY(i):u=new kY(i);const c=!0,l=[n??Rd(i)],d=this.runWebGLProgram(u,[{shape:i,dtype:o,dataId:e}],o,l,c,n);return{dtype:o,shape:a,dataId:d.dataId}}runWebGLProgram(e,n,r,s,a=!1,o){const i=this.makeTensorInfo(e.outputShape,r),u=this.texData.get(i.dataId);if(e.packedOutput&&(u.isPacked=!0),e.outPackingScheme===vc.DENSE){const g=o??Rd(e.outputShape);u.texShape=g.map(v=>v*2)}if(e.outTexUsage!=null&&(u.usage=e.outTexUsage),K(i.shape)===0)return u.values=Ua(i.dtype,0),i;const c=[],l=n.map(g=>{if(g.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let v=this.texData.get(g.dataId);if(v.texture==null){if(!e.packedInputs&&K(g.shape)<=U().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:g.shape,texData:null,isUniform:!0,uniformValues:v.values};e.packedInputs&&(v.isPacked=!0,v.shape=g.shape)}if(this.uploadToGPU(g.dataId),!!v.isPacked!=!!e.packedInputs)g=v.isPacked?this.unpackTensor(g):this.packTensor(g),c.push(g),v=this.texData.get(g.dataId);else if(v.isPacked&&!qp(v.shape,g.shape)){const w=g,S=g.shape;g.shape=v.shape,g=this.packedReshape(g,S),c.push(g),v=this.texData.get(g.dataId),w.shape=S}return{shape:g.shape,texData:v,isUniform:!1}});this.uploadToGPU(i.dataId);const d={shape:i.shape,texData:u,isUniform:!1},p=NY(e,l,d),f=this.getAndSaveBinary(p,()=>$Y(this.gpgpu,e,l,d)),h=this.activeTimers!=null;let y;h&&(y=this.startTimer()),U().get("ENGINE_COMPILE_ONLY")||_Y(this.gpgpu,f,l,d,s),c.forEach(g=>this.disposeIntermediateTensorInfo(g)),h&&(y=this.endTimer(y),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(y)}));const x=U().getNumber("WEBGL_FLUSH_THRESHOLD");if(x>0){const g=sr();g-this.lastGlFlushTime>x&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=g)}if(!U().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&a===!1){const g=this.unpackTensor(i);return this.disposeIntermediateTensorInfo(i),g}return i}compileAndRun(e,n,r,s,a=!1){return r=r||n[0].dtype,this.runWebGLProgram(e,n,r,s,a)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(U().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=De(()=>{if(!U().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=U().getBool("DEBUG");U().set("DEBUG",!1);const n=this.abs(Ve(1e-8)).dataSync()[0];if(U().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?iZ:uZ}uploadToGPU(e){const n=this.texData.get(e),{shape:r,dtype:s,values:a,texture:o,usage:i,isPacked:u}=n;if(o!=null)return;const c=this.activeTimers!=null;let l;c&&(l=sr());let d=n.texShape;if(d==null&&(d=O9(r,u),n.texShape=d),a!=null){const p=Dd(r);let f,h=d[1],y=d[0];const x=a instanceof Uint8Array||a instanceof Uint8ClampedArray;(u||!x)&&([h,y]=Fu(d[0],d[1])),u?f=new OY(p,x):f=new hS(p,x);const g=x?[y,h]:d,v=this.makeTensorInfo(g,s),w=this.texData.get(v.dataId);x?w.usage=ir.PIXELS:w.usage=ir.UPLOAD,w.texShape=g,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(v.dataId),h,y,a);const S=[[y,h]],k=this.runWebGLProgram(f,[v],s,S,!0),T=this.texData.get(k.dataId);n.texShape=T.texShape,n.isPacked=T.isPacked,n.usage=T.usage,U().get("ENGINE_COMPILE_ONLY")?this.disposeData(k.dataId):(n.texture=T.texture,n.values=null,this.texData.delete(k.dataId)),this.disposeIntermediateTensorInfo(v),c&&(this.uploadWaitMs+=sr()-l)}else{const p=this.acquireTexture(d,i,s,u);n.texture=p}}convertAndCacheOnCPU(e,n){const r=this.texData.get(e),{dtype:s}=r;return n!=null&&(r.values=fZ(n,s)),r.values}acquireTexture(e,n,r,s){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${a} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,s)}computeBytes(e,n){return e[0]*e[1]*vu(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(s=>{try{this.checkCompletion_(n),s(!0)}catch(a){throw a}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await CG(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(AE(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:r,infLoc:s,nanLoc:a,outShapeLocation:o,outShapeStridesLocation:i,outTexShapeLocation:u}=LE(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=r,e.infLoc=s,e.nanLoc=a,e.outShapeLocation=o,e.outShapeStridesLocation=i,e.outTexShapeLocation=u}}createTensorFromGPUData(e,n,r){e.channels=e.channels||"RGBA";const{texture:s,height:a,width:o,channels:i}=e,u=vs().backend;if(!u.gpgpu.gl.isTexture(s))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=u.writeTexture(s,n,r,a,o,i);return vs().makeTensorFromDataId(c,n,r,u)}}Uh.nextDataId=0;function fZ(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */G$()&&Dv("webgl",()=>new Uh,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kw=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Jo{constructor(e,n,r){this.variableNames=["A","B"],this.outputShape=Le(n,r),this.enableShapeUniforms=on(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pi=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class zu{constructor(e,n,r,s=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Le(n,r);const a=this.outputShape.length;this.enableShapeUniforms=on(a);let o="";if(s)if(a===0||K(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${nt(a)} coords = getOutputCoords();
        `,a===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const u=gn("coords",a);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${u[a-2]} + 1) >= outShape[${a} - 2];
            bool nextColOutOfBounds =
              (${u[a-1]} + 1) >= outShape[${a} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${u[a-2]} + 1) >= ${this.outputShape[a-2]};
            bool nextColOutOfBounds =
              (${u[a-1]} + 1) >= ${this.outputShape[a-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xn(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const hZ={kernelName:Kf,backendName:"webgl",kernelFunc:Xn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function so(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,a=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(a.dataId),i=Xn({inputs:{x:r},backend:n}),u=Xn({inputs:{x:s},backend:n});return o.complexTensorInfos={real:i,imag:u},a}const mZ={kernelName:a$,backendName:"webgl",kernelFunc:so};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qE="return (a < 0.) ? b * a : a;",XE=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function gZ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:a}=r,o=n.makeTensorInfo([],"float32",Du(a,"float32")),i=U().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new zu(XE,s.shape,o.shape):new Jo(qE,s.shape,o.shape),u=n.runWebGLProgram(i,[s,o],"float32");return n.disposeIntermediateTensorInfo(o),u}const yZ={kernelName:qf,backendName:"webgl",kernelFunc:gZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YE="return (a < 0.) ? b * a : a;",QE=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function xZ(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e,a=U().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new zu(QE,r.shape,s.shape):new Jo(YE,r.shape,s.shape);return n.runWebGLProgram(a,[r,s],"float32")}const vZ={kernelName:uh,backendName:"webgl",kernelFunc:xZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wu="if (isnan(x)) return x;";function We({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:s,backend:a})=>{const{x:o}=s,i=a,u=r||o.dtype;if(i.shouldExecuteOnCPU([o])&&n!=null){const d=i.texData.get(o.dataId),p=n(d.values,u);return i.makeTensorInfo(o.shape,u,p)}const c=U().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let l;return c?l=new _a(o.shape,e):l=new Is(o.shape,t),i.runWebGLProgram(l,[o],u)}}function Qt({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:s,dtype:a}){return({inputs:o,backend:i})=>{const{a:u,b:c}=o,l=i;if(r&&u.dtype==="complex64"){const h=l.texData.get(u.dataId),y=l.texData.get(c.dataId),[x,g]=[[h.complexTensorInfos.real,y.complexTensorInfos.real],[h.complexTensorInfos.imag,y.complexTensorInfos.imag]].map(w=>{const[S,$]=w,k={dataId:S.dataId,dtype:S.dtype,shape:u.shape},T={dataId:$.dataId,dtype:$.dtype,shape:c.shape},A=new Jo(t,u.shape,c.shape);return l.runWebGLProgram(A,[k,T],Ts(S.dtype,$.dtype))}),v=so({inputs:{real:x,imag:g},backend:l});return l.disposeIntermediateTensorInfo(x),l.disposeIntermediateTensorInfo(g),v}const d=a||Ts(u.dtype,c.dtype);if((u.dtype==="string"||c.dtype==="string"||l.shouldExecuteOnCPU([u,c]))&&s!=null){const h=l.texData.get(u.dataId).values,y=l.texData.get(c.dataId).values,x=u.dtype==="string"?Iu(h):h,g=u.dtype==="string"?Iu(y):y,[v,w]=s(u.shape,c.shape,x,g,d),S=l.makeTensorInfo(w,d),$=l.texData.get(S.dataId);return $.values=v,S}const p=U().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return p?f=new zu(e,u.shape,c.shape,n):f=new Jo(t,u.shape,c.shape),l.runWebGLProgram(f,[u,c],d)}}function wc(t,e=!1){if(t==="linear")return e?eZ:XQ;if(t==="relu")return e?nZ:QQ;if(t==="elu")return e?tZ:YQ;if(t==="relu6")return e?rZ:ZQ;if(t==="prelu")return e?QE:YE;if(t==="leakyrelu")return e?XE:qE;if(t==="sigmoid")return e?sZ:JQ;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZE{constructor(e,n,r,s=!1,a=!1,o=!1,i=null,u=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=on(this.outputShape.length);const l=s?e[1]:e[2],d=Math.ceil(l/2),p=s?"i * 2, rc.y":"rc.y, i * 2",f=a?"rc.z, i * 2":"i * 2, rc.z",h=s?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],y=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let x="",g="";i&&(u?x=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${i}
        }`:c?x=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${i}
        }`:x=`vec4 activation(vec4 x) {
          ${i}
        }`,g="result = activation(result);");const v=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let w="rc.x",S="rc.x";e[0]<n[0]?w=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(S=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${x}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${w};
        int batchB = ${S};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${p});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${h[0]} * ${y[0]});
          result += (${h[1]} * ${y[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${v}

        ${g}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vS={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class wS{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Le(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bS="return a * b;";function Ew(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,a=Ts(r.dtype,s.dtype);if(r.dtype==="complex64"){const i=n.texData.get(r.dataId),u=n.texData.get(s.dataId),c=new wS(vS.REAL,r.shape,s.shape),l=new wS(vS.IMAG,r.shape,s.shape),d=[{dataId:i.complexTensorInfos.real.dataId,dtype:i.complexTensorInfos.real.dtype,shape:r.shape},{dataId:i.complexTensorInfos.imag.dataId,dtype:i.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:s.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:s.shape}],p=n.runWebGLProgram(c,d,"float32"),f=n.runWebGLProgram(l,d,"float32"),h=so({inputs:{real:p,imag:f},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),h}if(n.shouldExecuteOnCPU([r,s])){const i=n.texData.get(r.dataId),u=n.texData.get(s.dataId),[c,l]=xQ(r.shape,s.shape,i.values,u.values,a),d=n.makeTensorInfo(l,a),p=n.texData.get(d.dataId);return p.values=c,d}let o;return U().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new zu(bS,r.shape,s.shape):o=new Jo(bS,r.shape,s.shape),n.runWebGLProgram(o,[r,s],a)}const wZ={kernelName:Kx,backendName:"webgl",kernelFunc:Ew};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bZ(t,e,n){const r=[$u(t.shape),..._u(t.shape)],s={dtype:t.dtype,shape:r,dataId:t.dataId},a=[$u(e),..._u(e)],o=new KE(a,r),i=!0,u=[r],c=n.runWebGLProgram(o,[s],t.dtype,u,i);return{dataId:c.dataId,shape:e,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ie(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{shape:a}=r,o=n,i=K(s.shape),u=Z2(a,i),c=K(u);E(i===c,()=>`The new shape (${u}) has ${c} elements and the old shape (${s.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`);const l=o.texData.get(s.dataId);return l.isPacked&&!qp(s.shape,u)&&!(l.texture!==null&&qp(l.shape,u))?bZ(s,u,o):(o.incRef(s.dataId),{dataId:s.dataId,shape:u,dtype:s.dtype})}const SZ={kernelName:nv,backendName:"webgl",kernelFunc:ie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SS{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:a,outSize:o}=e;this.outputShape=[s,o];const i=Math.floor(r/4)*4,u=r%4;let c="sumValue += dot(values, ones);";if(n!=null){const d=1/n;c=`sumValue += dot(values * ${xu(d)?d.toPrecision(2):d}, ones);`}let l="";a%r>0&&(l=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${l}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${i}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${i};
        if (${u===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${u===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${u===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CZ{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:a,outSize:o}=e;this.outputShape=[s,o];let i="0.0",u="";n==="prod"?i="1.0":n==="min"?(i="1.0 / 1e-20",u="min"):n==="max"&&(i="-1.0 / 1e-20",u="max");let c=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?c="sumValue":n==="prod"?c="prodValue":n==="all"?c="allValue":n==="any"&&(c="anyValue");const l=Math.floor(r/4)*4,d=r%4;let p=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${u}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${u}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(i="1.0",p=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(i="0.0",p=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let h="";a%r>0&&(h=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${i};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${i});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${l}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${p}
        }

        int inIdx = inOffset + ${l};
        if (${d===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${d===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${d===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${p}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IZ(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],r=Vh(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}function fi(t,e,n,r){const s=IZ(t.shape);let a=t;for(let o=0;o<s.length;o++){const{inSize:i,windowSize:u,outSize:c}=s[o];let l,d;n==="mean"?l=o===0?new SS({windowSize:u,inSize:i,batchSize:t.shape[0],outSize:c},i):new SS({windowSize:u,inSize:i,batchSize:t.shape[0],outSize:c}):l=new CZ({windowSize:u,inSize:i,batchSize:t.shape[0],outSize:c},n),d=a,a=r.runWebGLProgram(l,[a],e),d.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(d)}return a}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Z{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[n[o]];this.outputShape=r,this.rank=r.length;const s=nt(this.rank),a=_Z(n);this.userCode=`
    void main() {
      ${s} resRC = getOutputCoords();
      setOutput(getA(${a}));
    }
    `}}function _Z(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let s=0;s<t.length;s++)r[t[s]]=n[s];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NZ{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let l=0;l<r.length;l++)r[l]=e[n[l]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const s=nt(this.rank),a=jE("rc",this.rank),o=new Array(this.rank);for(let l=0;l<n.length;l++)o[n[l]]=a[l];const i=`vec2(${o.slice(-2).join()})`,u=`++${a[this.rank-1]} < ${r[this.rank-1]}`,c=`getChannel(getA(${o.join()}), ${i})`;this.userCode=`
    void main() {
      ${s} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${u}) {
        result[1] = ${c};
      }
      --${a[this.rank-1]};
      if(++${a[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${c};
        if(${u}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gh(t,e,n){const r=U().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new NZ(t.shape,e):new $Z(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kZ(t,e,n,r){const s=e,a=t.shape.length,o=vt(s,t.shape);let i=o;const u=An(i,a),c=u!=null;let l=t;c&&(l=Gh(t,u,r),i=Xt(i.length,a)),Dt("sum",i,a);const[d,p]=an(l.shape,i);let f=d;n&&(f=Ot(d,o));const h=K(p),x=K(t.shape)/h,g=ie({inputs:{x:l},attrs:{shape:[x,h]},backend:r}),v=Ov(t.dtype),w=fi(g,v,"sum",r),S=ie({inputs:{x:w},attrs:{shape:f},backend:r});return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(w),c&&r.disposeIntermediateTensorInfo(l),S}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hh(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:a,keepDims:o}=r;return kZ(s,a,o,n)}const EZ={kernelName:gh,backendName:"webgl",kernelFunc:Hh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xn(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{perm:a}=r,o=n,i=s.shape.length,u=new Array(i);for(let l=0;l<u.length;l++)u[l]=s.shape[a[l]];let c;if(o.shouldExecuteOnCPU([s])){const d=o.texData.get(s.dataId).values,p=Nw(d,s.shape,s.dtype,a,u);c=o.makeTensorInfo(u,s.dtype);const f=o.texData.get(c.dataId);f.values=p}else c=Gh(s,a,o);return c}const TZ={kernelName:au,backendName:"webgl",kernelFunc:xn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JE=1e3;function Xp({a:t,b:e,transposeA:n,transposeB:r,backend:s,bias:a=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:u=null}){const c=t.shape.length,l=e.shape.length,d=n?t.shape[c-2]:t.shape[c-1],p=r?e.shape[l-1]:e.shape[l-2],f=n?t.shape[c-1]:t.shape[c-2],h=r?e.shape[l-2]:e.shape[l-1],y=t.shape.slice(0,-2),x=e.shape.slice(0,-2),g=K(y),v=K(x),S=Le(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,h]);E(d===p,()=>`Error in matMul: inner shapes (${d}) and (${p}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const $=n?[g,d,f]:[g,f,d],k=r?[v,h,p]:[v,p,h],T=ie({inputs:{x:t},backend:s,attrs:{shape:$}}),A=ie({inputs:{x:e},backend:s,attrs:{shape:k}}),B=[T,A],L=Math.max(g,v),z=n?T.shape[1]:T.shape[2],Y=a!=null,Q=o!=null,re=u==="leakyrelu",Z=u!=null?wc(u,!0):null,de=Y||Q||re||Z!=null;let ce;if((f===1||h===1)&&z>JE&&de===!1){let ee=T,me=A;n&&(ee=xn({inputs:{x:T},backend:s,attrs:{perm:[0,2,1]}}),B.push(ee)),r&&(me=xn({inputs:{x:A},backend:s,attrs:{perm:[0,2,1]}}),B.push(me));const Ie=h!==1,Pe=h===1;let Ge=ee;Ie&&(Ge=ie({inputs:{x:ee},backend:s,attrs:{shape:[L,z,1]}}),B.push(Ge));const _t=h===1?2:1;let Pt=me;Pe&&(Pt=ie({inputs:{x:me},backend:s,attrs:{shape:[L,1,z]}}),B.push(Pt));const Nt=Ew({inputs:{a:Ge,b:Pt},backend:s});ce=Hh({inputs:{x:Nt},backend:s,attrs:{axis:_t,keepDims:!0}}),B.push(Nt)}else{const ee=Ts(t.dtype,e.dtype),me=new ZE($,k,[L,f,h],n,r,Y,Z,Q,re),Ie=[T,A];if(a!=null&&Ie.push(a),Q&&Ie.push(o),re){const Pe=s.makeTensorInfo([],"float32",Du(i,"float32"));Ie.push(Pe),B.push(Pe)}ce=s.runWebGLProgram(me,Ie,ee)}const j=ie({inputs:{x:ce},backend:s,attrs:{shape:S}});B.push(ce);for(const ee of B)s.disposeIntermediateTensorInfo(ee);return j}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RZ(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:a,bias:o,preluActivationWeights:i}=e,{transposeA:u,transposeB:c,activation:l,leakyreluAlpha:d}=r;return Xp({a:s,b:a,transposeA:u,transposeB:c,backend:n,bias:o,preluActivationWeights:i,leakyreluAlpha:d,activation:l})}const AZ={kernelName:oc,backendName:"webgl",kernelFunc:RZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CS="return abs(x);";function OZ(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const a=n.texData.get(r.dataId),o=GE(a.values);return n.makeTensorInfo(r.shape,r.dtype,o)}let s;return U().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new _a(r.shape,CS):s=new Is(r.shape,CS),n.runWebGLProgram(s,[r],r.dtype)}const DZ={kernelName:Y0,backendName:"webgl",kernelFunc:OZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PZ=Vr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,FZ=We({opSnippet:PZ}),LZ={kernelName:Q0,backendName:"webgl",kernelFunc:FZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MZ=Vr+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,BZ=We({opSnippet:MZ}),VZ={kernelName:Z0,backendName:"webgl",kernelFunc:BZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IS="return a + b;",zZ=Qt({opSnippet:IS,packedOpSnippet:IS,supportsComplex:!0,cpuKernelImpl:QY}),WZ={kernelName:$f,backendName:"webgl",kernelFunc:zZ};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UZ{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((a,o)=>`T${o}`);const r=[];this.variableNames.forEach(a=>{r.push(`float v${a} = get${a}AtOutCoords();`)});const s=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GZ{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((a,o)=>`T${o}`);const r=[];this.variableNames.forEach(a=>{r.push(`vec4 v${a} = get${a}AtOutCoords();`)});const s=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rp(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return Xn({inputs:{x:r[0]},backend:n});if(r.length>U().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const u=Math.floor(r.length/2),c=rp({inputs:r.slice(0,u),backend:n}),l=rp({inputs:r.slice(u),backend:n});return rp({inputs:[c,l],backend:n})}const s=r.map(u=>u.dtype).reduce((u,c)=>Ts(u,c)),a=r.map(u=>u.shape),i=U().getBool("WEBGL_PACK")?new GZ(r[0].shape,a):new UZ(r[0].shape,a);return n.runWebGLProgram(i,r,s)}const HZ={kernelName:_f,backendName:"webgl",kernelFunc:rp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jZ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:a,keepDims:o}=r,i=s.shape.length,u=vt(a,s.shape);let c=u;const l=An(c,i);let d=s;l!=null&&(d=xn({inputs:{x:s},backend:n,attrs:{perm:l}}),c=Xt(c.length,i)),Dt("all",c,i);const[p,f]=an(d.shape,c),h=K(f),y=ie({inputs:{x:d},backend:n,attrs:{shape:[-1,h]}}),x=fi(y,y.dtype,"all",n);let g;if(o){const v=Ot(p,u);g=ie({inputs:{x},backend:n,attrs:{shape:v}})}else g=ie({inputs:{x},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),l!=null&&n.disposeIntermediateTensorInfo(d),g}const KZ={kernelName:Nf,backendName:"webgl",kernelFunc:jZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qZ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:a,keepDims:o}=r,i=s.shape.length,u=vt(a,s.shape);let c=u;const l=An(c,i);let d=s;l!=null&&(d=xn({inputs:{x:s},backend:n,attrs:{perm:l}}),c=Xt(c.length,i)),Dt("any",c,i);const[p,f]=an(d.shape,c),h=K(f),y=ie({inputs:{x:d},backend:n,attrs:{shape:[-1,h]}}),x=fi(y,y.dtype,"any",n);let g;if(o){const v=Ot(p,u);g=ie({inputs:{x},backend:n,attrs:{shape:v}})}else g=ie({inputs:{x},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),l!=null&&n.disposeIntermediateTensorInfo(d),g}const XZ={kernelName:kf,backendName:"webgl",kernelFunc:qZ};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YZ{constructor(e,n,r){this.variableNames=["A"];const{windowSize:s,batchSize:a,outSize:o}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[a,o];const i=n==="max"?">":"<",u=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${s}; i++) {
          int inIdx = ${u};
          float candidate = getA(batch, inIdx);
          if (candidate ${i} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QZ{constructor(e,n,r,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,E(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const a=e[e.length-1],o=Math.ceil(a/n);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),s||this.variableNames.push("bestIndicesA");const i=this.outputShape,u=i.length,c=nt(u),l=gn("coords",u);let d,p;if(o===1){p=u+1;const A=nt(p);d=`
        ${A} sourceLocR = ${A}(${l.join()}, 0);
        ++${l[u-1]};
        ${A} sourceLocG = ${A}(${l.join()}, 0);
        ++${l[u-2]};
        ${A} sourceLocA = ${A}(${l.join()}, 0);
        --${l[u-1]};
        ${A} sourceLocB = ${A}(${l.join()}, 0);
        --${l[u-2]};`}else p=u,d=`
        ${c} sourceLocR = coords;
        ++${l[u-1]};
        ${c} sourceLocG = coords;
        ++${l[u-2]};
        ${c} sourceLocA = coords;
        --${l[u-1]};
        ${c} sourceLocB = coords;
        --${l[u-2]};`;const f=["x","y","z","w","u","v"].slice(0,p),h="."+f[p-1],y=f.map(A=>"int "+A),x=gn("sourceLocR",p-1).concat("inIdx.r"),g=gn("sourceLocG",p-1).concat("inIdx.g"),v=gn("sourceLocB",p-1).concat("inIdx.b"),w=gn("sourceLocA",p-1).concat("inIdx.a"),S=r==="max"?"greaterThan":"lessThan",$=s?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${w.join()})));`,k=`vec4(
            getAChannel(${x.join()}),
            hasNextCol ? getAChannel(${g.join()}) : 0.,
            hasNextRow ? getAChannel(${v.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${w.join()}) : 0.)`,T=s?"":`
      float getBestIndicesAChannel(${y.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${y.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${T}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${l[u-1]} < ${i[u-1]-1};
        bool hasNextRow = ${l[u-2]} < ${i[u-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${h}, sourceLocG${h},
          sourceLocB${h}, sourceLocA${h}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${k};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${$}
          vec4 candidate = ${k};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${S}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eT(t,e,n,r=null){let s=e.shape[0],a=e.shape[1];r!=null&&(s=r.shape[0],a=r.shape[1]);const o=Vh(a),i={windowSize:o,inSize:a,batchSize:s,outSize:Math.ceil(a/o)},u=new YZ(i,n,r==null),c=[e];r!=null&&c.push(r);const l=t.runWebGLProgram(u,c,"int32");if(l.shape[1]===1)return l;const d=eT(t,e,n,l);return t.disposeIntermediateTensorInfo(l),d}function tT(t,e,n,r=null){const s=r!=null?r.shape:e.shape,a=s[s.length-1],o=Vh(a),i=new QZ(s,o,n,r==null),u=r==null?[e]:[e,r],c=t.runWebGLProgram(i,u,"int32");if(c.shape.length===e.shape.length){const l=tT(t,e,n,c);return t.disposeIntermediateTensorInfo(c),l}return c}function nT(t,e,n,r){const s=[n];if(Dt("arg"+r.charAt(0).toUpperCase()+r.slice(1),s,e.shape.length),!U().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const a=[],o=t.texData.get(e.dataId),i=o!==null&&o.isPacked;let u=e;i&&(u=t.unpackTensor(e),a.push(u));const[c,l]=an(u.shape,s),d=K(l),p=ie({inputs:{x:u},backend:t,attrs:{shape:[-1,d]}});a.push(p);const f=eT(t,p,r);a.push(f);const h=ie({inputs:{x:f},backend:t,attrs:{shape:c}});return a.forEach(y=>t.disposeIntermediateTensorInfo(y)),h}return tT(t,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZZ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:a}=r;let o=vt(a,s.shape);const i=An(o,s.shape.length);let u=s;const c=[];i!=null&&(u=xn({inputs:{x:s},backend:n,attrs:{perm:i}}),c.push(u),o=Xt(o.length,u.shape.length)),Dt("argMax",[o[0]],u.shape.length);const l=nT(n,u,o[0],"max");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),l}const JZ={kernelName:J0,backendName:"webgl",kernelFunc:ZZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eJ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:a}=r;let o=vt(a,s.shape);const i=An(o,s.shape.length);let u=s;const c=[];i!=null&&(u=xn({inputs:{x:s},backend:n,attrs:{perm:i}}),c.push(u),o=Xt(o.length,u.shape.length)),Dt("argMin",[o[0]],u.shape.length);const l=nT(n,u,o[0],"min");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),l}const tJ={kernelName:ex,backendName:"webgl",kernelFunc:eJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nJ=Vr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,rJ=We({opSnippet:nJ}),sJ={kernelName:tx,backendName:"webgl",kernelFunc:rJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aJ=Vr+"return log(x + sqrt(x * x + 1.0));",oJ=We({opSnippet:aJ}),iJ={kernelName:nx,backendName:"webgl",kernelFunc:oJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uJ=Vr+`
  return atan(x);
`,lJ=We({opSnippet:uJ}),cJ={kernelName:rx,backendName:"webgl",kernelFunc:lJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dJ=kw+`
  return atan(a, b);
`,pJ=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+pi+`
  return result;
`,fJ=Qt({opSnippet:dJ,packedOpSnippet:pJ}),hJ={kernelName:ax,backendName:"webgl",kernelFunc:fJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mJ=Vr+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,gJ=We({opSnippet:mJ}),yJ={kernelName:sx,backendName:"webgl",kernelFunc:gJ};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bc{constructor(e,n,r,s=!1,a=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,i=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,l=e.dilationWidth,d=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=e.padInfo.top,h=e.padInfo.left;this.outputShape=e.outShape;const y=n==="avg",x=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,g=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let v="0.0";if(y||(v="-1.0 / 1e-20"),r){const A=">=";this.userCode=`
        const ivec2 strides = ivec2(${i}, ${u});
        const ivec2 pads = ivec2(${f}, ${h});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p};
                wC += ${l}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${A} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${s?a?x:g:`wR * ${p} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const w="max";let S=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(S="avgValue / max(count, 1.0)");const $=Math.floor(o/4)*4,k=o%4,T=`
      if (${y}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${w}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${u});
      const ivec2 pads = ivec2(${f}, ${h});
      const float initializationValue = ${v};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${v});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${$}; wC += 4) {
            int xC = xCCorner + wC * ${l};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${l}, d),
              getValue(batch, xR, xC + 2 * ${l}, d),
              getValue(batch, xR, xC + 3 * ${l}, d)
            );

            ${T}
          }

          int xC = xCCorner + ${$};
          if (${k===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${T}
          } else if (${k===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${l}, d),
              initializationValue,
              initializationValue
            );

            ${T}
          } else if (${k===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${l}, d),
              getValue(batch, xR, xC + 2 * ${l}, d),
              initializationValue
            );

            ${T}
          }
        }
        setOutput(${S});
      }
    `}}class Tw{constructor(e,n,r,s=!1,a=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,i=e.strideDepth,u=e.strideHeight,c=e.strideWidth,l=e.dilationDepth,d=e.dilationHeight,p=e.dilationWidth,f=e.effectiveFilterDepth,h=e.effectiveFilterHeight,y=e.effectiveFilterWidth,x=e.padInfo.front,g=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;const w=n==="avg";let S="0.0";if(w||(S="-1.0 / 1e-20"),r){const L=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${i}, ${u}, ${c});
        const ivec3 pads = ivec3(${x}, ${g}, ${v});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${l}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${h};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${y};
                  wC += ${p}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${L} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${s?a?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${h} * ${y} +
                      wR * ${y} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const $="max";let k=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(k="avgValue / max(count, 1.0)");const T=Math.floor(o/4)*4,A=o%4,B=`
      if (${w}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${$}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${i}, ${u}, ${c});
      const ivec3 pads = ivec3(${x}, ${g}, ${v});
      const float initializationValue = ${S};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${S});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${l}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${T}; wC += 4) {
              int xC = xCCorner + wC * ${p};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                getValue(batch, xD, xR, xC + 3 * ${p}, ch)
              );

              ${B}
            }

            int xC = xCCorner + ${T};
            if (${A===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${B}
            } else if (${A===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                initializationValue,
                initializationValue
              );

              ${B}
            } else if (${A===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                initializationValue
              );

              ${B}
            }
          }
        }
        setOutput(${k});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xJ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;Wc(s,"avgPool");const{filterSize:a,strides:o,pad:i,dimRoundingMode:u}=r,c=1;E(Rn(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const l=Mr(s.shape,a,o,c,i,u);if(l.filterWidth===1&&l.filterHeight===1&&yt(l.inShape,l.outShape))return Xn({inputs:{x:s},backend:n});const d=new bc(l,"avg",!1);return n.runWebGLProgram(d,[s],"float32")}const vJ={kernelName:Ef,backendName:"webgl",kernelFunc:xJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wJ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:a,strides:o,pad:i,dimRoundingMode:u,dataFormat:c}=r,l=[1,1,1],d=aa(s.shape,a,o,l,i,u,c),p=new Tw(d,"avg",!1);return n.runWebGLProgram(p,[s],"float32")}const bJ={kernelName:ox,backendName:"webgl",kernelFunc:wJ};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SJ{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,a=e.strideWidth,o=e.dilationHeight,i=e.dilationWidth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,l=u-1-e.padInfo.top,d=c-1-e.padInfo.left,p=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${l}, ${d});
      const float avgMultiplier = float(${p});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${u};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${i}) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class CJ{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,a=e.strideDepth,o=e.strideHeight,i=e.strideWidth,u=e.dilationDepth,c=e.dilationHeight,l=e.dilationWidth,d=e.effectiveFilterDepth,p=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=d-1-e.padInfo.front,y=p-1-e.padInfo.top,x=f-1-e.padInfo.left,g=1/(n*r*s);this.userCode=`
      const ivec3 pads = ivec3(${h}, ${y}, ${x});
      const float avgMultiplier = float(${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${u}) {
          float dyD = float(dyDCorner + wD) / ${a}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${p};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${l}) {
              float dyC = float(dyCCorner + wC) / ${i}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IJ(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:a}=e,o=a,{filterSize:i,strides:u,pad:c,dimRoundingMode:l}=r,d=[1,1,1],p=aa(o.shape,i,u,d,c,l),f=new CJ(p);return n.runWebGLProgram(f,[s],o.dtype)}const $J={kernelName:s$,backendName:"webgl",kernelFunc:IJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _J(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:a}=e,o=a;Wc([s,a],"avgPoolGrad");const{filterSize:i,strides:u,pad:c}=r,l=Mr(o.shape,i,u,1,c),d=new SJ(l);return n.runWebGLProgram(d,[s],o.dtype)}const NJ={kernelName:r$,backendName:"webgl",kernelFunc:_J};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kJ(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:a}=e,{transposeA:o,transposeB:i}=r;return Xp({a:s,b:a,transposeA:o,transposeB:i,backend:n})}const EJ={kernelName:Tf,backendName:"webgl",kernelFunc:kJ};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TJ{constructor(e,n,r,s,a,o){this.outputShape=[],this.variableNames=["x","mean","variance"],Le(e,n),Le(e,r);let i="0.0";s!=null&&(Le(e,s),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");let u="1.0";a!=null&&(Le(e,a),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${i};
        float scale = ${u};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RJ{constructor(e,n,r,s,a,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Le(e,n),Le(e,r);let i="vec4(0.0)";s!=null&&(Le(e,s),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");let u="vec4(1.0)";a!=null&&(Le(e,a),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${i};
        vec4 scale = ${u};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AJ=({inputs:t,backend:e,attrs:n})=>{const{x:r,mean:s,variance:a,offset:o,scale:i}=t;E(s.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),E(o==null||s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),E(i==null||s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:u}=n;u==null&&(u=.001);const c=[r,s,a];let l=null;o!=null&&(l=o.shape,c.push(o));let d=null;i!=null&&(d=i.shape,c.push(i));const p=U().getBool("WEBGL_PACK_NORMALIZATION")?new RJ(r.shape,s.shape,a.shape,l,d,u):new TJ(r.shape,s.shape,a.shape,l,d,u);return e.runWebGLProgram(p,c,c[0].dtype)},OJ={kernelName:Hf,backendName:"webgl",kernelFunc:AJ};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DJ{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=nt(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=PJ(this.rank);let s;const a=e.map((o,i)=>`sourceLoc.${Py[i]} = start[${i}] + coords.${Py[i]};`);s=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${a.join(`
`)}
      `,this.userCode=`
      void main() {
        ${s}
        setOutput(getSource(${r}));
      }
    `}}const Py=["x","y","z","w","u","v"];function PJ(t){if(t===1)return"sourceLoc";if(t<=6)return Py.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FJ{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=nt(this.rank),r=gn("coords",this.rank),s=gn("sourceLoc",this.rank),a=this.rank===1?"sourceLoc":`vec2(${s.slice(-2).join()})`,o=`getChannel(getSource(${s.join()}), ${a})`,i=`
      result.x = ${o};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${s[this.rank-1]};
        result.y = ${o};
        --${s[this.rank-1]};
      }
    `,u=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${s[this.rank-2]};
        result.z = ${o};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${s[this.rank-1]};
          result.w = ${o};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((l,d)=>`start[${d}]`).join()});`:e.map((l,d)=>`${s[d]} = ${r[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${i}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LJ(t,e,n,r){const s=r.texData.get(t.dataId),a=r.makeTensorInfo(n,t.dtype),o=r.texData.get(a.dataId);Object.assign(o,s),o.refCount=1,o.shape=n,o.dtype=t.dtype;let i=Bh(e,Ye(t.shape));s.slice&&(i+=s.slice.flatOffset),o.slice={flatOffset:i,origDataId:s.slice&&s.slice.origDataId||t.dataId};const u=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,u+1),a}function Uu(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:a,size:o}=r,[i,u]=ew(s,a,o);if(uN(s,i,u),K(u)===0)return n.makeTensorInfo(u,s.dtype,[]);if(n.shouldExecuteOnCPU([s])||s.dtype==="string"){const d=n.texData.get(s.dataId),p=EQ(d.values,i,u,s.shape,s.dtype);return n.makeTensorInfo(u,s.dtype,p)}const{isPacked:c}=n.texData.get(s.dataId),l=Mh(s.shape,i,u);if(c||!l){const d=U().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new FJ(u):new DJ(u),p=[i];return n.runWebGLProgram(d,[s],s.dtype,p)}return n.uploadToGPU(s.dataId),LJ(s,i,u,n)}const MJ={kernelName:cv,backendName:"webgl",kernelFunc:Uu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BJ=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:a,crops:o}=r;E(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const i=a.reduce((v,w)=>v*w),u=Mc(s.shape,a,i),c=Bc(u.length,a.length),l=Vc(s.shape,a,i),d=aw(o,a.length),p=ow(l,o,a.length),f=[],h=ie({inputs:{x:s},backend:n,attrs:{shape:u}}),y=xn({inputs:{x:h},backend:n,attrs:{perm:c}}),x=ie({inputs:{x:y},backend:n,attrs:{shape:l}}),g=Uu({inputs:{x},backend:n,attrs:{begin:d,size:p}});return f.push(h),f.push(y),f.push(x),f.forEach(v=>n.disposeIntermediateTensorInfo(v)),g},VJ={kernelName:ix,backendName:"webgl",kernelFunc:BJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zJ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:a}=e,{size:o}=r,i=n.readSync(s.dataId),u=n.readSync(a.dataId),c=UE(i,u,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,c)}const WJ={kernelName:Rf,backendName:"webgl",kernelFunc:zJ};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UJ=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,GJ=`
  return float(int(a.r) & int(b.r));
`;function HJ(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,a=U().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=U().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,s])||o===1){const u=n.texData.get(r.dataId).values,c=n.texData.get(s.dataId).values,[l,d]=JY(r.shape,s.shape,u,c,r.dtype),p=n.makeTensorInfo(d,r.dtype),f=n.texData.get(p.dataId);return f.values=l,p}let i;return a?i=new zu(UJ,r.shape,s.shape,!1):i=new Jo(GJ,r.shape,s.shape),n.runWebGLProgram(i,[r,s],r.dtype)}const jJ={kernelName:ux,backendName:"webgl",kernelFunc:HJ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KJ(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e,a=n.readSync(r.dataId),o=n.readSync(s.dataId),i=Le(Array.from(a),Array.from(o));return n.makeTensorInfo([i.length],"int32",Int32Array.from(i))}const qJ={kernelName:lx,backendName:"webgl",kernelFunc:KJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XJ="return float(a != b);",rT=Qt({opSnippet:XJ,cpuKernelImpl:wQ,dtype:"bool"}),YJ={kernelName:Xx,backendName:"webgl",kernelFunc:rT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gc(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return Xn({inputs:{x:s.complexTensorInfos.real},backend:n})}const QJ={kernelName:b$,backendName:"webgl",kernelFunc:Gc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZJ="return float(int(x));";function JJ(t,e){const n=new Is(t.shape,ZJ),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fy(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:a}=r;if(a==="complex64"){if(s.dtype==="complex64")return Xn({inputs:{x:s},backend:n});const o=qo(s.shape),i=Fy({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),u=so({inputs:{real:i,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(i),u}if(s.dtype==="complex64"){const o=Gc({inputs:{input:s},backend:n}),i=Fy({inputs:{x:o},backend:n,attrs:{dtype:a}});return n.disposeIntermediateTensorInfo(o),i}if(!yF(s.dtype,a)){const o=Xn({inputs:{x:s},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:a}}if(n.shouldExecuteOnCPU([s])){const o=n.texData.get(s.dataId).values,[i,u,c]=eQ(o,s.shape,s.dtype,a);return n.makeTensorInfo(i,u,c)}if(a==="int32")return JJ(s,n);if(a==="bool"){const o=n.makeTensorInfo([],"bool",Ua("bool",1)),u=rT({inputs:{a:s,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),u}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${a}`)}const eee={kernelName:Af,backendName:"webgl",kernelFunc:Fy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $S="return ceil(x);",tee=We({opSnippet:$S,packedOpSnippet:$S,cpuKernelImpl:tQ}),nee={kernelName:cx,backendName:"webgl",kernelFunc:tee};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ree{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class see{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aee(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{clipValueMin:a,clipValueMax:o}=r;let i;U().getBool("WEBGL_PACK_CLIP")?i=new see(s.shape):i=new ree(s.shape);const u=[[a],[o]];return n.runWebGLProgram(i,[s],s.dtype,u)}const oee={kernelName:Of,backendName:"webgl",kernelFunc:aee};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iee{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _S(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function uee(t){const{inputs:e,backend:n}=t,{x:r}=e,s=n.texData.get(r.dataId),a=new iee(r.shape),o=[_S(r,s.complexTensorInfos.real),_S(r,s.complexTensorInfos.imag)];return n.runWebGLProgram(a,o,o[0].dtype)}const lee={kernelName:o$,backendName:"webgl",kernelFunc:uee};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cee{constructor(e){this.outputShape=[],this.outputShape=ks(e,1),this.variableNames=e.map((o,i)=>`T${i}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+e[o][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const i=n[o-1];r.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${i}));`)}const s=n.length,a=n[n.length-1];r.push(`else setOutput(getT${s}(yR, yC-${a}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dee{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=ks(e,n);const r=this.outputShape,s=r.length,a=nt(s),o=gn("coords",s),i=["x","y","z","w","u","v"].slice(0,s);this.variableNames=e.map((y,x)=>`T${x}`);const u=new Array(e.length-1);u[0]=e[0][n];for(let y=1;y<u.length;y++)u[y]=u[y-1]+e[y][n];const c=i[n],l=i.slice(-2),d=i.join();let p=`if (${c} < ${u[0]}) {
        return getChannel(
            getT0(${d}), vec2(${l.join()}));
        }`;for(let y=1;y<u.length;y++){const x=u[y-1];p+=`
        if (${c} < ${u[y]}  && ${c} >= ${u[y-1]}) {
          return getChannel(
            getT${y}(${Ld(i,c,x)}),
            vec2(${Ld(l,c,x)}));
        }`}const f=u.length,h=u[u.length-1];p+=`
        return getChannel(
          getT${f}(${Ld(i,c,h)}),
          vec2(${Ld(l,c,h)}));`,this.userCode=`
      float getValue(${i.map(y=>"int "+y)}) {
        ${p}
      }

      void main() {
        ${a} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[s-1]} = ${o[s-1]} + 1;
        if (${o[s-1]} < ${r[s-1]}) {
          result.g = getValue(${o});
        }

        ${o[s-2]} = ${o[s-2]} + 1;
        if (${o[s-2]} < ${r[s-2]}) {
          result.a = getValue(${o});
        }

        ${o[s-1]} = ${o[s-1]} - 1;
        if (${o[s-2]} < ${r[s-2]} &&
            ${o[s-1]} < ${r[s-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function Ld(t,e,n){const r=t.indexOf(e);return t.map((a,o)=>o===r?`${a} - ${n}`:a).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jh(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return Xn({inputs:{x:s.complexTensorInfos.imag},backend:n})}const pee={kernelName:m$,backendName:"webgl",kernelFunc:jh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _l(t,e,n){const r=t[0].dtype;if(r==="complex64"){const f=t.map(v=>Gc({inputs:{input:v},backend:n})),h=t.map(v=>jh({inputs:{input:v},backend:n})),y=_l(f,e,n),x=_l(h,e,n),g=so({inputs:{real:y,imag:x},backend:n});return f.forEach(v=>n.disposeIntermediateTensorInfo(v)),h.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),g}let s=n.shouldExecuteOnCPU(t);if(r==="string"&&(s=!0),s){const f=t.map(S=>{const k=[-1,K(S.shape.slice(e))];return ie({inputs:{x:S},backend:n,attrs:{shape:k}})}),h=f.map(S=>({vals:n.readSync(S.dataId),shape:S.shape})),y=ks(f.map(S=>S.shape),1),x=f[0].shape[0]===1,g=nQ(h,y,r,x),v=ks(t.map(S=>S.shape),e),w=n.makeTensorInfo(v,r,g);return f.forEach(S=>n.disposeIntermediateTensorInfo(S)),w}const a=t.filter(f=>K(f.shape)>0),o=U().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&a[0].shape.length>1;if(a.length===1){const f=o?new Is(t[0].shape,xa):new _a(t[0].shape,xa);return n.runWebGLProgram(f,t,r)}const i=U().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(a.length>i){const f=[];for(let y=0;y<a.length;y+=i){const x=a.slice(y,y+i);f.push(_l(x,e,n))}const h=_l(f,e,n);for(const y of f)n.disposeIntermediateTensorInfo(y);return h}if(o){const f=new dee(a.map(h=>h.shape),e);return n.runWebGLProgram(f,a,r)}const{tensors2D:u,outShape:c}=fee(a,e,n),l=new cee(u.map(f=>f.shape)),d=n.runWebGLProgram(l,u,r);u.forEach(f=>n.disposeIntermediateTensorInfo(f));const p=ie({inputs:{x:d},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(d),p}function fee(t,e,n){const r=ks(t.map(a=>a.shape),e);return{tensors2D:t.map(a=>ie({inputs:{x:a},attrs:{shape:[-1,K(a.shape.slice(e))]},backend:n})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sT(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,a=vt(s,e[0].shape)[0],o=e.map(c=>c.shape);nw(o,a);const i=ks(e.map(c=>c.shape),a);if(K(i)===0)return n.makeTensorInfo(i,e[0].dtype,[]);const u=e.filter(c=>K(c.shape)>0);return u.length===1?Xn({inputs:{x:u[0]},backend:n}):_l(u,a,n)}const hee={kernelName:dx,backendName:"webgl",kernelFunc:sT};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aT{constructor(e,n=!1,r=null,s=!1,a=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,i=e.padInfo.left,u=e.strideHeight,c=e.strideWidth,l=e.dilationHeight,d=e.dilationWidth,p=e.filterHeight,f=e.filterWidth,h=Math.floor(e.inChannels/4)*4,y=e.inChannels%4,x=e.dataFormat==="channelsLast",g=x?1:2,v=x?2:3,w=x?3:1;let S="",$="";r&&(s?S=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:a?S=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:S=`
          float activation(float x) {
            ${r}
          }
        `,$="result = activation(result);");const k=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${S}

      const ivec2 strides = ivec2(${u}, ${c});
      const ivec2 pads = ivec2(${o}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${w}];

        ivec2 xRCCorner =
            ivec2(coords[${g}], coords[${v}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${p}; wR++) {
          int xR = xRCorner + wR * ${l};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${h}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${x}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${y===1}) {

              if (${x}) {
                dotProd +=
                    getX(batch, xR, xC, ${h}) *
                    getW(wR, wC, ${h}, d2);
              } else {
                dotProd +=
                    getX(batch, ${h}, xR, xC) *
                    getW(wR, wC, ${h}, d2);
              }

            } else if (${y===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${h}, d2),
                getW(wR, wC, ${h} + 1, d2)
              );

              if (${x}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${h}),
                  getX(batch, xR, xC, ${h} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${h}, xR, xC),
                  getX(batch, ${h} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${y===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${h}, d2),
                getW(wR, wC, ${h} + 1, d2),
                getW(wR, wC, ${h} + 2, d2)
              );

              if (${x}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${h}),
                  getX(batch, xR, xC, ${h} + 1),
                  getX(batch, xR, xC, ${h} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${h}, xR, xC),
                  getX(batch, ${h} + 1, xR, xC),
                  getX(batch, ${h} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${k}
        ${$}
        setOutput(result);
      }
    `}}class mee{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,r=e.padInfo.top,s=e.padInfo.left,a=e.strideDepth,o=e.strideHeight,i=e.strideWidth,u=e.dilationDepth,c=e.dilationHeight,l=e.dilationWidth,d=e.filterDepth,p=e.filterHeight,f=e.filterWidth,h=Math.floor(e.inChannels/4)*4,y=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${a}, ${o}, ${i});
      const ivec3 pads = ivec3(${n}, ${r}, ${s});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${u};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${l};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${h}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${y===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${h}) *
                  getW(wF, wR, wC, ${h}, d2);
              } else if (${y===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${h}),
                  getX(batch, xF, xR, xC, ${h} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${h}, d2),
                  getW(wF, wR, wC, ${h} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${y===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${h}),
                  getX(batch, xF, xR, xC, ${h} + 1),
                  getX(batch, xF, xR, xC, ${h} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${h}, d2),
                  getW(wF, wR, wC, ${h} + 1, d2),
                  getW(wF, wR, wC, ${h} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oT{constructor(e,n=!1,r=null,s=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=on(this.outputShape.length);const o=e.padInfo.left,i=e.strideWidth,u=e.dilationWidth,c=e.filterHeight,l=e.filterWidth,d=l;let p=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let x=0;x<l;x++)p+=`
           vec4 xTexelC${x*2};
           int xTexelC${x*2}Ready;
           vec4 xTexelC${x*2+1};
           int xTexelC${x*2+1}Ready;
           vec4 xC${x};`;p+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let x=0;x<l;x++)p+=`
           xTexelC${x*2} = vec4(0.0);
           xTexelC${x*2}Ready = 0;
           xTexelC${x*2+1} = vec4(0.0);
           xTexelC${x*2+1}Ready = 0;
           xC${x} = vec4(0.0);`;p+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let x=0;x<(d+1)/2;x++){const g=x*2;if(p+=`
           xC = xCCorner + ${g*u};
           `,i===1){if(g<l&&(o%2===1?(p+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }
               `,u===1&&g>0?p+=`
                 xC${g} = vec4(xTexelC${g-2}.zw, xTexelC${g}.xy);
                 `:p+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${g} = vec4(previous.zw, xTexelC${g}.xy);
                   } else {
                     xC${g} = vec4(0.0, 0.0, xTexelC${g}.xy);
                   }
                   `):p+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xC${g} = xTexelC${g};
                 `,g+1<l)){const v=o%2===0?K0(u):u;u%2===0&&o%2===1||u%2!==0&&o%2!==1?(p+=`
                   xCOffset = xC + imod(pads[1], 2) + ${v};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                     xTexelC${g+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${g+1}.zw = vec2(0.0);
                     }
                     xTexelC${g+1}Ready = 1;
                   }
                   `,u>1?p+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${g+1} = vec4(previous.zw, xTexelC${g+1}.xy);
                     } else {
                      xC${g+1} = vec4(0.0, 0.0, xTexelC${g+1}.xy);
                     }
                     `:p+=`
                     xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.xy);
                     `):v===1?p+=`
                     xC${g+1} = xTexelC${g};
                     `:p+=`
                     xCOffset = xC + ${v};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                       xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${g+1}.zw = vec2(0.0);
                       }
                       xTexelC${g+1}Ready = 1;
                     }

                     xC${g+1} = xTexelC${g+1};
                     `}}else g<l&&(o%2===1?(p+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.0);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
               `,g+1<l&&(p+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${g+1} = vec4(xTexelC${g+1}.xy, final.xy);
                 `)):(p+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(
                   xTexelC${g}.xy, xTexelC${g+1}.xy);
               `,g+1<l&&(p+=`
                   xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
                 `)));g<l&&(p+=`
             wTexel = getW(r, ${g}, d1, d2);
             dotProd += xC${g}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${g}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,g+1<l&&(p+=`
               wTexel = getW(r, ${g+1}, d1, d2);
               dotProd += xC${g+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${g+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}p+=`
     }
   `,p+=`
     }
   `,p+=`
     }
   `;let f="",h="";r&&(s?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:a?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:f=`vec4 activation(vec4 x) {
           ${r}
         }`,h="result = activation(result);");const y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${p}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${y}
         ${h}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gee{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=on(this.outputShape.length);const{dataFormat:r}=n,s=vn(),a=r==="channelsLast",o=a?1:2,i=a?2:3,u=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let c="";for(let l=0;l<=1;l++)for(let d=0;d<=1;d++)c+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${l};

          ${u}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${i}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${a}) {
                  innerDims = vec2(d1, ch);
                  result[${l*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${l*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${s.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yp(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function iT({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:a=null,leakyreluAlpha:o=0,activation:i=null}){const u=t.shape,c=r.texData.get(t.dataId),l=n.inChannels,d=u[0]*u[1]*u[2],p=n.outChannels,f=n.dataFormat==="channelsLast",h=!1,y=!1;let x;const g=[];if(a!=null){const S=Yp(a.shape,f);S!=null&&(a=ie({inputs:{x:a},backend:r,attrs:{shape:S}}),g.push(a))}if(s!=null){const S=Yp(s.shape,f);S!=null&&(s=ie({inputs:{x:s},backend:r,attrs:{shape:S}}),g.push(s))}if(!((d===1||p===1)&&l>JE)&&c.isPacked&&f&&c.texture!=null&&u[2]%2!==0&&yt(c.shape.slice(-3),u.slice(-3))){const S=u[0]*u[1]*(u[2]+1),$={dataId:t.dataId,shape:[1,S,n.inChannels],dtype:t.dtype},k=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,E(qp(c.shape,$.shape),()=>`packed reshape ${c.shape} to ${$.shape} isn't free`);const T=ie({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});g.push(T);const A=Xp({a:$,b:T,backend:r,transposeA:h,transposeB:y,bias:s,activation:i,preluActivationWeights:a,leakyreluAlpha:o}),B=r.texData.get(A.dataId);E(B.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=k,B.shape=n.outShape,x=Xn({inputs:{x:A},backend:r}),x.shape=n.outShape,g.push(A)}else{const S=n.outHeight*n.outWidth,$=ie({inputs:{x:t},backend:r,attrs:{shape:f?[n.batchSize,S,n.inChannels]:[n.batchSize,n.inChannels,S]}}),k=ie({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),T=Xp({a:f?$:k,b:f?k:$,transposeA:!f,transposeB:y,backend:r,bias:s,activation:i,preluActivationWeights:a,leakyreluAlpha:o});x=ie({inputs:{x:T},backend:r,attrs:{shape:n.outShape}}),g.push($),g.push(k),g.push(T)}for(const S of g)r.disposeIntermediateTensorInfo(S);return x}function uT({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:a=null,leakyreluAlpha:o=0,activation:i=null}){const{filterWidth:u,filterHeight:c,inChannels:l,outWidth:d,outHeight:p,dataFormat:f}=n,h=f==="channelsLast",y=u*c*l,x=p*d,g=[n.batchSize,y,x],v=!0,w=!1,S=[];if(a!=null){const j=Yp(a.shape,h);j!=null&&(a=ie({inputs:{x:a},backend:r,attrs:{shape:j}}),S.push(a))}if(s!=null){const j=Yp(s.shape,h);j!=null&&(s=ie({inputs:{x:s},backend:r,attrs:{shape:j}}),S.push(s))}const $=ie({inputs:{x:e},backend:r,attrs:{shape:[1,y,K(e.shape)/y]}});S.push($);const k=new gee(g,n),T=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],A=r.runWebGLProgram(k,[t],"float32",T),B=ie({inputs:{x:A},backend:r,attrs:{shape:g}});S.push(A),S.push(B);const L=s!=null,z=a!=null,Y=i==="leakyrelu",Q=i?wc(i,!0):null,re=new ZE(h?B.shape:$.shape,h?$.shape:B.shape,h?[n.batchSize,x,n.outChannels]:[n.batchSize,n.outChannels,x],v,w,L,Q,z,Y),Z=h?[B,$]:[$,B];if(s&&Z.push(s),z&&Z.push(a),Y){const j=r.makeTensorInfo([],"float32",Du(o,"float32"));Z.push(j),S.push(j)}const de=r.runWebGLProgram(re,Z,"float32"),ce=ie({inputs:{x:de},backend:r,attrs:{shape:n.outShape}});S.push(de);for(const j of S)r.disposeIntermediateTensorInfo(j);return ce}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yee(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:a}=e,{strides:o,pad:i,dataFormat:u,dilations:c,dimRoundingMode:l}=r,d=to(u),p=qt(s.shape,a.shape,o,c,i,l,!1,d);let f;if(p.filterHeight===1&&p.filterWidth===1&&p.dilationHeight===1&&p.dilationWidth===1&&p.strideHeight===1&&p.strideWidth===1&&(p.padInfo.type==="SAME"||p.padInfo.type==="VALID"))f=iT({x:s,filter:a,convInfo:p,backend:n});else if(p.strideWidth<=2&&d==="channelsLast"&&U().getBool("WEBGL_EXP_CONV")){const y=new oT(p),x=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];f=n.runWebGLProgram(y,[s,a],"float32",x)}else if(U().getBool("WEBGL_CONV_IM2COL"))f=uT({x:s,filter:a,convInfo:p,backend:n});else{const y=new aT(p);f=n.runWebGLProgram(y,[s,a],"float32")}const h=ie({inputs:{x:f},backend:n,attrs:{shape:p.outShape}});return n.disposeIntermediateTensorInfo(f),h}const xee={kernelName:Df,backendName:"webgl",kernelFunc:yee};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vee{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,a=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class wee{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,a=e.strideWidth,o=e.dataFormat==="channelsLast",i=n-1-e.padInfo.top,u=r-1-e.padInfo.left,c=o?1:2,l=o?2:3,d=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${u});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${l}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class bee{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,a=e.padInfo.front,o=e.padInfo.top,i=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${a};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${s} - ${i};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class See{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,a=e.strideDepth,o=e.strideHeight,i=e.strideWidth,u=n-1-e.padInfo.front,c=r-1-e.padInfo.top,l=s-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${u}, ${c}, ${l});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${a}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${s}; wC++) {
              float dyC = float(dyCCorner + wC) / ${i}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${s} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cee(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:a}=e,{strides:o,pad:i,dataFormat:u,dimRoundingMode:c,filterShape:l}=r,d=to(u),p=qt(s.shape,l,o,1,i,c,!1,d),f=new vee(p);return n.runWebGLProgram(f,[s,a],"float32")}const Iee={kernelName:i$,backendName:"webgl",kernelFunc:Cee};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $ee{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=on(this.outputShape.length);const n=e.filterHeight,r=e.filterWidth,s=n-1-e.padInfo.top,a=r-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ee(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:a}=e,{inputShape:o,strides:i,pad:u,dataFormat:c,dimRoundingMode:l}=r,d=to(c),p=qt(o,a.shape,i,1,u,l,!1,d);if(U().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const f=[[p.strideHeight,p.strideWidth]],h=new $ee(p);return n.runWebGLProgram(h,[s,a],"float32",f)}else{const f=new wee(p);return n.runWebGLProgram(f,[s,a],"float32")}}const Nee={kernelName:Pf,backendName:"webgl",kernelFunc:_ee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kee(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:a}=e,{strides:o,pad:i,dilations:u}=r,c=eo(s.shape,a.shape,o,u,i),l=new mee(c);return n.runWebGLProgram(l,[s,a],"float32")}const Eee={kernelName:Ff,backendName:"webgl",kernelFunc:kee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tee(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:a}=e,{strides:o,pad:i,filterShape:u}=r,c=eo(s.shape,u,o,1,i),l=new bee(c);return n.runWebGLProgram(l,[s,a],"float32")}const Ree={kernelName:px,backendName:"webgl",kernelFunc:Tee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aee(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:a}=e,{pad:o,strides:i,inputShape:u}=r,c=eo(u,a.shape,i,1,o),l=new See(c);return n.runWebGLProgram(l,[s,a],"float32")}const Oee={kernelName:Lf,backendName:"webgl",kernelFunc:Aee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dee=Wu+`
  return cos(x);
`,Pee=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${pi}
  return result;
`,Fee=We({opSnippet:Dee,packedOpSnippet:Pee}),Lee={kernelName:fx,backendName:"webgl",kernelFunc:Fee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mee=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Bee=We({opSnippet:Mee}),Vee={kernelName:hx,backendName:"webgl",kernelFunc:Bee};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zee{constructor(e,n,r,s,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,i,u,c]=e,[l]=n,[d,p]=r;this.outputShape=[l,d,p,c];const f=s==="bilinear"?1:0,[h,y]=[`${i-1}.0`,`${u-1}.0`],[x,g,v]=d>1?[`${(i-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${h} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${h}`],[w,S,$]=p>1?[`${(u-1)/(p-1)}`,"(x2-x1) * width_ratio",`x1*${y} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${y}`];this.userCode=`
      const float height_ratio = float(${x});
      const float width_ratio = float(${w});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${g};
        float width_scale = ${S};

        float in_y = ${v};
        if( in_y < 0.0 || in_y > ${h} ) {
          setOutput(float(${a}));
          return;
        }
        float in_x = ${$};
        if( in_x < 0.0 || in_x > ${y} ) {
          setOutput(float(${a}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wee=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:a,boxInd:o}=e,{cropSize:i,method:u,extrapolationValue:c}=r,l=new zee(s.shape,a.shape,i,u,c);return n.runWebGLProgram(l,[s,a,o],"float32")},Uee={kernelName:Vf,backendName:"webgl",kernelFunc:Wee};var Sc;(function(t){t.Prod="*",t.Sum="+"})(Sc||(Sc={}));class NS{constructor(e,n,r,s){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const a=this.outputShape.length,o=this.op===Sc.Prod?"1.0":"0.0",i=r?o:`getX(${kS(a,"coords",this.op)})`,u=this.outputShape[this.outputShape.length-1];let c="",l="";r?(c=s?`end != ${u-1}`:"end != 0",l=s?"end + 1":"end - 1"):(c=s?`end + pow2 < ${u}`:"end >= pow2",l=s?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${nt(a)} coords = getOutputCoords();
        int end = ${ES(a,"coords",this.op)};
        float val = ${i};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${l};
          ${ES(a,"coords",this.op)} = idx;
          val ${this.op}= getX(${kS(a,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function kS(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function ES(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lT(t,e,n,r,s,a){const o=e.shape.length,i=An([r],o);let u=e;i!=null&&(u=xn({inputs:{x:e},backend:n,attrs:{perm:i}}));const c=Xt(1,o)[0];if(c!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const l=u.shape[c];let d=Xn({inputs:{x:u},backend:n});for(let p=0;p<=Math.ceil(Math.log2(l))-1;p++){const f=new NS(t,u.shape,!1,a),h=[[p]],y=d;d=n.runWebGLProgram(f,[d],d.dtype,h),n.disposeIntermediateTensorInfo(y)}if(s){const p=new NS(t,u.shape,s,a),f=d;d=n.runWebGLProgram(p,[d],d.dtype),n.disposeIntermediateTensorInfo(f)}if(i!=null){const p=Fc(i),f=xn({inputs:{x:d},backend:n,attrs:{perm:p}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(u),f}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gee(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:a,exclusive:o,reverse:i}=r;return lT(Sc.Prod,s,n,a,o,i)}const Hee={kernelName:Mf,backendName:"webgl",kernelFunc:Gee};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jee(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:a,exclusive:o,reverse:i}=r;return lT(Sc.Sum,s,n,a,o,i)}const Kee={kernelName:Bf,backendName:"webgl",kernelFunc:jee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qee(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:a}=e,{size:o,binaryOutput:i}=r;if(s.shape.length===1){const u=n.readSync(s.dataId),c=n.readSync(a.dataId),l=UE(u,c,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,l)}else if(s.shape.length===2){const u=n.bufferSync(s),c=n.bufferSync(a),l=ZY(u,c,o,i);return n.makeTensorInfo(l.shape,a.dtype,l.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const Xee={kernelName:mx,backendName:"webgl",kernelFunc:qee};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yee{constructor(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qee(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:a,dataFormat:o}=r,i=s.shape[0],u=o==="NHWC"?s.shape[1]:s.shape[2],c=o==="NHWC"?s.shape[2]:s.shape[3],l=o==="NHWC"?s.shape[3]:s.shape[1],d=u*a,p=c*a,f=l/(a*a),h=o==="NHWC"?[i,d,p,f]:[i,f,d,p],y=new Yee(h,a,o);return n.runWebGLProgram(y,[s],s.dtype)}const Zee={kernelName:zf,backendName:"webgl",kernelFunc:Qee};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cT{constructor(e,n=!1,r=null,s=!1,a=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=on(this.outputShape.length);const o=e.filterHeight,i=e.filterWidth,u=e.outChannels/e.inChannels;let c="",l="";r&&(s?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:a?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:c=`
          float activation(float x) {
            ${r}
          }
        `,l="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${u};
        int q = d2 - d1 * ${u};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${i}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dT{constructor(e,n=!1,r=null,s=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=on(this.outputShape.length);const o=e.outChannels/e.inChannels,i=e.padInfo.left,u=e.strideWidth,c=e.dilationWidth,l=e.filterHeight,d=e.filterWidth,p=d;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<d;g++)f+=`
          vec4 xTexelC${g*2};
          int xTexelC${g*2}Ready;
          vec4 xTexelC${g*2+1};
          int xTexelC${g*2+1}Ready;
          vec4 xC${g};`;f+=`
    for (int r = 0; r < ${l}; r++) {
      `;for(let g=0;g<d;g++)f+=`
          xTexelC${g*2} = vec4(0.0);
          xTexelC${g*2}Ready = 0;
          xTexelC${g*2+1} = vec4(0.0);
          xTexelC${g*2+1}Ready = 0;
          xC${g} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let g=0;g<(p+1)/2;g++){const v=g*2;if(f+=`
          xC = xCCorner + ${v*c};
          `,u===1){if(v<d&&(i%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }
              `,c===1&&v>0?f+=`
                xC${v} = vec4(xTexelC${v-2}.zw, xTexelC${v}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${v} = vec4(previous.zw, xTexelC${v}.xy);
                  } else {
                    xC${v} = vec4(0.0, 0.0, xTexelC${v}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xC${v} = xTexelC${v};
                `,v+1<d)){const w=i%2===0?K0(c):c;c%2===0&&i%2===1||c%2!==0&&i%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${w};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                    xTexelC${v+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${v+1}.zw = vec2(0.0);
                    }
                    xTexelC${v+1}Ready = 1;
                  }
                  `,c>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${v+1} = vec4(previous.zw, xTexelC${v+1}.xy);
                    } else {
                     xC${v+1} = vec4(0.0, 0.0, xTexelC${v+1}.xy);
                    }
                    `:f+=`
                    xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.xy);
                    `):w===1?f+=`
                    xC${v+1} = xTexelC${v};
                    `:f+=`
                    xCOffset = xC + ${w};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                      xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${v+1}.zw = vec2(0.0);
                      }
                      xTexelC${v+1}Ready = 1;
                    }

                    xC${v+1} = xTexelC${v+1};
                    `}}else v<d&&(i%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.0);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
              `,v+1<d&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${v+1} = vec4(xTexelC${v+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(
                  xTexelC${v}.xy, xTexelC${v+1}.xy);
              `,v+1<d&&(f+=`
                  xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
                `)));v<d&&(f+=`
            wTexel = getW(r, ${v}, d1, q);
            dotProd += xC${v} * vec4(wTexel.xz, wTexel.xz);
          `,v+1<d&&(f+=`
              wTexel = getW(r, ${v+1}, d1, q);
              dotProd += xC${v+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let h="",y="";r&&(s?h=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:a?h=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:h=`vec4 activation(vec4 x) {
          ${r}
        }`,y="result = activation(result);");const x=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${h}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${x}
        ${y}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jee(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:a}=e,{strides:o,pad:i,dilations:u,dimRoundingMode:c}=r;let l=u;l==null&&(l=[1,1]),E(Rn(o,l),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${l}'`);const d=qt(s.shape,a.shape,o,l,i,c,!0);let p;U().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?p=new dT(d):p=new cT(d);const f=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(p,[s,a],"float32",f)}const ete={kernelName:Wf,backendName:"webgl",kernelFunc:Jee};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tte{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,a=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class nte{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,a=e.strideWidth,o=n-1-e.padInfo.top,i=r-1-e.padInfo.left,u=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${u}; dm++) {
              int d2 = d1 * ${u} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rte(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:a}=e,{strides:o,dilations:i,pad:u,dimRoundingMode:c,filterShape:l}=r,d=qt(s.shape,l,o,i,u,c,!0),p=new tte(d);return n.runWebGLProgram(p,[s,a],"float32")}const ste={kernelName:u$,backendName:"webgl",kernelFunc:rte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ate(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:a}=e,{strides:o,dilations:i,pad:u,dimRoundingMode:c,inputShape:l}=r,d=qt(l,a.shape,o,i,u,c,!0),p=new nte(d);return n.runWebGLProgram(p,[s,a],"float32")}const ote={kernelName:l$,backendName:"webgl",kernelFunc:ate};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ite{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ute(t){const{inputs:e,backend:n}=t,{x:r}=e,s=[...r.shape,...r.shape],a=K(r.shape),o=ie({inputs:{x:r},backend:n,attrs:{shape:[a]}}),i=new ite(a),u=n.runWebGLProgram(i,[o],o.dtype),c=ie({inputs:{x:u},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),c}const lte={kernelName:gx,backendName:"webgl",kernelFunc:ute};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cte{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:r,padInfo:s,strideHeight:a,strideWidth:o,filterHeight:i,filterWidth:u,dilationHeight:c,dilationWidth:l}=e,{top:d,left:p}=s;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${o});
      const ivec2 pads = ivec2(${d}, ${p});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${i}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${u}; w++) {
              int wIn = wBeg + w * ${l};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dte(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:a}=e,{strides:o,pad:i,dilations:u}=r,c=Dc(s.shape,a.shape,o,i,"NHWC",u);let l;const d=new cte(c);l=n.runWebGLProgram(d,[s,a],"float32");const p=ie({inputs:{x:l},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(l),p}const pte={kernelName:Uf,backendName:"webgl",kernelFunc:dte};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fte(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,a=e,{allDims:o,summedDims:i,idDims:u}=EN(s,a.length);RN(o.length,u,a);const{path:c,steps:l}=AN(i,u),d=l.length;let p=null,f=o.length;const h=[];for(let y=0;y<d;++y){for(const x of l[y]){const{permutationIndices:g,expandDims:v}=TN(f,u[x]);let w;ON(g)?w=a[x]:(w=xn({inputs:{x:a[x]},backend:n,attrs:{perm:g}}),h.push(w));const S=w.shape.slice();for(let $=0;$<v.length;++$)S.splice(v[$],0,1);yt(w.shape,S)||(w=ie({inputs:{x:w},backend:n,attrs:{shape:S}}),h.push(w)),p===null?p=w:(p=Ew({inputs:{a:w,b:p},backend:n}),h.push(p))}y<d-1&&(c[y]>=0&&(p=Hh({inputs:{x:p},backend:n,attrs:{axis:c[y]-(o.length-f),keepDims:!1}}),h.push(p)),f--)}for(const y of h)y!==p&&n.disposeIntermediateTensorInfo(y);return p}const hte={kernelName:p$,backendName:"webgl",kernelFunc:fte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mte="return (x >= 0.0) ? x : (exp(x) - 1.0);",gte=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,yte=We({opSnippet:mte,packedOpSnippet:gte}),xte={kernelName:xx,backendName:"webgl",kernelFunc:yte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vte="return (b >= 0.0) ? a : a * (b + 1.0);",wte=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,bte=t=>{const{inputs:e,backend:n}=t,{dy:r,y:s}=e,a=U().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new zu(wte,r.shape,s.shape):new Jo(vte,r.shape,s.shape);return n.runWebGLProgram(a,[r,s],r.dtype)},Ste={kernelName:vx,backendName:"webgl",kernelFunc:bte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cte=`
  return vec4(equal(a, b));
`,Ite="return float(a == b);",$te=Qt({opSnippet:Ite,packedOpSnippet:Cte,dtype:"bool",cpuKernelImpl:rQ}),_te={kernelName:bx,backendName:"webgl",kernelFunc:$te};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nte=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${CN};
  float a1 = ${IN};
  float a2 = ${$N};
  float a3 = ${_N};
  float a4 = ${NN};
  float a5 = ${kN};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,kte=We({opSnippet:Nte}),Ete={kernelName:wx,backendName:"webgl",kernelFunc:kte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tte=Wu+`
  return exp(x);
`,Rte=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,pT=We({opSnippet:Tte,packedOpSnippet:Rte,cpuKernelImpl:sQ,dtype:"float32"}),Ate={kernelName:Sx,backendName:"webgl",kernelFunc:pT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ly(t){const{inputs:e,attrs:n,backend:r}=t,{dim:s}=n,{input:a}=e,o=a.shape.length,i=a.shape.slice();let u=s;return s<0&&(E(-(o+1)<=s,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),u=o+s+1),i.splice(u,0,1),ie({inputs:{x:a},backend:r,attrs:{shape:i}})}const Ote={kernelName:Cx,backendName:"webgl",kernelFunc:Ly};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TS="return exp(x) - 1.0;",Dte=We({opSnippet:TS,packedOpSnippet:TS,cpuKernelImpl:aQ}),Pte={kernelName:Ix,backendName:"webgl",kernelFunc:Dte};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RS{constructor(e,n,r){this.variableNames=["real","imag"];const s=n[1];this.outputShape=n;const a=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=r?`${s}.0`:"1.0";let i;if(e==="real")i="return real * expR - imag * expI;";else if(e==="imag")i="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${a};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${i}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${s});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${s}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fT(t,e,n){const r=n.texData.get(t.dataId),s=K(t.shape),a=t.shape[t.shape.length-1],o=s/a,i=ie({inputs:{x:t},backend:n,attrs:{shape:[o,a]}}),u=i.shape,c=new RS("real",u,e),l=new RS("imag",u,e),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:u},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:u}],p=n.runWebGLProgram(c,d,"float32"),f=n.runWebGLProgram(l,d,"float32"),h=so({inputs:{real:p,imag:f},backend:n});n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f);const y=ie({inputs:{x:h},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(h),y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fte(t){const{inputs:e,backend:n}=t,{input:r}=e;return fT(r,!1,n)}const Lte={kernelName:f$,backendName:"webgl",kernelFunc:Fte};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mte{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hc(t){const{backend:e,attrs:n}=t,{shape:r,value:s}=n;let{dtype:a}=n;if(a=a||Ou(s),a==="string"){const o=Vt(a,K(r));return o.fill(s),e.makeTensorInfo(r,a,o)}else{const o=new Mte(r,s),i=[[s]];return e.runWebGLProgram(o,[],a,i)}}const Bte={kernelName:$x,backendName:"webgl",kernelFunc:Hc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vte{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zte={kernelName:Gf,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,s=new Vte(n.shape);return r.runWebGLProgram(s,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AS="return floor(x);",Wte=We({opSnippet:AS,packedOpSnippet:AS,cpuKernelImpl:oQ}),Ute={kernelName:_x,backendName:"webgl",kernelFunc:Wte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gte=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,Hte=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,jte=Qt({opSnippet:Gte,packedOpSnippet:Hte,dtype:"int32"}),Kte={kernelName:Nx,backendName:"webgl",kernelFunc:jte};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qte{constructor(e){this.variableNames=["A"];const n=vn(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xte{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=vn(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${s}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yte={kernelName:Zg,backendName:"webgl",kernelFunc:Qte};let Di,Hm=U().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function Qte(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:s}=e;const{numChannels:a}=r,o=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,i=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,[u,c]=o?[s.videoWidth,s.videoHeight]:[s.width,s.height],l=[c,u],d=[c,u,a];if(i||o){const y=U().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Di==null||y!==Hm)&&(Hm=y,Di=document.createElement("canvas").getContext("2d",{willReadFrequently:Hm})),Di.canvas.width=u,Di.canvas.height=c,Di.drawImage(s,0,0,u,c),s=Di.canvas}const p=n.makeTensorInfo(l,"int32");n.texData.get(p.dataId).usage=ir.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),s);const f=U().getBool("WEBGL_PACK")?new Xte(d):new qte(d),h=n.runWebGLProgram(f,[p],"int32");return n.disposeData(p.dataId),h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zte(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:a,bias:o,preluActivationWeights:i}=e,{strides:u,pad:c,dataFormat:l,dilations:d,dimRoundingMode:p,activation:f,leakyreluAlpha:h}=r,y=to(l),x=qt(s.shape,a.shape,u,d,c,p,!1,y);let g;const v=[],w=o!=null,S=i!=null,$=f==="leakyrelu",k=()=>{const A=[s,a],B=(L,z)=>{if(z==="NCHW"&&L.shape.length===1&&L.shape[0]!==1){const Y=ie({inputs:{x:L},backend:n,attrs:{shape:[L.shape[0],1,1]}});return v.push(Y),Y}return L};if(w&&A.push(B(o,l)),S&&A.push(B(i,l)),$){const L=n.makeTensorInfo([],"float32",Du(h,"float32"));A.push(L),v.push(L)}return A};if(x.filterHeight===1&&x.filterWidth===1&&x.dilationHeight===1&&x.dilationWidth===1&&x.strideHeight===1&&x.strideWidth===1&&(x.padInfo.type==="SAME"||x.padInfo.type==="VALID"))g=iT({x:s,filter:a,convInfo:x,backend:n,bias:o,activation:f,preluActivationWeights:i,leakyreluAlpha:h});else if(x.strideWidth<=2&&y==="channelsLast"&&U().getBool("WEBGL_EXP_CONV")){const A=f?wc(f,!0):null,B=new oT(x,w,A,S,$),L=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],z=k();g=n.runWebGLProgram(B,z,"float32",L)}else if(U().getBool("WEBGL_CONV_IM2COL"))g=uT({x:s,filter:a,convInfo:x,backend:n,bias:o,activation:f,preluActivationWeights:i,leakyreluAlpha:h});else{const A=f?wc(f,!1):null,B=new aT(x,w,A,S,$),L=k();g=n.runWebGLProgram(B,L,"float32")}const T=ie({inputs:{x:g},backend:n,attrs:{shape:x.outShape}});return v.push(g),v.forEach(A=>n.disposeIntermediateTensorInfo(A)),T}const Jte={kernelName:ic,backendName:"webgl",kernelFunc:Zte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ene(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:a,bias:o,preluActivationWeights:i}=e,{strides:u,pad:c,dilations:l,dimRoundingMode:d,activation:p,leakyreluAlpha:f}=r,h=[];let y=l;y==null&&(y=[1,1]),E(Rn(u,y),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${u} and dilations '${y}'`);const x=qt(s.shape,a.shape,u,y,c,d,!0),g=U().getBool("WEBGL_PACK_DEPTHWISECONV")&&x.strideWidth<=2&&x.outChannels/x.inChannels===1,v=p?wc(p,g):null,w=[s,a],S=o!=null,$=i!=null,k=p==="leakyrelu";if(S&&w.push(o),$&&w.push(i),k){const L=n.makeTensorInfo([],"float32",Du(f,"float32"));w.push(L),h.push(L)}let T;g?T=new dT(x,S,v,$,k):T=new cT(x,S,v,$,k);const A=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],B=n.runWebGLProgram(T,w,"float32",A);return h.forEach(L=>n.disposeIntermediateTensorInfo(L)),B}const tne={kernelName:uc,backendName:"webgl",kernelFunc:ene};class nne{constructor(e,n,r,s){this.sliceDim=e,this.strides=n,this.paramsShape=s,this.variableNames=["x","indices"],this.outputShape=r;const a=nt(r.length);let o=`
    int index;`;for(let i=0;i<this.sliceDim;i++)o+=`
          index = round(getIndices(coords[0], ${i}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[i]};
          flattenIndex += index * ${this.strides[i]};`;this.userCode=`
         void main() {
          ${a} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rne(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,a=s.shape,o=a[a.length-1],i=K(r.shape),[u,c,l,d]=Zv(r,s),p=ie({inputs:{x:s},backend:n,attrs:{shape:[c,o]}}),f=ie({inputs:{x:r},backend:n,attrs:{shape:[K(r.shape)/l,l]}});if(n.shouldExecuteOnCPU([r,s])||r.dtype==="string"){const g=n.readSync(s.dataId),v=n.bufferSync(r),w=iQ(g,v,r.dtype,c,o,l,d,r.shape,i);return n.makeTensorInfo(u,r.dtype,w.values)}const h=new nne(o,d,[c,l],r.shape),y=n.runWebGLProgram(h,[f,p],f.dtype),x=ie({inputs:{x:y},backend:n,attrs:{shape:u}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(y),x}const sne={kernelName:jf,backendName:"webgl",kernelFunc:rne};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ane{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=nt(this.rank),s=one(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${s}));
      }
    `}}function one(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<t.length;s++)s===2?r.push("index"):r.push(`${n[s]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hT(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:a}=e,{axis:o,batchDims:i}=r,u=vt(o,s.shape)[0];if(U().get("DEBUG")){const v=n.readSync(a.dataId),w=s.shape[u];for(let S=0;S<v.length;++S){const $=v[S];E($<=w-1&&$>=0,()=>`GatherV2: the index value ${$} is not in [0, ${w-1}]`)}}const c=vw(s,a,u,i),l=K(a.shape),d=[],p=ie({inputs:{x:s},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=ie({inputs:{x:a},backend:n,attrs:{shape:[c.batchSize,l/c.batchSize]}});d.push(p),d.push(f);const h=[c.batchSize,c.outerSize,l/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([s,a])||s.dtype==="string"){const v=n.bufferSync(f),w=n.bufferSync(p),S=uQ(w,v,h);return d.forEach($=>n.disposeIntermediateTensorInfo($)),n.makeTensorInfo(c.outputShape,S.dtype,S.values)}const y=new ane(p.shape,h),x=n.runWebGLProgram(y,[p,f],p.dtype);d.push(x);const g=ie({inputs:{x},backend:n,attrs:{shape:c.outputShape}});return d.forEach(v=>n.disposeIntermediateTensorInfo(v)),g}const ine={kernelName:kx,backendName:"webgl",kernelFunc:hT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const une="return float(a > b);",lne=`
  return vec4(greaterThan(a, b));
`,cne=Qt({opSnippet:une,packedOpSnippet:lne,cpuKernelImpl:lQ,dtype:"bool"}),dne={kernelName:Ex,backendName:"webgl",kernelFunc:cne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pne="return float(a >= b);",fne=`
  return vec4(greaterThanEqual(a, b));
`,hne=Qt({opSnippet:pne,packedOpSnippet:fne,dtype:"bool",cpuKernelImpl:cQ}),mne={kernelName:Tx,backendName:"webgl",kernelFunc:hne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gne(t){const{inputs:e,backend:n}=t,{input:r}=e;return fT(r,!0,n)}const yne={kernelName:h$,backendName:"webgl",kernelFunc:gne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xne="return float(!isnan(x) && !isinf(x));",vne=We({opSnippet:xne,dtype:"bool"}),wne={kernelName:Rx,backendName:"webgl",kernelFunc:vne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bne="return float(isinf(x));",Sne=We({opSnippet:bne,dtype:"bool"}),Cne={kernelName:Ax,backendName:"webgl",kernelFunc:Sne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ine="return float(isnan(x));",$ne=We({opSnippet:Ine,dtype:"bool"}),_ne={kernelName:Ox,backendName:"webgl",kernelFunc:$ne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nne="return float(a < b);",kne=`
  return vec4(lessThan(a, b));
`,Ene=Qt({opSnippet:Nne,packedOpSnippet:kne,cpuKernelImpl:dQ,dtype:"bool"}),Tne={kernelName:Dx,backendName:"webgl",kernelFunc:Ene};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rne="return float(a <= b);",Ane=`
  return vec4(lessThanEqual(a, b));
`,One=Qt({opSnippet:Rne,packedOpSnippet:Ane,cpuKernelImpl:pQ,dtype:"bool"}),Dne={kernelName:Px,backendName:"webgl",kernelFunc:One};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pne(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:a}=n,o=fQ(r,s,a);return e.makeTensorInfo([o.length],"float32",o)}const Fne={kernelName:Xf,backendName:"webgl",kernelFunc:Pne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lne=Wu+`
  return x < 0.0 ? 0./0. : log(x);
`,Mne=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,Bne=We({opSnippet:Lne,packedOpSnippet:Mne,cpuKernelImpl:hQ}),Vne={kernelName:Fx,backendName:"webgl",kernelFunc:Bne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zne=Wu+`
  return log(1.0 + x);
`,Wne=We({opSnippet:zne}),Une={kernelName:Lx,backendName:"webgl",kernelFunc:Wne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gne="return float(a >= 1.0 && b >= 1.0);",Hne=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,jne=Qt({opSnippet:Gne,packedOpSnippet:Hne,dtype:"bool"}),Kne={kernelName:Mx,backendName:"webgl",kernelFunc:jne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qne="return float(!(x >= 1.0));",Xne=We({opSnippet:qne}),Yne={kernelName:Bx,backendName:"webgl",kernelFunc:Xne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qne="return float(a >= 1.0 || b >= 1.0);",Zne=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,Jne=Qt({opSnippet:Qne,packedOpSnippet:Zne,dtype:"bool"}),ere={kernelName:Vx,backendName:"webgl",kernelFunc:Jne};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tre{constructor(e,n,r,s,a){this.variableNames=["x"],this.outputShape=[];const o=n,i=e[3]-1;this.outputShape=e;let u;const c=`float(${r}) + float(${s}) * sum`;a===.5?u=`inversesqrt(${c})`:a===1?u=`1.0/(${c})`:u=`exp(log(${c}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${i}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${u};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nre{constructor(e,n,r,s,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,i=e[3]-1;this.outputShape=e;let u;const c=`float(${r}) + float(${s}) * sum`;a===.5?u=`inversesqrt(${c})`:a===1?u=`1.0/(${c})`:u=`exp(log(${c}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${i}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${u};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rre=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:a,bias:o,alpha:i,beta:u}=r,c=U().getBool("WEBGL_PACK_NORMALIZATION")?new nre(s.shape,a,o,i,u):new tre(s.shape,a,o,i,u);return n.runWebGLProgram(c,[s],s.dtype)},sre={kernelName:Yf,backendName:"webgl",kernelFunc:rre};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class are{constructor(e,n,r,s,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=r,this.alpha=s,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${s}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${s})
                * float(${a})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${a});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ore=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s,y:a,dy:o}=e,{depthRadius:i,bias:u,alpha:c,beta:l}=r,d=new are(s.shape,i,u,c,l);return n.runWebGLProgram(d,[s,a,o],s.dtype)},ire={kernelName:zx,backendName:"webgl",kernelFunc:ore};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ure(t,e,n,r){const s=K(e),o=K(t.shape)/s,i=ie({inputs:{x:t},attrs:{shape:[o,s]},backend:r}),u=fi(i,t.dtype,"max",r),c=ie({inputs:{x:u},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(u),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mT(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:a,keepDims:o}=r,i=s.shape.length,u=vt(a,s.shape);let c=u;const l=An(c,i),d=l!=null,p=n.shouldExecuteOnCPU([s]);let f=s;if(d){if(p){const w=n.texData.get(f.dataId).values,S=new Array(i);for(let T=0;T<S.length;T++)S[T]=s.shape[l[T]];const $=Nw(w,s.shape,s.dtype,l,S);f=n.makeTensorInfo(S,s.dtype);const k=n.texData.get(f.dataId);k.values=$}else f=Gh(s,l,n);c=Xt(c.length,i)}Dt("max",c,i);const[h,y]=an(f.shape,c);let x=h;o&&(x=Ot(h,u));let g;if(p){const w=n.texData.get(f.dataId).values,S=mQ(w,K(y),x,s.dtype);g=n.makeTensorInfo(x,s.dtype);const $=n.texData.get(g.dataId);$.values=S}else g=ure(f,y,x,n);return d&&n.disposeIntermediateTensorInfo(f),g}const lre={kernelName:Qf,backendName:"webgl",kernelFunc:mT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cre=kw+`
  return max(a, b);
`,dre=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+pi+`
  return result;
`,pre=Qt({opSnippet:cre,packedOpSnippet:dre,cpuKernelImpl:gQ}),fre={kernelName:Wx,backendName:"webgl",kernelFunc:pre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hre(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;Wc(s,"maxPool");const{filterSize:a,strides:o,pad:i,dimRoundingMode:u}=r,c=1;E(Rn(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const l=Mr(s.shape,a,o,c,i,u);if(l.filterWidth===1&&l.filterHeight===1&&yt(l.inShape,l.outShape))return Xn({inputs:{x:s},backend:n});const d=new bc(l,"max",!1);return n.runWebGLProgram(d,[s],s.dtype)}const mre={kernelName:Zf,backendName:"webgl",kernelFunc:hre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gre(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:a,strides:o,pad:i,dataFormat:u,dimRoundingMode:c}=r,l=[1,1,1],d=aa(s.shape,a,o,l,i,c,u),p=new Tw(d,"max",!1);return n.runWebGLProgram(p,[s],s.dtype)}const yre={kernelName:Ux,backendName:"webgl",kernelFunc:gre};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xre{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,r=e.strideWidth,s=e.dilationHeight,a=e.effectiveFilterHeight,o=e.effectiveFilterWidth,i=a-1-e.padInfo.top,u=o-1-e.padInfo.left,c=a*o-1;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${u});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${a};
          wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class vre{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,a=e.dilationDepth,o=e.dilationHeight,i=e.dilationWidth,u=e.effectiveFilterDepth,c=e.effectiveFilterHeight,l=e.effectiveFilterWidth,d=u-1-e.padInfo.front,p=c-1-e.padInfo.top,f=l-1-e.padInfo.left,h=u*c*l-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${p}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${u};
           wD += ${a}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${l};
                wC += ${i}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${h} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${l} +
                  wR * ${l} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wre(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:a}=e,o=a,{filterSize:i,strides:u,pad:c,dimRoundingMode:l}=r,d=[1,1,1],p=aa(o.shape,i,u,d,c,l),f=new Tw(p,"max",!0),h=n.runWebGLProgram(f,[o],o.dtype),y=new vre(p),x=n.runWebGLProgram(y,[s,h],o.dtype);return n.disposeIntermediateTensorInfo(h),x}const bre={kernelName:y$,backendName:"webgl",kernelFunc:wre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sre(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:a,output:o}=e,i=a;Wc([a,o],"maxPoolGrad");const{filterSize:u,strides:c,pad:l,dimRoundingMode:d}=r,p=Mr(i.shape,u,c,1,l,d),f=!0,h=new bc(p,"max",f),y=n.runWebGLProgram(h,[i],i.dtype),x=new xre(p),g=n.runWebGLProgram(x,[s,y],i.dtype);return n.disposeIntermediateTensorInfo(y),g}const Cre={kernelName:g$,backendName:"webgl",kernelFunc:Sre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ire(t,e,n,r){let s=new bc(n,"max",!1);const a=r.runWebGLProgram(s,[t],"float32");s=new bc(n,"max",!0,!0,e);const o=r.runWebGLProgram(s,[t],"float32");return[a,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $re={kernelName:Gx,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:s,strides:a,pad:o,includeBatchInIndex:i}=e,u=n;E(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const c=[1,1];E(Rn(a,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const l=Mr(r.shape,s,a,c,o),[d,p]=Ire(r,i,l,u);return[d,p]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _re(t,e,n,r){const s=K(e),o=K(t.shape)/s,i=ie({inputs:{x:t},attrs:{shape:[o,s]},backend:r}),u=fi(i,"float32","mean",r),c=ie({inputs:{x:u},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(u),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nre={kernelName:Jf,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{keepDims:s,axis:a}=e,o=n,i=r.shape.length,u=vt(a,r.shape);let c=u;const l=An(c,i),d=l!=null,p=o.shouldExecuteOnCPU([r]),f=[];let h=r;if(d){if(p){const S=o.texData.get(h.dataId).values,$=new Array(i);for(let A=0;A<$.length;A++)$[A]=r.shape[l[A]];const k=Nw(S,r.shape,r.dtype,l,$);h=o.makeTensorInfo($,r.dtype);const T=o.texData.get(h.dataId);T.values=k}else h=Gh(r,l,o);f.push(h),c=Xt(c.length,i)}Dt("sum",c,i);const[y,x]=an(h.shape,c);let g=y;s&&(g=Ot(y,u));const v=_re(h,x,g,o);for(const w of f)o.disposeIntermediateTensorInfo(w);return v}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kre(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:a,keepDims:o}=r,i=s.shape.length,u=vt(a,s.shape);let c=u;const l=An(c,i);let d=s;l!=null&&(d=xn({inputs:{x:s},backend:n,attrs:{perm:l}}),c=Xt(c.length,s.shape.length)),Dt("min",c,i);const[p,f]=an(d.shape,c),h=K(f),y=ie({inputs:{x:d},backend:n,attrs:{shape:[-1,h]}}),x=fi(y,y.dtype,"min",n);let g;if(o){const v=Ot(p,u);g=ie({inputs:{x},backend:n,attrs:{shape:v}})}else g=ie({inputs:{x},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),l!=null&&n.disposeIntermediateTensorInfo(d),g}const Ere={kernelName:eh,backendName:"webgl",kernelFunc:kre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tre=kw+`
  return min(a, b);
`,Rre=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+pi+`
  return result;
`,Are=Qt({opSnippet:Tre,packedOpSnippet:Rre,cpuKernelImpl:yQ}),Ore={kernelName:Hx,backendName:"webgl",kernelFunc:Are};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dre{constructor(e,n,r){this.variableNames=["x"],this.outputShape=n.map((l,d)=>l[0]+e[d]+l[1]);const s=e.length,a=nt(s),o=n.map(l=>l[0]).join(","),i=n.map((l,d)=>l[0]+e[d]).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s),c=r==="reflect"?0:1;if(s===1){this.userCode=`
        int start = ${o};
        int end = ${i};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${o});
      ${a} end = ${a}(${i});

      void main() {
        ${a} outC = getOutputCoords();
        for (int i = 0; i < ${s}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${a} coords = outC - start;
        setOutput(getX(${u}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pre{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((h,y)=>h[0]+e[y]+h[1]);const s=e.length,a=nt(s),o=n.map(h=>h[0]).join(","),i=n.map((h,y)=>h[0]+e[y]).join(","),u=gn("rc",s),c=gn("source",s),l=`${u[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${c.slice(-2).join()})`,p=r==="reflect"?0:1;let f="";if(s===1){const h=`
        ${a} source = rc;
        if (source < start) {
          source = start * 2 - source - ${p};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${p};
        }
        source -= start;
      `;f=`
        ${a} rc = outputLoc;
        ${h}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${u[s-1]} += 1;
        if(${l}) {
          ${h}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
      `}else{const h=`
        ${a} source = rc;
        ${a} lt = ${a}(lessThan(source, start));
        ${a} gte = ${a}(greaterThanEqual(source, end));
        ${a} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${p}) +
                gte * ((end - 1) * 2 - source + ${p});
        source -= start;
      `;f=`
        ${a} rc = outputLoc;
        ${h}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${u[s-1]} += 1;
        if(${l}) {
          ${h}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
        rc = outputLoc;
        ${u[s-2]} += 1;
        if(${u[s-2]} < ${this.outputShape[s-2]}) {
          ${h}
          result[2] = getChannel(getX(${c.join()}), ${d});
          ${u[s-1]} += 1;
          if(${l}) {
            ${h}
            result[3] = getChannel(getX(${c.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${a} start = ${a}(${o});
      const ${a} end = ${a}(${i});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fre=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:s,mode:a}=n,o=U().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Pre(r.shape,s,a):new Dre(r.shape,s,a);return e.runWebGLProgram(o,[r],r.dtype)},Lre={kernelName:th,backendName:"webgl",kernelFunc:Fre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mre=`if (b == 0.0) return NAN;
  return mod(a, b);`,Bre=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+pi+`
  return result;
`,Vre=Qt({opSnippet:Mre,packedOpSnippet:Bre}),zre={kernelName:jx,backendName:"webgl",kernelFunc:Vre};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wre{constructor(e,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ure=`
if (a == b) {
  return 1.0;
};
return a / b;`,Gre=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,gT=Qt({opSnippet:Ure,packedOpSnippet:Gre,checkOutOfBounds:!0}),Hre={kernelName:yx,backendName:"webgl",kernelFunc:gT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OS="return a - b;",yT=Qt({opSnippet:OS,packedOpSnippet:OS,supportsComplex:!0,cpuKernelImpl:MQ}),jre={kernelName:_v,backendName:"webgl",kernelFunc:yT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xT(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:a}=r,o=vt([a],s.shape),i=mT({inputs:{x:s},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),u=Ot(i.shape,o),c=ie({inputs:{x:i},backend:n,attrs:{shape:u}}),l=yT({inputs:{a:s,b:c},backend:n}),d=pT({inputs:{x:l},backend:n}),p=Hh({inputs:{x:d},backend:n,attrs:{axis:o,keepDims:!1}}),f=ie({inputs:{x:p},backend:n,attrs:{shape:u}}),h=gT({inputs:{a:d,b:f},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),h}const Kre={kernelName:yh,backendName:"webgl",kernelFunc:xT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qre(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:a,seed:o,normalized:i}=r,u=i?s:xT({inputs:{logits:s},backend:n,attrs:{dim:s.shape.length-1}}),c=u.shape[0],l=u.shape[1],d=new Wre(c,l,a),p=[[o]],f=n.runWebGLProgram(d,[u],"int32",p);return i||n.disposeIntermediateTensorInfo(u),f}const Xre={kernelName:nh,backendName:"webgl",kernelFunc:qre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yre=Vr+`
  return -x;
`,Qre=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function Zre(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const a=n.texData.get(r.dataId),[o,i]=vQ(a.values,r.shape,r.dtype);return n.makeTensorInfo(i,r.dtype,o)}let s;return U().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new _a(r.shape,Qre):s=new Is(r.shape,Yre),n.runWebGLProgram(s,[r],r.dtype)}const Jre={kernelName:qx,backendName:"webgl",kernelFunc:Zre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ese=Z_;function tse(t){Jr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:a}=e,{maxOutputSize:o,iouThreshold:i,scoreThreshold:u}=r,c=n.readSync(s.dataId),l=n.readSync(a.dataId),{selectedIndices:d}=ese(c,l,o,i,u);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const nse={kernelName:rh,backendName:"webgl",kernelFunc:tse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rse=J_;function sse(t){Jr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:a}=e,{maxOutputSize:o,iouThreshold:i,scoreThreshold:u,padToMaxOutputSize:c}=r,l=n.readSync(s.dataId),d=n.readSync(a.dataId),{selectedIndices:p,validOutputs:f}=rse(l,d,o,i,u,c);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const ase={kernelName:sh,backendName:"webgl",kernelFunc:sse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ose=eN;function ise(t){Jr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:a}=e,{maxOutputSize:o,iouThreshold:i,scoreThreshold:u,softNmsSigma:c}=r,l=n.readSync(s.dataId),d=n.readSync(a.dataId),p=o,f=i,h=u,y=c,{selectedIndices:x,selectedScores:g}=ose(l,d,p,f,h,y);return[n.makeTensorInfo([x.length],"int32",new Int32Array(x)),n.makeTensorInfo([g.length],"float32",new Float32Array(g))]}const use={kernelName:ah,backendName:"webgl",kernelFunc:ise};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lse{constructor(e,n,r,s){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${s}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cse=t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:a,depth:o,onValue:i,offValue:u}=r,c=K(s.shape),l=new lse(c,o,i,u),d=ie({inputs:{x:s},backend:n,attrs:{shape:[c]}}),p=n.runWebGLProgram(l,[d],a);n.disposeIntermediateTensorInfo(d);const f=[...s.shape,o],h=ie({inputs:{x:p},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(p),h},dse={kernelName:oh,backendName:"webgl",kernelFunc:cse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qp(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const s=Gc({inputs:{input:r},backend:n}),a=Qp({inputs:{x:s},backend:n}),o=jh({inputs:{input:r},backend:n}),i=Qp({inputs:{x:o},backend:n}),u=so({inputs:{real:a,imag:i},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),u}else return Hc({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const pse={kernelName:Rv,backendName:"webgl",kernelFunc:Qp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vT(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const s=Gc({inputs:{input:r},backend:n}),a=vT({inputs:{x:s},backend:n}),o=jh({inputs:{input:r},backend:n}),i=Qp({inputs:{x:o},backend:n}),u=so({inputs:{real:a,imag:i},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),u}else return Hc({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const fse={kernelName:Yx,backendName:"webgl",kernelFunc:vT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hse(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return Ly({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const a=e[0].shape,o=e[0].dtype;e.forEach(l=>{Yn(a,l.shape,"All tensors passed to stack must have matching shapes"),E(o===l.dtype,()=>"All tensors passed to stack must have matching dtypes")});const i=[],u=e.map(l=>{const d=Ly({inputs:{input:l},backend:n,attrs:{dim:s}});return i.push(d),d}),c=sT({inputs:u,backend:n,attrs:{axis:s}});return i.forEach(l=>n.disposeIntermediateTensorInfo(l)),c}const mse={kernelName:Qx,backendName:"webgl",kernelFunc:hse};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gse{constructor(e,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((c,l)=>c[0]+e[l]+c[1]);const s=e.length,a=nt(s),o=n.map(c=>c[0]).join(","),i=n.map((c,l)=>c[0]+e[l]).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s);if(s===1){this.userCode=`
        int start = ${o};
        int end = ${i};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${o});
      ${a} end = ${a}(${i});

      void main() {
        ${a} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${a} coords = outC - start;
          setOutput(getX(${u}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yse{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((y,x)=>y[0]+e[x]+y[1]);const s=e.length,a=nt(s),o=n.map(y=>y[0]).join(","),i=n.map((y,x)=>y[0]+e[x]).join(","),u=gn("rc",s),c=gn("source",s),l=`${u[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${c.slice(-2).join()})`,p=[`${a} rc = outputLoc;`,`${u[s-1]} += 1;
       if(${l}) {
      `,s===1?"":`}
       rc = outputLoc;
       ${u[s-2]} += 1;
       if(${u[s-2]} < ${this.outputShape[s-2]}) {`,s===1?"":`  ${u[s-1]} += 1;
         if(${l}) {`],f=s===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let h="";for(let y=0,x=s===1?2:4;y<x;y++)h+=`
        ${p[y]}
        if (${f}) {
          result[${y}] = float(value);
        } else {
          ${a} source = rc - start;
          result[${y}] = getChannel(getX(${c.join()}), ${d});
        }
      `;h+=s===1?"} ":"}}",this.userCode=`
      const ${a} start = ${a}(${o});
      const ${a} end = ${a}(${i});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${h}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wT=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:a,constantValue:o}=r;if(K(s.shape)===0){const c=a.map((l,d)=>l[0]+s.shape[d]+l[1]);return Hc({backend:n,attrs:{shape:c,value:o,dtype:s.dtype}})}const i=U().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new yse(s.shape,a,o):new gse(s.shape,a,o),u=[[o]];return n.runWebGLProgram(i,[s],s.dtype,u)},xse={kernelName:ih,backendName:"webgl",kernelFunc:wT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vse=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,wse=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+pi+`
  return result;
`,bse=Qt({opSnippet:vse,packedOpSnippet:wse}),Sse={kernelName:Zx,backendName:"webgl",kernelFunc:bse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cse(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:a,keepDims:o}=r,i=s.shape.length,u=[],c=vt(a,s.shape);let l=c;const d=An(l,i);let p=s;d!=null&&(p=xn({inputs:{x:s},backend:n,attrs:{perm:d}}),l=Xt(l.length,i),u.push(p)),Dt("prod",l,i);let f;if(n.shouldExecuteOnCPU([p])){const h=n.texData.get(p.dataId).values,{outVals:y,outShape:x,outDtype:g}=bQ(p.shape,p.dtype,h,l);f=n.makeTensorInfo(x,g,y)}else{const[h,y]=an(p.shape,l),x=K(y),g=ie({inputs:{x:p},backend:n,attrs:{shape:[-1,x]}}),v=Ov(s.dtype),w=fi(g,v,"prod",n);f=ie({inputs:{x:w},backend:n,attrs:{shape:h}}),u.push(g),u.push(w)}if(o){u.push(f);const h=Ot(f.shape,c);f=ie({inputs:{x:f},backend:n,attrs:{shape:h}})}return u.forEach(h=>n.disposeIntermediateTensorInfo(h)),f}const Ise={kernelName:lh,backendName:"webgl",kernelFunc:Cse};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $se(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:s,paramsDenseValues:a,indices:o}=e,{outputRaggedRank:i}=r,u=s.map(g=>n.readSync(g.dataId)),c=s.map(g=>g.shape),l=n.readSync(a.dataId),d=n.readSync(o.dataId),[p,f,h]=SQ(u,c,l,a.shape,a.dtype,d,o.shape,i),y=p.map(g=>n.makeTensorInfo([g.length],"int32",g)),x=n.makeTensorInfo(h,a.dtype,f);return y.concat([x])}const _se={kernelName:x$,backendName:"webgl",kernelFunc:$se};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nse(t){const{inputs:e,backend:n}=t,{starts:r,limits:s,deltas:a}=e,o=n.readSync(r.dataId),i=n.readSync(s.dataId),u=n.readSync(a.dataId),[c,l]=CQ(o,r.shape,r.dtype,i,s.shape,u,a.shape),d=n.makeTensorInfo([c.length],"int32",c),p=n.makeTensorInfo([l.length],r.dtype,l);return[d,p]}const kse={kernelName:v$,backendName:"webgl",kernelFunc:Nse};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ese(t){const{inputs:e,backend:n,attrs:r}=t,{shape:s,values:a,defaultValue:o,rowPartitionTensors:i}=e,{rowPartitionTypes:u}=r,c=n.readSync(s.dataId),l=n.readSync(a.dataId),d=n.readSync(o.dataId),p=i.map(x=>n.readSync(x.dataId)),f=i.map(x=>x.shape),[h,y]=IQ(c,s.shape,l,a.shape,a.dtype,d,o.shape,p,f,u);return n.makeTensorInfo(h,a.dtype,y)}const Tse={kernelName:w$,backendName:"webgl",kernelFunc:Ese};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bT=t=>{const{backend:e,attrs:n}=t,{start:r,stop:s,step:a,dtype:o}=n,i=$Q(r,s,a,o);return e.makeTensorInfo([i.length],o,i)},Rse={kernelName:Jx,backendName:"webgl",kernelFunc:bT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ase="return 1.0 / x;",Ose=We({opSnippet:Ase}),Dse={kernelName:ev,backendName:"webgl",kernelFunc:Ose};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pse=Vr+`
  return (x < 0.0) ? 0.0 : x;
`,Fse=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Lse=We({opSnippet:Pse,packedOpSnippet:Fse}),Mse={kernelName:tv,backendName:"webgl",kernelFunc:Lse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bse=Vr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Vse=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,zse=We({opSnippet:Bse,packedOpSnippet:Vse}),Wse={kernelName:av,backendName:"webgl",kernelFunc:zse};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Use{constructor(e,n,r,s,a){this.variableNames=["A"],this.outputShape=[];const[o,i,u,c]=e;this.outputShape=[o,n,r,c];const l=[s&&n>1?i-1:i,s&&r>1?u-1:u],d=[s&&n>1?n-1:n,s&&r>1?r-1:r];let p;a?p="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${l[0]/d[0]},
          ${l[1]/d[1]});
      const vec2 inputShapeRC = vec2(${i}.0, ${u}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gse{constructor(e,n,r,s,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,i,u,c]=e;this.outputShape=[o,n,r,c];const l=[s&&n>1?i-1:i,s&&r>1?u-1:u],d=[s&&n>1?n-1:n,s&&r>1?r-1:r];let p;a?p="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${l[0]/d[0]},
          ${l[1]/d[1]},
          ${l[1]/d[1]});
      const vec3 inputShapeRC = vec3(${i}.0, ${u}.0,
                                     ${u}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hse(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:a,halfPixelCenters:o,size:i}=r,[u,c]=i,l=U().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Gse(s.shape,u,c,a,o):new Use(s.shape,u,c,a,o);return n.runWebGLProgram(l,[s],"float32")}const jse={kernelName:dh,backendName:"webgl",kernelFunc:Hse};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kse{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,a]=n,[,o,i]=e,u=[r&&o>1?s-1:s,r&&i>1?a-1:a],c=[r&&o>1?o-1:o,r&&i>1?i-1:i],l=u[0]/c[0],d=u[1]/c[1],p=1/l,f=1/d,h=Math.ceil(p)*2+2,y=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${l});
        const float widthScale = float(${d});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${f});

        const int winHeight = int(${h});
        const int winWidth = int(${y});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${i}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${s-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${a-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qse(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:a}=e,{alignCorners:o}=r,i=new Kse(a.shape,s.shape,o);return n.runWebGLProgram(i,[a],a.dtype)}const Xse={kernelName:sv,backendName:"webgl",kernelFunc:qse};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yse{constructor(e,n,r,s,a){this.variableNames=["A"],this.outputShape=[];const[o,i,u,c]=e;this.outputShape=[o,n,r,c];const l=[s&&n>1?i-1:i,s&&r>1?u-1:u],d=[s&&n>1?n-1:n,s&&r>1?r-1:r],p=s?"0.5":"0.0";let f;a?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${l[0]/d[0]},
          ${l[1]/d[1]});
      const vec2 inputShapeRC = vec2(${i}.0, ${u}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qse{constructor(e,n,r,s,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,i,u,c]=e;this.outputShape=[o,n,r,c];const l=[s&&n>1?i-1:i,s&&r>1?u-1:u],d=[s&&n>1?n-1:n,s&&r>1?r-1:r],p=s?"0.5":"0.0";let f;a?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${l[0]/d[0]},
          ${l[1]/d[1]},
          ${l[1]/d[1]});
      const vec3 inputShapeRC = vec3(${i}.0, ${u}.0,
                                     ${u}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zse(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:a,halfPixelCenters:o,size:i}=r,[u,c]=i,l=U().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Qse(s.shape,u,c,a,o):new Yse(s.shape,u,c,a,o);return n.runWebGLProgram(l,[s],s.dtype)}const Jse={kernelName:ch,backendName:"webgl",kernelFunc:Zse};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eae{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,a]=n,[,o,i]=e,u=[r&&o>1?s-1:s,r&&i>1?a-1:a],c=[r&&o>1?o-1:o,r&&i>1?i-1:i],l=u[0]/c[0],d=u[1]/c[1],p=1/l,f=1/d,h=Math.ceil(p)*2+2,y=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${l});
        const float widthScale = float(${d});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${f});

        const int winHeight = int(${h});
        const int winWidth = int(${y});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${i}) {
              continue;
            }

            float sourceFracRow =
              float(${u[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${u[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${a}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tae(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:a}=e,{alignCorners:o}=r,i=new eae(a.shape,s.shape,o);return n.runWebGLProgram(i,[a],a.dtype)}const nae={kernelName:rv,backendName:"webgl",kernelFunc:tae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rae{constructor(e,n){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const s=i=>n.indexOf(i)!==-1&&e[i]!==1?`${e[i]} - coords[${i}] - 1`:`coords[${i}]`,a=e.map((i,u)=>s(u)).join(","),o=nt(r);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sae{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const s=gn("rc",r),a=`${s[r-1]} + 1 < ${this.outputShape[r-1]}`,o=`${s[r-2]} + 1 < ${this.outputShape[r-2]}`,i=nt(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${a}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${i} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${u(s.slice())};
          if(${a}){
            result.g = ${c(s.slice())};
          }
          if(${o}) {
            result.b = ${l(s.slice())};
            if(${a}) {
              result.a = ${d(s.slice())};
            }
          }
          setOutput(result);
        }
    `;function u(h){return p(h)}function c(h){return h[r-1]="("+h[r-1]+" + 1)",p(h)}function l(h){return h[r-2]="("+h[r-2]+" + 1)",p(h)}function d(h){return h[r-1]="("+h[r-1]+" + 1)",h[r-2]="("+h[r-2]+" + 1)",p(h)}function p(h){const y=e.map((v,w)=>f(w,h)),x=y.join(","),g=y.slice(-2).join(",");return`getChannel(getX(${x}), vec2(${g}))`}function f(h,y){return n.indexOf(h)!==-1&&e[h]!==1?`${e[h]} - ${y[h]} - 1`:`${y[h]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aae(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:a}=r,o=s.shape.length,i=vt(a,s.shape);if(o===0)return Xn({inputs:{x:s},backend:n});const u=U().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new sae(s.shape,i):new rae(s.shape,i);return n.runWebGLProgram(u,[s],s.dtype)}const oae={kernelName:ph,backendName:"webgl",kernelFunc:aae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iae{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],s=e[2];this.outputShape=e;let a="";typeof n=="number"?a=`float outputValue = ${n.toFixed(2)};`:a=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${a}
          if(coordX >= 0 && coordX < ${s} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uae={kernelName:Ih,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:a,center:o}=e,i=n,u=new iae(r.shape,a),[c,l]=sw(o,r.shape[1],r.shape[2]),d=[[c,l,Math.sin(s),Math.cos(s)]];return i.runWebGLProgram(u,[r],r.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lae=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,cae=We({opSnippet:lae}),dae={kernelName:ov,backendName:"webgl",kernelFunc:cae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pae="return inversesqrt(x);",fae=We({opSnippet:pae,cpuKernelImpl:_Q}),hae={kernelName:iv,backendName:"webgl",kernelFunc:fae};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rw{constructor(e,n,r,s,a,o,i=!0,u=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const c=nt(a.length),l=nt(o.length);let d="";r===1?d="i":r===2&&(d="i, j");const p=`getIndices(${d})`;let f="";s===1?f="i":s===2&&(f="i, coords[1]");const h=`getUpdates(${f})`;let y="";u&&(y="coords[0], coords[1]");const x=`getDefaultValue(${y})`,g=n>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${a});

        void main() {
          ${l} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${p});
              flattenedIndex += index * ${g};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${h};
              found = true;
            }
          }
          setOutput(mix(${x}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mae{constructor(e,n,r,s,a,o,i=!0,u=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const c=nt(a.length),l=nt(o.length);let d="";r===1?d="i":r===2&&(d="i, j");const p=`getIndices(${d})`;let f="";s===1?f="i":s===2&&(f="i, coords[1]");const h=`getUpdates(${f})`;let y="";u&&(y="coords[0], coords[1]");const x=`getDefaultValue(${y})`,g=n>1?"strides[j]":"strides",v=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${a});

        void main() {
          ${l} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${p});
              flattenedIndex += index.xz * ${g};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${v};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${h};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${x}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gae(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:a}=e,{shape:o}=r,{sliceRank:i,numUpdates:u,sliceSize:c,strides:l,outputSize:d}=ii(a,s,o),p=[d/c,c];if(d===0)return n.makeTensorInfo(o,s.dtype);const f=ie({inputs:{x:s},backend:n,attrs:{shape:[u,i]}}),h=ie({inputs:{x:a},backend:n,attrs:{shape:[u,c]}}),y=n.makeTensorInfo([],"float32",new Float32Array([0]));let x;U().getBool("WEBGL_PACK")?x=new mae(u,i,f.shape.length,h.shape.length,l,p):x=new Rw(u,i,f.shape.length,h.shape.length,l,p);const g=n.runWebGLProgram(x,[h,f,y],h.dtype),v=ie({inputs:{x:g},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),v}const yae={kernelName:fh,backendName:"webgl",kernelFunc:gae};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xae{constructor(e,n,r,s){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const a="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,i=U().getNumber("WEBGL_VERSION")===2?a:o,u=s==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${i}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${u} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vae(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:a}=e,{side:o}=r,i=new xae(s.shape[0],s.shape[1],a.shape[1],o),u=[[s.shape[1]]];return n.runWebGLProgram(i,[s,a],"int32",u)}const wae={kernelName:mh,backendName:"webgl",kernelFunc:vae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bae{constructor(e,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let s,a;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)a="resRC",s="resRC";else{const i=["resRC.x","resRC.y","resRC.z","resRC.w"],u=[],c=[];for(let l=0;l<n.length;l++)c.push(`${i[l]}`),l<e&&u.push(`${i[l]}`);s=u.join(),a=c.join()}const o=nt(r);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${s});
        if (cVal >= 1.0) {
          setOutput(getA(${a}));
        } else {
          setOutput(getB(${a}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sae(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:a}=e,o=new bae(r.shape.length,s.shape,s.shape.length);return n.runWebGLProgram(o,[r,s,a],Ts(s.dtype,a.dtype))}const Cae={kernelName:uv,backendName:"webgl",kernelFunc:Sae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iae=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${bN};
  float scale = ${SN};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,$ae=We({opSnippet:Iae}),_ae={kernelName:lv,backendName:"webgl",kernelFunc:$ae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nae=Wu+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,kae=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Eae=We({opSnippet:Nae,packedOpSnippet:kae,cpuKernelImpl:kQ}),Tae={kernelName:hv,backendName:"webgl",kernelFunc:Eae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rae=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,Aae=We({opSnippet:Rae}),Oae={kernelName:fv,backendName:"webgl",kernelFunc:Aae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dae=Wu+`
  return sin(x);
`,Pae=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${pi}
  return result;
`,Fae=We({opSnippet:Dae,packedOpSnippet:Pae}),Lae={kernelName:dv,backendName:"webgl",kernelFunc:Fae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mae=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Bae=We({opSnippet:Mae}),Vae={kernelName:pv,backendName:"webgl",kernelFunc:Bae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zae=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Wae=We({opSnippet:zae}),Uae={kernelName:mv,backendName:"webgl",kernelFunc:Wae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gae=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:a,paddings:o}=r;E(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const i=a.reduce((g,v)=>g*v),u=[[0,0]];u.push(...o);for(let g=1+a.length;g<s.shape.length;++g)u.push([0,0]);const c=[],l=wT({inputs:{x:s},backend:n,attrs:{paddings:u,constantValue:0}}),d=Mc(l.shape,a,i,!1),p=Bc(d.length,a.length,!1),f=Vc(l.shape,a,i,!1),h=ie({inputs:{x:l},backend:n,attrs:{shape:d}}),y=xn({inputs:{x:h},backend:n,attrs:{perm:p}}),x=ie({inputs:{x:y},backend:n,attrs:{shape:f}});return c.push(l),c.push(h),c.push(y),c.forEach(g=>n.disposeIntermediateTensorInfo(g)),x},Hae={kernelName:yv,backendName:"webgl",kernelFunc:Gae};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jae(t){const{inputs:e,backend:n}=t,{indices:r,values:s,denseShape:a,defaultValue:o}=e;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${a.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${s.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const i=n.readSync(r.dataId),u=n.readSync(s.dataId),c=n.readSync(a.dataId),l=n.readSync(o.dataId)[0],[d,p,f,h,y]=TQ(i,r.shape,r.dtype,u,s.dtype,c,l);return[n.makeTensorInfo(p,r.dtype,d),n.makeTensorInfo([p[0]],s.dtype,f),n.makeTensorInfo([h.length],"bool",new Uint8Array(h.map(x=>Number(x)))),n.makeTensorInfo([y.length],r.dtype,new Int32Array(y))]}const Kae={kernelName:vv,backendName:"webgl",kernelFunc:jae};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qae(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:s,newShape:a}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${s.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const o=Array.from(n.readSync(s.dataId)),i=n.readSync(r.dataId),u=Array.from(n.readSync(a.dataId)),[c,l,d]=RQ(i,r.shape,r.dtype,o,u);return[n.makeTensorInfo(l,r.dtype,c),n.makeTensorInfo([d.length],a.dtype,new Int32Array(d))]}const Xae={kernelName:xh,backendName:"webgl",kernelFunc:qae};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yae(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:a}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${s.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${a.shape}`);const o=n.readSync(r.dataId),i=n.readSync(s.dataId),u=n.readSync(a.dataId),[c,l]=HE(o,r.shape,r.dtype,i,u,!0);return n.makeTensorInfo(l,r.dtype,c)}const Qae={kernelName:wv,backendName:"webgl",kernelFunc:Yae};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zae(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:a}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${s.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${a.shape}`);const o=n.readSync(r.dataId),i=n.readSync(s.dataId),u=n.readSync(a.dataId),[c,l]=HE(o,r.shape,r.dtype,i,u);return n.makeTensorInfo(l,r.dtype,c)}const Jae={kernelName:bv,backendName:"webgl",kernelFunc:Zae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eoe(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:a,defaultValue:o}=e,{outputShape:i}=r,{sliceRank:u,numUpdates:c,sliceSize:l,strides:d,outputSize:p}=ii(a,s,i),f=!1;if(a.dtype==="string"){const g=n.bufferSync(s),v=n.bufferSync(a),w=bu(n.readSync(o.dataId)[0]),S=NQ(g,v,i,p,l,c,u,d,w,f);return n.makeTensorInfo(i,S.dtype,S.values)}const h=new Rw(c,u,s.shape.length,a.shape.length,d,[p,1],f),y=n.runWebGLProgram(h,[a,s,o],a.dtype),x=ie({inputs:{x:y},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(y),x}const toe={kernelName:vh,backendName:"webgl",kernelFunc:eoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function noe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:a,axis:o}=r,i=vt(o,s.shape)[0],u=iw(s,a,i),c=s.shape.length,l=new Array(c).fill(0),d=s.shape.slice();return u.map(p=>{const f=[...d];f[i]=p;const h=Uu({inputs:{x:s},backend:n,attrs:{begin:l,size:f}});return l[i]+=p,h})}const roe={kernelName:xv,backendName:"webgl",kernelFunc:noe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DS="return sqrt(x);",soe=We({opSnippet:DS,packedOpSnippet:DS,cpuKernelImpl:AQ}),aoe={kernelName:gv,backendName:"webgl",kernelFunc:soe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ooe="return x * x;",ioe=We({opSnippet:ooe}),uoe={kernelName:S$,backendName:"webgl",kernelFunc:ioe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PS="return (a - b) * (a - b);",loe=Qt({opSnippet:PS,packedOpSnippet:PS}),coe={kernelName:Sv,backendName:"webgl",kernelFunc:loe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function doe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");const a=n.readSync(s.dataId),o=Iu(a),i=OQ(o,"string",r);return n.makeTensorInfo(s.shape,"string",i)}const poe={kernelName:C$,backendName:"webgl",kernelFunc:doe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function foe({inputs:t,attrs:e,backend:n}){const{x:r}=t,s=Vr+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,a=new Is(r.shape,s);return n.runWebGLProgram(a,[r],r.dtype)}const hoe={kernelName:Ch,backendName:"webgl",kernelFunc:foe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class moe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=r;const s=r.length,a=nt(r.length),o=nt(r.length);let i="";if(s===1)i="coords * strides + begin";else{let u=0;i=r.map((c,l)=>(u++,r.length===1?`coords * strides[${l}] + begin[${l}]`:`coords[${u-1}] * strides[${l}] + begin[${l}]`)).join(",")}this.userCode=`
      ${a} begin = ${a}(${e});
      ${a} strides = ${a}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function goe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:a,end:o,strides:i,beginMask:u,endMask:c,ellipsisMask:l,newAxisMask:d,shrinkAxisMask:p}=r,{finalShapeSparse:f,finalShape:h,isIdentity:y,sliceDim0:x,isSimpleSlice:g,begin:v,end:w,strides:S}=tw(s.shape,a,o,i,u,c,l,d,p);let $;if(y)$=ie({inputs:{x:s},backend:n,attrs:{shape:h}});else if(x||g){E(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const T=Jv(v,w,S),A=Uu({inputs:{x:s},backend:n,attrs:{begin:v,size:T}});$=ie({inputs:{x:A},backend:n,attrs:{shape:h}}),n.disposeIntermediateTensorInfo(A)}else if(n.shouldExecuteOnCPU([s])){const A=n.readSync(s.dataId),B=xt(s.shape,s.dtype,A),L=DQ(f,B,S,v);$=n.makeTensorInfo(h,s.dtype,L.values)}else{const A=new moe(v,S,f);$=n.runWebGLProgram(A,[s],s.dtype)}const k=ie({inputs:{x:$},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo($),k}const yoe={kernelName:wh,backendName:"webgl",kernelFunc:goe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xoe(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:a,leftPad:o,rightPad:i,padWidth:u,preserveShortSequences:c}=r,{data:l,dataSplits:d}=e,p=n.readSync(l.dataId),f=n.readSync(d.dataId),[h,y]=PQ(p,f,s,a,o,i,u,c);return[n.makeTensorInfo([h.length],"string",h),n.makeTensorInfo(d.shape,"int32",y)]}const voe={kernelName:Cv,backendName:"webgl",kernelFunc:xoe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function woe(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:s}=r,{input:a,delimiter:o}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const i=n.readSync(a.dataId),u=n.readSync(o.dataId)[0],[c,l,d]=FQ(i,u,s),p=l.length;return[n.makeTensorInfo([p,2],"int32",c),n.makeTensorInfo([p],"string",l),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const boe={kernelName:Iv,backendName:"webgl",kernelFunc:woe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Soe(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:s}=r,{input:a}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(a.dataId),i=LQ(o,s);return n.makeTensorInfo(a.shape,"int32",i)}const Coe={kernelName:$v,backendName:"webgl",kernelFunc:Soe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ioe="return tan(x);",$oe=We({opSnippet:Ioe}),_oe={kernelName:Nv,backendName:"webgl",kernelFunc:$oe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Noe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,koe=We({opSnippet:Noe}),Eoe={kernelName:kv,backendName:"webgl",kernelFunc:koe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Toe(t){const{inputs:e,backend:n,attrs:r}=t,{tensor:s,indices:a,updates:o}=e,{sliceRank:i,numUpdates:u,sliceSize:c,strides:l,outputSize:d}=ii(o,a,s.shape),p=[d/c,c];if(d===0)return n.makeTensorInfo(s.shape,a.dtype);const f=ie({inputs:{x:a},backend:n,attrs:{shape:[u,i]}}),h=ie({inputs:{x:o},backend:n,attrs:{shape:[u,c]}}),y=ie({inputs:{x:s},backend:n,attrs:{shape:p}}),x=new Rw(u,i,f.shape.length,h.shape.length,l,p,!1,!0),g=n.runWebGLProgram(x,[h,f,y],y.dtype),v=ie({inputs:{x:g},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(g),v}const Roe={kernelName:hh,backendName:"webgl",kernelFunc:Toe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Aoe{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[o]*n[o];this.outputShape=r,this.rank=r.length;const s=nt(this.rank),a=Ooe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        setOutput(getA(${a}));
      }
    `}}function Ooe(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let s=0;s<t.length;s++)r.push(`imod(${n[s]}, ${t[s]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ST(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:a}=r;if(s.dtype==="string"||s.shape.length>5){const u=n.readSync(s.dataId),c=s.dtype==="string"?u.map(p=>bu(p)):u,l=xt(s.shape,s.dtype,c),d=BQ(l,a);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const o=new Aoe(s.shape,a);return n.runWebGLProgram(o,[s],s.dtype)}const Doe={kernelName:Ac,backendName:"webgl",kernelFunc:ST};class Poe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class Foe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yo(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function FS(t){let e=1;for(;e<t;)e*=2;return e}function Loe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:a,sorted:o}=r,i=U().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),u=U().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=s.shape,l=c[c.length-1];if(n.shouldExecuteOnCPU([s])||l<i||a>u){const L=n.readSync(s.dataId),[z,Y]=VQ(L,c,s.dtype,a,o);return[n.makeTensorInfo(z.shape,z.dtype,z.values),n.makeTensorInfo(Y.shape,Y.dtype,Y.values)]}if(a===0)return c[c.length-1]=0,[n.makeTensorInfo(c,s.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(l===1)return[s,Hc({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const d=n.texData.get(s.dataId),p=d!==null&&d.isPacked,f=p?n.unpackTensor(s):s,y=K(c)/l,x=ie({inputs:{x:f},attrs:{shape:[y,l]},backend:n});p&&yo(n,f);const g=FS(a),v=FS(l);let w=null;const S=()=>w===null?[x,x]:[x,w],$=(L,z,Y)=>{const Q=S(),re=new Poe(Y),de=[[l],[w===null?1:0],[Number.NEGATIVE_INFINITY],[L],[z]],ce=w;w=n.runWebGLProgram(re,Q,"int32",de),yo(n,ce)};for(let L=1;L<g;L*=2){const z=L*2;for(let Y=L;Y>=1;Y/=2)$(z,Y,[y,v])}for(let L=v;L>g;L/=2){const z=S(),Y=new Foe([y,L/2]),re=[[l],[w===null?1:0],[g]],Z=w;w=n.runWebGLProgram(Y,z,"int32",re),yo(n,Z);const de=g/2,ce=de*2;for(let j=de;j>=1;j/=2)$(ce,j,w.shape)}let k=w;w=Uu({inputs:{x:w},backend:n,attrs:{begin:0,size:[y,a]}}),yo(n,k);let T=hT({inputs:{x,indices:w},backend:n,attrs:{axis:1,batchDims:1}});yo(n,x);const A=c.slice(0,-1);A.push(a),k=w,w=ie({inputs:{x:w},attrs:{shape:A},backend:n}),yo(n,k);const B=T;return T=ie({inputs:{x:T},attrs:{shape:A},backend:n}),yo(n,B),[T,w]}const Moe={kernelName:bh,backendName:"webgl",kernelFunc:Loe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Boe{constructor(e,n,r,s,a,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const i=r==="nearest"?1:2;let u;switch(s){case"constant":u=1;break;case"reflect":u=2;break;case"wrap":u=3;break;case"nearest":u=4;break;default:u=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${u} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${u} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${u} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${a});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${a});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${i} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Voe(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,transforms:a}=e,{interpolation:o,fillMode:i,fillValue:u,outputShape:c}=r,[l,d,p,f]=s.shape,[h,y]=c??[d,p],x=[l,h,y,f],g=new Boe(d,p,o,i,u,x);return n.runWebGLProgram(g,[s,a],"float32")}const zoe={kernelName:Sh,backendName:"webgl",kernelFunc:Voe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Woe(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:a}=e;Wc(a,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(a.dataId),{outputValues:i,outputShape:u,indices:c}=zQ(o,s,a.shape,a.dtype);return[r.makeTensorInfo(u,a.dtype,i),r.makeTensorInfo([c.length],"int32",c)]}const Uoe={kernelName:Ev,backendName:"webgl",kernelFunc:Woe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Goe(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:a}=r;a<0&&(a+=s.shape.length);const o=s,i=o.shape.length,u=s.shape[a],c=new Array(i-1);let l=0;for(let y=0;y<i;y++)y!==a&&(c[l++]=o.shape[y]);const d=[],p=new Array(i).fill(0),f=o.shape.slice();f[a]=1;const h=new Array(u);for(let y=0;y<h.length;y++){p[a]=y;const x=Uu({inputs:{x:o},backend:n,attrs:{begin:p,size:f}}),g=ie({inputs:{x},backend:n,attrs:{shape:c}});h[y]=g,d.push(x)}return d.forEach(y=>n.disposeIntermediateTensorInfo(y)),h}const Hoe={kernelName:Tv,backendName:"webgl",kernelFunc:Goe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class joe{constructor(e,n){this.variableNames=["x","segmentIds"];const r=e.windowSize,s=e.batchSize,a=e.inSize,o=e.numSegments,i=o*Math.ceil(a/r);this.outputShape=[s,i];const u="0.0",c="sumValue",l=Math.floor(r/4)*4,d=r%4,p=`
        sumValue += dot(values, segFilter);
    `;let f="";a%r>0&&(f=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `);let h="";a%r>0&&(h=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${u};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${h}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${l}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${p}
        }

        int inIdx = inOffset + ${l};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${p}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${p}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${p}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Koe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:a}=e,{numSegments:o}=r,i=s.shape.length,u=[];let c=0;const l=An([c],i);let d=s;l!=null&&(d=xn({inputs:{x:s},backend:n,attrs:{perm:l}}),u.push(d),c=Xt(1,i)[0]);const p=PN(d.shape,c,o),f=K([d.shape[c]]),h=ie({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}});u.push(h);const y=Ov(s.dtype),x=(S,$,k,T,A)=>{const B=S.shape[0],L=S.shape[1],z=DN(L,A),Y={windowSize:z,inSize:L,batchSize:B,numSegments:A},Q=new joe(Y,$),re=n.compileAndRun(Q,[S,k],T);if(u.push(re),re.shape[1]===A)return re;const Z=bT({backend:n,attrs:{start:0,stop:A,step:1,dtype:"float32"}}),de=ST({inputs:{x:Z},backend:n,attrs:{reps:[L/z]}});return u.push(Z),u.push(de),x(re,$,de,T,A)},g=x(h,"unsortedSegmentSum",a,y,o),v=ie({inputs:{x:g},backend:n,attrs:{shape:p}});let w=v;if(l!=null){u.push(v);const S=Fc(l);w=xn({inputs:{x:w},backend:n,attrs:{perm:S}})}return u.forEach(S=>n.disposeIntermediateTensorInfo(S)),w}const qoe={kernelName:I$,backendName:"webgl",kernelFunc:Koe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xoe=[AZ,DZ,LZ,VZ,WZ,HZ,KZ,XZ,JZ,tJ,sJ,iJ,cJ,hJ,yJ,vJ,bJ,$J,NJ,EJ,OJ,VJ,WJ,jJ,qJ,eee,nee,oee,mZ,lee,hee,xee,Iee,Nee,Eee,Ree,Oee,Lee,Vee,Uee,Hee,Kee,Xee,Zee,ete,ste,ote,lte,pte,hte,xte,Ste,_te,Ete,Ate,Ote,Pte,Lte,Bte,zte,Ute,Kte,Yte,Jte,tne,sne,ine,dne,mne,hZ,yne,pee,wne,Cne,_ne,yZ,Tne,Dne,Fne,Vne,Une,Kne,Yne,ere,sre,ire,lre,fre,mre,yre,bre,Cre,$re,Nre,Ere,Ore,Lre,zre,Xre,wZ,Jre,nse,ase,use,YJ,dse,fse,mse,xse,Sse,vZ,Ise,_se,kse,Tse,Rse,QJ,Hre,Dse,Mse,Wse,SZ,jse,Xse,Jse,nae,oae,uae,dae,hae,yae,wae,Cae,_ae,Tae,Oae,Lae,Vae,MJ,Kre,Uae,Hae,Kae,Xae,Qae,Jae,toe,roe,aoe,uoe,coe,poe,hoe,yoe,voe,boe,Coe,jre,EZ,_oe,Eoe,Roe,Doe,Moe,zoe,TZ,Uoe,Hoe,qoe,pse];for(const t of Xoe)$$(t);r9(`https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-backend-wasm@${a9}/dist/`);const jm={WEBGL_VERSION:[1,2],WASM_HAS_SIMD_SUPPORT:[!0,!1],WASM_HAS_MULTITHREAD_SUPPORT:[!0,!1],WEBGL_CPU_FORWARD:[!0,!1],WEBGL_PACK:[!0,!1],WEBGL_FORCE_F16_TEXTURES:[!0,!1],WEBGL_RENDER_FLOAT32_CAPABLE:[!0,!1],WEBGL_FLUSH_THRESHOLD:[-1,0,.25,.5,.75,1,1.25,1.5,1.75,2],CHECK_COMPUTATION_FOR_ERRORS:[!0,!1]};async function Yoe(t){const e=vs();if(!(t in e.registryFactory))throw new Error(`${t} backend is not registed.`);if(t in e.registry){const n=a3(t);s3(t),Dv(t,n)}await n3(t)}async function Qoe(t,e){if(t==null)return;if(typeof t!="object")throw new Error(`An object is expected, while a(n) ${typeof t} is found.`);for(const s in t){if(!(s in jm))throw new Error(`${s} is not a tunable or valid environment flag.`);if(jm[s].indexOf(t[s])===-1)throw new Error(`${s} value is expected to be in the range [${jm[s]}], while ${t[s]} is found.`)}U().setFlags(t);const[n,r]=e.split("-");n==="tfjs"&&await Yoe(r)}const Kh="[V-Gesture] ",Aw=console.warn.bind(console,Kh);console.debug.bind(console,Kh);console.log.bind(console,Kh);const Zp=console.error.bind(console,Kh),CT=(t,e,n=!1)=>{const r={get:(s,a,o)=>n&&typeof s[a]=="object"&&s[a]!==null?new Proxy(s[a],r):Reflect.get(s,a,o),set:(s,a,o)=>a[0]==="_"?o.accessKey===e?(s[a]=o.value,!0):!1:(s[a]=o,!0)};return new Proxy(t,r)};function Km(t,e){return{accessKey:t,value:e}}class kr extends Error{constructor(e,n,r){super(r),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"initiate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.type=e,this.initiate=n}}var Bn;(function(t){t.LEFT="left",t.RIGHT="right"})(Bn||(Bn={}));var Wn;(function(t){t.VALIDATION="validation-error",t.UNKNOWN="unknown-error",t.PREDICTION="prediction-error",t.UNSUPPORT="unsupport-error",t.NOT_ALLOWED="not-allowed-error"})(Wn||(Wn={}));var va;(function(t){t.IDLE="idle",t.READY="ready",t.RUNNING="running",t.FINISHED="finished"})(va||(va={}));const Md=Symbol("HandDetector-setter-access-key");class Zoe{constructor(){return Object.defineProperty(this,"_detector",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_initialized",{enumerable:!0,configurable:!0,writable:!0,value:!1}),CT(this,Md)}async initialize(){if(this._initialized)return Zp("Duplicate HandDetector initialization not allowed"),null;await Qoe({},"");const e=await Fj();this._detector=Km(Md,e),this._initialized=Km(Md,!0)}async predict(e){const n=this._detector;if(!n||!this._initialized)throw new kr(Wn.VALIDATION,"HandDetector.predict","HandPost Detector not initialized");const r=await(n==null?void 0:n.estimateHands(e.video,{flipHorizontal:!1}).catch(s=>{throw new kr(Wn.PREDICTION,"estimateHands",s)}));for(const s of r)s.handedness==="Left"?s.handedness="Right":s.handedness="Left";if(!(r instanceof Array))throw n==null||n.dispose(),this._detector=Km(Md,null),e.close(),new kr(Wn.PREDICTION,"HandDetector.predict",`Prediction failed. expected prediction return type to be array but got ${typeof r}`);if(r.length!==0)return r}}const Joe=3,LS="func::",MS="var::",BS="vGesture-canvas-wrapper",IT="vGesture-video",$T="vGesture-stage",eie="vGesture-scatter-gl-container-left",tie="vGesture-scatter-gl-container-right",ml=["#EAC435","#345995","#03CEA4","#FB4D3D","#CA1551"],nie="#0000ff",gl=30,rie=10,sie="#B388EB",aie=30;let Bd=null,VS;class Ow{constructor(e,n){Object.defineProperty(this,"video",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"targetFPS",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ready",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"stream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.video=document.getElementById(IT),this.targetFPS=n.targetFPS,this.stream=e,VS=this.updateMedia.bind(this),window.addEventListener("resize",VS),this.ready=!0}static async setupCamera(e){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new kr(Wn.UNSUPPORT,"Camera.setupCamera","Browser API navigator.mediaDevices.getUserMedia not available");const{targetFPS:n}=e,r={audio:!1,video:{facingMode:"user",width:window.innerWidth,height:window.innerHeight,frameRate:{ideal:n}}},s=await navigator.mediaDevices.getUserMedia(r),a=new Ow(s,{targetFPS:n});a.video.srcObject=s,await new Promise(u=>{a.video.onloadedmetadata=()=>{u(a.video)}}),a.video.play();const o=a.video.videoWidth,i=a.video.videoHeight;return a.video.width=o,a.video.height=i,a}close(){this.video.srcObject.getVideoTracks()[0].stop(),this.ready=!1}async updateMedia(){Bd&&clearTimeout(Bd),Bd=setTimeout(async()=>{this.close(),this.video.pause();const e={audio:!1,video:{facingMode:"user",width:window.innerWidth,height:window.innerHeight,frameRate:{ideal:this.targetFPS}}},n=await navigator.mediaDevices.getUserMedia(e);this.video.srcObject=n,await new Promise(r=>{this.video.onloadedmetadata=()=>{r(this.video)}}),this.video.width=this.video.videoWidth,this.video.height=this.video.videoHeight,this.video.play(),Bd=null,this.ready=!0},500)}}function My(t,e){return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)}function zS(t,e,n){if(!e)return n;if(!n)return e;const r=My(t,e.boundary),s=My(t,n.boundary);return r<s?e:n}const _T=3;class Cc{[Symbol.iterator](){let e=-1;const n=this.data;return{next:()=>({value:n[++e],done:e>=n.length})}}constructor(e,n=2,r=0){if(Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"root",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"left",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"right",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"depth",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"axis",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dimension",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"m",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n>_T)throw new kr(Wn.VALIDATION,"KDTree.constructor","Unable to construct K-d tree. Unsupported Dimension");this.data=e,this.depth=r,this.dimension=n,this.axis=r%n,this.data=oie(this.data,this.axis),this.size=this.data.length,this.m=Math.floor(e.length/2),this.root=this.data[this.m],this.id=this.root.id,this.m>0&&(this.left=new Cc(this.data.slice(0,this.m),this.depth+1)),this.size-(this.m+1)>0&&(this.right=new Cc(this.data.slice(this.m+1),this.depth+1))}searchClosest(e){return this._search(this,e)}_search(e,n){if(!e)return null;const r=this.axis;let s=null,a=null;const o=e.root.boundary[r];n[r]<o?(s=e.left,a=e.right):(s=e.right,a=e.left);let i=zS(n,s==null?void 0:s._search(s,n),e.root);return My(n,i.boundary)>Math.abs(n[r]-o)&&(i=zS(n,a==null?void 0:a._search(a,n),i)),i}}function oie(t,e){if(e<=_T)return t.sort((n,r)=>n.boundary[e]-r.boundary[e]);throw new kr(Wn.VALIDATION,"KDTree.sort",`UnSupported axis: ${e}`)}var NT={exports:{}};(function(t){(function(e){var n=function(){},r=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.msRequestAnimationFrame||function(l){return setTimeout(l,16)};function s(){var l=this;l.reads=[],l.writes=[],l.raf=r.bind(e)}s.prototype={constructor:s,runTasks:function(l){for(var d;d=l.shift();)d()},measure:function(l,d){var p=d?l.bind(d):l;return this.reads.push(p),a(this),p},mutate:function(l,d){var p=d?l.bind(d):l;return this.writes.push(p),a(this),p},clear:function(l){return i(this.reads,l)||i(this.writes,l)},extend:function(l){if(typeof l!="object")throw new Error("expected object");var d=Object.create(this);return u(d,l),d.fastdom=this,d.initialize&&d.initialize(),d},catch:null};function a(l){l.scheduled||(l.scheduled=!0,l.raf(o.bind(null,l)))}function o(l){var d=l.writes,p=l.reads,f;try{n("flushing reads",p.length),l.runTasks(p),n("flushing writes",d.length),l.runTasks(d)}catch(h){f=h}if(l.scheduled=!1,(p.length||d.length)&&a(l),f)if(n("task errored",f.message),l.catch)l.catch(f);else throw f}function i(l,d){var p=l.indexOf(d);return!!~p&&!!l.splice(p,1)}function u(l,d){for(var p in d)d.hasOwnProperty(p)&&(l[p]=d[p])}var c=e.fastdom=e.fastdom||new s;t.exports=c})(typeof window<"u"?window:typeof qn<"u"?qn:globalThis)})(NT);var iie=NT.exports,uie=Rc(iie),kT={exports:{}};(function(t){(function(){var e={initialize:function(){this._tasks=new Map},mutate:function(r,s){return n(this,"mutate",r,s)},measure:function(r,s){return n(this,"measure",r,s)},clear:function(r){var s=this._tasks,a=s.get(r);this.fastdom.clear(a),s.delete(r)}};function n(r,s,a,o){var i=r._tasks,u=r.fastdom,c,l=new Promise(function(d,p){c=u[s](function(){i.delete(l);try{d(o?a.call(o):a())}catch(f){p(f)}},o)});return i.set(l,c),l}t.exports=e})()})(kT);var lie=kT.exports,cie=Rc(lie);function qh(t,e){var n;if(!t)return null;e&&e(t);for(let r=0;r<((n=t==null?void 0:t.childNodes)==null?void 0:n.length);r++){const s=t.childNodes[r];die(s)&&qh(s,e)}}function die(t){const e=["script","head","data","embed","html","unknown","meta","link","object","script","noscript","source","template","track","title","style","link","#text"],n=!t.nodeValue&&t.nodeType===1,r=!e.includes(t.nodeName.toLowerCase());return n&&r}qh(document.body);const pie=uie.extend(cie);class fie{[Symbol.iterator](){let e=-1;const n=this._originalData;return{next:()=>({value:n[++e],done:e>=n.length})}}constructor(e,n=2){if(Object.defineProperty(this,"_originalData",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dimension",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_searchTree",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"baseCoord",{enumerable:!0,configurable:!0,writable:!0,value:[document.documentElement.scrollLeft,document.documentElement.scrollTop]}),n>Joe)throw new kr(Wn.VALIDATION,"DataDomain.constructor","Unable to construct DataDomain. Unsupported Dimension");this._originalData=e,this.dimension=n,this.size=this._originalData.length}async update(){const e="vgesturable",n=[];let r=0;await pie.mutate(()=>{qh(document.body,s=>{if(s.hasAttribute("vgesturable")){const a=s,{top:o,left:i,width:u,height:c}=a.getBoundingClientRect();let l=a.id;l||(l=`${e}-${r}`,r++),a.id=l;const d=i+u/2,p=o+c/2,f=u/2,h=c/2,y=[d,p,f,h],x={id:l,dimension:y.length/2,boundary:y};n.push(x)}})}),this._originalData=n,this.size=this._originalData.length}searchClosest(e){var o,i;const n=[((o=document.scrollingElement)==null?void 0:o.scrollLeft)||0,((i=document.scrollingElement)==null?void 0:i.scrollTop)||0,0],r=[this.baseCoord[0]-n[0],this.baseCoord[1]-n[1]];this._createSearchTree(r);const s=this._searchTree;if(!s||!(s instanceof Cc))return null;const a=s.searchClosest(e);return this._searchTree=null,a}_createSearchTree(e){let n=this._originalData.filter(s=>s.boundary[0]+e[0]>=0&&s.boundary[1]+e[1]>=0&&s.boundary[0]+e[0]<=window.innerWidth&&s.boundary[1]+e[1]<=window.innerHeight);if(n=n.map(s=>{const a=structuredClone(s);return a.boundary[0]+=e[0],a.boundary[1]+=e[1],a}),n.length<=0){this._searchTree=null;return}const r=new Cc(n,this.dimension);this._searchTree=r}}function hie(t,e){return!t||!e?NaN:Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)}function mie(t,e){if(!t)return null;let n="";switch(e){case"wrist":{n=e;break}case"thumb_cmc":{n="thumbCmc";break}case"thumb_mcp":{n="thumbMcp";break}case"thumb_ip":{n="thumbIp";break}case"thumb_tip":{n="thumbTip";break}case"index_finger_mcp":{n="indexMcp";break}case"index_finger_pip":{n="indexPcp";break}case"index_finger_dip":{n="indexDip";break}case"index_finger_tip":{n="indexTip";break}case"middle_finger_mcp":{n="middleMcp";break}case"middle_finger_pip":{n="middlePcp";break}case"middle_finger_dip":{n="middleDip";break}case"middle_finger_tip":{n="middleTip";break}case"ring_finger_mcp":{n="ringMcp";break}case"ring_finger_pip":{n="ringPcp";break}case"ring_finger_dip":{n="ringDip";break}case"ring_finger_tip":{n="ringTip";break}case"pinky_finger_mcp":{n="pinkyMcp";break}case"pinky_finger_pip":{n="pinkyPcp";break}case"pinky_finger_dip":{n="pinkyDip";break}case"pinky_finger_tip":{n="pinkyTip";break}}return t?{name:n,x:t.x,y:t.y}:null}const WS={get2FingerDistance:hie};function gie(t){switch(t.startsWith(LS)?"function":t.startsWith(MS)?"variable":"invalid"){case"function":{let n=t.split(LS)[1];n=n.split("-");const r=n.shift(),s=n;return r in WS||Zp(`function ${r} is not supported`),{type:"function",func:WS[r],vars:s}}case"variable":return{type:"variable",vars:t.split(MS)[1]};default:return Zp(`operation ${t} is not a valid format`),null}}function yie(t,e){const n=e.gesture.name;if(!t.gestureManager.gestures.has(n)){const s=a=>{e.gesture.handler(a,t.gestureTargetCollection)};return window.addEventListener(e.gesture.eventName,s),[s]}}function xie(t,e){window.removeEventListener(t.gesture.eventName,e)}const vie={enableHelper:t=>!t},wie={usedHand:"hand",disableHelper:"enableHelper",operationsRequest:"operations"};function Dw(t){const e=t;let n=e;e.constructor.name==="Object"&&(n={...e});for(const r of Object.keys(e)){const s=wie[r];if(typeof e[r]=="object"&&!(e[r]instanceof Array)&&e[r]&&(n[r]=Dw(e[r])),s){const a=e[r],o=vie[s];delete n[r],n[s]=o?o(a):a,Aw(`Property "${r}" is not used anymore. Please use "${s}"`)}}return n}const bie=Symbol("Gesture-manager"),Sie={thumb_tip:!0,index_finger_tip:!0,middle_finger_tip:!0,ring_finger_tip:!0,pinky_finger_tip:!0};class Cie{constructor(){return Object.defineProperty(this,"gestures",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"gestureGC",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sharedOperations",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"handsVertex",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.gestures=new Map,this.gestureGC=new Map,this.sharedOperations=new Map,this.handsVertex=new Map,this.handsVertex.set(Bn.LEFT,new Map),this.handsVertex.set(Bn.RIGHT,new Map),this.version=0,CT(this,bie)}has(e){return this.gestures.has(e)}register(e,n){const r=Dw(e),s=r.gesture.name,a=this.gestures,o=this.gestureGC,i=r.gesture.operations,u=r.gesture.hand;if(i&&this._registerOperation(i,u),a.has(s)){Aw(`${s} is already registered`);return}const c=()=>{r.unregister?r.unregister():n&&xie(r,n),a.delete(s)};a.set(s,r.gesture),o.set(s,c)}dispose(e){const n=this.gestures.get(e);if(n!=null&&n.operations)for(const s of n.operations){const a=this.sharedOperations.get(s);a&&(a.used-=1,a.used<=0&&this.sharedOperations.delete(s))}const r=this.gestureGC.get(e);typeof r=="function"&&r(),this.gestureGC.delete(e),this.gestures.delete(e)}disposeAll(){this.gestureGC.forEach(e=>{typeof e=="function"&&e()}),this.gestures.clear(),this.gestureGC.clear(),this.sharedOperations.clear()}updateHandVertex(e,n){if(e==="left"||e==="right"){const r=this.handsVertex.get(e);n.keypoints.forEach(s=>{if(s.name&&s.name in Sie){const a=mie(s,s.name);a&&r.set(a.name,a)}})}}_registerOperation(e,n){const r=this.sharedOperations;for(const s of e){let a=r.get(s);if(a)a.used++;else{const o=gie(s);if(!o)return;a={used:1,operation:this._operationFactory(o,n),value:null,version:0%8}}this.sharedOperations.set(s,a)}}_operationFactory(e,n){let r;if(e.type==="function"){const s=e,a=s.func;r=()=>{const o=s.vars.map(i=>{if(n===Bn.LEFT)return this.handsVertex.get(Bn.LEFT).get(i);if(n===Bn.RIGHT)return this.handsVertex.get(Bn.RIGHT).get(i)});return a(...o)}}if(e.type==="variable"){const a=e.vars;n===Bn.LEFT&&(r=()=>this.handsVertex.get(Bn.LEFT).get(a)),n===Bn.RIGHT&&(r=()=>this.handsVertex.get(Bn.RIGHT).get(a))}return r}}class Iie{constructor(e,n,r,s){Object.defineProperty(this,"ctx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"point",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"r",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"g",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"b",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lifespan",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ctx=e,this.r=parseInt(r.slice(1,3),16),this.g=parseInt(r.slice(3,5),16),this.b=parseInt(r.slice(5,7),16),this.point=n,this.lifespan=1,this.size=s}draw(){this.ctx.beginPath(),this.ctx.arc(this.point.x,this.point.y,this.size,0,2*Math.PI),this.ctx.fillStyle=`rgba(${this.r}, ${this.g}, ${this.b} , ${this.lifespan})`,this.ctx.fill(),this.ctx.closePath()}update(){this.lifespan-=.01}}let yl;class $ie{constructor(e){Object.defineProperty(this,"canvas",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ctx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"helper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hitpoints",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"initialized",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.canvas=document.getElementById($T),this.ctx=this.canvas.getContext("2d"),this.helper=e,this.hitpoints=[],this._resize(),this.initialized=!0,yl=this._resize.bind(this),this.connect()}connect(){yl&&window.addEventListener("resize",yl)}disconnect(){yl&&window.removeEventListener("resize",yl)}_resize(){this.clearCtx(),this.canvas.style.width=`${window.innerWidth}px`,this.canvas.style.height=`${window.innerHeight}px`,this.canvas.width=window.innerWidth*2,this.canvas.height=window.innerHeight*2,this.ctx.translate(window.innerWidth*2,0),this.ctx.scale(-2,2)}createHitPoint(e){var a,o;const n=((a=this.helper)==null?void 0:a.hitpoint.color)||sie,r=((o=this.helper)==null?void 0:o.hitpoint.size)||aie,s=new Iie(this.ctx,e,n,r);this.hitpoints.push(s)}drawHitPoint(){this.helper&&this.hitpoints.forEach(e=>{e.update(),e.draw(),e.lifespan<0&&this.hitpoints.shift()})}drawTips(e){var s,a,o,i,u,c,l,d,p,f;if(!e||!this.helper)return;let n=nie,r=rie;switch(e.name){case"thumbTip":{n=((s=this.helper)==null?void 0:s.colors.thumbTip)||ml[0],r=((a=this.helper)==null?void 0:a.sizes.thumbTip)||gl;break}case"indexTip":{n=((o=this.helper)==null?void 0:o.colors.indexTip)||ml[1],r=((i=this.helper)==null?void 0:i.sizes.indexTip)||gl;break}case"middleTip":{n=((u=this.helper)==null?void 0:u.colors.middleTip)||ml[2],r=((c=this.helper)==null?void 0:c.sizes.middleTip)||gl;break}case"ringTip":{n=((l=this.helper)==null?void 0:l.colors.ringTip)||ml[3],r=((d=this.helper)==null?void 0:d.sizes.ringTip)||gl;break}case"pinkyTip":{n=((p=this.helper)==null?void 0:p.colors.pinkyTip)||ml[4],r=((f=this.helper)==null?void 0:f.sizes.pinkyTip)||gl;break}}this.ctx.fillStyle=n,this.ctx.beginPath(),typeof e.x=="number"&&typeof e.y=="number"&&this.drawPoint(e.x,e.y,r),this.ctx.closePath()}clearCtx(){this.ctx.clearRect(0,0,this.canvas.width*2,this.canvas.height*2)}drawPoint(e,n,r){this.ctx.beginPath(),this.ctx.arc(e,n,r,0,2*Math.PI),this.ctx.fill()}drawVideo(e){this.ctx.drawImage(e,0,0,e.videoWidth,e.videoHeight)}}function _ie(t){return!(t.register&&!t.unregister||!t.register&&t.unregister)}function Nie(t,e,{signal:n}={}){let r=null;const s=function(...o){r!==null&&clearTimeout(r),!(n!=null&&n.aborted)&&(r=setTimeout(()=>{t(...o),r=null},e))},a=function(){s.cancel()};return s.cancel=function(){r!==null&&(clearTimeout(r),r=null)},n==null||n.addEventListener("abort",a,{once:!0}),s}const US=Symbol("driverKey");class kie{constructor(e={}){var a,o,i;Object.defineProperty(this,"gestureManager",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"gestureTargetCollection",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"initialized",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"detector",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"camera",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"stage",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"domObserver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cssomObserver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sessionState",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"frameId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"dataDimension",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"helper",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const n=Dw(e),r=(n==null?void 0:n.dataDimension)||2,s=n!=null&&n.enableHelper?{colors:((a=n==null?void 0:n.helper)==null?void 0:a.colors)||{},sizes:((o=n==null?void 0:n.helper)==null?void 0:o.sizes)||{},hitpoint:((i=n==null?void 0:n.helper)==null?void 0:i.hitpoint)||{}}:null;this.helper=s,this.dataDimension=r,this.gestureManager=new Cie,this.sessionState=va.IDLE,this.domObserver=new MutationObserver(()=>{this.flush()}),this.cssomObserver=new ResizeObserver(()=>{Nie(this.flush.bind(this),200)})}async initialize(){if(this.initialized){Zp("Duplicate V-Gesture initialization not allowed");return}await this._generateGestureTargetCollection(),this._createStarterElems(),this.detector=new Zoe,this.camera=await Ow.setupCamera({targetFPS:60}),this.stage=new $ie(this.helper),await this.detector.initialize(),this.domObserver.observe(document.body,{childList:!0,subtree:!0,characterData:!0,attributeFilter:["style","vgesturable"]}),qh(document.body,e=>{this.cssomObserver.observe(e),e.addEventListener("transitionend",this.flush.bind(this))}),this.initialized=!0,this.sessionState=va.READY}async flush(){var e;(e=this.gestureTargetCollection)==null||e.update()}async startDetection(){if(!this.initialized||!this.detector)throw new kr(Wn.VALIDATION,"VGesture.startDetection","Validation Error: V-Gesture not initialized");if(this.sessionState===va.FINISHED)throw new kr(Wn.NOT_ALLOWED,"VGesture.startDetection","Cannot reuse VGesture session. Please re-instantiate");this.sessionState=va.RUNNING;const e=this;async function n(){await e.task(US),e.frameId=requestAnimationFrame(n)}n()}endDetection(){var e,n,r,s,a;this.sessionState!==va.FINISHED&&(this.sessionState=va.FINISHED,this.frameId&&cancelAnimationFrame(this.frameId),(e=this.camera)==null||e.close(),(n=this.stage)==null||n.disconnect(),(r=this.gestureManager)==null||r.disposeAll(),this._cleanStartedElems(),(s=this.domObserver)==null||s.disconnect(),(a=this.cssomObserver)==null||a.disconnect(),this.initialized=!1)}register(e){const n=e.gesture.name,r=this.gestureManager;if(r.has(n)){Aw(`${n} is already registered`);return}let s;if(!_ie(e))throw new kr(Wn.VALIDATION,"VGesture.register","Validation Error: plugin doesn't match valid interface");if(e.register)e.register(this);else{const o=yie(this,e);o instanceof Array&&(s=o[0])}r.register(e,s)}unregister(e){this.gestureManager.dispose(e)}async task(e){var i;if(e!==US)throw new kr(Wn.NOT_ALLOWED,"VGesture.task","executing task directly is not allowed");const n=this.detector,r=this.camera,s=this.stage,a=this.gestureManager;if(!r.ready)return;s.clearCtx(),s.drawHitPoint();let o;try{o=await n.predict(r)}catch(u){throw u instanceof kr&&u.type===Wn.PREDICTION&&this.endDetection(),u}if(o){for(const u of o){const c=u.handedness==="Left"?Bn.LEFT:Bn.RIGHT;a.updateHandVertex(c,u),(i=a.handsVertex.get(c))==null||i.forEach(l=>{s.drawTips(l)}),s.drawHitPoint()}a.version=(a.version+1)%8,a.gestures.forEach(u=>{let c;if(u.operations&&u.operations.length>0){c={};for(const d of u.operations){let p;const f=a.sharedOperations.get(d);f&&(f.version!==a.version&&(f.value=f.operation(),f.version++,a.sharedOperations.set(d,f)),p=f.value,c[d]=p)}}const l=u.determinant(o,c);l&&"x"in l&&"y"in l&&s.createHitPoint(l)})}}async _generateGestureTargetCollection(){this.gestureTargetCollection=new fie([]),this.gestureTargetCollection.update()}_createStarterElems(){const e=document.createElement("div"),n=document.createElement("video"),r=document.createElement("canvas"),s=document.createElement("div"),a=document.createElement("div");s.id=eie,a.id=tie,n.id=IT,r.id=$T,e.id=BS,s.style.float="left",a.style.float="left",s.style.position="relative",a.style.position="relative",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex="99999",n.playsInline=!0,n.muted=!0,n.style.visibility="hidden",n.style.position="absolute",n.style.transform="scaleX(-1)",r.style.zIndex="99999",r.style.position="fixed",r.style.display="block",r.style.pointerEvents="none",e.appendChild(s),e.appendChild(a),e.appendChild(n),e.appendChild(r),document.body.appendChild(e)}_cleanStartedElems(){const e=document.getElementById(BS);e&&e.remove()}}var By;(function(t){t.LEFT="left",t.RIGHT="right"})(By||(By={}));var GS;(function(t){t.VALIDATION="validation-error",t.UNKNOWN="unknown-error",t.PREDICTION="prediction-error",t.UNSUPPORT="unsupport-error",t.NOT_ALLOWED="not-allowed-error"})(GS||(GS={}));var HS;(function(t){t.IDLE="idle",t.READY="ready",t.RUNNING="running",t.FINISHED="finished"})(HS||(HS={}));class Eie extends Event{constructor(e,n,r){super(e,r),Object.defineProperty(this,"indexTip",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"thumbTip",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"triggerPoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.indexTip=n.indexTip,this.thumbTip=n.thumbTip,this.triggerPoint={x:window.innerWidth-(this.indexTip.x+this.thumbTip.x)/2,y:(this.indexTip.y+this.thumbTip.y)/2}}}class Tie{constructor(e){Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"clickGesture"}),Object.defineProperty(this,"eventName",{enumerable:!0,configurable:!0,writable:!0,value:"clickGesture"}),Object.defineProperty(this,"hand",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dispatchInterval",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"threshold",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"operations",{enumerable:!0,configurable:!0,writable:!0,value:["func::get2FingerDistance-thumbTip-indexTip","func::get2FingerDistance-thumbTip-middleTip","var::thumbTip","var::indexTip"]}),this.dispatchInterval=(e==null?void 0:e.dispatchInterval)||500,this.threshold=(e==null?void 0:e.threshold)||1200,this.hand=(e==null?void 0:e.hand)||By.LEFT}handler(e,n,r){const s=e;r&&(r.style.top=s.triggerPoint.y+"px",r.style.left=s.triggerPoint.x+"px");const a=[s.triggerPoint.x,s.triggerPoint.y],o=n.searchClosest(a);if(o&&a[0]>=o.boundary[0]-o.boundary[2]&&a[0]<=o.boundary[0]+o.boundary[2]&&a[1]>=o.boundary[1]-o.boundary[3]&&a[1]<=o.boundary[1]+o.boundary[3]){const i=o.id;if(i){const u=document.getElementById(i);u==null||u.dispatchEvent(new Event("click",{bubbles:!0}))}}}determinant(e,n){if(this.timer||e.length===0)return!1;const r=n["func::get2FingerDistance-thumbTip-indexTip"],s=n["var::indexTip"],a=n["var::thumbTip"];return s&&a&&r<=this.threshold?(dispatchEvent(new Eie(this.eventName,{indexTip:s,thumbTip:a})),this.timer=setTimeout(()=>{this.timer=null},this.dispatchInterval),{x:(s.x+a.x)/2,y:(s.y+a.y)/2}):!1}}class Rie{constructor(e){Object.defineProperty(this,"gesture",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.gesture=new Tie(e)}}function Aie(){const[t]=G.useState(new kie({enableHelper:!0}));return G.useEffect(()=>{async function e(){await t.initialize(),t.register(new Rie),await t.startDetection()}return t.initialized||e(),()=>{t.endDetection()}},[]),Ee.jsx(Ee.Fragment,{children:Ee.jsxs(Y2,{width:"100vw",height:"100vh",rows:"repeat(2, 1fr)",columns:"repeat(2,1fr)",gap:"0",children:[Ee.jsx(_d,{color:"var(--mint-10)"}),Ee.jsx(_d,{color:"var(--purple-10)"}),Ee.jsx(_d,{color:"var(--crimson-10)"}),Ee.jsx(_d,{color:"var(--lime-10)"})]})})}qm.createRoot(document.getElementById("root")).render(Ee.jsx(cR.StrictMode,{children:Ee.jsx(G2,{accentColor:"blue",grayColor:"sand",radius:"large",scaling:"95%",children:Ee.jsx(Aie,{})})}));
